(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(SimpleType(SimpleName:SignerInfo))(SimpleName:verify)(SingleVariableDeclaration(SimpleType(SimpleName:PKCS7))(SimpleName:block))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:data))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:SignatureException))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:ContentInfo))(VariableDeclarationFragment(SimpleName:content)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:block))(SimpleName:getContentInfo))))(IfStatement(InfixExpression(SimpleName:data)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:data)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:content))(SimpleName:getContentBytes))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:digestAlgname)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getDigestAlgorithmId)))(SimpleName:getName))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestAlgname))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:digestAlgname)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:dataSigned)))(IfStatement(InfixExpression(SimpleName:authenticatedAttributes)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:dataSigned)(ASSIGNMENT_OPERATOR:=)(SimpleName:data))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ObjectIdentifier))(VariableDeclarationFragment(SimpleName:contentType)(CastExpression(SimpleType(SimpleName:ObjectIdentifier))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authenticatedAttributes))(SimpleName:getAttributeValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PKCS9Attribute.CONTENT_TYPE_OID))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:contentType)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentType))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:content.contentType)))))(ReturnStatement(NullLiteral)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:messageDigest)(CastExpression(ArrayType(PrimitiveType:byte)(Dimension))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authenticatedAttributes))(SimpleName:getAttributeValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PKCS9Attribute.MESSAGE_DIGEST_OID))))))(IfStatement(InfixExpression(SimpleName:messageDigest)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ReturnStatement(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestAlgname)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:computedMessageDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)))))(IfStatement(InfixExpression(QualifiedName:messageDigest.length)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:computedMessageDigest.length))(ReturnStatement(NullLiteral)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:messageDigest.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(ArrayAccess(SimpleName:messageDigest)(SimpleName:i))(INFIX_EXPRESSION_OPERATOR:!=)(ArrayAccess(SimpleName:computedMessageDigest)(SimpleName:i)))(ReturnStatement(NullLiteral)))))(ExpressionStatement(Assignment(SimpleName:dataSigned)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authenticatedAttributes))(SimpleName:getDerEncoding))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:encryptionAlgname)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getDigestEncryptionAlgorithmId)))(SimpleName:getName))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encryptionAlgname))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:encryptionAlgname)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:algname)(InfixExpression(SimpleName:digestAlgname)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:encryptionAlgname))))(VariableDeclarationStatement(SimpleType(SimpleName:Signature))(VariableDeclarationFragment(SimpleName:sig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Signature))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:algname)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:cert)(MethodInvocation(SimpleName:getCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:block)))))(IfStatement(InfixExpression(SimpleName:cert)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ReturnStatement(NullLiteral))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:hasUnsupportedCriticalExtension))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:keyUsageBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getExtensionValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:PKIXExtensions.KeyUsage_Id))(SimpleName:toString))))))(IfStatement(InfixExpression(SimpleName:keyUsageBytes)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeyUsageExtension))(VariableDeclarationFragment(SimpleName:keyUsage)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:keyUsage)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:KeyUsageExtension))(ClassInstanceCreation(SimpleType(SimpleName:Boolean))(BooleanLiteral:true))(SimpleName:keyUsageBytes)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioe))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)))))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:digSigAllowed)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Boolean))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyUsage))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:KeyUsageExtension.DIGITAL_SIGNATURE))))))(SimpleName:booleanValue))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:digSigAllowed))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>))))))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:key)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getPublicKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:initVerify)(METHOD_INVOCATION_ARGUMENTS(SimpleName:key))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataSigned))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptedDigest)))(Block(ReturnStatement(ThisExpression)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidKeyException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))(ReturnStatement(NullLiteral))))))