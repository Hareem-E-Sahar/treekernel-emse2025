(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:sendMessage)(SingleVariableDeclaration(SimpleType(SimpleName:EntityManager))(SimpleName:em))(SingleVariableDeclaration(SimpleType(SimpleName:User))(SimpleName:to))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:subject))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:messageText))(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:TaskAttachment)))(SimpleName:attachemnts))(SimpleType(SimpleName:MessagingException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:toEmail)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:to))(SimpleName:getEmail))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:to))(SimpleName:isNotifyByEmail)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:to))(SimpleName:getEmail))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(ReturnStatement))(VariableDeclarationStatement(SimpleType(SimpleName:Message))(VariableDeclarationFragment(SimpleName:message)(ClassInstanceCreation(SimpleType(SimpleName:MimeMessage))(MethodInvocation(SimpleName:getAdminSession)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:setFrom)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getAdminAddress)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:addRecipient)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Message.RecipientType.TO)(ClassInstanceCreation(SimpleType(SimpleName:InternetAddress))(SimpleName:toEmail)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:setSubject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject))))(VariableDeclarationStatement(SimpleType(SimpleName:Multipart))(VariableDeclarationFragment(SimpleName:multipart)(ClassInstanceCreation(SimpleType(SimpleName:MimeMultipart)))))(VariableDeclarationStatement(SimpleType(SimpleName:BodyPart))(VariableDeclarationFragment(SimpleName:part)(ClassInstanceCreation(SimpleType(SimpleName:MimeBodyPart)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:part))(SimpleName:setText)(METHOD_INVOCATION_ARGUMENTS(SimpleName:messageText))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:multipart))(SimpleName:addBodyPart)(METHOD_INVOCATION_ARGUMENTS(SimpleName:part))))(IfStatement(InfixExpression(SimpleName:attachemnts)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:TaskAttachment))(SimpleName:attachment))(SimpleName:attachemnts)(Block(VariableDeclarationStatement(SimpleType(SimpleName:BinaryData))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:em))(SimpleName:find)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:BinaryData)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attachment))(SimpleName:getBinaryId))))))(VariableDeclarationStatement(SimpleType(SimpleName:BodyPart))(VariableDeclarationFragment(SimpleName:attPart)(ClassInstanceCreation(SimpleType(SimpleName:MimeBodyPart)))))(VariableDeclarationStatement(SimpleType(SimpleName:DataSource))(VariableDeclarationFragment(SimpleName:source)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayDataSource))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:getContent))(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attPart))(SimpleName:setDataHandler)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DataHandler))(SimpleName:source)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attPart))(SimpleName:setFileName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attachment))(SimpleName:getName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:multipart))(SimpleName:addBodyPart)(METHOD_INVOCATION_ARGUMENTS(SimpleName:attPart))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:setContent)(METHOD_INVOCATION_ARGUMENTS(SimpleName:multipart))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Transport))(SimpleName:send)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message))))))))