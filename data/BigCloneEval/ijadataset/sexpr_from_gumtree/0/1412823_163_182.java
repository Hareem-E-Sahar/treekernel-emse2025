(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:ByteBuffer))(SimpleName:encode)(SingleVariableDeclaration(Modifier:final)(PrimitiveType:int)(SimpleName:chunkSize))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ByteBuffer))(VariableDeclarationFragment(SimpleName:buffer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:allocate)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1024)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:header))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buffer))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:remaining)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:header))(SimpleName:getSize))))(WhileStatement(BooleanLiteral:true)(Block(VariableDeclarationStatement(Modifier:final)(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:toWrite)(ConditionalExpression(InfixExpression(SimpleName:remaining)(INFIX_EXPRESSION_OPERATOR:>)(SimpleName:chunkSize))(SimpleName:chunkSize)(SimpleName:remaining))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:bytes)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:toWrite))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bytes))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bytes))))(ExpressionStatement(Assignment(SimpleName:remaining)(ASSIGNMENT_OPERATOR:-=)(SimpleName:chunkSize)))(IfStatement(InfixExpression(SimpleName:remaining)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Header))(VariableDeclarationFragment(SimpleName:tiny)(ClassInstanceCreation(SimpleType(SimpleName:Header))(SimpleName:TINY)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:header))(SimpleName:getChannelId))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:header))(SimpleName:getPacketType)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tiny))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buffer)))))(Block(BreakStatement)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:flip)))(ReturnStatement(SimpleName:buffer))))))