(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:addSignatureToPDFDocument)(SingleVariableDeclaration(SimpleType(SimpleName:PDFSignerParameters))(SimpleName:params))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:pdfbytes))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:password))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:DocumentException))(SimpleType(SimpleName:CryptoTokenOfflineException))(SimpleType(SimpleName:SignServerException))(SimpleType(SimpleName:IllegalRequestException))(Block(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Collection))(SimpleType(SimpleName:Certificate)))(VariableDeclarationFragment(SimpleName:certs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getSigningCertificateChain))))(IfStatement(InfixExpression(SimpleName:certs)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignServerException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:certChain)(CastExpression(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certs))(SimpleName:toArray)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:Certificate))(Dimension(NumberLiteral:0)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:privKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getCryptoToken)))(SimpleName:getPrivateKey)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ICryptoToken.PURPOSE_SIGN)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfReader))(VariableDeclarationFragment(SimpleName:reader)(ClassInstanceCreation(SimpleType(SimpleName:PdfReader))(SimpleName:pdfbytes)(SimpleName:password))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:appendMode)(BooleanLiteral:true)))(IfStatement(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getCertificationLevel))(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:PdfSignatureAppearance.NOT_CERTIFIED))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getCertification_level))(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:PdfSignatureAppearance.NOT_CERTIFIED)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalRequestException))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getCertificationLevel))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:PdfSignatureAppearance.CERTIFIED_NO_CHANGES_ALLOWED))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getCertificationLevel))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:PdfSignatureAppearance.CERTIFIED_FORM_FILLING)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalRequestException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Permissions))(VariableDeclarationFragment(SimpleName:currentPermissions)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Permissions))(SimpleName:fromInt)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getPermissions))))))(IfStatement(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getSetPermissions))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getRemovePermissions))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignServerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:workerId)(StringLiteral:<STR>)(SimpleName:SET_PERMISSIONS)(StringLiteral:<STR>)(SimpleName:REMOVE_PERMISSIONS)(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:Permissions))(VariableDeclarationFragment(SimpleName:newPermissions)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getSetPermissions))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:newPermissions)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getSetPermissions)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getRemovePermissions))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:newPermissions)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentPermissions))(SimpleName:withRemoved)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getRemovePermissions)))))))(Block(ExpressionStatement(Assignment(SimpleName:newPermissions)(ASSIGNMENT_OPERATOR:=)(NullLiteral))))))(VariableDeclarationStatement(SimpleType(SimpleName:Permissions))(VariableDeclarationFragment(SimpleName:rejectPermissions)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Permissions))(SimpleName:fromSet)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getRejectPermissions))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:userPassword)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:computeUserPassword))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:cryptoMode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getCryptoMode))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:isDebugEnabled))(Block(VariableDeclarationStatement(SimpleType(SimpleName:StringBuilder))(VariableDeclarationFragment(SimpleName:buff)(ClassInstanceCreation(SimpleType(SimpleName:StringBuilder)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buff))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:currentPermissions))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getRemovePermissions)))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rejectPermissions))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newPermissions))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(SimpleName:userPassword)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(StringLiteral:<STR>)(StringLiteral:<STR>)))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(SimpleName:password)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(StringLiteral:<STR>)(ParenthesizedExpression(ConditionalExpression(MethodInvocation(SimpleName:isUserPassword)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(SimpleName:password)))(StringLiteral:<STR>)(StringLiteral:<STR>)))))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getSetOwnerPassword))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(StringLiteral:<STR>)(StringLiteral:<STR>)))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cryptoMode))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buff))(SimpleName:toString)))))))(IfStatement(InfixExpression(SimpleName:appendMode)(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(InfixExpression(SimpleName:newPermissions)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getSetOwnerPassword))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))))(Block(ExpressionStatement(Assignment(SimpleName:appendMode)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:isDebugEnabled))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:fout)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfStamper))(VariableDeclarationFragment(SimpleName:stp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfStamper))(SimpleName:createSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(SimpleName:fout)(CharacterLiteral:<STR>)(NullLiteral)(SimpleName:appendMode)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignatureAppearance))(VariableDeclarationFragment(SimpleName:sap)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:stp))(SimpleName:getSignatureAppearance))))(IfStatement(InfixExpression(InfixExpression(SimpleName:newPermissions)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getSetOwnerPassword))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(IfStatement(InfixExpression(SimpleName:cryptoMode)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:cryptoMode)(ASSIGNMENT_OPERATOR:=)(QualifiedName:PdfWriter.STANDARD_ENCRYPTION_128)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:isDebugEnabled))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))(IfStatement(InfixExpression(SimpleName:newPermissions)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:newPermissions)(ASSIGNMENT_OPERATOR:=)(SimpleName:currentPermissions)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getSetOwnerPassword))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:password)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getSetOwnerPassword)))(SimpleName:getBytes)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(MethodInvocation(SimpleName:isUserPassword)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(SimpleName:password)))(Block(ExpressionStatement(Assignment(SimpleName:password)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:16))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:random))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:isDebugEnabled))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:stp))(SimpleName:setEncryption)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userPassword)(SimpleName:password)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newPermissions))(SimpleName:asInt))(SimpleName:cryptoMode))))(ExpressionStatement(Assignment(SimpleName:currentPermissions)(ASSIGNMENT_OPERATOR:=)(SimpleName:newPermissions)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rejectPermissions))(SimpleName:asInt))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0))(Block(IfStatement(InfixExpression(InfixExpression(SimpleName:cryptoMode)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentPermissions))(SimpleName:containsAnyOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rejectPermissions))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalRequestException))(StringLiteral:<STR>)))))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:CRL))(Dimension))(VariableDeclarationFragment(SimpleName:crlList)(NullLiteral)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:isEmbed_crl))(Block(ExpressionStatement(Assignment(SimpleName:crlList)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getCrlsForChain)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getSigningCertificateChain))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCrypto)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:certChain)(SimpleName:crlList)(QualifiedName:PdfSignatureAppearance.SELF_SIGNED))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:isAdd_visible_signature))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:signaturePage)(MethodInvocation(SimpleName:getPageNumberForSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(SimpleName:params)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setVisibleSignature)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(QualifiedName:com.lowagie.text.Rectangle))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getVisible_sig_rectangle_llx))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getVisible_sig_rectangle_lly))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getVisible_sig_rectangle_urx))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getVisible_sig_rectangle_ury)))(SimpleName:signaturePage)(NullLiteral))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:isUse_custom_image))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setAcro6Layers)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfTemplate))(VariableDeclarationFragment(SimpleName:n2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getLayer)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:2)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getCustom_image)))(SimpleName:setAbsolutePosition)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:n2))(SimpleName:addImage)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getCustom_image)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCertificationLevel)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getCertification_level)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignature))(VariableDeclarationFragment(SimpleName:dic)(ClassInstanceCreation(SimpleType(SimpleName:PdfSignature))(QualifiedName:PdfName.ADOBE_PPKLITE)(ClassInstanceCreation(SimpleType(SimpleName:PdfName))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setReason)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getReason)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setLocation)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getLocation)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setDate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:PdfDate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Calendar))(SimpleName:getInstance))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCryptoDictionary)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic))))(VariableDeclarationStatement(SimpleType(SimpleName:TSAClient))(VariableDeclarationFragment(SimpleName:tsc)(NullLiteral)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:isUse_timestamp))(Block(ExpressionStatement(Assignment(SimpleName:tsc)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:TSAClientBouncyCastle))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getTsa_url))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getTsa_username))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getTsa_password)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:contentEstimated)(NumberLiteral:15000)))(VariableDeclarationStatement(SimpleType(SimpleName:HashMap))(VariableDeclarationFragment(SimpleName:exc)(ClassInstanceCreation(SimpleType(SimpleName:HashMap)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exc))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(ClassInstanceCreation(SimpleType(SimpleName:Integer))(InfixExpression(InfixExpression(SimpleName:contentEstimated)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:preClose)(METHOD_INVOCATION_ARGUMENTS(SimpleName:exc))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfPKCS7))(VariableDeclarationFragment(SimpleName:sgn)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:sgn)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:PdfPKCS7))(SimpleName:privKey)(SimpleName:certChain)(SimpleName:crlList)(StringLiteral:<STR>)(NullLiteral)(BooleanLiteral:false)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidKeyException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignServerException))(StringLiteral:<STR>)(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchProviderException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignServerException))(StringLiteral:<STR>)(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignServerException))(StringLiteral:<STR>)(SimpleName:e))))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getRangeStream))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:messageDigest)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:messageDigest)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignServerException))(StringLiteral:<STR>)(SimpleName:e))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:buf)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8192))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:n)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:n)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(NumberLiteral:0)(SimpleName:n))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:hash)(Dimension)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(VariableDeclarationStatement(SimpleType(SimpleName:Calendar))(VariableDeclarationFragment(SimpleName:cal)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Calendar))(SimpleName:getInstance))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ocsp)(NullLiteral)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:isEmbed_ocsp_response))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(QualifiedName:certChain.length)(INFIX_EXPRESSION_OPERATOR:>=)(NumberLiteral:2)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:url)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:url)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfPKCS7))(SimpleName:getOCSPURL)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:certChain)(NumberLiteral:0)))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:url)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0)))(Block(ExpressionStatement(Assignment(SimpleName:ocsp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:OcspClientBouncyCastle))(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:certChain)(NumberLiteral:0)))(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:certChain)(NumberLiteral:1)))(SimpleName:url)))(SimpleName:getEncoded)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CertificateParsingException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignServerException))(StringLiteral:<STR>)(SimpleName:e))))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:sh)(Dimension)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sgn))(SimpleName:getAuthenticatedAttributeBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:cal)(SimpleName:ocsp)))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sgn))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sh)(NumberLiteral:0)(QualifiedName:sh.length)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:SignatureException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignServerException))(StringLiteral:<STR>)(SimpleName:e))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encodedSig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sgn))(SimpleName:getEncodedPKCS7)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:cal)(SimpleName:tsc)(SimpleName:ocsp)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:contentEstimated)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:encodedSig.length))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignServerException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:paddedSig)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:contentEstimated))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encodedSig)(NumberLiteral:0)(SimpleName:paddedSig)(NumberLiteral:0)(QualifiedName:encodedSig.length))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfDictionary))(VariableDeclarationFragment(SimpleName:dic2)(ClassInstanceCreation(SimpleType(SimpleName:PdfDictionary)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic2))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:PdfString))(SimpleName:paddedSig)))(SimpleName:setHexWriting)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic2))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fout))(SimpleName:close)))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fout))(SimpleName:toByteArray)))))))