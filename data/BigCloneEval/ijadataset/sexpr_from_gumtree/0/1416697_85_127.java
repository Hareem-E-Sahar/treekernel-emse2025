(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(SimpleType(SimpleName:Date))(SimpleName:verifyToken)(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:timeStampToken))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:tsDigestInput))(SimpleType(SimpleName:TimeStampTokenVerificationException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:TimeStampToken))(VariableDeclarationFragment(SimpleName:tsToken)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:ContentInfo))(VariableDeclarationFragment(SimpleName:tsContentInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ContentInfo))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:ASN1InputStream))(SimpleName:timeStampToken)))(SimpleName:readObject))))))(ExpressionStatement(Assignment(SimpleName:tsToken)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:TimeStampToken))(SimpleName:tsContentInfo)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TimeStampTokenStructureException))(StringLiteral:<STR>)(SimpleName:ex)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:TSPException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TimeStampTokenStructureException))(StringLiteral:<STR>)(SimpleName:ex))))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:tsaCert)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:certsIt)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsToken))(SimpleName:getCertificates)))(SimpleName:getMatches)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsToken))(SimpleName:getSID)))))(SimpleName:iterator))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certsIt))(SimpleName:hasNext))(Block(ExpressionStatement(Assignment(SimpleName:tsaCert)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:x509CertificateConverter)))(SimpleName:getCertificate)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509CertificateHolder))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certsIt))(SimpleName:next)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:ValidationData))(VariableDeclarationFragment(SimpleName:vData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:certificateValidationProvider)))(SimpleName:validate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:x509CertSelectorConverter))(SimpleName:getCertSelector)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsToken))(SimpleName:getSID))))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsToken))(SimpleName:getTimeStampInfo)))(SimpleName:getGenTime))(ConditionalExpression(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:tsaCert))(NullLiteral)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Collections))(SimpleName:singletonList)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tsaCert))))))))(ExpressionStatement(Assignment(SimpleName:tsaCert)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vData))(SimpleName:getCerts)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CertificateException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TimeStampTokenVerificationException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ex))(SimpleName:getMessage))(SimpleName:ex)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:XAdES4jException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TimeStampTokenTSACertException))(StringLiteral:<STR>)(SimpleName:ex))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsToken))(SimpleName:validate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:signerInfoVerifierBuilder)))(SimpleName:build)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tsaCert)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:TSPValidationException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TimeStampTokenSignatureException))(StringLiteral:<STR>)(SimpleName:ex)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TimeStampTokenVerificationException))(StringLiteral:<STR>)(SimpleName:ex))))))(VariableDeclarationStatement(SimpleType(QualifiedName:org.bouncycastle.tsp.TimeStampTokenInfo))(VariableDeclarationFragment(SimpleName:tsTokenInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsToken))(SimpleName:getTimeStampInfo))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:digestAlgUri)(MethodInvocation(SimpleName:uriForDigest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsTokenInfo))(SimpleName:getMessageImprintAlgOID))))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigestProvider))(SimpleName:getEngine)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestAlgUri)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tsDigestInput)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsTokenInfo))(SimpleName:getMessageImprintDigest)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TimeStampTokenDigestException)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:UnsupportedAlgorithmException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TimeStampTokenVerificationException))(StringLiteral:<STR>)(SimpleName:ex))))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsTokenInfo))(SimpleName:getGenTime)))))))