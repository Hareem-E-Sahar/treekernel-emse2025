(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(SimpleType(SimpleName:OutgoingMessage))(SimpleName:computeSharedSecret)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:IncomingMessage))(SimpleName:in))(SimpleType(SimpleName:KeyAgreementException))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:I)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readString))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:A)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readMPI))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:credentials)))(TryStatement(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:userID)(ClassInstanceCreation(SimpleType(SimpleName:HashMap)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userID))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Registry.SASL_USERNAME)(SimpleName:I))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userID))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SRPRegistry.MD_NAME_FIELD)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:srp))(SimpleName:getAlgorithm)))))(ExpressionStatement(Assignment(SimpleName:credentials)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:passwordDB))(SimpleName:lookup)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userID))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:x))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeyAgreementException))(StringLiteral:<STR>)(SimpleName:x))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:s)(ClassInstanceCreation(SimpleType(SimpleName:BigInteger))(NumberLiteral:1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:fromBase64)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:credentials))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SRPRegistry.SALT_FIELD)))))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:v)(ClassInstanceCreation(SimpleType(SimpleName:BigInteger))(NumberLiteral:1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:fromBase64)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:credentials))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SRPRegistry.USER_VERIFIER_FIELD)))))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:SRPKeyPairGenerator))(VariableDeclarationFragment(SimpleName:kpg)(ClassInstanceCreation(SimpleType(SimpleName:SRPKeyPairGenerator)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:attributes)(ClassInstanceCreation(SimpleType(SimpleName:HashMap)))))(IfStatement(InfixExpression(SimpleName:rnd)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attributes))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SRPKeyPairGenerator.SOURCE_OF_RANDOMNESS)(SimpleName:rnd)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attributes))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SRPKeyPairGenerator.SHARED_MODULUS)(SimpleName:N))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attributes))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SRPKeyPairGenerator.GENERATOR)(SimpleName:g))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attributes))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SRPKeyPairGenerator.USER_VERIFIER)(SimpleName:v))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kpg))(SimpleName:setup)(METHOD_INVOCATION_ARGUMENTS(SimpleName:attributes))))(ExpressionStatement(Assignment(SimpleName:hostKeyPair)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kpg))(SimpleName:generate))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:B)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:SRPPublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hostKeyPair))(SimpleName:getPublic)))))(SimpleName:getY))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:u)(MethodInvocation(SimpleName:uValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:A)(SimpleName:B)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:b)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:SRPPrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hostKeyPair))(SimpleName:getPrivate)))))(SimpleName:getX))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:S)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:A))(SimpleName:multiply)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:modPow)(METHOD_INVOCATION_ARGUMENTS(SimpleName:u)(SimpleName:N))))))(SimpleName:modPow)(METHOD_INVOCATION_ARGUMENTS(SimpleName:b)(SimpleName:N)))))(VariableDeclarationStatement(Modifier:final)(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:sBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:trim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:S)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:IMessageDigest))(VariableDeclarationFragment(SimpleName:hash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:srp))(SimpleName:newDigest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hash))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sBytes)(NumberLiteral:0)(QualifiedName:sBytes.length))))(ExpressionStatement(Assignment(SimpleName:K)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:BigInteger))(NumberLiteral:1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hash))(SimpleName:digest)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:OutgoingMessage))(VariableDeclarationFragment(SimpleName:result)(ClassInstanceCreation(SimpleType(SimpleName:OutgoingMessage)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:result))(SimpleName:writeMPI)(METHOD_INVOCATION_ARGUMENTS(SimpleName:s))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:result))(SimpleName:writeMPI)(METHOD_INVOCATION_ARGUMENTS(SimpleName:B))))(ExpressionStatement(Assignment(SimpleName:complete)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ReturnStatement(SimpleName:result))))))