(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(SimpleType(SimpleName:passwordDetails))(SimpleName:getPassword)(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:handler))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:action))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:reason))(SingleVariableDeclaration(SimpleType(SimpleName:passwordTester))(SimpleName:tester))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:pw_type))(SimpleType(SimpleName:CryptoManagerException))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:persist_timeout_key)(InfixExpression(QualifiedName:CryptoManager.CRYPTO_CONFIG_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:handler)(StringLiteral:<STR>))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:persist_pw_key)(InfixExpression(QualifiedName:CryptoManager.CRYPTO_CONFIG_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:handler)(StringLiteral:<STR>))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:persist_pw_key_type)(InfixExpression(QualifiedName:CryptoManager.CRYPTO_CONFIG_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:handler)(StringLiteral:<STR>))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:current_timeout)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:COConfigurationManager))(SimpleName:getLongParameter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_timeout_key)(NumberLiteral:0)))))(IfStatement(InfixExpression(SimpleName:current_timeout)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(Block(VariableDeclarationStatement(SimpleType(SimpleName:passwordDetails))(VariableDeclarationFragment(SimpleName:pw)(CastExpression(SimpleType(SimpleName:passwordDetails))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session_passwords))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_pw_key))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:pw)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pw))(SimpleName:getHandlerType))(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:pw_type)))(Block(ReturnStatement(ParenthesizedExpression(SimpleName:pw)))))))(IfStatement(InfixExpression(SimpleName:current_timeout)(INFIX_EXPRESSION_OPERATOR:>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SystemTime))(SimpleName:getCurrentTime)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:current_pw)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:COConfigurationManager))(SimpleName:getStringParameter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_pw_key)(StringLiteral:<STR>)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:current_pw))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:type)(CastExpression(PrimitiveType:int)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:COConfigurationManager))(SimpleName:getLongParameter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_pw_key_type)(QualifiedName:CryptoManagerPasswordHandler.HANDLER_TYPE_USER))))))(IfStatement(InfixExpression(SimpleName:type)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:pw_type))(Block(ReturnStatement(ParenthesizedExpression(ClassInstanceCreation(SimpleType(SimpleName:passwordDetails))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:current_pw))(SimpleName:toCharArray))(SimpleName:type))))))))))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:it)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:password_handlers))(SimpleName:iterator))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:hasNext))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:retry_count)(NumberLiteral:0)))(VariableDeclarationStatement(ArrayType(PrimitiveType:char)(Dimension))(VariableDeclarationFragment(SimpleName:last_pw_chars)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:CryptoManagerPasswordHandler))(VariableDeclarationFragment(SimpleName:provider)(CastExpression(SimpleType(SimpleName:CryptoManagerPasswordHandler))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:next)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:pw_type)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:CryptoManagerPasswordHandler.HANDLER_TYPE_UNKNOWN))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:pw_type)(INFIX_EXPRESSION_OPERATOR:!=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:provider))(SimpleName:getHandlerType))))(Block(ContinueStatement)))(WhileStatement(InfixExpression(SimpleName:retry_count)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:64))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(QualifiedName:CryptoManagerPasswordHandler.passwordDetails))(VariableDeclarationFragment(SimpleName:details)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:provider))(SimpleName:getPassword)(METHOD_INVOCATION_ARGUMENTS(SimpleName:handler)(SimpleName:action)(InfixExpression(SimpleName:retry_count)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(SimpleName:reason)))))(IfStatement(InfixExpression(SimpleName:details)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(BreakStatement)))(VariableDeclarationStatement(ArrayType(PrimitiveType:char)(Dimension))(VariableDeclarationFragment(SimpleName:pw_chars)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:details))(SimpleName:getPassword))))(IfStatement(InfixExpression(InfixExpression(SimpleName:last_pw_chars)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:last_pw_chars)(SimpleName:pw_chars))))(Block(ExpressionStatement(PostfixExpression(SimpleName:retry_count)(POSTFIX_EXPRESSION_OPERATOR:++)))(ContinueStatement)))(ExpressionStatement(Assignment(SimpleName:last_pw_chars)(ASSIGNMENT_OPERATOR:=)(SimpleName:pw_chars)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:salt)(MethodInvocation(SimpleName:getPasswordSalt))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:pw_bytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:String))(SimpleName:pw_chars)))(SimpleName:getBytes)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:SHA1))(VariableDeclarationFragment(SimpleName:sha1)(ClassInstanceCreation(SimpleType(SimpleName:SHA1)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sha1))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:wrap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:salt))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sha1))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:wrap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pw_bytes))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:encoded_pw)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteFormatter))(SimpleName:encodeString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sha1))(SimpleName:digest))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:tester)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tester))(SimpleName:testPassword)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encoded_pw))(SimpleName:toCharArray))))))(Block(ExpressionStatement(PostfixExpression(SimpleName:retry_count)(POSTFIX_EXPRESSION_OPERATOR:++)))(ContinueStatement)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:persist_secs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:details))(SimpleName:getPersistForSeconds))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:timeout)))(IfStatement(InfixExpression(SimpleName:persist_secs)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:timeout)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0))))(IfStatement(InfixExpression(SimpleName:persist_secs)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:Integer.MAX_VALUE))(Block(ExpressionStatement(Assignment(SimpleName:timeout)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Long.MAX_VALUE))))(IfStatement(InfixExpression(SimpleName:persist_secs)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:timeout)(ASSIGNMENT_OPERATOR:=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(Block(ExpressionStatement(Assignment(SimpleName:timeout)(ASSIGNMENT_OPERATOR:=)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SystemTime))(SimpleName:getCurrentTime))(INFIX_EXPRESSION_OPERATOR:+)(InfixExpression(SimpleName:persist_secs)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:1000L)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:passwordDetails))(VariableDeclarationFragment(SimpleName:result)(ClassInstanceCreation(SimpleType(SimpleName:passwordDetails))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encoded_pw))(SimpleName:toCharArray))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:provider))(SimpleName:getHandlerType)))))(SynchronizedStatement(ThisExpression)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:COConfigurationManager))(SimpleName:setParameter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_timeout_key)(SimpleName:timeout))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:COConfigurationManager))(SimpleName:setParameter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_pw_key_type)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:provider))(SimpleName:getHandlerType)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session_passwords))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_pw_key))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:COConfigurationManager))(SimpleName:removeParameter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_pw_key))))(IfStatement(InfixExpression(SimpleName:timeout)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session_passwords))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_pw_key)(SimpleName:result)))))(IfStatement(InfixExpression(SimpleName:timeout)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:COConfigurationManager))(SimpleName:setParameter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_pw_key)(SimpleName:encoded_pw))))(ExpressionStatement(MethodInvocation(SimpleName:addPasswordTimer)(METHOD_INVOCATION_ARGUMENTS(SimpleName:persist_timeout_key)(SimpleName:persist_pw_key)(SimpleName:timeout)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:provider))(SimpleName:passwordOK)(METHOD_INVOCATION_ARGUMENTS(SimpleName:handler)(SimpleName:details))))(ReturnStatement(ParenthesizedExpression(SimpleName:result))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:printStackTrace)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e))))(BreakStatement))))))))(ThrowStatement(ParenthesizedExpression(ClassInstanceCreation(SimpleType(SimpleName:CryptoManagerPasswordException))(BooleanLiteral:false)(StringLiteral:<STR>))))))))