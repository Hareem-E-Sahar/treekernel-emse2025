(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(Modifier:static)(SimpleType(SimpleName:Header))(SimpleName:getHeader)(SingleVariableDeclaration(SimpleType(SimpleName:InputStream))(SimpleName:inputStream))(SingleVariableDeclaration(SimpleType(SimpleName:File))(SimpleName:f))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:in64)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:firstByte)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:base64)))(IfStatement(InfixExpression(SimpleName:firstByte)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:BASE64_ENCODING))(Block(ExpressionStatement(Assignment(SimpleName:in64)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Base64InputStream))(SimpleName:inputStream))))(ExpressionStatement(Assignment(SimpleName:inputStream)(ASSIGNMENT_OPERATOR:=)(SimpleName:in64)))(ExpressionStatement(Assignment(SimpleName:base64)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))(IfStatement(InfixExpression(SimpleName:firstByte)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:BINARY_ENCODING))(Block(ExpressionStatement(Assignment(SimpleName:base64)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false))))(Block(ReturnStatement(NullLiteral)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:fileHash)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:FILEHASH_SIZE))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:FILEHASH_SIZE))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:fileHash)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:fileSize)(NumberLiteral:0)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:FILESIZE_SIZE))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(SimpleName:fileSize)(ASSIGNMENT_OPERATOR:=)(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:fileSize)(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(NumberLiteral:0xFF)(INFIX_EXPRESSION_OPERATOR:&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read))))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:dataOffset)(NumberLiteral:0)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:DATAOFFSET_SIZE))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(SimpleName:dataOffset)(ASSIGNMENT_OPERATOR:=)(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:dataOffset)(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(NumberLiteral:0xFF)(INFIX_EXPRESSION_OPERATOR:&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read))))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:dataChunkSize)(NumberLiteral:0)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:DATASIZE_SIZE))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(SimpleName:dataChunkSize)(ASSIGNMENT_OPERATOR:=)(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:dataChunkSize)(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(NumberLiteral:0xFF)(INFIX_EXPRESSION_OPERATOR:&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read))))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:dataHash)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:DATAHASH_SIZE))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:DATAHASH_SIZE))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:dataHash)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read))))))(IfStatement(SimpleName:base64)(Block(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:HEADER64_B64PAD_CNT))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read))))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:md)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(SimpleName:ex))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:nRead)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:remaining)(SimpleName:dataChunkSize)))(VariableDeclarationStatement(Modifier:final)(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:dataBytesBufferSize)(NumberLiteral:4096)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:dataBytes)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:dataBytesBufferSize))))))(WhileStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:remaining)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0)))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:nRead)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataBytes)))))(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))(Block(IfStatement(InfixExpression(SimpleName:remaining)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:nRead))(Block(ExpressionStatement(Assignment(SimpleName:nRead)(ASSIGNMENT_OPERATOR:=)(SimpleName:remaining)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataBytes)(NumberLiteral:0)(SimpleName:nRead))))(ExpressionStatement(Assignment(SimpleName:remaining)(ASSIGNMENT_OPERATOR:-=)(SimpleName:nRead)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:actualDataHash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataHash)(SimpleName:actualDataHash))))(ReturnStatement(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:Header))(VariableDeclarationFragment(SimpleName:header)(ClassInstanceCreation(SimpleType(SimpleName:Header))(SimpleName:base64)(SimpleName:fileHash)(SimpleName:fileSize)(SimpleName:dataOffset)(SimpleName:dataChunkSize)(SimpleName:dataHash)(SimpleName:f))))(ReturnStatement(SimpleName:header)))(Block(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:in64))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in64))(SimpleName:close))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:close)))))))))