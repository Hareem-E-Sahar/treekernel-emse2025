(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:AuthorizationHeader))(SimpleName:getAuthorizationHeader)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:method))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:uri))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:requestBody))(SingleVariableDeclaration(SimpleType(SimpleName:Header))(SimpleName:authHeader))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:username))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:password))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:nonce))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:nc))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:response)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:isResponseHeader)(BooleanLiteral:true)))(VariableDeclarationStatement(SimpleType(SimpleName:WWWAuthenticateHeader))(VariableDeclarationFragment(SimpleName:wwwAuthenticateHeader)(NullLiteral)))(IfStatement(InstanceofExpression(SimpleName:authHeader)(SimpleType(SimpleName:WWWAuthenticateHeader)))(Block(ExpressionStatement(Assignment(SimpleName:wwwAuthenticateHeader)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:WWWAuthenticateHeader))(SimpleName:authHeader))))))(VariableDeclarationStatement(SimpleType(SimpleName:AuthorizationHeader))(VariableDeclarationFragment(SimpleName:authorizationHeader)(NullLiteral)))(IfStatement(InstanceofExpression(SimpleName:authHeader)(SimpleType(SimpleName:AuthorizationHeader)))(Block(ExpressionStatement(Assignment(SimpleName:authorizationHeader)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:AuthorizationHeader))(SimpleName:authHeader))))(ExpressionStatement(Assignment(SimpleName:isResponseHeader)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:qopList)(NullLiteral)))(IfStatement(SimpleName:isResponseHeader)(Block(ExpressionStatement(Assignment(SimpleName:qopList)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wwwAuthenticateHeader))(SimpleName:getQop)))))(Block(ExpressionStatement(Assignment(SimpleName:qopList)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorizationHeader))(SimpleName:getQop))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:algorithm)(NullLiteral)))(IfStatement(SimpleName:isResponseHeader)(Block(ExpressionStatement(Assignment(SimpleName:algorithm)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wwwAuthenticateHeader))(SimpleName:getAlgorithm)))))(Block(ExpressionStatement(Assignment(SimpleName:algorithm)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorizationHeader))(SimpleName:getAlgorithm))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:realm)(NullLiteral)))(IfStatement(SimpleName:isResponseHeader)(Block(ExpressionStatement(Assignment(SimpleName:realm)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wwwAuthenticateHeader))(SimpleName:getRealm)))))(Block(ExpressionStatement(Assignment(SimpleName:realm)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorizationHeader))(SimpleName:getRealm))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:scheme)(NullLiteral)))(IfStatement(SimpleName:isResponseHeader)(Block(ExpressionStatement(Assignment(SimpleName:scheme)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wwwAuthenticateHeader))(SimpleName:getScheme)))))(Block(ExpressionStatement(Assignment(SimpleName:scheme)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorizationHeader))(SimpleName:getScheme))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:opaque)(NullLiteral)))(IfStatement(SimpleName:isResponseHeader)(Block(ExpressionStatement(Assignment(SimpleName:opaque)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wwwAuthenticateHeader))(SimpleName:getOpaque)))))(Block(ExpressionStatement(Assignment(SimpleName:opaque)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorizationHeader))(SimpleName:getOpaque))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:qop)(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:qopList)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(StringLiteral:<STR>)(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:nc_value)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:format)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:nc)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:currentTime)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:nOnceValue)(InfixExpression(SimpleName:currentTime)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:response))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buffer)(NullLiteral)))(SynchronizedStatement(SimpleName:md5Helper)(Block(ExpressionStatement(Assignment(SimpleName:buffer)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md5Helper))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nOnceValue))(SimpleName:getBytes))))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cnonce)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MD5_ECNODER))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buffer)))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:response)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigestResponseAlgorithm))(SimpleName:calculateResponse)(METHOD_INVOCATION_ARGUMENTS(SimpleName:algorithm)(SimpleName:username)(SimpleName:realm)(SimpleName:password)(SimpleName:nonce)(SimpleName:nc_value)(SimpleName:cnonce)(SimpleName:method)(SimpleName:uri)(SimpleName:requestBody)(SimpleName:qop))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NullPointerException))(SimpleName:exc))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(StringLiteral:<STR>)(SimpleName:exc))))))(VariableDeclarationStatement(SimpleType(SimpleName:AuthorizationHeader))(VariableDeclarationFragment(SimpleName:authorization)(NullLiteral)))(TryStatement(Block(IfStatement(InfixExpression(InstanceofExpression(SimpleName:authHeader)(SimpleType(SimpleName:ProxyAuthenticateHeader)))(INFIX_EXPRESSION_OPERATOR:||)(InstanceofExpression(SimpleName:authHeader)(SimpleType(SimpleName:ProxyAuthorizationHeader))))(Block(ExpressionStatement(Assignment(SimpleName:authorization)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headerFactory))(SimpleName:createProxyAuthorizationHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:scheme))))))(Block(ExpressionStatement(Assignment(SimpleName:authorization)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headerFactory))(SimpleName:createAuthorizationHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:scheme)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setUsername)(METHOD_INVOCATION_ARGUMENTS(SimpleName:username))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setRealm)(METHOD_INVOCATION_ARGUMENTS(SimpleName:realm))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setNonce)(METHOD_INVOCATION_ARGUMENTS(SimpleName:nonce))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:uri))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setResponse)(METHOD_INVOCATION_ARGUMENTS(SimpleName:response))))(IfStatement(InfixExpression(SimpleName:algorithm)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setAlgorithm)(METHOD_INVOCATION_ARGUMENTS(SimpleName:algorithm))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:opaque)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:opaque))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setOpaque)(METHOD_INVOCATION_ARGUMENTS(SimpleName:opaque))))))(IfStatement(InfixExpression(SimpleName:qop)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setQop)(METHOD_INVOCATION_ARGUMENTS(SimpleName:qop))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setCNonce)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cnonce))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setNonceCount)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Integer))(SimpleName:parseInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:nc_value)(NumberLiteral:16))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorization))(SimpleName:setResponse)(METHOD_INVOCATION_ARGUMENTS(SimpleName:response)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:ParseException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SecurityException))(StringLiteral:<STR>)(SimpleName:ex))))))(ReturnStatement(SimpleName:authorization))))))