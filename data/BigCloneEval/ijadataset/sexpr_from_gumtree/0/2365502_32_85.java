(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(Modifier:synchronized)(SimpleType(SimpleName:File))(SimpleName:download)(SimpleType(SimpleName:AMSpacksException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:a)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:addr.url))(SimpleName:toExternalForm))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:p)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:a))(SimpleName:lastIndexOf)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:p)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:p)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:a))(SimpleName:lastIndexOf)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>)))))))(IfStatement(InfixExpression(SimpleName:p)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:a)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Math))(SimpleName:random))))))(Block(ExpressionStatement(Assignment(SimpleName:a)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:a))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:p)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))))))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:td)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:td)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:File))(SimpleName:createTempFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:a)(StringLiteral:<STR>))))(SimpleName:getParentFile)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ex))(Block(ExpressionStatement(Assignment(SimpleName:td)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(StringLiteral:<STR>)))))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:f)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:td)(SimpleName:a))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:td))(SimpleName:delete)))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:total)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:addr.update))(SimpleName:getSize))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:progress)(NumberLiteral:0)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:in)(ClassInstanceCreation(SimpleType(SimpleName:BufferedInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:addr.url))(SimpleName:openStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:out)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:f))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:500))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:n)))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:percentage)(NumberLiteral:0)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:callback))(SimpleName:updateProgress)(METHOD_INVOCATION_ARGUMENTS(SimpleName:percentage))))(DoStatement(Block(ExpressionStatement(Assignment(SimpleName:n)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))(IfStatement(InfixExpression(SimpleName:n)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(NumberLiteral:0)(SimpleName:n))))(ExpressionStatement(Assignment(SimpleName:progress)(ASSIGNMENT_OPERATOR:+=)(SimpleName:n)))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:tmpPercentage)(InfixExpression(InfixExpression(SimpleName:progress)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:100))(INFIX_EXPRESSION_OPERATOR:/)(SimpleName:total))))(IfStatement(InfixExpression(SimpleName:percentage)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:tmpPercentage))(Block(ExpressionStatement(Assignment(SimpleName:percentage)(ASSIGNMENT_OPERATOR:=)(SimpleName:tmpPercentage)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:callback))(SimpleName:updateProgress)(METHOD_INVOCATION_ARGUMENTS(SimpleName:percentage)))))))))(InfixExpression(SimpleName:n)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:delete)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:DownloadFailedException))(StringLiteral:<STR>)(SimpleName:ex))))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:size)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:length))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:checksum)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CheckSumFinder))(SimpleName:checkSum)(METHOD_INVOCATION_ARGUMENTS(SimpleName:f)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:size)(INFIX_EXPRESSION_OPERATOR:==)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:addr.update))(SimpleName:getSize)))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:checksum))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:addr.update))(SimpleName:getChecksum)))))(ReturnStatement(SimpleName:f))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:delete)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CheckSumMismathchException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:addr.update))(SimpleName:getChecksum))(StringLiteral:<STR>)(SimpleName:checksum))))))))))