(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:int)(SimpleName:do_response)(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:auth))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:Uid))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:kernelUid))(SingleVariableDeclaration(SimpleType(SimpleName:Command))(SimpleName:c))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:md)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:NSAe))(Block(IfStatement(InfixExpression(QualifiedName:Debug.debug)(INFIX_EXPRESSION_OPERATOR:&&)(QualifiedName:AbstractConnection.EXCEPTION_DEBUG))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Debug.ERR)(SimpleName:NSAe)))))(ReturnStatement(SimpleName:ERROR)))))(SwitchStatement(SimpleName:auth)(SwitchCase(SimpleName:AUTH_NONE))(SwitchStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:getMechs))(SwitchCase(SimpleName:AUTH_ANON))(ReturnStatement(SimpleName:OK))(SwitchCase(SimpleName:AUTH_EXTERNAL))(IfStatement(InfixExpression(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:==)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:col))(SimpleName:compare)(METHOD_INVOCATION_ARGUMENTS(SimpleName:Uid)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:getData)))))(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:kernelUid))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:==)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:col))(SimpleName:compare)(METHOD_INVOCATION_ARGUMENTS(SimpleName:Uid)(SimpleName:kernelUid)))))))(ReturnStatement(SimpleName:OK))(ReturnStatement(SimpleName:ERROR)))(SwitchCase(SimpleName:AUTH_SHA))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:context)(SimpleName:COOKIE_CONTEXT)))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:id)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Message))(SimpleName:marshallintBig)(METHOD_INVOCATION_ARGUMENTS(SimpleName:id)(SimpleName:buf)(NumberLiteral:0)(NumberLiteral:8))))(ExpressionStatement(Assignment(SimpleName:challenge)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:stupidlyEncode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Random))(VariableDeclarationFragment(SimpleName:r)(ClassInstanceCreation(SimpleType(SimpleName:Random)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:r))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf))))(ExpressionStatement(Assignment(SimpleName:cookie)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:stupidlyEncode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(SimpleName:addCookie)(METHOD_INVOCATION_ARGUMENTS(SimpleName:context)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:id))(InfixExpression(SimpleName:id)(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:1000))(SimpleName:cookie)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:IOe))(Block(IfStatement(InfixExpression(QualifiedName:Debug.debug)(INFIX_EXPRESSION_OPERATOR:&&)(QualifiedName:AbstractConnection.EXCEPTION_DEBUG))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Debug.ERR)(SimpleName:IOe))))))))(IfStatement(QualifiedName:Debug.debug)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Debug.DEBUG)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:context)(CharacterLiteral:<STR>)(SimpleName:id)(CharacterLiteral:<STR>)(SimpleName:challenge))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:setResponse)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:stupidlyEncode)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:context)(INFIX_EXPRESSION_OPERATOR:+)(CharacterLiteral:<STR>)(SimpleName:id)(CharacterLiteral:<STR>)(SimpleName:challenge)))))))(ReturnStatement(SimpleName:CONTINUE))(SwitchCase)(ReturnStatement(SimpleName:ERROR)))(SwitchCase(SimpleName:AUTH_SHA))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:String))(Dimension))(VariableDeclarationFragment(SimpleName:response)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:stupidlyDecode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:getData)))))(SimpleName:split)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(QualifiedName:response.length)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:2))(ReturnStatement(SimpleName:ERROR)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cchal)(ArrayAccess(SimpleName:response)(NumberLiteral:0))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:hash)(ArrayAccess(SimpleName:response)(NumberLiteral:1))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:prehash)(InfixExpression(SimpleName:challenge)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:cchal)(StringLiteral:<STR>)(SimpleName:cookie))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prehash))(SimpleName:getBytes))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:posthash)(MethodInvocation(SimpleName:stupidlyEncode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))(IfStatement(QualifiedName:Debug.debug)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Debug.DEBUG)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:prehash)(StringLiteral:<STR>)(SimpleName:hash)(StringLiteral:<STR>)(SimpleName:posthash))))))(IfStatement(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:==)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:col))(SimpleName:compare)(METHOD_INVOCATION_ARGUMENTS(SimpleName:posthash)(SimpleName:hash))))(ReturnStatement(SimpleName:OK))(ReturnStatement(SimpleName:ERROR)))(SwitchCase)(ReturnStatement(SimpleName:ERROR)))))))