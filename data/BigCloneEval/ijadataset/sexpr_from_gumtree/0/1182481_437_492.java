(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(PrimitiveType:boolean)(SimpleName:engineVerify)(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:signature))(SimpleType(SimpleName:SignatureException))(Block(ExpressionStatement(MethodInvocation(SimpleName:ensureInitialized)))(TryStatement(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyAlgorithm))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:signature)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:asn1ToDSA)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signature))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyAlgorithm))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:signature)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:asn1ToECDSA)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signature))))))))(IfStatement(InfixExpression(SimpleName:type)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:T_UPDATE))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:token.p11))(SimpleName:C_VerifyFinal)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:id))(SimpleName:signature)))))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digest)))(IfStatement(InfixExpression(SimpleName:type)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:T_DIGEST))(Block(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)))))(Block(IfStatement(InfixExpression(SimpleName:mechanism)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:CKM_DSA))(Block(IfStatement(InfixExpression(SimpleName:bytesProcessed)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:buffer.length))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(SimpleName:buffer))))(Block(IfStatement(InfixExpression(SimpleName:bytesProcessed)(INFIX_EXPRESSION_OPERATOR:>)(QualifiedName:buffer.length))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:RAW_ECDSA_MAX)(StringLiteral:<STR>))))))(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:bytesProcessed))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buffer)(NumberLiteral:0)(SimpleName:digest)(NumberLiteral:0)(SimpleName:bytesProcessed))))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyAlgorithm))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:==)(BooleanLiteral:false))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:token.p11))(SimpleName:C_Verify)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:id))(SimpleName:digest)(SimpleName:signature)))))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(SimpleName:encodeSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest)))))(IfStatement(InfixExpression(SimpleName:mechanism)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:CKM_RSA_X_509))(Block(ExpressionStatement(Assignment(SimpleName:data)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:pkcs1Pad)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:token.p11))(SimpleName:C_Verify)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:id))(SimpleName:data)(SimpleName:signature))))))))(ReturnStatement(BooleanLiteral:true)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:PKCS11Exception))(SimpleName:e))(Block(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:errorCode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getErrorCode))))(IfStatement(InfixExpression(SimpleName:errorCode)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:CKR_SIGNATURE_INVALID))(Block(ReturnStatement(BooleanLiteral:false))))(IfStatement(InfixExpression(SimpleName:errorCode)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:CKR_SIGNATURE_LEN_RANGE))(Block(ReturnStatement(BooleanLiteral:false))))(IfStatement(InfixExpression(SimpleName:errorCode)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:CKR_DATA_LEN_RANGE))(Block(ReturnStatement(BooleanLiteral:false))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ProviderException))(SimpleName:e)))))(Block(ExpressionStatement(Assignment(SimpleName:initialized)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))(ExpressionStatement(Assignment(SimpleName:session)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:releaseSession)(METHOD_INVOCATION_ARGUMENTS(SimpleName:session)))))))))))