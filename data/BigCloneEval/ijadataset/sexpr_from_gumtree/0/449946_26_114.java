(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(SimpleType(SimpleName:String))(SimpleName:processNestedTags)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:str))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:tagName))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:openSubstWithParam))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:closeSubstWithParam))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:openSubstWithoutParam))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:closeSubstWithoutParam))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:internalSubst))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:processInternalTags))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:acceptParam))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:requiresQuotedParam))(Block(VariableDeclarationStatement(SimpleType(SimpleName:StringBuffer))(VariableDeclarationFragment(SimpleName:buffer)(ClassInstanceCreation(SimpleType(SimpleName:StringBuffer)))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Stack))(SimpleType(SimpleName:Object)))(VariableDeclarationFragment(SimpleName:openStack)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:Stack))(SimpleType(SimpleName:Object))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Set))(SimpleType(SimpleName:Object)))(VariableDeclarationFragment(SimpleName:subsOpen)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashSet))(SimpleType(SimpleName:Object))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Set))(SimpleType(SimpleName:Object)))(VariableDeclarationFragment(SimpleName:subsClose)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashSet))(SimpleType(SimpleName:Object))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Set))(SimpleType(SimpleName:Object)))(VariableDeclarationFragment(SimpleName:subsInternal)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashSet))(SimpleType(SimpleName:Object))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:openTag)(InfixExpression(SimpleName:CR_LF)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:tagName)(ParenthesizedExpression(ConditionalExpression(SimpleName:acceptParam)(ParenthesizedExpression(ConditionalExpression(SimpleName:requiresQuotedParam)(StringLiteral:<STR>)(StringLiteral:<STR>)))(StringLiteral:<STR>)))(StringLiteral:<STR>)(SimpleName:CR_LF))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:closeTag)(InfixExpression(SimpleName:CR_LF)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:tagName)(StringLiteral:<STR>)(SimpleName:CR_LF))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:internTag)(InfixExpression(SimpleName:CR_LF)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:CR_LF))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:patternString)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:openTag)(StringLiteral:<STR>)(SimpleName:closeTag)(StringLiteral:<STR>))))(IfStatement(SimpleName:processInternalTags)(Block(ExpressionStatement(Assignment(SimpleName:patternString)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:internTag)(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:Pattern))(VariableDeclarationFragment(SimpleName:tagsPattern)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Pattern))(SimpleName:compile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:patternString)))))(VariableDeclarationStatement(SimpleType(SimpleName:Matcher))(VariableDeclarationFragment(SimpleName:matcher)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tagsPattern))(SimpleName:matcher)(METHOD_INVOCATION_ARGUMENTS(SimpleName:str)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:openTagGroup)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:paramGroup)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:closeTagGroup)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:internalTagGroup)))(IfStatement(SimpleName:acceptParam)(Block(ExpressionStatement(Assignment(SimpleName:openTagGroup)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:1)))(ExpressionStatement(Assignment(SimpleName:paramGroup)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:2)))(ExpressionStatement(Assignment(SimpleName:closeTagGroup)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:3)))(ExpressionStatement(Assignment(SimpleName:internalTagGroup)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:4))))(Block(ExpressionStatement(Assignment(SimpleName:openTagGroup)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:1)))(ExpressionStatement(Assignment(SimpleName:paramGroup)(ASSIGNMENT_OPERATOR:=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))(ExpressionStatement(Assignment(SimpleName:closeTagGroup)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:2)))(ExpressionStatement(Assignment(SimpleName:internalTagGroup)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:3)))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:matcher))(SimpleName:find))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:length)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:matcher))(SimpleName:end))(INFIX_EXPRESSION_OPERATOR:-)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:matcher))(SimpleName:start)))))(VariableDeclarationStatement(SimpleType(SimpleName:MutableCharSequence))(VariableDeclarationFragment(SimpleName:matchedSeq)(ClassInstanceCreation(SimpleType(SimpleName:MutableCharSequence))(SimpleName:str)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:matcher))(SimpleName:start))(SimpleName:length))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:matcher))(SimpleName:group)(METHOD_INVOCATION_ARGUMENTS(SimpleName:openTagGroup)))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(IfStatement(InfixExpression(SimpleName:acceptParam)(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:matcher))(SimpleName:group)(METHOD_INVOCATION_ARGUMENTS(SimpleName:paramGroup)))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))))(Block(ExpressionStatement(Assignment(QualifiedName:matchedSeq.param)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:matcher))(SimpleName:group)(METHOD_INVOCATION_ARGUMENTS(SimpleName:paramGroup)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openStack))(SimpleName:push)(METHOD_INVOCATION_ARGUMENTS(SimpleName:matchedSeq)))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:matcher))(SimpleName:group)(METHOD_INVOCATION_ARGUMENTS(SimpleName:closeTagGroup)))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openStack))(SimpleName:isEmpty))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MutableCharSequence))(VariableDeclarationFragment(SimpleName:openSeq)(CastExpression(SimpleType(SimpleName:MutableCharSequence))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openStack))(SimpleName:pop)))))(IfStatement(SimpleName:acceptParam)(Block(ExpressionStatement(Assignment(QualifiedName:matchedSeq.param)(ASSIGNMENT_OPERATOR:=)(QualifiedName:openSeq.param)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subsOpen))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:openSeq))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subsClose))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:matchedSeq)))))(IfStatement(InfixExpression(SimpleName:processInternalTags)(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:matcher))(SimpleName:group)(METHOD_INVOCATION_ARGUMENTS(SimpleName:internalTagGroup)))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(ParenthesizedExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openStack))(SimpleName:isEmpty)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subsInternal))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:matchedSeq)))))(Block))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:Object)))(VariableDeclarationFragment(SimpleName:subst)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:Object))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subst))(SimpleName:addAll)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subsOpen))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subst))(SimpleName:addAll)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subsClose))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subst))(SimpleName:addAll)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subsInternal))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Collections))(SimpleName:sort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subst)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:Comparator))(SimpleType(SimpleName:Object)))(AnonymousClassDeclaration(MethodDeclaration(Modifier:public)(PrimitiveType:int)(SimpleName:compare)(SingleVariableDeclaration(SimpleType(SimpleName:Object))(SimpleName:o1))(SingleVariableDeclaration(SimpleType(SimpleName:Object))(SimpleName:o2))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MutableCharSequence))(VariableDeclarationFragment(SimpleName:s1)(CastExpression(SimpleType(SimpleName:MutableCharSequence))(SimpleName:o1))))(VariableDeclarationStatement(SimpleType(SimpleName:MutableCharSequence))(VariableDeclarationFragment(SimpleName:s2)(CastExpression(SimpleType(SimpleName:MutableCharSequence))(SimpleName:o2))))(ReturnStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(QualifiedName:s1.start)(INFIX_EXPRESSION_OPERATOR:-)(QualifiedName:s2.start))))))))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:start)(NumberLiteral:0)))(WhileStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subst))(SimpleName:isEmpty)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MutableCharSequence))(VariableDeclarationFragment(SimpleName:seq)(CastExpression(SimpleType(SimpleName:MutableCharSequence))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subst))(SimpleName:removeLast)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:str))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(SimpleName:start)(QualifiedName:seq.start))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subsClose))(SimpleName:contains)(METHOD_INVOCATION_ARGUMENTS(SimpleName:seq)))(Block(IfStatement(InfixExpression(QualifiedName:seq.param)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:closeSubstWithParam)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:closeSubstWithoutParam)))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subsInternal))(SimpleName:contains)(METHOD_INVOCATION_ARGUMENTS(SimpleName:seq)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:internalSubst)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subsOpen))(SimpleName:contains)(METHOD_INVOCATION_ARGUMENTS(SimpleName:seq)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Matcher))(VariableDeclarationFragment(SimpleName:m)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Pattern))(SimpleName:compile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:openTag))))(SimpleName:matcher)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:str))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:seq.start)(InfixExpression(QualifiedName:seq.start)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:seq.length))))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:matches))(Block(IfStatement(InfixExpression(SimpleName:acceptParam)(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(QualifiedName:seq.param)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openSubstWithParam))(SimpleName:replaceAll)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(QualifiedName:seq.param)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:openSubstWithoutParam))))))))))))(ExpressionStatement(Assignment(SimpleName:start)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:seq.start)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:seq.length))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:str))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(SimpleName:start))))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:toString)))))))