(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:main)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:args)(Dimension))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeyPairGenerator))(VariableDeclarationFragment(SimpleName:kpg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyPairGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kpg))(SimpleName:initialize)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1024)(ClassInstanceCreation(SimpleType(SimpleName:SecureRandom))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signDN)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:signKP)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kpg))(SimpleName:generateKeyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:signCert)(MethodInvocation(SimpleName:makeCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signKP)(SimpleName:signDN)(SimpleName:signKP)(SimpleName:signDN)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:origDN)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:origKP)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kpg))(SimpleName:generateKeyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:origCert)(MethodInvocation(SimpleName:makeCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:origKP)(SimpleName:origDN)(SimpleName:signKP)(SimpleName:signDN)))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:certList)(ClassInstanceCreation(SimpleType(SimpleName:ArrayList)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certList))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:origCert))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certList))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signCert))))(VariableDeclarationStatement(SimpleType(SimpleName:CertStore))(VariableDeclarationFragment(SimpleName:certsAndcrls)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ClassInstanceCreation(SimpleType(SimpleName:CollectionCertStoreParameters))(SimpleName:certList))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:signedAttrs)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(VariableDeclarationStatement(SimpleType(SimpleName:SMIMECapabilityVector))(VariableDeclarationFragment(SimpleName:caps)(ClassInstanceCreation(SimpleType(SimpleName:SMIMECapabilityVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:caps))(SimpleName:addCapability)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SMIMECapability.dES_EDE3_CBC))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:caps))(SimpleName:addCapability)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SMIMECapability.rC2_CBC)(NumberLiteral:128))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:caps))(SimpleName:addCapability)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SMIMECapability.dES_CBC))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedAttrs))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:SMIMECapabilitiesAttribute))(SimpleName:caps)))))(VariableDeclarationStatement(SimpleType(SimpleName:IssuerAndSerialNumber))(VariableDeclarationFragment(SimpleName:issAndSer)(ClassInstanceCreation(SimpleType(SimpleName:IssuerAndSerialNumber))(ClassInstanceCreation(SimpleType(SimpleName:X509Name))(SimpleName:signDN))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:origCert))(SimpleName:getSerialNumber)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedAttrs))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:SMIMEEncryptionKeyPreferenceAttribute))(SimpleName:issAndSer)))))(VariableDeclarationStatement(SimpleType(SimpleName:SMIMESignedGenerator))(VariableDeclarationFragment(SimpleName:gen)(ClassInstanceCreation(SimpleType(SimpleName:SMIMESignedGenerator)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:addSigner)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:origKP))(SimpleName:getPrivate))(SimpleName:origCert)(QualifiedName:SMIMESignedGenerator.DIGEST_SHA1)(ClassInstanceCreation(SimpleType(SimpleName:AttributeTable))(SimpleName:signedAttrs))(NullLiteral))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:addCertificatesAndCRLs)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certsAndcrls))))(VariableDeclarationStatement(SimpleType(SimpleName:MimeBodyPart))(VariableDeclarationFragment(SimpleName:msg)(ClassInstanceCreation(SimpleType(SimpleName:MimeBodyPart)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:msg))(SimpleName:setDataHandler)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DataHandler))(ClassInstanceCreation(SimpleType(SimpleName:FileDataSource))(ClassInstanceCreation(SimpleType(SimpleName:File))(ArrayAccess(SimpleName:args)(NumberLiteral:0))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:msg))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:msg))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:MimeMultipart))(VariableDeclarationFragment(SimpleName:mm)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:generate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:msg)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Properties))(VariableDeclarationFragment(SimpleName:props)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:getProperties))))(VariableDeclarationStatement(SimpleType(SimpleName:Session))(VariableDeclarationFragment(SimpleName:session)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Session))(SimpleName:getDefaultInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:props)(NullLiteral)))))(VariableDeclarationStatement(SimpleType(SimpleName:Address))(VariableDeclarationFragment(SimpleName:fromUser)(ClassInstanceCreation(SimpleType(SimpleName:InternetAddress))(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Address))(VariableDeclarationFragment(SimpleName:toUser)(ClassInstanceCreation(SimpleType(SimpleName:InternetAddress))(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:MimeMessage))(VariableDeclarationFragment(SimpleName:body)(ClassInstanceCreation(SimpleType(SimpleName:MimeMessage))(SimpleName:session))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:setFrom)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fromUser))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:setRecipient)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Message.RecipientType.TO)(SimpleName:toUser))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:setSubject)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:setContent)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mm)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mm))(SimpleName:getContentType)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:saveChanges)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:writeTo)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(StringLiteral:<STR>)))))))))