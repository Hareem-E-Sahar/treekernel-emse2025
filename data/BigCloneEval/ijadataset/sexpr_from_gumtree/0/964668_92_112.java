(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(PrimitiveType:void)(SimpleName:signSamlAssertion)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:SAMLAssertion))(SimpleName:samlAssertion))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Crypto))(VariableDeclarationFragment(SimpleName:issuerCrypto)))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:issuerKeyPassword)))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:issuerKeyName)))(VariableDeclarationStatement(SimpleType(SimpleName:Properties))(VariableDeclarationFragment(SimpleName:properties)(ClassInstanceCreation(SimpleType(SimpleName:Properties)))))(VariableDeclarationStatement(SimpleType(SimpleName:URL))(VariableDeclarationFragment(SimpleName:url)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Loader))(SimpleName:getResource)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:issuerKeyProperties))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:load)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:openStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cryptoProp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:issuerCrypto)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CryptoFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cryptoProp)))))(ExpressionStatement(Assignment(SimpleName:issuerKeyName)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:issuerKeyPassword)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:issuerCerts)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:issuerCrypto))(SimpleName:getCertificates)(METHOD_INVOCATION_ARGUMENTS(SimpleName:issuerKeyName)))))(VariableDeclarationStatement(SimpleType(QualifiedName:java.security.Key))(VariableDeclarationFragment(SimpleName:issuerPK)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:issuerCrypto))(SimpleName:getPrivateKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:issuerKeyName)(SimpleName:issuerKeyPassword)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:sigAlgo)(QualifiedName:XMLSignature.ALGO_ID_SIGNATURE_RSA)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:pubKeyAlgo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:issuerCerts)(NumberLiteral:0)))(SimpleName:getPublicKey)))(SimpleName:getAlgorithm))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:pubKeyAlgo)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKeyAlgo))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:sigAlgo)(ASSIGNMENT_OPERATOR:=)(QualifiedName:XMLSignature.ALGO_ID_SIGNATURE_DSA)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:samlAssertion))(SimpleName:sign)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sigAlgo)(SimpleName:issuerPK)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:asList)(METHOD_INVOCATION_ARGUMENTS(SimpleName:issuerCerts))))))))))