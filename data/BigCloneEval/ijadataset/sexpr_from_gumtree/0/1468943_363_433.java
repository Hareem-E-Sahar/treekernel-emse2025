(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:endElement)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:uri))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:name))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:qname))(SimpleType(SimpleName:SAXException))(Block(ExpressionStatement(Assignment(SimpleName:qname)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:qname))(SimpleName:toLowerCase))))(SwitchStatement(SimpleName:state)(SwitchCase(SimpleName:SESSIONS))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:qname))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:state)(ASSIGNMENT_OPERATOR:=)(SimpleName:START)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(StringLiteral:<STR>))))(BreakStatement)(SwitchCase(SimpleName:SESSION))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:qname))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(QualifiedName:current.valid)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:addSession)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:current.sessionId)(SimpleName:current))))(ExpressionStatement(Assignment(SimpleName:state)(ASSIGNMENT_OPERATOR:=)(SimpleName:SESSIONS))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(StringLiteral:<STR>))))(BreakStatement)(SwitchCase(SimpleName:PEER))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:qname))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:state)(ASSIGNMENT_OPERATOR:=)(SimpleName:SESSION)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:qname)))))(BreakStatement)(SwitchCase(SimpleName:PEER_CERTS))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:qname))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:CertificateFactory))(VariableDeclarationFragment(SimpleName:fact)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)))))(ExpressionStatement(Assignment(QualifiedName:current.peerCerts)(ASSIGNMENT_OPERATOR:=)(CastExpression(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fact))(SimpleName:generateCertificates)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:toString)))(SimpleName:getBytes))))))(SimpleName:toArray)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:Certificate))(Dimension(NumberLiteral:0))))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(SimpleName:ex))))))(ExpressionStatement(Assignment(QualifiedName:current.peerVerified)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ExpressionStatement(Assignment(SimpleName:state)(ASSIGNMENT_OPERATOR:=)(SimpleName:PEER))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:qname)))))(BreakStatement)(SwitchCase(SimpleName:CERTS))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:qname))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:CertificateFactory))(VariableDeclarationFragment(SimpleName:fact)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)))))(ExpressionStatement(Assignment(QualifiedName:current.localCerts)(ASSIGNMENT_OPERATOR:=)(CastExpression(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fact))(SimpleName:generateCertificates)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:toString)))(SimpleName:getBytes))))))(SimpleName:toArray)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:Certificate))(Dimension(NumberLiteral:0))))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(SimpleName:ex))))))(ExpressionStatement(Assignment(SimpleName:state)(ASSIGNMENT_OPERATOR:=)(SimpleName:SESSION))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:qname)))))(BreakStatement)(SwitchCase(SimpleName:SECRET))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:qname))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encrypted)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:encrypted)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Base64))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:toString))))))(IfStatement(InfixExpression(QualifiedName:encrypted.length)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:68))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pbekdf))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:key)(NumberLiteral:0)(QualifiedName:key.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pbekdf))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:iv)(NumberLiteral:0)(QualifiedName:iv.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pbekdf))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mackey)(NumberLiteral:0)(QualifiedName:mackey.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:reset)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipherAttr))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mac))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(SimpleName:macAttr)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(SimpleName:ex))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encrypted)(NumberLiteral:0)(NumberLiteral:48))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:macValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mac))(SimpleName:digest))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:macValue.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(ArrayAccess(SimpleName:macValue)(SimpleName:i))(INFIX_EXPRESSION_OPERATOR:!=)(ArrayAccess(SimpleName:encrypted)(InfixExpression(NumberLiteral:48)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:i))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(StringLiteral:<STR>))))))(ExpressionStatement(Assignment(QualifiedName:current.masterSecret)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:48))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:current.masterSecret.length))(Assignment(SimpleName:i)(ASSIGNMENT_OPERATOR:+=)(NumberLiteral:16))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encrypted)(SimpleName:i)(QualifiedName:current.masterSecret)(SimpleName:i))))))(ExpressionStatement(Assignment(SimpleName:state)(ASSIGNMENT_OPERATOR:=)(SimpleName:SESSION))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:qname)))))(BreakStatement)(SwitchCase)(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SAXException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:qname)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:setLength)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))))