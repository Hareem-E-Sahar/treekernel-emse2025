(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:HttpResponse))(SimpleName:execute)(SingleVariableDeclaration(SimpleType(SimpleName:HttpRequest))(SimpleName:request))(SimpleType(SimpleName:GadgetException))(Block(ExpressionStatement(MethodInvocation(SimpleName:normalizeProtocol)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpResponse))(VariableDeclarationFragment(SimpleName:invalidatedResponse)(NullLiteral)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getIgnoreCache)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:HttpResponse))(VariableDeclarationFragment(SimpleName:cachedResponse)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpCache))(SimpleName:getResponse)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)))))(IfStatement(InfixExpression(SimpleName:cachedResponse)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cachedResponse))(SimpleName:isStale)))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:invalidationService))(SimpleName:isValid)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:cachedResponse)))(Block(ReturnStatement(SimpleName:cachedResponse)))(Block(ExpressionStatement(Assignment(SimpleName:invalidatedResponse)(ASSIGNMENT_OPERATOR:=)(SimpleName:cachedResponse)))))))))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpResponse))(VariableDeclarationFragment(SimpleName:fetchedResponse)(NullLiteral)))(SwitchStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getAuthType))(SwitchCase(SimpleName:NONE))(ExpressionStatement(Assignment(SimpleName:fetchedResponse)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpFetcher))(SimpleName:fetch)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)))))(BreakStatement)(SwitchCase(SimpleName:SIGNED))(SwitchCase(SimpleName:OAUTH))(ExpressionStatement(Assignment(SimpleName:fetchedResponse)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oauthRequestProvider))(SimpleName:get)))(SimpleName:fetch)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)))))(BreakStatement)(SwitchCase)(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:HttpResponse))(SimpleName:error))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fetchedResponse))(SimpleName:isError))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:invalidatedResponse)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ReturnStatement(SimpleName:invalidatedResponse))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fetchedResponse))(SimpleName:isError)))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getIgnoreCache)))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getCacheTtl))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0)))(Block(ExpressionStatement(Assignment(SimpleName:fetchedResponse)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:imageRewriter))(SimpleName:rewrite)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:fetchedResponse)))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getIgnoreCache)))(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fetchedResponse))(SimpleName:getCacheTtl))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:fetchedResponse)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:invalidationService))(SimpleName:markResponse)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:fetchedResponse)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpCache))(SimpleName:addResponse)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:fetchedResponse))))))(ReturnStatement(SimpleName:fetchedResponse))))))