(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:getBytesToSign)(SingleVariableDeclaration(SimpleType(SimpleName:DERObjectIdentifier))(SimpleName:contentType))(SingleVariableDeclaration(SimpleType(SimpleName:CMSProcessable))(SimpleName:content))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:sigProvider))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:SignatureException))(SimpleType(SimpleName:InvalidKeyException))(SimpleType(SimpleName:NoSuchProviderException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:CertificateEncodingException))(SimpleType(SimpleName:CMSException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:dig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getDigestAlgOID))(SimpleName:sigProvider)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:content))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DigOutputStream))(SimpleName:dig)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:digest))))(VariableDeclarationStatement(SimpleType(SimpleName:AttributeTable))(VariableDeclarationFragment(SimpleName:attr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getSignedAttributes))))(IfStatement(InfixExpression(SimpleName:attr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:v)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attr))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributes.contentType)))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:CMSAttributes.contentType)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:contentType)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attr))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributes.contentType))))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attr))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributes.signingTime)))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:CMSAttributes.signingTime)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(ClassInstanceCreation(SimpleType(SimpleName:Time))(ClassInstanceCreation(SimpleType(SimpleName:Date))))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attr))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributes.signingTime))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:CMSAttributes.messageDigest)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(SimpleName:hash)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:buildSigningCertificateV2Attribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sigProvider))))))(VariableDeclarationStatement(SimpleType(SimpleName:Hashtable))(VariableDeclarationFragment(SimpleName:ats)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attr))(SimpleName:toHashtable))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ats))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributes.contentType))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ats))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributes.signingTime))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ats))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributes.messageDigest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ats))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PKCSObjectIdentifiers.id_aa_signingCertificateV2))))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:it)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ats))(SimpleName:values)))(SimpleName:iterator))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:hasNext))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Attribute))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:next)))))))))(ExpressionStatement(Assignment(SimpleName:signedAttr)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:v)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:v)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:CMSAttributes.contentType)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:contentType))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:CMSAttributes.signingTime)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(ClassInstanceCreation(SimpleType(SimpleName:DERUTCTime))(ClassInstanceCreation(SimpleType(SimpleName:Date)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:CMSAttributes.messageDigest)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(SimpleName:hash)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:buildSigningCertificateV2Attribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sigProvider))))))(ExpressionStatement(Assignment(SimpleName:signedAttr)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:v))))))(ExpressionStatement(Assignment(SimpleName:attr)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getUnsignedAttributes))))(IfStatement(InfixExpression(SimpleName:attr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Hashtable))(VariableDeclarationFragment(SimpleName:ats)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attr))(SimpleName:toHashtable))))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:it)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ats))(SimpleName:values)))(SimpleName:iterator))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:v)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:hasNext))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Attribute))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:next)))))))))(ExpressionStatement(Assignment(SimpleName:unsignedAttr)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:v))))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bOut)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:DEROutputStream))(VariableDeclarationFragment(SimpleName:dOut)(ClassInstanceCreation(SimpleType(SimpleName:DEROutputStream))(SimpleName:bOut))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dOut))(SimpleName:writeObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedAttr))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bOut))(SimpleName:toByteArray)))))))