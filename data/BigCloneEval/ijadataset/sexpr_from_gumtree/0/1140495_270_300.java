(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Test))(Modifier:public)(PrimitiveType:void)(SimpleName:testImageCreationCmd)(SimpleType(SimpleName:PhotovaultException))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:testDir)(ClassInstanceCreation(SimpleType(SimpleName:File))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:testFile)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:testDir)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:ModifyImageFileCommand))(VariableDeclarationFragment(SimpleName:cmd)(ClassInstanceCreation(SimpleType(SimpleName:ModifyImageFileCommand))(SimpleName:testFile))))(VariableDeclarationStatement(SimpleType(SimpleName:PhotovaultCommandHandler))(VariableDeclarationFragment(SimpleName:cmdHandler)(ClassInstanceCreation(SimpleType(SimpleName:PhotovaultCommandHandler))(NullLiteral))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cmdHandler))(SimpleName:executeCommand)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cmd))))(VariableDeclarationStatement(SimpleType(SimpleName:ImageFile))(VariableDeclarationFragment(SimpleName:f)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cmd))(SimpleName:getImageFile))))(VariableDeclarationStatement(SimpleType(SimpleName:UUID))(VariableDeclarationFragment(SimpleName:fileId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getId))))(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ifDAO))(SimpleName:findById)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fileId)(BooleanLiteral:false)))))(AssertStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getFileSize))(INFIX_EXPRESSION_OPERATOR:==)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:testFile))(SimpleName:length))))(AssertStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getImages)))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:1)))(VariableDeclarationStatement(SimpleType(SimpleName:OriginalImageDescriptor))(VariableDeclarationFragment(SimpleName:img)(CastExpression(SimpleType(SimpleName:OriginalImageDescriptor))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getImage)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:img))(SimpleName:getPhotos)))(SimpleName:size)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getLocations)))(SimpleName:size)))))(VariableDeclarationStatement(SimpleType(SimpleName:VolumeDAO))(VariableDeclarationFragment(SimpleName:volDAO)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:daoFactory))(SimpleName:getVolumeDAO))))(VariableDeclarationStatement(SimpleType(SimpleName:VolumeBase))(VariableDeclarationFragment(SimpleName:defaultVolume)(SimpleName:vol1)))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:fl)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:defaultVolume))(SimpleName:getFilingFname)(METHOD_INVOCATION_ARGUMENTS(SimpleName:testFile)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:copyFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:testFile)(SimpleName:fl))))(ExpressionStatement(Assignment(SimpleName:cmd)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ModifyImageFileCommand))(SimpleName:f))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cmd))(SimpleName:addLocation)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:FileLocation))(SimpleName:defaultVolume)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:defaultVolume))(SimpleName:mapFileToVolumeRelativeName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fl)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cmdHandler))(SimpleName:executeCommand)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cmd))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:clear)))(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cmd))(SimpleName:getImageFile))))(ExpressionStatement(Assignment(SimpleName:fileId)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getId))))(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ifDAO))(SimpleName:findById)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fileId)(BooleanLiteral:false)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getLocations)))(SimpleName:size)))))(VariableDeclarationStatement(SimpleType(SimpleName:FileLocation))(VariableDeclarationFragment(SimpleName:loc)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getLocations)))(SimpleName:iterator)))(SimpleName:next))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loc))(SimpleName:getVolume)))(SimpleName:getId))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:defaultVolume))(SimpleName:getId)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loc))(SimpleName:getFile)))(SimpleName:lastModified))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loc))(SimpleName:getLastModified)))))))))