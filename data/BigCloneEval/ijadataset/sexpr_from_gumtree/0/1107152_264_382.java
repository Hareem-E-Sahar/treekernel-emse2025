(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:fetchCRL)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:uri))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Object))(VariableDeclarationFragment(SimpleName:fing)))(VariableDeclarationStatement(SimpleType(SimpleName:X509CRL))(VariableDeclarationFragment(SimpleName:old_crl)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:im_fetching)(BooleanLiteral:false)))(SynchronizedStatement(ThisExpression)(Block(ExpressionStatement(Assignment(SimpleName:fing)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:being_fetched))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri)))))(IfStatement(InfixExpression(SimpleName:fing)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:fing)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Object)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:being_fetched))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri)(SimpleName:fing))))(ExpressionStatement(Assignment(SimpleName:old_crl)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:X509CRL))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crls))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri)(NullLiteral))))))(ExpressionStatement(Assignment(SimpleName:im_fetching)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))))))(IfStatement(SimpleName:im_fetching)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:chat)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509CRL))(VariableDeclarationFragment(SimpleName:new_crl)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:ok)(BooleanLiteral:false)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:problem)(StringLiteral:<STR>)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:URL))(VariableDeclarationFragment(SimpleName:url)(ClassInstanceCreation(SimpleType(SimpleName:URL))(SimpleName:uri))))(VariableDeclarationStatement(SimpleType(SimpleName:CertificateFactory))(VariableDeclarationFragment(SimpleName:cf)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:chat)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:toString))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:getProtocol))))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:is)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:openStream))))(VariableDeclarationStatement(SimpleType(SimpleName:DataInputStream))(VariableDeclarationFragment(SimpleName:dis)(ClassInstanceCreation(SimpleType(SimpleName:DataInputStream))(SimpleName:is))))(VariableDeclarationStatement(SimpleType(SimpleName:BufferedInputStream))(VariableDeclarationFragment(SimpleName:bis)(ClassInstanceCreation(SimpleType(SimpleName:BufferedInputStream))(SimpleName:dis))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:readcrldata)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(NumberLiteral:100)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:1024)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:in)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)))(ForStatement(Assignment(SimpleName:i)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0))(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:in)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bis))(SimpleName:read))))(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:readcrldata)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(SimpleName:in)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bis))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:chat)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:i)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:crldata)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:i))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:j)(NumberLiteral:0)))(ForStatement(Assignment(SimpleName:j)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0))(InfixExpression(SimpleName:j)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:i))(PostfixExpression(SimpleName:j)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(Assignment(ArrayAccess(SimpleName:crldata)(SimpleName:j))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:readcrldata)(SimpleName:j))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:crlpem)(ClassInstanceCreation(SimpleType(SimpleName:String))(SimpleName:crldata))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crlpem))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(Block(ExpressionStatement(Assignment(SimpleName:new_crl)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:readCRLFromPEM)(METHOD_INVOCATION_ARGUMENTS(SimpleName:crldata)(SimpleName:cf))))))(Block(ExpressionStatement(Assignment(SimpleName:new_crl)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:readCRLFromDER)(METHOD_INVOCATION_ARGUMENTS(SimpleName:crldata)(SimpleName:cf)))))))(IfStatement(InfixExpression(SimpleName:new_crl)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:problem)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Enumeration))(VariableDeclarationFragment(SimpleName:e)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ListenerManager))(SimpleName:getGKS)))(SimpleName:aliases))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:hasMoreElements))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Certificate))(VariableDeclarationFragment(SimpleName:c)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ListenerManager))(SimpleName:getGKS)))(SimpleName:getCertificate)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:nextElement)))))))(IfStatement(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:new_crl))(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:getPublicKey)))))(ExpressionStatement(Assignment(SimpleName:ok)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(BreakStatement))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block)))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:ok))(Block(ExpressionStatement(Assignment(SimpleName:problem)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))))))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:java.net.MalformedURLException))(SimpleName:mfuex))(Block(ExpressionStatement(Assignment(SimpleName:problem)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CertificateException))(SimpleName:cex))(Block(ExpressionStatement(Assignment(SimpleName:problem)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:cex))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CRLException))(SimpleName:crlex))(Block(ExpressionStatement(Assignment(SimpleName:problem)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:crlex))))))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:java.io.IOException))(SimpleName:ioex))(Block(ExpressionStatement(Assignment(SimpleName:problem)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ioex))))))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:java.security.KeyStoreException))(SimpleName:ksex))(Block(ExpressionStatement(Assignment(SimpleName:problem)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ksex))))))(Block(IfStatement(SimpleName:ok)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crls))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri)(SimpleName:new_crl))))(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:now)(ClassInstanceCreation(SimpleType(SimpleName:Date)))))(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:next_update)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:new_crl))(SimpleName:getNextUpdate))))(IfStatement(InfixExpression(InfixExpression(SimpleName:next_update)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:next_update))(SimpleName:before)(METHOD_INVOCATION_ARGUMENTS(SimpleName:now))))(Block(ExpressionStatement(Assignment(SimpleName:next_update)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Date))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:now))(SimpleName:getTime))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Configuration))(SimpleName:defaultCRLValidity))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Alarm))(SimpleName:get)))(SimpleName:set)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Waiter))(SimpleName:uri)(ThisExpression))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:next_update))(SimpleName:getTime)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri)(StringLiteral:<STR>)(SimpleName:next_update))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:update_of_old)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:old_crl)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(Assignment(SimpleName:update_of_old)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:old_crl))(SimpleName:getNextUpdate)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:update_of_old)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Configuration))(SimpleName:getCRLGrace))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0.0)))(Block(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:valid_time)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:update_of_old))(SimpleName:getTime))(INFIX_EXPRESSION_OPERATOR:-)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:old_crl))(SimpleName:getThisUpdate)))(SimpleName:getTime)))))(IfStatement(InfixExpression(SimpleName:valid_time)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:valid_time)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:1)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:grace_so_far)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:-)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:update_of_old))(SimpleName:getTime)))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(CastExpression(PrimitiveType:double)(SimpleName:grace_so_far)))(INFIX_EXPRESSION_OPERATOR:/)(ParenthesizedExpression(CastExpression(PrimitiveType:double)(SimpleName:valid_time)))))(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Configuration))(SimpleName:getCRLGrace)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crls))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri)(SimpleName:old_crl))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:next_update)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:+)(CastExpression(PrimitiveType:long)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Configuration))(SimpleName:getCRLGrace))(INFIX_EXPRESSION_OPERATOR:*)(ParenthesizedExpression(InfixExpression(SimpleName:valid_time)(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:10.0)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Alarm))(SimpleName:get)))(SimpleName:set)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Waiter))(SimpleName:uri)(ThisExpression))(SimpleName:next_update))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:warning)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri)(StringLiteral:<STR>)(SimpleName:problem)(StringLiteral:<STR>)(ClassInstanceCreation(SimpleType(SimpleName:Date))(SimpleName:next_update)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:severe)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri)(StringLiteral:<STR>)(SimpleName:problem)(StringLiteral:<STR>))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:severe)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri)(StringLiteral:<STR>)(SimpleName:problem)(StringLiteral:<STR>)))))))))(SynchronizedStatement(ThisExpression)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:being_fetched))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri))))))(SynchronizedStatement(SimpleName:fing)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fing))(SimpleName:notifyAll))))))))(Block(SynchronizedStatement(SimpleName:fing)(Block(TryStatement(Block(IfStatement(QualifiedName:logger.CHAT)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri)(StringLiteral:<STR>))(QualifiedName:LoggerLevel.CHAT)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fing))(SimpleName:wait))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InterruptedException))(SimpleName:ex))(Block)))))))))))