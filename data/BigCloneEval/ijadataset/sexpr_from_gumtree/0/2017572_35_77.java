(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(SimpleType(SimpleName:Map))(SimpleName:submitPKCSRequest)(SingleVariableDeclaration(SimpleType(SimpleName:DispatchContext))(SimpleName:dctx))(SingleVariableDeclaration(SimpleType(SimpleName:Map))(SimpleName:context))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:scepKeyPair)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LtansUtils))(SimpleName:getDefaultKeyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:scepCert)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LtansUtils))(SimpleName:getDefaultCertificate))))(VariableDeclarationStatement(SimpleType(SimpleName:GenericDelegator))(VariableDeclarationFragment(SimpleName:delegator)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dctx))(SimpleName:getDelegator))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:pkiMessageStr)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:scepRequestContentInfoBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Base64))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkiMessageStr))(SimpleName:getBytes))))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1InputStream))(VariableDeclarationFragment(SimpleName:aIS)(ClassInstanceCreation(SimpleType(SimpleName:ASN1InputStream))(SimpleName:scepRequestContentInfoBytes))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1Sequence))(VariableDeclarationFragment(SimpleName:seqTwo)(CastExpression(SimpleType(SimpleName:ASN1Sequence))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aIS))(SimpleName:readObject)))))(VariableDeclarationStatement(SimpleType(SimpleName:ContentInfo))(VariableDeclarationFragment(SimpleName:inCtntInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ContentInfo))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:seqTwo)))))(VariableDeclarationStatement(SimpleType(SimpleName:CertificationRequest))(VariableDeclarationFragment(SimpleName:certReq)(CastExpression(SimpleType(SimpleName:CertificationRequest))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LtansEnvelopeUtils))(SimpleName:openSignedEnvelopedData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inCtntInfo)(SimpleName:scepCert)(SimpleName:scepKeyPair))))))(VariableDeclarationStatement(SimpleType(SimpleName:CertificationRequestInfo))(VariableDeclarationFragment(SimpleName:certReqInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certReq))(SimpleName:getCertificationRequestInfo))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Name))(VariableDeclarationFragment(SimpleName:subject)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certReqInfo))(SimpleName:getSubject))))(VariableDeclarationStatement(SimpleType(SimpleName:SubjectPublicKeyInfo))(VariableDeclarationFragment(SimpleName:subjectKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certReqInfo))(SimpleName:getSubjectPublicKeyInfo))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPublicKeyStructure))(VariableDeclarationFragment(SimpleName:rsastruct)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSAPublicKeyStructure))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subjectKey)))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPublicKeySpec))(VariableDeclarationFragment(SimpleName:rsaKey)(ClassInstanceCreation(SimpleType(SimpleName:RSAPublicKeySpec))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsastruct))(SimpleName:getModulus))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsastruct))(SimpleName:getPublicExponent)))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyFactory))(VariableDeclarationFragment(SimpleName:rsaFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPublicKey))(VariableDeclarationFragment(SimpleName:rsaPubKey)(CastExpression(SimpleType(SimpleName:RSAPublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaFactory))(SimpleName:generatePublic)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rsaKey))))))(VariableDeclarationStatement(SimpleType(SimpleName:DERBitString))(VariableDeclarationFragment(SimpleName:derStr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certReq))(SimpleName:getSignature))))(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmIdentifier))(VariableDeclarationFragment(SimpleName:sigalgId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certReq))(SimpleName:getSignatureAlgorithm))))(VariableDeclarationStatement(SimpleType(SimpleName:Signature))(VariableDeclarationFragment(SimpleName:verifySig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Signature))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LtansUtils))(SimpleName:getJavaAlgorithmIdentifier)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sigalgId)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:verifySig))(SimpleName:initVerify)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rsaPubKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:verifySig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LtansUtils))(SimpleName:getDERObjectBytes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certReq))(SimpleName:getCertificationRequestInfo)))))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:signedTest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:verifySig))(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:derStr))(SimpleName:getBytes))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:signedTest))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:logError)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:IllegalArgumentException))(StringLiteral:<STR>))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:searchFields)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FastMap))(SimpleName:newInstance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:searchFields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaKey))(SimpleName:getPublicExponent)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:searchFields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certReqInfo))(SimpleName:getSubject)))(SimpleName:toString)))))(VariableDeclarationStatement(SimpleType(SimpleName:GenericValue))(VariableDeclarationFragment(SimpleName:pubKeyValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:delegator))(SimpleName:findByPrimaryKey)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:searchFields)))))(IfStatement(InfixExpression(SimpleName:pubKeyValue)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:logError)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:IllegalArgumentException)))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaKey))(SimpleName:getPublicExponent))(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:pubkeyid)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:delegator))(SimpleName:getNextSeqId)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:pubKeyMap)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FastMap))(SimpleName:newInstance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKeyMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:pubkeyid))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKeyMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaPubKey))(SimpleName:getEncoded)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKeyMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certReqInfo))(SimpleName:getSubject)))(SimpleName:toString)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digestBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:LtansUtils.DIGEST_ALGORITHM))))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaPubKey))(SimpleName:getEncoded))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKeyMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Hex))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestBytes)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKeyMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKeyMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaKey))(SimpleName:getPublicExponent)))(SimpleName:intValue)))))(ExpressionStatement(Assignment(SimpleName:pubKeyValue)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:delegator))(SimpleName:makeValue)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:pubKeyMap)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:delegator))(SimpleName:create)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pubKeyValue))))(VariableDeclarationStatement(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:retMap)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FastMap))(SimpleName:newInstance))))(ReturnStatement(SimpleName:retMap))))))