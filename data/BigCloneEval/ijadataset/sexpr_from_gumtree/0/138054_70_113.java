(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:signFile)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:inFile))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:outFile))(SingleVariableDeclaration(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(SimpleName:certChain))(SingleVariableDeclaration(SimpleType(SimpleName:PrivateKey))(SimpleName:privKey))(SingleVariableDeclaration(SimpleType(SimpleName:TSAClient))(SimpleName:tsaCli))(SingleVariableDeclaration(SimpleType(SimpleName:Rectangle))(SimpleName:Rctng))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:location))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:reason))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:DocumentException))(SimpleType(SimpleName:InvalidKeyException))(SimpleType(SimpleName:NoSuchProviderException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:CertificateParsingException))(SimpleType(SimpleName:SignatureException))(SimpleType(SimpleName:NotEnoughSpaceException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:PdfReader))(VariableDeclarationFragment(SimpleName:reader)(ClassInstanceCreation(SimpleType(SimpleName:PdfReader))(SimpleName:inFile))))(VariableDeclarationStatement(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:fout)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:outFile))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfStamper))(VariableDeclarationFragment(SimpleName:stp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfStamper))(SimpleName:createSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(SimpleName:fout)(CharacterLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignatureAppearance))(VariableDeclarationFragment(SimpleName:sap)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:stp))(SimpleName:getSignatureAppearance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCrypto)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:certChain)(NullLiteral)(QualifiedName:PdfSignatureAppearance.WINCER_SIGNED))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setVisibleSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:Rctng)(NumberLiteral:1)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setLocation)(METHOD_INVOCATION_ARGUMENTS(SimpleName:location))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setReason)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reason))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignature))(VariableDeclarationFragment(SimpleName:pdfSig)(ClassInstanceCreation(SimpleType(SimpleName:PdfSignature))(QualifiedName:PdfName.ADOBE_PPKLITE)(ClassInstanceCreation(SimpleType(SimpleName:PdfName))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pdfSig))(SimpleName:setReason)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getReason)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pdfSig))(SimpleName:setLocation)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getLocation)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pdfSig))(SimpleName:setContact)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getContact)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pdfSig))(SimpleName:setDate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:PdfDate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getSignDate))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCryptoDictionary)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pdfSig))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:contentEstimated)(NumberLiteral:15000)))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer)))(VariableDeclarationFragment(SimpleName:exc)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exc))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(ClassInstanceCreation(SimpleType(SimpleName:Integer))(InfixExpression(InfixExpression(SimpleName:contentEstimated)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:preClose)(METHOD_INVOCATION_ARGUMENTS(SimpleName:exc))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfPKCS7))(VariableDeclarationFragment(SimpleName:sgn)(ClassInstanceCreation(SimpleType(SimpleName:PdfPKCS7))(SimpleName:privKey)(SimpleName:certChain)(NullLiteral)(StringLiteral:<STR>)(NullLiteral)(BooleanLiteral:false))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getRangeStream))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:messageDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:buf)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8192))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:n)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:n)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(NumberLiteral:0)(SimpleName:n))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:hash)(Dimension)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(VariableDeclarationStatement(SimpleType(SimpleName:Calendar))(VariableDeclarationFragment(SimpleName:cal)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Calendar))(SimpleName:getInstance))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ocsp)(NullLiteral)))(IfStatement(InfixExpression(QualifiedName:certChain.length)(INFIX_EXPRESSION_OPERATOR:>=)(NumberLiteral:2))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:url)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfPKCS7))(SimpleName:getOCSPURL)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:certChain)(NumberLiteral:0)))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:url)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0)))(ExpressionStatement(Assignment(SimpleName:ocsp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:OcspClientBouncyCastle))(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:certChain)(NumberLiteral:0)))(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:certChain)(NumberLiteral:1)))(SimpleName:url)))(SimpleName:getEncoded)))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:sh)(Dimension)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sgn))(SimpleName:getAuthenticatedAttributeBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:cal)(SimpleName:ocsp)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sgn))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sh)(NumberLiteral:0)(QualifiedName:sh.length))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encodedSig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sgn))(SimpleName:getEncodedPKCS7)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:cal)(SimpleName:tsaCli)(SimpleName:ocsp)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:contentEstimated)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:encodedSig.length))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:NotEnoughSpaceException)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:paddedSig)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:contentEstimated))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encodedSig)(NumberLiteral:0)(SimpleName:paddedSig)(NumberLiteral:0)(QualifiedName:encodedSig.length))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfDictionary))(VariableDeclarationFragment(SimpleName:dic2)(ClassInstanceCreation(SimpleType(SimpleName:PdfDictionary)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic2))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:PdfString))(SimpleName:paddedSig)))(SimpleName:setHexWriting)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic2))))))))