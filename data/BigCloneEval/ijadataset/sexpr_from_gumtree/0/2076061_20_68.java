(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(PrimitiveType:void)(SimpleName:doFilter)(SingleVariableDeclaration(SimpleType(SimpleName:ServletRequest))(SimpleName:req))(SingleVariableDeclaration(SimpleType(SimpleName:ServletResponse))(SimpleName:resp))(SingleVariableDeclaration(SimpleType(SimpleName:FilterChain))(SimpleName:chain))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:ServletException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:HttpServletRequest))(VariableDeclarationFragment(SimpleName:request)(CastExpression(SimpleType(SimpleName:HttpServletRequest))(SimpleName:req))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpServletResponse))(VariableDeclarationFragment(SimpleName:response)(CastExpression(SimpleType(SimpleName:HttpServletResponse))(SimpleName:resp))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ThreadAttributes))(SimpleName:setThreadAttribute)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:req))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:tokenId)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:userId)(StringLiteral:<STR>)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:authPass)(BooleanLiteral:false)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRequestURI)))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chain))(SimpleName:doFilter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:response))))(ReturnStatement)))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Cookie))(Dimension))(VariableDeclarationFragment(SimpleName:cookies)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getCookies))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:cookies.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Cookie))(VariableDeclarationFragment(SimpleName:c)(ArrayAccess(SimpleName:cookies)(SimpleName:i))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:getName)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:tokenId)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:getValue)))))))(IfStatement(InfixExpression(SimpleName:tokenId)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ssoServerUrl)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropertyUtil))(SimpleName:getSSOServerUrl))))(VariableDeclarationStatement(SimpleType(SimpleName:URL))(VariableDeclarationFragment(SimpleName:url)(ClassInstanceCreation(SimpleType(SimpleName:URL))(InfixExpression(SimpleName:ssoServerUrl)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:tokenId)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getLocalAddr))))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpURLConnection))(VariableDeclarationFragment(SimpleName:urlConnection)(CastExpression(SimpleType(SimpleName:HttpURLConnection))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:openConnection)))))(VariableDeclarationStatement(SimpleType(SimpleName:BufferedReader))(VariableDeclarationFragment(SimpleName:in)(ClassInstanceCreation(SimpleType(SimpleName:BufferedReader))(ClassInstanceCreation(SimpleType(SimpleName:InputStreamReader))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:urlConnection))(SimpleName:getInputStream))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:line)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readLine))))(IfStatement(InfixExpression(SimpleName:line)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(Assignment(SimpleName:userId)(ASSIGNMENT_OPERATOR:=)(SimpleName:line))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userId))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getSession)))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:userId))))(ExpressionStatement(Assignment(SimpleName:authPass)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Cookie))(VariableDeclarationFragment(SimpleName:c)(ClassInstanceCreation(SimpleType(SimpleName:Cookie))(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:setMaxAge)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:addCookie)(METHOD_INVOCATION_ARGUMENTS(SimpleName:c)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace)))))))(Block(ExpressionStatement(Assignment(SimpleName:userId)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:password)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:userId)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userId))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getSession)))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:userId))))(ExpressionStatement(Assignment(SimpleName:authPass)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))))))))(IfStatement(SimpleName:authPass)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chain))(SimpleName:doFilter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:response))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getWriter)))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRequestURL))(StringLiteral:<STR>))))))))))