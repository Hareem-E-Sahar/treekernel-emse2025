(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:receivedMessage)(SingleVariableDeclaration(SimpleType(SimpleName:ByteBuffer))(SimpleName:message))(Block(VariableDeclarationStatement(SimpleType(SimpleName:PacketType))(VariableDeclarationFragment(SimpleName:packetType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NetworkProtocol))(SimpleName:getPacketHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message)))))(SwitchStatement(SimpleName:packetType)(SwitchCase(SimpleName:JOIN_CHANNEL))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ChannelManager))(VariableDeclarationFragment(SimpleName:channelManager)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AppContext))(SimpleName:getChannelManager))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channelName)(InfixExpression(QualifiedName:NetworkProtocol.chatChannelPrefix)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:JoinChannelPacket))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:getChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName))))(SimpleName:join)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getSession)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:channelName))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NameNotBoundException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:createChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName)(ClassInstanceCreation(SimpleType(SimpleName:ChatChannelListener)))(QualifiedName:Delivery.UNRELIABLE))))(SimpleName:join)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getSession)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:channelName))))))))(BreakStatement))(SwitchCase(SimpleName:LEAVE_CHANNEL))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ChannelManager))(VariableDeclarationFragment(SimpleName:channelManager)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AppContext))(SimpleName:getChannelManager))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channelName)(InfixExpression(QualifiedName:NetworkProtocol.chatChannelPrefix)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LeaveChannelPacket))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Channel))(VariableDeclarationFragment(SimpleName:channel)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:getChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channel))(SimpleName:leave)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getSession)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AppContext))(SimpleName:getTaskManager)))(SimpleName:scheduleTask)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:CleanChannelTask))(SimpleName:channelName))(NumberLiteral:500)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NameNotBoundException))(SimpleName:e))(Block)))(BreakStatement))(SwitchCase(SimpleName:WHISPER_CHAT))(Block(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:String))(Dimension))(VariableDeclarationFragment(SimpleName:contents)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ChatWhisperPacket))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:targetName)(ArrayAccess(SimpleName:contents)(NumberLiteral:0))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:messageContents)(ArrayAccess(SimpleName:contents)(NumberLiteral:1))))(VariableDeclarationStatement(SimpleType(SimpleName:ClientSession))(VariableDeclarationFragment(SimpleName:targetSession)(MethodInvocation(SimpleName:getSessionByName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:targetName)))))(IfStatement(InfixExpression(SimpleName:targetSession)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getSession)))(SimpleName:send)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SimpleChatPacket))(SimpleName:create)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:targetName)(StringLiteral:<STR>)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getSession)))(SimpleName:send)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:WhisperSuccessPacket))(SimpleName:create)(METHOD_INVOCATION_ARGUMENTS(SimpleName:targetName)(SimpleName:messageContents))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:targetSession))(SimpleName:send)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ChatWhisperPacket))(SimpleName:create)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sessionName)(SimpleName:messageContents))))))))(BreakStatement))(SwitchCase(SimpleName:PLAYER_INPUT))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:playerReference))(SimpleName:get)))(SimpleName:getGameInputRef)))(SimpleName:getForUpdate)))(SimpleName:setByPacket)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message))))(BreakStatement))(SwitchCase(SimpleName:CLIENT_STATE))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ClientGameState))(VariableDeclarationFragment(SimpleName:currState)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:playerReference))(SimpleName:get)))(SimpleName:getGameState))))(IfStatement(InfixExpression(SimpleName:currState)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:ClientGameState.FACTION_SELECT))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ClientGameState))(VariableDeclarationFragment(SimpleName:reportedState)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ClientStateTransitionPacket))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message)))))(IfStatement(InfixExpression(SimpleName:reportedState)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:ClientGameState.FACTION_SELECT))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(StringLiteral:<STR>))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:factionSelect)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ClientStateTransitionPacket))(SimpleName:decodePBByteSelection)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message)))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(ParameterizedType(SimpleType(SimpleName:ManagedReference))(WildcardType(SimpleType(SimpleName:PlayableFaction)))))(VariableDeclarationFragment(SimpleName:factionList)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:GameUniverse))(SimpleName:getReadOnly)))(SimpleName:getPlayableFactions))))(VariableDeclarationStatement(SimpleType(SimpleName:Player))(VariableDeclarationFragment(SimpleName:player)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:playerReference))(SimpleName:getForUpdate))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:player))(SimpleName:setFaction)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:factionList))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:factionSelect))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:player))(SimpleName:transitionToShipSelection))))(IfStatement(InfixExpression(InfixExpression(SimpleName:currState)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:ClientGameState.SHIP_SELECT))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:currState)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:ClientGameState.FRAGGED)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ClientGameState))(VariableDeclarationFragment(SimpleName:reportedState)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ClientStateTransitionPacket))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message)))))(IfStatement(InfixExpression(SimpleName:reportedState)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:currState))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(StringLiteral:<STR>))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:shipSelect)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ClientStateTransitionPacket))(SimpleName:decodePBByteSelection)(METHOD_INVOCATION_ARGUMENTS(SimpleName:message)))))(VariableDeclarationStatement(SimpleType(SimpleName:Player))(VariableDeclarationFragment(SimpleName:player)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:playerReference))(SimpleName:getForUpdate))))(VariableDeclarationStatement(SimpleType(SimpleName:PlayerShipRecordHolder))(VariableDeclarationFragment(SimpleName:record)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:player))(SimpleName:getShipRecords))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AppContext))(SimpleName:getDataManager)))(SimpleName:markForUpdate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:record))))(VariableDeclarationStatement(SimpleType(SimpleName:ServerPlayerShip))(VariableDeclarationFragment(SimpleName:ship)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:player))(SimpleName:getFaction)))(SimpleName:makeShipBySelection)(METHOD_INVOCATION_ARGUMENTS(SimpleName:shipSelect)(SimpleName:playerReference)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:record))(SimpleName:associateShipWithRecord)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ship))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:player))(SimpleName:transitionToInGame))))))(BreakStatement))(SwitchCase(SimpleName:SERIAL_UNIVERSE))(Block(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:ByteBuffer)))(VariableDeclarationFragment(SimpleName:toSend)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:GameUniverse))(SimpleName:getReadOnly)))(SimpleName:makeUniverseInformationPackets))))(VariableDeclarationStatement(SimpleType(SimpleName:ClientSession))(VariableDeclarationFragment(SimpleName:session)(MethodInvocation(SimpleName:getSession))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:ByteBuffer))(SimpleName:b))(SimpleName:toSend)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:send)(METHOD_INVOCATION_ARGUMENTS(SimpleName:b)))))(BreakStatement))(SwitchCase(SimpleName:SERVER_DEBUG))(Block(BreakStatement))(SwitchCase)(BreakStatement))))))