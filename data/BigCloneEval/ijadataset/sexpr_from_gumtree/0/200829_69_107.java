(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:PluginResult))(SimpleName:check)(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:ssl))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:hostname))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:port))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:timeout))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:cmdline))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:KeyManagementException))(SimpleType(SimpleName:NoSuchAlgorithmException))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:packet)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(NumberLiteral:2)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2)(NumberLiteral:4)(NumberLiteral:2)(SimpleName:MAX_PACKETBUFFER_LENGTH)(SimpleName:C_STRUCT_PADDING)))))))(ExpressionStatement(MethodInvocation(SimpleName:htons)(METHOD_INVOCATION_ARGUMENTS(SimpleName:NRPE_PACKET_VERSION_2)(SimpleName:packet)(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(SimpleName:htons)(METHOD_INVOCATION_ARGUMENTS(SimpleName:QUERY_PACKET)(SimpleName:packet)(NumberLiteral:2))))(ExpressionStatement(MethodInvocation(SimpleName:htonl)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(SimpleName:packet)(NumberLiteral:4))))(ExpressionStatement(MethodInvocation(SimpleName:htons)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PluginResult.STATE_OK)(SimpleName:packet)(NumberLiteral:8))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cmdline))(SimpleName:getBytes))(NumberLiteral:0)(SimpleName:packet)(NumberLiteral:10)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cmdline))(SimpleName:length)))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:packet)(InfixExpression(InfixExpression(NumberLiteral:10)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:MAX_PACKETBUFFER_LENGTH))(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(VariableDeclarationStatement(SimpleType(SimpleName:CRC32))(VariableDeclarationFragment(SimpleName:crc32)(ClassInstanceCreation(SimpleType(SimpleName:CRC32)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc32))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:packet))))(ExpressionStatement(MethodInvocation(SimpleName:htonl)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc32))(SimpleName:getValue))(SimpleName:packet)(NumberLiteral:4))))(ExpressionStatement(MethodInvocation(SimpleName:hexdump)(METHOD_INVOCATION_ARGUMENTS(SimpleName:packet)(NumberLiteral:0)(QualifiedName:packet.length)(QualifiedName:System.out))))(VariableDeclarationStatement(SimpleType(SimpleName:Socket))(VariableDeclarationFragment(SimpleName:socket)(ClassInstanceCreation(SimpleType(SimpleName:Socket))(SimpleName:hostname)(SimpleName:port))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:socket))(SimpleName:setSoTimeout)(METHOD_INVOCATION_ARGUMENTS(SimpleName:timeout))))(IfStatement(SimpleName:ssl)(Block(ExpressionStatement(Assignment(SimpleName:socket)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:wrap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socket)))))))(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:out)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:socket))(SimpleName:getOutputStream))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:packet))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:in)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:socket))(SimpleName:getInputStream))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:length)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:packet)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:length)))))(ExpressionStatement(MethodInvocation(SimpleName:hexdump)(METHOD_INVOCATION_ARGUMENTS(SimpleName:packet)(NumberLiteral:0)(SimpleName:length)(QualifiedName:System.out))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:packetCrc32)(MethodInvocation(SimpleName:ntohl)(METHOD_INVOCATION_ARGUMENTS(SimpleName:packet)(NumberLiteral:4)))))(ExpressionStatement(MethodInvocation(SimpleName:htonl)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(SimpleName:packet)(NumberLiteral:4))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc32))(SimpleName:reset)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc32))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:packet))))(IfStatement(InfixExpression(SimpleName:packetCrc32)(INFIX_EXPRESSION_OPERATOR:!=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc32))(SimpleName:getValue)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:packetCrc32)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc32))(SimpleName:getValue))(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:PluginResult))(VariableDeclarationFragment(SimpleName:result)(ClassInstanceCreation(SimpleType(SimpleName:PluginResult)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:result))(SimpleName:setState)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:ntohs)(METHOD_INVOCATION_ARGUMENTS(SimpleName:packet)(NumberLiteral:8))))))(VariableDeclarationStatement(SimpleType(SimpleName:StringBuffer))(VariableDeclarationFragment(SimpleName:pluginOutput)(ClassInstanceCreation(SimpleType(SimpleName:StringBuffer)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:10)))(InfixExpression(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:packet.length))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:!=)(ArrayAccess(SimpleName:packet)(SimpleName:i))))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pluginOutput))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:char)(ArrayAccess(SimpleName:packet)(SimpleName:i))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:result))(SimpleName:setPluginOutput)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pluginOutput))(SimpleName:toString)))))(ReturnStatement(SimpleName:result))))))