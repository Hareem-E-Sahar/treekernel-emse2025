(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:exportMessages)(SingleVariableDeclaration(ArrayType(SimpleType(SimpleName:Long))(Dimension))(SimpleName:msgIds))(SingleVariableDeclaration(SimpleType(SimpleName:ExportFormat))(SimpleName:format))(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:outStream))(SimpleType(SimpleName:NotFoundException))(SimpleType(SimpleName:PermissionException))(SimpleType(SimpleName:ExportMessagesException))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:ExportFormat.XML))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:format)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExportMessagesException))(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:ZipOutputStream))(VariableDeclarationFragment(SimpleName:zipOutputStream)(NullLiteral)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:ExportFormat.RFC2822DIRECTORY))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:format)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:CheckedOutputStream))(VariableDeclarationFragment(SimpleName:checksum)(ClassInstanceCreation(SimpleType(SimpleName:CheckedOutputStream))(SimpleName:outStream)(ClassInstanceCreation(SimpleType(SimpleName:Adler32))))))(ExpressionStatement(Assignment(SimpleName:zipOutputStream)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ZipOutputStream))(ClassInstanceCreation(SimpleType(SimpleName:BufferedOutputStream))(SimpleName:checksum)))))))(TryStatement(Block(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Long))(SimpleName:msgId))(SimpleName:msgIds)(Block(VariableDeclarationStatement(SimpleType(SimpleName:Mail))(VariableDeclarationFragment(SimpleName:mail)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getMailFor)(METHOD_INVOCATION_ARGUMENTS(SimpleName:msgId)(QualifiedName:Permission.VIEW_ARCHIVES)))))(SwitchStatement(SimpleName:format)(SwitchCase(SimpleName:RFC2822DIRECTORY))(VariableDeclarationStatement(SimpleType(SimpleName:ZipEntry))(VariableDeclarationFragment(SimpleName:entry)(ClassInstanceCreation(SimpleType(SimpleName:ZipEntry))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:msgId))(SimpleName:toString))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:setComment)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mail))(SimpleName:getFrom))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mail))(SimpleName:getList)))(SimpleName:getEmail))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:setTime)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mail))(SimpleName:getArrivalDate)))(SimpleName:getTime)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOutputStream))(SimpleName:putNextEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:entry))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:writeMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mail)(SimpleName:zipOutputStream))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOutputStream))(SimpleName:closeEntry)))(BreakStatement)(SwitchCase(SimpleName:MBOX))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mail))(SimpleName:getFrom)))))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:writeMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mail)(SimpleName:outStream))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:getBytes)))))(BreakStatement)(SwitchCase)(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExportMessagesException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:format))(SimpleName:toString))))))))(SwitchStatement(SimpleName:format)(SwitchCase(SimpleName:RFC2822DIRECTORY))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOutputStream))(SimpleName:close)))(BreakStatement)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExportMessagesException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))))))