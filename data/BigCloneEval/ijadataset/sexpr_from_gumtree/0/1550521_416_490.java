(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(PrimitiveType:void)(SimpleName:_fetchResource)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:targetUrl))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:op))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:type))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:referer))(Block(VariableDeclarationStatement(SimpleType(SimpleName:URL))(VariableDeclarationFragment(SimpleName:url)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:url)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:URL))(ClassInstanceCreation(SimpleType(SimpleName:URL))(SimpleName:referer))(SimpleName:targetUrl)))))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:java.net.MalformedURLException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:errorMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:referer)(StringLiteral:<STR>)(SimpleName:e))))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:webPageCache))(SimpleName:containsKey)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:toString))))(Block(ExpressionStatement(MethodInvocation(SimpleName:logMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:url)))))(ReturnStatement)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(SimpleName:_checkCache)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:toString)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:GetMethod))(VariableDeclarationFragment(SimpleName:getImageMethod)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:getImageMethod)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:GetMethod))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:toString)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:getParams)))(SimpleName:setSoTimeout)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socketTimeout))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:getParams)))(SimpleName:setParameter)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpMethodParams.RETRY_HANDLER)(ClassInstanceCreation(SimpleType(SimpleName:DefaultHttpMethodRetryHandler))(NumberLiteral:3)(BooleanLiteral:false)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:setFollowRedirects)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:setRequestHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:referer))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:setRequestHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(SimpleName:id)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)))(StringLiteral:<STR>)(SimpleName:scriptName)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:responseCode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpClient))(SimpleName:executeMethod)(METHOD_INVOCATION_ARGUMENTS(SimpleName:getImageMethod)))))(IfStatement(SimpleName:test)(Block(VariableDeclarationStatement(SimpleType(SimpleName:Request))(VariableDeclarationFragment(SimpleName:req)(ClassInstanceCreation(SimpleType(SimpleName:Request))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:toString))(StringLiteral:<STR>)(SimpleName:responseCode)(StringLiteral:<STR>))))(ExpressionStatement(Assignment(QualifiedName:req.queryString)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:getQueryString))))(ExpressionStatement(Assignment(QualifiedName:req.respHeaders)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:getResponseHeaders))))(ExpressionStatement(Assignment(QualifiedName:req.reqHeaders)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:getRequestHeaders))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:logDir)(SimpleName:targetUrl)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:localFile)(ClassInstanceCreation(SimpleType(SimpleName:File))(InfixExpression(SimpleName:logDir)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:targetUrl)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:localFile))(SimpleName:getParentFile)))(SimpleName:mkdirs)))(VariableDeclarationStatement(SimpleType(SimpleName:BufferedInputStream))(VariableDeclarationFragment(SimpleName:is)(ClassInstanceCreation(SimpleType(SimpleName:BufferedInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:getResponseBodyAsStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:BufferedOutputStream))(VariableDeclarationFragment(SimpleName:os)(ClassInstanceCreation(SimpleType(SimpleName:BufferedOutputStream))(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:localFile)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:i)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:is))(SimpleName:read))))(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:is))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:logDir)(SimpleName:targetUrl)(StringLiteral:<STR>)(SimpleName:e))))))))(IfStatement(InfixExpression(SimpleName:status)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:status.requests))(SimpleName:addElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:req)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:userIterationStatus.requests))(SimpleName:addElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:req))))))))(IfStatement(InfixExpression(SimpleName:responseCode)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:HttpStatus.SC_OK))(Block(ExpressionStatement(MethodInvocation(SimpleName:logMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:url)(StringLiteral:<STR>)(SimpleName:responseCode)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:HttpStatus))(SimpleName:getStatusText)(METHOD_INVOCATION_ARGUMENTS(SimpleName:responseCode)))))))(IfStatement(SimpleName:test)(Block(IfStatement(InfixExpression(SimpleName:status)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:status.logs))(SimpleName:addElement)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:logStr)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:responseCode)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:HttpStatus))(SimpleName:getStatusText)(METHOD_INVOCATION_ARGUMENTS(SimpleName:responseCode))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:userIterationStatus.logs))(SimpleName:addElement)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:logStr)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:responseCode)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:HttpStatus))(SimpleName:getStatusText)(METHOD_INVOCATION_ARGUMENTS(SimpleName:responseCode)))))))))))(ReturnStatement)))(ExpressionStatement(MethodInvocation(SimpleName:logMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:url)(StringLiteral:<STR>)(SimpleName:responseCode)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:HttpStatus))(SimpleName:getStatusText)(METHOD_INVOCATION_ARGUMENTS(SimpleName:responseCode)))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lastModified)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:getResponseHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:getValue))))(ExpressionStatement(MethodInvocation(SimpleName:_updateCache)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:toString))(SimpleName:lastModified))))(IfStatement(InfixExpression(SimpleName:getImageMethod)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getImageMethod))(SimpleName:releaseConnection)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:HttpException))(SimpleName:he))(Block(ExpressionStatement(MethodInvocation(SimpleName:errorMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:he)))))))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:java.io.IOException))(SimpleName:ioe))(Block(ExpressionStatement(MethodInvocation(SimpleName:errorMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ioe)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:errorMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:e))(SimpleName:e))))))(Block(IfStatement(InfixExpression(SimpleName:getMethod)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:getMethod))(SimpleName:releaseConnection)))))))(Block(ExpressionStatement(MethodInvocation(SimpleName:logMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:url)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:webPageCache))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:toString))(StringLiteral:<STR>))))))(ReturnStatement)))))