(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(PrimitiveType:int)(SimpleName:routeDataForChannel)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:NodeChannel))(SimpleName:nodeChannel))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:Node))(SimpleName:sourceNode))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ChannelRouterContext))(VariableDeclarationFragment(SimpleName:context)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:ts)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:dataCount)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:context)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ChannelRouterContext))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sourceNode))(SimpleName:getNodeId))(SimpleName:nodeChannel)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:symmetricDialect))(SimpleName:getPlatform)))(SimpleName:getSqlTemplate)))(SimpleName:startSqlTransaction)))))(ExpressionStatement(Assignment(SimpleName:dataCount)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:selectDataAndRoute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:context)))))(ReturnStatement(SimpleName:dataCount)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:format)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nodeChannel))(SimpleName:getChannelId))))(SimpleName:ex))))(IfStatement(InfixExpression(SimpleName:context)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:rollback)))))(ReturnStatement(NumberLiteral:0))))(Block(TryStatement(Block(IfStatement(InfixExpression(SimpleName:dataCount)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:insertTs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dataService))(SimpleName:insertDataEvents)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getSqlTransaction))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getDataEventList)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:clearDataEventsList)))(ExpressionStatement(MethodInvocation(SimpleName:completeBatchesAndCommit)(METHOD_INVOCATION_ARGUMENTS(SimpleName:context))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:incrementStat)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:insertTs))(QualifiedName:ChannelRouterContext.STAT_INSERT_DATA_EVENTS_MS))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getLastDataIdProcessed))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channelId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nodeChannel))(SimpleName:getChannelId))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:queryTs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:dataLeftToRoute)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sqlTemplate))(SimpleName:queryForInt)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getSql)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(SimpleName:channelId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getLastDataIdProcessed))))))(ExpressionStatement(Assignment(SimpleName:queryTs)(ASSIGNMENT_OPERATOR:=)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:queryTs))))(IfStatement(InfixExpression(SimpleName:queryTs)(INFIX_EXPRESSION_OPERATOR:>)(QualifiedName:Constants.LONG_OPERATION_THRESHOLD))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:channelId)(SimpleName:queryTs))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:statisticManager))(SimpleName:setDataUnRouted)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelId)(SimpleName:dataLeftToRoute)))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(IfStatement(InfixExpression(SimpleName:context)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:rollback)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))(SimpleName:e))))))(Block(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:totalTime)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:ts))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:incrementStat)(METHOD_INVOCATION_ARGUMENTS(SimpleName:totalTime)(QualifiedName:ChannelRouterContext.STAT_ROUTE_TOTAL_TIME))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:logStats)(METHOD_INVOCATION_ARGUMENTS(SimpleName:log)(SimpleName:totalTime))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:cleanup)))))))))))