(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleName:NatChecker)(SingleVariableDeclaration(SimpleType(SimpleName:AzureusCore))(SimpleName:azureus_core))(SingleVariableDeclaration(SimpleType(SimpleName:InetAddress))(SimpleName:bind_ip))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:port))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:http_test))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:check)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:int)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Math))(SimpleName:random))(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:100000)))))))))(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:port)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:port)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:65535)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:port)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:6880)))(Block(ExpressionStatement(Assignment(SimpleName:result)(ASSIGNMENT_OPERATOR:=)(SimpleName:NAT_UNABLE)))(ExpressionStatement(Assignment(SimpleName:additional_info)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(ReturnStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:NatCheckerServer))(VariableDeclarationFragment(SimpleName:server)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:server)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:NatCheckerServer))(SimpleName:bind_ip)(SimpleName:port)(SimpleName:check)(SimpleName:http_test)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:e))(Block(ExpressionStatement(Assignment(SimpleName:result)(ASSIGNMENT_OPERATOR:=)(SimpleName:NAT_UNABLE)))(ExpressionStatement(Assignment(SimpleName:additional_info)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:getNestedExceptionMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e))))))(ReturnStatement))))(VariableDeclarationStatement(SimpleType(SimpleName:PluginInterface))(VariableDeclarationFragment(SimpleName:pi_upnp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:azureus_core))(SimpleName:getPluginManager)))(SimpleName:getPluginInterfaceByClass)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:UPnPPlugin)))))))(VariableDeclarationStatement(SimpleType(SimpleName:UPnPMapping))(VariableDeclarationFragment(SimpleName:new_mapping)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:upnp_str)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:pi_upnp)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:UPnPPlugin))(VariableDeclarationFragment(SimpleName:upnp)(CastExpression(SimpleType(SimpleName:UPnPPlugin))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pi_upnp))(SimpleName:getPlugin)))))(VariableDeclarationStatement(SimpleType(SimpleName:UPnPMapping))(VariableDeclarationFragment(SimpleName:mapping)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:upnp))(SimpleName:getMapping)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true)(SimpleName:port)))))(IfStatement(InfixExpression(SimpleName:mapping)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:new_mapping)(ASSIGNMENT_OPERATOR:=)(Assignment(SimpleName:mapping)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:upnp))(SimpleName:addMapping)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(BooleanLiteral:true)(SimpleName:port)(BooleanLiteral:true))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Thread))(SimpleName:sleep)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:500)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:printStackTrace)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e)))))))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:UPnPPluginService))(Dimension))(VariableDeclarationFragment(SimpleName:services)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:upnp))(SimpleName:getServices))))(IfStatement(InfixExpression(QualifiedName:services.length)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:upnp_str)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:services.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:UPnPPluginService))(VariableDeclarationFragment(SimpleName:service)(ArrayAccess(SimpleName:services)(SimpleName:i))))(ExpressionStatement(Assignment(SimpleName:upnp_str)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(StringLiteral:<STR>)(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:service))(SimpleName:getInfo)))))))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:server))(SimpleName:start)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:urlStr)(InfixExpression(QualifiedName:Constants.NAT_TEST_SERVER_HTTP)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(ConditionalExpression(SimpleName:http_test)(StringLiteral:<STR>)(StringLiteral:<STR>)))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:port)))(StringLiteral:<STR>)(SimpleName:check))))(IfStatement(InfixExpression(SimpleName:upnp_str)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:urlStr)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:URLEncoder))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:upnp_str)(StringLiteral:<STR>))))))))(VariableDeclarationStatement(SimpleType(SimpleName:NetworkAdminASN))(VariableDeclarationFragment(SimpleName:net_asn)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NetworkAdmin))(SimpleName:getSingleton)))(SimpleName:getCurrentASN))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:as)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:net_asn))(SimpleName:getAS))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:asn)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:net_asn))(SimpleName:getASName))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:as))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:urlStr)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:URLEncoder))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:as)(StringLiteral:<STR>))))))(ExpressionStatement(Assignment(SimpleName:urlStr)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:URLEncoder))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:asn)(StringLiteral:<STR>))))))))(ExpressionStatement(Assignment(SimpleName:urlStr)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageText))(SimpleName:getCurrentLocale)))(SimpleName:toString)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ip_override)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TRTrackerUtils))(SimpleName:getPublicIPOverride))))(IfStatement(InfixExpression(SimpleName:ip_override)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:urlStr)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ip_override))))))(VariableDeclarationStatement(SimpleType(SimpleName:URL))(VariableDeclarationFragment(SimpleName:url)(ClassInstanceCreation(SimpleType(SimpleName:URL))(SimpleName:urlStr))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpURLConnection))(VariableDeclarationFragment(SimpleName:con)(CastExpression(SimpleType(SimpleName:HttpURLConnection))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:openConnection)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:connect)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:message)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:is)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:getInputStream))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:1024))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:expected_length)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))(WhileStatement(BooleanLiteral:true)(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:len)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:is))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)))))(IfStatement(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:<=)(NumberLiteral:0))(Block(BreakStatement)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(SimpleName:len))))(IfStatement(InfixExpression(InfixExpression(SimpleName:expected_length)(INFIX_EXPRESSION_OPERATOR:==)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>=)(NumberLiteral:4)))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:bytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:toByteArray))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteBuffer))(VariableDeclarationFragment(SimpleName:bb)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:wrap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bytes)))))(ExpressionStatement(Assignment(SimpleName:expected_length)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bb))(SimpleName:getInt))))(ExpressionStatement(Assignment(SimpleName:message)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(IfStatement(InfixExpression(QualifiedName:bytes.length)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:4))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bytes)(NumberLiteral:4)(InfixExpression(QualifiedName:bytes.length)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:4)))))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:expected_length)(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:expected_length)))(Block(BreakStatement)))))(VariableDeclarationStatement(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:map)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BDecoder))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:toByteArray))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:reply_result)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Long))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:map))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(SimpleName:intValue))))(SwitchStatement(SimpleName:reply_result)(SwitchCase(NumberLiteral:0))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:reason)(CastExpression(ArrayType(PrimitiveType:byte)(Dimension))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:map))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(InfixExpression(SimpleName:reason)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:LogEvent))(SimpleName:LOGID)(QualifiedName:LogEvent.LT_ERROR)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ClassInstanceCreation(SimpleType(SimpleName:String))(SimpleName:reason)))))))))(ExpressionStatement(Assignment(SimpleName:result)(ASSIGNMENT_OPERATOR:=)(SimpleName:NAT_KO)))(ExpressionStatement(Assignment(SimpleName:additional_info)(ASSIGNMENT_OPERATOR:=)(ConditionalExpression(InfixExpression(SimpleName:reason)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(StringLiteral:<STR>)(ClassInstanceCreation(SimpleType(SimpleName:String))(SimpleName:reason)(StringLiteral:<STR>)))))(BreakStatement))(SwitchCase(NumberLiteral:1))(Block(ExpressionStatement(Assignment(SimpleName:result)(ASSIGNMENT_OPERATOR:=)(SimpleName:NAT_OK)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:reply)(CastExpression(ArrayType(PrimitiveType:byte)(Dimension))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:map))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(InfixExpression(SimpleName:reply)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:additional_info)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:String))(SimpleName:reply)(StringLiteral:<STR>))))))(BreakStatement))(SwitchCase)(Block(ExpressionStatement(Assignment(SimpleName:result)(ASSIGNMENT_OPERATOR:=)(SimpleName:NAT_UNABLE)))(ExpressionStatement(Assignment(SimpleName:additional_info)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(BreakStatement)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ip_bytes)(CastExpression(ArrayType(PrimitiveType:byte)(Dimension))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:map))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(InfixExpression(SimpleName:ip_bytes)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:ip_address)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:InetAddress))(SimpleName:getByAddress)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ip_bytes))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:e))(Block))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(Assignment(SimpleName:result)(ASSIGNMENT_OPERATOR:=)(SimpleName:NAT_UNABLE)))(ExpressionStatement(Assignment(SimpleName:additional_info)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:getNestedExceptionMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:server))(SimpleName:stopIt)))(IfStatement(InfixExpression(SimpleName:new_mapping)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:new_mapping))(SimpleName:destroy)))))))))))