(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:writeKeyPair)(SingleVariableDeclaration(SimpleType(SimpleName:ASCIIArmour))(SimpleName:armour))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:password))(SingleVariableDeclaration(SimpleType(SimpleName:SecureRandom))(SimpleName:random))(SingleVariableDeclaration(SimpleType(SimpleName:KeyPair))(SimpleName:keyPair))(SimpleType(SimpleName:SSH2FatalException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ASN1Object))(VariableDeclarationFragment(SimpleName:pem)))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:publicKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:headType)))(IfStatement(InstanceofExpression(SimpleName:publicKey)(SimpleType(SimpleName:DSAPublicKey)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DSAPublicKey))(VariableDeclarationFragment(SimpleName:pubKey)(CastExpression(SimpleType(SimpleName:DSAPublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic)))))(VariableDeclarationStatement(SimpleType(SimpleName:DSAPrivateKey))(VariableDeclarationFragment(SimpleName:prvKey)(CastExpression(SimpleType(SimpleName:DSAPrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate)))))(VariableDeclarationStatement(SimpleType(SimpleName:DSAParams))(VariableDeclarationFragment(SimpleName:params)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKey))(SimpleName:getParams))))(VariableDeclarationStatement(SimpleType(SimpleName:PEMDSAPrivate))(VariableDeclarationFragment(SimpleName:dsa)(ClassInstanceCreation(SimpleType(SimpleName:PEMDSAPrivate))(NumberLiteral:0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getP))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getQ))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getG))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKey))(SimpleName:getY))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prvKey))(SimpleName:getX)))))(ExpressionStatement(Assignment(SimpleName:pem)(ASSIGNMENT_OPERATOR:=)(SimpleName:dsa)))(ExpressionStatement(Assignment(SimpleName:headType)(ASSIGNMENT_OPERATOR:=)(SimpleName:TYPE_PEM_DSA))))(IfStatement(InstanceofExpression(SimpleName:publicKey)(SimpleType(SimpleName:RSAPublicKey)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:RSAPublicKey))(VariableDeclarationFragment(SimpleName:pubKey)(CastExpression(SimpleType(SimpleName:RSAPublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic)))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPrivateCrtKey))(VariableDeclarationFragment(SimpleName:prvKey)(CastExpression(SimpleType(SimpleName:RSAPrivateCrtKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate)))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPrivateKey))(VariableDeclarationFragment(SimpleName:rsa)(ClassInstanceCreation(SimpleType(SimpleName:RSAPrivateKey))(NumberLiteral:0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKey))(SimpleName:getModulus))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKey))(SimpleName:getPublicExponent))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prvKey))(SimpleName:getPrivateExponent))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prvKey))(SimpleName:getPrimeP))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prvKey))(SimpleName:getPrimeQ))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prvKey))(SimpleName:getCrtCoefficient)))))(ExpressionStatement(Assignment(SimpleName:pem)(ASSIGNMENT_OPERATOR:=)(SimpleName:rsa)))(ExpressionStatement(Assignment(SimpleName:headType)(ASSIGNMENT_OPERATOR:=)(SimpleName:TYPE_PEM_RSA))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SSH2FatalException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:publicKey)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:armour))(SimpleName:setHeaderLine)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:BEGIN_PRV_KEY)(SimpleName:headType)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:armour))(SimpleName:setTailLine)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:END_PRV_KEY)(SimpleName:headType)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:enc)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream))(NumberLiteral:128))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1DER))(VariableDeclarationFragment(SimpleName:der)(ClassInstanceCreation(SimpleType(SimpleName:ASN1DER)))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:der))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:enc)(SimpleName:pem)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SSH2FatalException))(StringLiteral:<STR>))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:keyBlob)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:enc))(SimpleName:toByteArray))))(IfStatement(InfixExpression(InfixExpression(SimpleName:password)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:password))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0)))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:iv)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:key)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:random))(SimpleName:setSeed)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyBlob))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:8))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:r)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:1))))))(DoStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:random))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:r))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:iv)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:r)(NumberLiteral:0)))))(InfixExpression(ArrayAccess(SimpleName:iv)(SimpleName:i))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0x00)))))(ExpressionStatement(Assignment(SimpleName:key)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:expandPasswordToKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)(InfixExpression(NumberLiteral:192)(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:8))(SimpleName:iv)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:armour))(SimpleName:setHeaderField)(METHOD_INVOCATION_ARGUMENTS(SimpleName:PRV_PROCTYPE)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:armour))(SimpleName:setHeaderField)(METHOD_INVOCATION_ARGUMENTS(SimpleName:PRV_DEKINFO)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:HexDump))(SimpleName:toString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:iv))))(SimpleName:toUpperCase))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:encLen)(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:8)(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(QualifiedName:keyBlob.length)(INFIX_EXPRESSION_OPERATOR:%)(NumberLiteral:8)))))(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:keyBlob.length))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encBuf)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:encLen))))))(ExpressionStatement(MethodInvocation(SimpleName:doCipher)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:password)(SimpleName:keyBlob)(QualifiedName:keyBlob.length)(SimpleName:encBuf)(SimpleName:iv))))(ExpressionStatement(Assignment(SimpleName:keyBlob)(ASSIGNMENT_OPERATOR:=)(SimpleName:encBuf)))))(ReturnStatement(SimpleName:keyBlob))))))