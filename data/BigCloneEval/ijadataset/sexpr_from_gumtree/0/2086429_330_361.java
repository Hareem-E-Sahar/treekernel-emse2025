(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:void)(SimpleName:onDhReply)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:SshDhReply))(SimpleName:msg))(SimpleType(SimpleName:GeneralSecurityException))(SimpleType(SimpleName:IOException))(Block(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(FieldAccess(ThisExpression)(SimpleName:keyPair))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:connection)))(SimpleName:isServer)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SshException))(StringLiteral:<STR>)(FieldAccess(FieldAccess(ThisExpression)(SimpleName:connection))(SimpleName:uri))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:msg))(SimpleName:getType)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:k)))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:DHPublicKeySpec))(VariableDeclarationFragment(SimpleName:remoteKeySpec)(ClassInstanceCreation(SimpleType(SimpleName:DHPublicKeySpec))(ClassInstanceCreation(SimpleType(SimpleName:BigInteger))(QualifiedName:msg.f))(SimpleName:P1)(SimpleName:G))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:KeyFactory))(VariableDeclarationFragment(SimpleName:dhKeyFact)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:DHPublicKey))(VariableDeclarationFragment(SimpleName:remotePubKey)(CastExpression(SimpleType(SimpleName:DHPublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dhKeyFact))(SimpleName:generatePublic)(METHOD_INVOCATION_ARGUMENTS(SimpleName:remoteKeySpec))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:KeyAgreement))(VariableDeclarationFragment(SimpleName:dhKex)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyAgreement))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dhKex))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:keyPair)))(SimpleName:getPrivate)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dhKex))(SimpleName:doPhase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:remotePubKey)(BooleanLiteral:true))))(ExpressionStatement(Assignment(SimpleName:k)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:BigInteger))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dhKex))(SimpleName:generateSecret))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(SimpleName:createMessageDigest))))(VariableDeclarationStatement(Modifier:final)(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:h)))(Block(ExpressionStatement(MethodInvocation(SimpleName:updateByteArray)(METHOD_INVOCATION_ARGUMENTS(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:SshVersion.LOCAL))(SimpleName:toString)))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(SimpleName:updateByteArray)(METHOD_INVOCATION_ARGUMENTS(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:connection)))(SimpleName:getRemoteSshVersion)))(SimpleName:toString)))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(SimpleName:updateByteArray)(METHOD_INVOCATION_ARGUMENTS(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:keyExchangeInitLocal)))(SimpleName:getPayload)))))(ExpressionStatement(MethodInvocation(SimpleName:updateByteArray)(METHOD_INVOCATION_ARGUMENTS(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:keyExchangeInitRemote)))(SimpleName:getPayload)))))(ExpressionStatement(MethodInvocation(SimpleName:updateByteArray)(METHOD_INVOCATION_ARGUMENTS(SimpleName:md)(QualifiedName:msg.hostKey))))(ExpressionStatement(MethodInvocation(SimpleName:updateByteArray)(METHOD_INVOCATION_ARGUMENTS(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:DHPublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:keyPair)))(SimpleName:getPublic)))))(SimpleName:getY)))(SimpleName:toByteArray)))))(ExpressionStatement(MethodInvocation(SimpleName:updateByteArray)(METHOD_INVOCATION_ARGUMENTS(SimpleName:md)(QualifiedName:msg.f))))(ExpressionStatement(MethodInvocation(SimpleName:updateBigInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:md)(SimpleName:k))))(ExpressionStatement(Assignment(SimpleName:h)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)))))(IfStatement(InfixExpression(FieldAccess(ThisExpression)(SimpleName:sessionId))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:sessionId))(ASSIGNMENT_OPERATOR:=)(SimpleName:h))))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:keyExchangeInitLocal))(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:keyExchangeInitRemote))(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:h))(ASSIGNMENT_OPERATOR:=)(SimpleName:h)))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:k))(ASSIGNMENT_OPERATOR:=)(SimpleName:k)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:connection)))(SimpleName:send)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:SshKeyExchangeNewKeys))))))))))