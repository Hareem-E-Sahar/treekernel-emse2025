(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:decrypt)(SingleVariableDeclaration(PrimitiveType:long)(SimpleName:inSize))(SingleVariableDeclaration(SimpleType(SimpleName:InputStream))(SimpleName:in))(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:out))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:GeneralSecurityException))(Block(TryStatement(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:text)(NullLiteral))(VariableDeclarationFragment(SimpleName:backup)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:total)(InfixExpression(NumberLiteral:3)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)(NumberLiteral:1)(SimpleName:BLOCK_SIZE)(SimpleName:BLOCK_SIZE)(SimpleName:KEY_SIZE)(SimpleName:SHA_SIZE)(NumberLiteral:1)(SimpleName:SHA_SIZE))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:version)))(ExpressionStatement(Assignment(SimpleName:text)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:3))))))(ExpressionStatement(MethodInvocation(SimpleName:readBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)(SimpleName:text))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:String))(SimpleName:text)(StringLiteral:<STR>)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:version)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read))))(IfStatement(InfixExpression(InfixExpression(SimpleName:version)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:1))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:version)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:2)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:version))))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:version)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read)))(IfStatement(InfixExpression(SimpleName:version)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:2))(Block(ExpressionStatement(Assignment(SimpleName:text)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:2))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:len)))(DoStatement(Block(ExpressionStatement(MethodInvocation(SimpleName:readBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)(SimpleName:text))))(ExpressionStatement(Assignment(SimpleName:len)(ASSIGNMENT_OPERATOR:=)(InfixExpression(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:0xff)(INFIX_EXPRESSION_OPERATOR:&)(CastExpression(PrimitiveType:int)(ArrayAccess(SimpleName:text)(NumberLiteral:0)))))(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:|)(ParenthesizedExpression(InfixExpression(NumberLiteral:0xff)(INFIX_EXPRESSION_OPERATOR:&)(CastExpression(PrimitiveType:int)(ArrayAccess(SimpleName:text)(NumberLiteral:1))))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:skip)(METHOD_INVOCATION_ARGUMENTS(SimpleName:len)))(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:len))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:total)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(NumberLiteral:2)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:len))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:len))))))(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0)))))(ExpressionStatement(Assignment(SimpleName:text)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:BLOCK_SIZE))))))(ExpressionStatement(MethodInvocation(SimpleName:readBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)(SimpleName:text))))(ExpressionStatement(Assignment(SimpleName:ivSpec1)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:IvParameterSpec))(SimpleName:text))))(ExpressionStatement(Assignment(SimpleName:aesKey1)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(MethodInvocation(SimpleName:generateAESKey1)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ivSpec1))(SimpleName:getIV))(SimpleName:password)))(SimpleName:CRYPT_ALG))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ivSpec1))(SimpleName:getIV)))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aesKey1))(SimpleName:getEncoded)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.DECRYPT_MODE)(SimpleName:aesKey1)(SimpleName:ivSpec1))))(ExpressionStatement(Assignment(SimpleName:backup)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:BLOCK_SIZE)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:KEY_SIZE)))))))(ExpressionStatement(MethodInvocation(SimpleName:readBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)(SimpleName:backup))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:backup))))(ExpressionStatement(Assignment(SimpleName:text)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:backup)))))(ExpressionStatement(Assignment(SimpleName:ivSpec2)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:IvParameterSpec))(SimpleName:text)(NumberLiteral:0)(SimpleName:BLOCK_SIZE))))(ExpressionStatement(Assignment(SimpleName:aesKey2)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(SimpleName:text)(SimpleName:BLOCK_SIZE)(SimpleName:KEY_SIZE)(SimpleName:CRYPT_ALG))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ivSpec2))(SimpleName:getIV)))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aesKey2))(SimpleName:getEncoded)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hmac))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aesKey1))(SimpleName:getEncoded))(SimpleName:HMAC_ALG)))))(ExpressionStatement(Assignment(SimpleName:backup)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hmac))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:backup)))))(ExpressionStatement(Assignment(SimpleName:text)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:SHA_SIZE))))))(ExpressionStatement(MethodInvocation(SimpleName:readBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)(SimpleName:text))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:backup)(SimpleName:text))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:text))))(ExpressionStatement(Assignment(SimpleName:total)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:inSize)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:total))))(IfStatement(InfixExpression(InfixExpression(SimpleName:total)(INFIX_EXPRESSION_OPERATOR:%)(SimpleName:BLOCK_SIZE))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:total)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read)))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:total)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.DECRYPT_MODE)(SimpleName:aesKey2)(SimpleName:ivSpec2))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hmac))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aesKey2))(SimpleName:getEncoded))(SimpleName:HMAC_ALG)))))(ExpressionStatement(Assignment(SimpleName:backup)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:BLOCK_SIZE))))))(ExpressionStatement(Assignment(SimpleName:text)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:BLOCK_SIZE))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:block)(CastExpression(PrimitiveType:int)(ParenthesizedExpression(InfixExpression(SimpleName:total)(INFIX_EXPRESSION_OPERATOR:/)(SimpleName:BLOCK_SIZE))))))(InfixExpression(SimpleName:block)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(PostfixExpression(SimpleName:block)(POSTFIX_EXPRESSION_OPERATOR:--))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:len)(SimpleName:BLOCK_SIZE)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:backup)(NumberLiteral:0)(SimpleName:len)))(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:len))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:backup)(NumberLiteral:0)(SimpleName:len)(SimpleName:text))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hmac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:backup)(NumberLiteral:0)(SimpleName:len))))(IfStatement(InfixExpression(SimpleName:block)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:1))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:last)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:last)))))(ExpressionStatement(Assignment(SimpleName:len)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:last)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(SimpleName:last)(SimpleName:BLOCK_SIZE)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:text)(NumberLiteral:0)(SimpleName:len))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:doFinal)))))(ExpressionStatement(Assignment(SimpleName:backup)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hmac))(SimpleName:doFinal))))(ExpressionStatement(Assignment(SimpleName:text)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:SHA_SIZE))))))(ExpressionStatement(MethodInvocation(SimpleName:readBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)(SimpleName:text))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:backup)(SimpleName:text))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:text)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidKeyException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GeneralSecurityException))(SimpleName:JCE_EXCEPTION_MESSAGE)(SimpleName:e))))))))))