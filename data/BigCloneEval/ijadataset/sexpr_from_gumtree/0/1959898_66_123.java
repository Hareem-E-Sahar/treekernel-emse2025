(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:signPdf)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:src))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:dest))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:detached))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:DocumentException))(SimpleType(SimpleName:GeneralSecurityException))(SimpleType(SimpleName:CMSException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:path)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:keystore_password)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:key_password)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:ks)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:load)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(SimpleName:path))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keystore_password))(SimpleName:toCharArray)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:alias)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:aliases)))(SimpleName:nextElement)))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:key)(CastExpression(SimpleType(SimpleName:PrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:getKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key_password))(SimpleName:toCharArray)))))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:chain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:getCertificateChain)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfReader))(VariableDeclarationFragment(SimpleName:reader)(ClassInstanceCreation(SimpleType(SimpleName:PdfReader))(SimpleName:src))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfStamper))(VariableDeclarationFragment(SimpleName:stp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfStamper))(SimpleName:createSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:dest))(CharacterLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignatureAppearance))(VariableDeclarationFragment(SimpleName:sap)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:stp))(SimpleName:getSignatureAppearance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setVisibleSignature)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Rectangle))(NumberLiteral:72)(NumberLiteral:732)(NumberLiteral:144)(NumberLiteral:780))(NumberLiteral:1)(NullLiteral))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setSignDate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:GregorianCalendar))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCrypto)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:chain)(NullLiteral)(NullLiteral))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setAcro6Layers)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setRenderingMode)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfSignatureAppearance.RenderingMode.DESCRIPTION))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignature))(VariableDeclarationFragment(SimpleName:dic)))(IfStatement(SimpleName:detached)(ExpressionStatement(Assignment(SimpleName:dic)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:PdfSignature))(QualifiedName:PdfName.ADOBE_PPKLITE)(QualifiedName:PdfName.ADBE_PKCS7_DETACHED))))(ExpressionStatement(Assignment(SimpleName:dic)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:PdfSignature))(QualifiedName:PdfName.ADOBE_PPKMS)(QualifiedName:PdfName.ADBE_PKCS7_SHA1)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setDate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:PdfDate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getSignDate))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfPKCS7))(SimpleName:getSubjectFields)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(NumberLiteral:0))))))(SimpleName:getField)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setReason)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setLocation)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCryptoDictionary)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:csize)(NumberLiteral:4000)))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer)))(VariableDeclarationFragment(SimpleName:exc)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exc))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(ClassInstanceCreation(SimpleType(SimpleName:Integer))(InfixExpression(InfixExpression(SimpleName:csize)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:preClose)(METHOD_INVOCATION_ARGUMENTS(SimpleName:exc))))(VariableDeclarationStatement(SimpleType(SimpleName:CMSSignedDataGenerator))(VariableDeclarationFragment(SimpleName:generator)(ClassInstanceCreation(SimpleType(SimpleName:CMSSignedDataGenerator)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:generator))(SimpleName:addSigner)(METHOD_INVOCATION_ARGUMENTS(SimpleName:key)(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(NumberLiteral:0)))(QualifiedName:CMSSignedDataGenerator.DIGEST_SHA1))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Certificate)))(VariableDeclarationFragment(SimpleName:list)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Certificate))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:chain.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:list))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:chain)(SimpleName:i)))))))(VariableDeclarationStatement(SimpleType(SimpleName:CertStore))(VariableDeclarationFragment(SimpleName:chainStore)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ClassInstanceCreation(SimpleType(SimpleName:CollectionCertStoreParameters))(SimpleName:list))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:generator))(SimpleName:addCertificatesAndCRLs)(METHOD_INVOCATION_ARGUMENTS(SimpleName:chainStore))))(VariableDeclarationStatement(SimpleType(SimpleName:CMSSignedData))(VariableDeclarationFragment(SimpleName:signedData)))(IfStatement(SimpleName:detached)(Block(VariableDeclarationStatement(SimpleType(SimpleName:CMSProcessable))(VariableDeclarationFragment(SimpleName:content)(ClassInstanceCreation(SimpleType(SimpleName:CMSProcessableRange))(SimpleName:sap))))(ExpressionStatement(Assignment(SimpleName:signedData)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:generator))(SimpleName:generate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:content)(BooleanLiteral:false)(StringLiteral:<STR>))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:s)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getRangeStream))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:read)(NumberLiteral:0)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buff)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8192))))))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:read)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buff)(NumberLiteral:0)(NumberLiteral:8192)))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buff)(NumberLiteral:0)(SimpleName:read))))))(VariableDeclarationStatement(SimpleType(SimpleName:CMSProcessable))(VariableDeclarationFragment(SimpleName:content)(ClassInstanceCreation(SimpleType(SimpleName:CMSProcessableByteArray))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)))))(ExpressionStatement(Assignment(SimpleName:signedData)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:generator))(SimpleName:generate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:content)(BooleanLiteral:true)(StringLiteral:<STR>)))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:pk)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedData))(SimpleName:getEncoded))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:outc)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:csize))))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfDictionary))(VariableDeclarationFragment(SimpleName:dic2)(ClassInstanceCreation(SimpleType(SimpleName:PdfDictionary)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pk)(NumberLiteral:0)(SimpleName:outc)(NumberLiteral:0)(QualifiedName:pk.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic2))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:PdfString))(SimpleName:outc)))(SimpleName:setHexWriting)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic2))))))))