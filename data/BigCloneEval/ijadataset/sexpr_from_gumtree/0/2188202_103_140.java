(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(TypeParameter(SimpleName:T))(SimpleType(SimpleName:T))(SimpleName:synchronizeWriteThenReadImpl)(SingleVariableDeclaration(SimpleType(SimpleName:Object))(SimpleName:mutex))(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:Callback))(WildcardType))(SimpleName:write_callback))(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:Callback))(SimpleType(SimpleName:T)))(SimpleName:read_callback))(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:Callback))(WildcardType))(SimpleName:release_callback))(Block(IfStatement(InstanceofExpression(SimpleName:mutex)(SimpleType(SimpleName:ReentrantReadWriteLock)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ReentrantReadWriteLock))(VariableDeclarationFragment(SimpleName:lock)(CastExpression(SimpleType(SimpleName:ReentrantReadWriteLock))(SimpleName:mutex))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:read_lock)(BooleanLiteral:false)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:write_lock)(BooleanLiteral:false)))(IfStatement(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:getReadHoldCount))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:getWriteHoldCount))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:writeLock)))(SimpleName:lock)))(ExpressionStatement(Assignment(SimpleName:write_lock)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:readLock)))(SimpleName:lock)))(ExpressionStatement(Assignment(SimpleName:read_lock)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:write_callback))(SimpleName:action)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:writeLock)))(SimpleName:unlock)))(ExpressionStatement(Assignment(SimpleName:write_lock)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:read_callback))(SimpleName:action))))(Block(IfStatement(SimpleName:write_lock)(Block(TryStatement(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:read_lock))(Block(IfStatement(InfixExpression(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:getReadHoldCount))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:getWriteHoldCount))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:release_callback)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:release_callback))(SimpleName:action)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:writeLock)))(SimpleName:unlock)))))))(IfStatement(SimpleName:read_lock)(Block(TryStatement(Block(IfStatement(InfixExpression(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:getReadHoldCount))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:1))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:getWriteHoldCount))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0)))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:release_callback)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:release_callback))(SimpleName:action)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:readLock)))(SimpleName:unlock))))))))))(IfStatement(InstanceofExpression(SimpleName:mutex)(SimpleType(SimpleName:SyncList)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:UnsupportedOperationException))(StringLiteral:<STR>))))(ReturnStatement(SuperMethodInvocation(SimpleName:synchronizeWriteThenReadImpl)(SimpleName:mutex)(SimpleName:write_callback)(SimpleName:read_callback)(SimpleName:release_callback)))))))))