(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:static)(SimpleType(SimpleName:OCSPResponse))(SimpleName:check)(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:CertId)))(SimpleName:certIds))(SingleVariableDeclaration(SimpleType(SimpleName:URI))(SimpleName:responderURI))(SingleVariableDeclaration(SimpleType(SimpleName:X509Certificate))(SimpleName:responderCert))(SingleVariableDeclaration(SimpleType(SimpleName:Date))(SimpleName:date))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:CertPathValidatorException))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:bytes)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:OCSPRequest))(VariableDeclarationFragment(SimpleName:request)(ClassInstanceCreation(SimpleType(SimpleName:OCSPRequest))(SimpleName:certIds))))(ExpressionStatement(Assignment(SimpleName:bytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:encodeBytes)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioe))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CertPathValidatorException))(StringLiteral:<STR>)(SimpleName:ioe))))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:in)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:out)(NullLiteral)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:response)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:URL))(VariableDeclarationFragment(SimpleName:url)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:responderURI))(SimpleName:toURL))))(IfStatement(InfixExpression(SimpleName:debug)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:debug))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:url)))))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpURLConnection))(VariableDeclarationFragment(SimpleName:con)(CastExpression(SimpleType(SimpleName:HttpURLConnection))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:openConnection)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:setConnectTimeout)(METHOD_INVOCATION_ARGUMENTS(SimpleName:CONNECT_TIMEOUT))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:setReadTimeout)(METHOD_INVOCATION_ARGUMENTS(SimpleName:CONNECT_TIMEOUT))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:setDoOutput)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:setDoInput)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:setRequestMethod)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:setRequestProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:setRequestProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:bytes.length))))))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:getOutputStream))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bytes))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:flush)))(IfStatement(InfixExpression(InfixExpression(SimpleName:debug)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:getResponseCode))(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:HttpURLConnection.HTTP_OK)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:debug))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:getResponseCode))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:getResponseMessage))))))))(ExpressionStatement(Assignment(SimpleName:in)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:getInputStream))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:contentLength)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:getContentLength))))(IfStatement(InfixExpression(SimpleName:contentLength)(INFIX_EXPRESSION_OPERATOR:==)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(Block(ExpressionStatement(Assignment(SimpleName:contentLength)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Integer.MAX_VALUE)))))(ExpressionStatement(Assignment(SimpleName:response)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(ConditionalExpression(InfixExpression(SimpleName:contentLength)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:2048))(NumberLiteral:2048)(SimpleName:contentLength)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:total)(NumberLiteral:0)))(WhileStatement(InfixExpression(SimpleName:total)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:contentLength))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:count)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:response)(SimpleName:total)(InfixExpression(QualifiedName:response.length)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:total))))))(IfStatement(InfixExpression(SimpleName:count)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(BreakStatement))(ExpressionStatement(Assignment(SimpleName:total)(ASSIGNMENT_OPERATOR:+=)(SimpleName:count)))(IfStatement(InfixExpression(InfixExpression(SimpleName:total)(INFIX_EXPRESSION_OPERATOR:>=)(QualifiedName:response.length))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:total)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:contentLength)))(Block(ExpressionStatement(Assignment(SimpleName:response)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:copyOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:response)(InfixExpression(SimpleName:total)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:2))))))))))(ExpressionStatement(Assignment(SimpleName:response)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:copyOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:response)(SimpleName:total))))))(Block(IfStatement(InfixExpression(SimpleName:in)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioe))(Block(ThrowStatement(SimpleName:ioe)))))))(IfStatement(InfixExpression(SimpleName:out)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioe))(Block(ThrowStatement(SimpleName:ioe)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:OCSPResponse))(VariableDeclarationFragment(SimpleName:ocspResponse)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:ocspResponse)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:OCSPResponse))(SimpleName:response)(SimpleName:date)(SimpleName:responderCert)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioe))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CertPathValidatorException))(SimpleName:ioe))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ocspResponse))(SimpleName:getResponseStatus))(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:ResponseStatus.SUCCESSFUL))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CertPathValidatorException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ocspResponse))(SimpleName:getResponseStatus)))))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:CertId))(SimpleName:certId))(SimpleName:certIds)(Block(VariableDeclarationStatement(SimpleType(SimpleName:SingleResponse))(VariableDeclarationFragment(SimpleName:sr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ocspResponse))(SimpleName:getSingleResponse)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certId)))))(IfStatement(InfixExpression(SimpleName:sr)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(IfStatement(InfixExpression(SimpleName:debug)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:debug))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:certId)))))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CertPathValidatorException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))))(IfStatement(InfixExpression(SimpleName:debug)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:debug))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certId))(SimpleName:getSerialNumber))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sr))(SimpleName:getCertStatus))))))))))(ReturnStatement(SimpleName:ocspResponse))))))