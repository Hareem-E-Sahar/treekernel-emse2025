(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:String))(SimpleName:handlePutRequestWithResponse)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:File))(SimpleName:fileForUpload))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:InetSocketAddress))(SimpleName:serverAddr))(SimpleType(SimpleName:FileNotFoundException))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(Modifier:final)(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:fileLength)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileForUpload))(SimpleName:length))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:ByteBuffer))(VariableDeclarationFragment(SimpleName:requestBuffer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:allocate)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(CastExpression(PrimitiveType:int)(SimpleName:fileLength))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1024))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:requestHeader)(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>)(StringLiteral:<STR>)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:fileLength)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestBuffer))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestHeader))(SimpleName:getBytes)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:ByteBuffer))(VariableDeclarationFragment(SimpleName:responseBuffer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:allocate)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1024)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:FileInputStream))(VariableDeclarationFragment(SimpleName:streamFromFile)(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(SimpleName:fileForUpload))))(TryStatement(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:FileChannel))(VariableDeclarationFragment(SimpleName:chanFromFile)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:streamFromFile))(SimpleName:getChannel))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chanFromFile))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:requestBuffer))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:SocketChannel))(VariableDeclarationFragment(SimpleName:chanToServer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SocketChannel))(SimpleName:open)(METHOD_INVOCATION_ARGUMENTS(SimpleName:serverAddr)))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chanToServer))(SimpleName:configureBlocking)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Selector))(VariableDeclarationFragment(SimpleName:sel)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Selector))(SimpleName:open))))(TryStatement(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:SelectionKey))(VariableDeclarationFragment(SimpleName:readyForWrite)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chanToServer))(SimpleName:register)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sel)(QualifiedName:SelectionKey.OP_WRITE)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:SelectionKey))(VariableDeclarationFragment(SimpleName:readyForRead)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chanToServer))(SimpleName:register)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sel)(QualifiedName:SelectionKey.OP_READ)))))(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:finished)(BooleanLiteral:false)))(WhileStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:finished))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sel))(SimpleName:select)))(VariableDeclarationStatement(Modifier:final)(ParameterizedType(SimpleType(SimpleName:Iterator))(SimpleType(SimpleName:SelectionKey)))(VariableDeclarationFragment(SimpleName:availableOperations)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sel))(SimpleName:selectedKeys)))(SimpleName:iterator))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:availableOperations))(SimpleName:hasNext))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:SelectionKey))(VariableDeclarationFragment(SimpleName:op)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:availableOperations))(SimpleName:next))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:availableOperations))(SimpleName:remove)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:op))(SimpleName:isValid)))(Block(ContinueStatement)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:op))(SimpleName:isWritable))(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(SimpleName:nioHandleWrite)(METHOD_INVOCATION_ARGUMENTS(SimpleName:op)(SimpleName:requestBuffer))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:readyForWrite))(SimpleName:cancel))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:op))(SimpleName:isReadable))(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(SimpleName:nioHandleRead)(METHOD_INVOCATION_ARGUMENTS(SimpleName:op)(SimpleName:responseBuffer))))(Block(ExpressionStatement(Assignment(SimpleName:finished)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(BreakStatement)))))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:readyForRead))(SimpleName:cancel)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:readyForWrite))(SimpleName:cancel)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chanToServer))(SimpleName:close))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sel))(SimpleName:close))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chanToServer))(SimpleName:close))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chanFromFile))(SimpleName:close))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:streamFromFile))(SimpleName:close)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:responseBuffer))(SimpleName:hasArray)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Assert))(SimpleName:fail)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:responseBuffer))(SimpleName:array)))(SimpleName:toString)))))))