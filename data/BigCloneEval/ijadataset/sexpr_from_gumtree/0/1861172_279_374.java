(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(PrimitiveType:boolean)(SimpleName:createCertificate)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:commonName))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:validityDays))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:exportFile))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:exportPassword))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:exportAlias))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:InvalidKeyException))(SimpleType(SimpleName:SecurityException))(SimpleType(SimpleName:SignatureException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:DataLengthException))(SimpleType(SimpleName:CryptoException))(SimpleType(SimpleName:KeyStoreException))(SimpleType(SimpleName:CertificateException))(SimpleType(SimpleName:InvalidKeySpecException))(Block(IfStatement(InfixExpression(InfixExpression(InfixExpression(InfixExpression(SimpleName:commonName)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:exportFile)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:exportPassword)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:validityDays)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:1)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalArgumentException))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:commonName)(StringLiteral:<STR>)(SimpleName:validityDays)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:SecureRandom))(VariableDeclarationFragment(SimpleName:sr)(ClassInstanceCreation(SimpleType(SimpleName:SecureRandom)))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:pubKey)))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:privKey)))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPrivateCrtKeyParameters))(VariableDeclarationFragment(SimpleName:privateKey)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAKeyPairGenerator))(VariableDeclarationFragment(SimpleName:gen)(ClassInstanceCreation(SimpleType(SimpleName:RSAKeyPairGenerator)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:RSAKeyGenerationParameters))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BigInteger))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0x10001)))(SimpleName:sr)(NumberLiteral:1024)(NumberLiteral:80)))))(VariableDeclarationStatement(SimpleType(SimpleName:AsymmetricCipherKeyPair))(VariableDeclarationFragment(SimpleName:keypair)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:generateKeyPair))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAKeyParameters))(VariableDeclarationFragment(SimpleName:publicKey)(CastExpression(SimpleType(SimpleName:RSAKeyParameters))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypair))(SimpleName:getPublic)))))(ExpressionStatement(Assignment(SimpleName:privateKey)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:RSAPrivateCrtKeyParameters))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypair))(SimpleName:getPrivate)))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPublicKeyStructure))(VariableDeclarationFragment(SimpleName:pkStruct)(ClassInstanceCreation(SimpleType(SimpleName:RSAPublicKeyStructure))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getModulus))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getExponent)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Hex))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkStruct))(SimpleName:getEncoded)))))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getExponent))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getModulus))))))(ExpressionStatement(Assignment(SimpleName:pubKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:generatePublic)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:RSAPublicKeySpec))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getModulus))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getExponent)))))))(ExpressionStatement(Assignment(SimpleName:privKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:generatePrivate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:RSAPrivateCrtKeySpec))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getModulus))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getExponent))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateKey))(SimpleName:getExponent))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateKey))(SimpleName:getP))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateKey))(SimpleName:getQ))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateKey))(SimpleName:getDP))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateKey))(SimpleName:getDQ))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateKey))(SimpleName:getQInv)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Calendar))(VariableDeclarationFragment(SimpleName:expiry)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Calendar))(SimpleName:getInstance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:expiry))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Calendar.DAY_OF_YEAR)(SimpleName:validityDays))))(VariableDeclarationStatement(SimpleType(SimpleName:X500Name))(VariableDeclarationFragment(SimpleName:x509Name)(ClassInstanceCreation(SimpleType(SimpleName:X500Name))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:commonName)))))(VariableDeclarationStatement(SimpleType(SimpleName:V3TBSCertificateGenerator))(VariableDeclarationFragment(SimpleName:certGen)(ClassInstanceCreation(SimpleType(SimpleName:V3TBSCertificateGenerator)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:setSerialNumber)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERInteger))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BigInteger))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))))))(IfStatement(InfixExpression(SimpleName:caCert)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:setIssuer)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PrincipalUtil))(SimpleName:getSubjectX509Principal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:caCert)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:setIssuer)(METHOD_INVOCATION_ARGUMENTS(SimpleName:x509Name))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:setSubject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:x509Name))))(VariableDeclarationStatement(SimpleType(SimpleName:DERObjectIdentifier))(VariableDeclarationFragment(SimpleName:sigOID)(QualifiedName:PKCSObjectIdentifiers.sha1WithRSAEncryption)))(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmIdentifier))(VariableDeclarationFragment(SimpleName:sigAlgId)(ClassInstanceCreation(SimpleType(SimpleName:AlgorithmIdentifier))(SimpleName:sigOID)(ClassInstanceCreation(SimpleType(SimpleName:DERNull))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:setSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sigAlgId))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:setSubjectPublicKeyInfo)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:SubjectPublicKeyInfo))(CastExpression(SimpleType(SimpleName:ASN1Sequence))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:ASN1InputStream))(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKey))(SimpleName:getEncoded)))))(SimpleName:readObject)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:setStartDate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Time))(ClassInstanceCreation(SimpleType(SimpleName:Date))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:setEndDate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Time))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:expiry))(SimpleName:getTime))))))(VariableDeclarationStatement(SimpleType(SimpleName:Hashtable))(VariableDeclarationFragment(SimpleName:extensions)(ClassInstanceCreation(SimpleType(SimpleName:Hashtable)))))(VariableDeclarationStatement(SimpleType(SimpleName:Vector))(VariableDeclarationFragment(SimpleName:extOrdering)(ClassInstanceCreation(SimpleType(SimpleName:Vector)))))(ExpressionStatement(MethodInvocation(SimpleName:addExtensionHelper)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Extension.subjectKeyIdentifier)(BooleanLiteral:false)(ClassInstanceCreation(SimpleType(SimpleName:SubjectKeyIdentifierStructure))(SimpleName:pubKey))(SimpleName:extOrdering)(SimpleName:extensions))))(IfStatement(InfixExpression(SimpleName:caCert)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(SimpleName:addExtensionHelper)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Extension.authorityKeyIdentifier)(BooleanLiteral:false)(ClassInstanceCreation(SimpleType(SimpleName:AuthorityKeyIdentifierStructure))(SimpleName:caCert))(SimpleName:extOrdering)(SimpleName:extensions)))))(Block(ExpressionStatement(MethodInvocation(SimpleName:addExtensionHelper)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Extension.basicConstraints)(BooleanLiteral:true)(ClassInstanceCreation(SimpleType(SimpleName:BasicConstraints))(NumberLiteral:0))(SimpleName:extOrdering)(SimpleName:extensions))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:setExtensions)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:X509Extensions))(SimpleName:extOrdering)(SimpleName:extensions)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:SHA1Digest))(VariableDeclarationFragment(SimpleName:digester)(ClassInstanceCreation(SimpleType(SimpleName:SHA1Digest)))))(VariableDeclarationStatement(SimpleType(SimpleName:AsymmetricBlockCipher))(VariableDeclarationFragment(SimpleName:rsa)(ClassInstanceCreation(SimpleType(SimpleName:PKCS1Encoding))(ClassInstanceCreation(SimpleType(SimpleName:RSAEngine))))))(VariableDeclarationStatement(SimpleType(SimpleName:TBSCertificateStructure))(VariableDeclarationFragment(SimpleName:tbsCert)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGen))(SimpleName:generateTBSCertificate))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bOut)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:DEROutputStream))(VariableDeclarationFragment(SimpleName:dOut)(ClassInstanceCreation(SimpleType(SimpleName:DEROutputStream))(SimpleName:bOut))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dOut))(SimpleName:writeObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tbsCert))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:signature)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:certBlock)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bOut))(SimpleName:toByteArray))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Hex))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certBlock))))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digester))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certBlock)(NumberLiteral:0)(QualifiedName:certBlock.length))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hash)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digester))(SimpleName:getDigestSize)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digester))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(NumberLiteral:0))))(IfStatement(InfixExpression(SimpleName:caCert)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsa))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true)(SimpleName:caPrivateKey)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsa))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true)(SimpleName:privateKey))))))(VariableDeclarationStatement(SimpleType(SimpleName:DigestInfo))(VariableDeclarationFragment(SimpleName:dInfo)(ClassInstanceCreation(SimpleType(SimpleName:DigestInfo))(ClassInstanceCreation(SimpleType(SimpleName:AlgorithmIdentifier))(QualifiedName:X509ObjectIdentifiers.id_SHA1)(NullLiteral))(SimpleName:hash))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dInfo))(SimpleName:getEncoded)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ASN1Encodable.DER)))))(ExpressionStatement(Assignment(SimpleName:signature)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsa))(SimpleName:processBlock)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest)(NumberLiteral:0)(QualifiedName:digest.length)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Hex))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signature))))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:v)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tbsCert))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sigAlgId))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERBitString))(SimpleName:signature)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509CertificateObject))(VariableDeclarationFragment(SimpleName:clientCert)(ClassInstanceCreation(SimpleType(SimpleName:X509CertificateObject))(ClassInstanceCreation(SimpleType(SimpleName:X509CertificateStructure))(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:v))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:PKCS12BagAttributeCarrier))(VariableDeclarationFragment(SimpleName:bagCert)(SimpleName:clientCert)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bagCert))(SimpleName:setBagAttribute)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PKCSObjectIdentifiers.pkcs_9_at_friendlyName)(ClassInstanceCreation(SimpleType(SimpleName:DERBMPString))(ConditionalExpression(InfixExpression(SimpleName:exportAlias)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(SimpleName:CertificateExportFriendlyName)(SimpleName:exportAlias))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bagCert))(SimpleName:setBagAttribute)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PKCSObjectIdentifiers.pkcs_9_at_localKeyId)(ClassInstanceCreation(SimpleType(SimpleName:SubjectKeyIdentifierStructure))(SimpleName:pubKey)))))(VariableDeclarationStatement(SimpleType(SimpleName:JDKPKCS12KeyStore))(VariableDeclarationFragment(SimpleName:store)))(ExpressionStatement(Assignment(SimpleName:store)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(QualifiedName:JDKPKCS12KeyStore.BCPKCS12KeyStore)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:store))(SimpleName:engineLoad)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:fOut)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:exportFile))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:chain)))(IfStatement(InfixExpression(SimpleName:caCert)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:chain)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension(NumberLiteral:2))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:chain)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(SimpleName:clientCert)))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:chain)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(SimpleName:caCert))))(Block(ExpressionStatement(Assignment(SimpleName:chain)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension(NumberLiteral:1))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:chain)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(SimpleName:clientCert)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:store))(SimpleName:engineSetKeyEntry)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(SimpleName:exportAlias)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(SimpleName:KeyExportFriendlyName)(SimpleName:exportAlias))(SimpleName:privKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exportPassword))(SimpleName:toCharArray))(SimpleName:chain))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:store))(SimpleName:engineStore)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fOut)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exportPassword))(SimpleName:toCharArray)))))(ReturnStatement(BooleanLiteral:true))))))