(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(SimpleType(SimpleName:Protocol))(SimpleName:negotiateProtocol)(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Protocol))(VariableDeclarationFragment(SimpleName:defaultProtocol)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Protocol))(SimpleName:getProtocol)(METHOD_INVOCATION_ARGUMENTS(SimpleName:repNode)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:defaultProtocol))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleName:defaultProtocol)(SimpleType(SimpleName:ReplicaProtocolVersion)))(SimpleName:namedChannel))))(VariableDeclarationStatement(SimpleType(SimpleName:Message))(VariableDeclarationFragment(SimpleName:message)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:defaultProtocol))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:namedChannel)))))(IfStatement(InstanceofExpression(SimpleName:message)(SimpleType(SimpleName:DuplicateNodeReject)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EnvironmentFailureException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:repNode))(SimpleName:getRepImpl))(QualifiedName:EnvironmentFailureReason.HANDSHAKE_ERROR)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:replicaNameIdPair)(StringLiteral:<STR>)(SimpleName:feederNameIdPair))))))(VariableDeclarationStatement(SimpleType(SimpleName:FeederProtocolVersion))(VariableDeclarationFragment(SimpleName:feederVersion)(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:FeederProtocolVersion))(SimpleName:message)))))(ExpressionStatement(Assignment(SimpleName:feederNameIdPair)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:feederVersion))(SimpleName:getNameIdPair))))(VariableDeclarationStatement(SimpleType(SimpleName:Protocol))(VariableDeclarationFragment(SimpleName:configuredProtocol)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Protocol))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:repNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:feederVersion))(SimpleName:getVersion))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LoggerUtils))(SimpleName:fine)(METHOD_INVOCATION_ARGUMENTS(SimpleName:logger)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:repNode))(SimpleName:getRepImpl))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:feederVersion))(SimpleName:getNameIdPair))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:feederVersion))(SimpleName:getVersion))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:namedChannel))(SimpleName:setNameIdPair)(METHOD_INVOCATION_ARGUMENTS(SimpleName:feederNameIdPair))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LoggerUtils))(SimpleName:fine)(METHOD_INVOCATION_ARGUMENTS(SimpleName:logger)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:repNode))(SimpleName:getRepImpl))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:feederNameIdPair)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:namedChannel))(SimpleName:getChannel))))))(IfStatement(InfixExpression(SimpleName:configuredProtocol)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EnvironmentFailureException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:repNode))(SimpleName:getRepImpl))(QualifiedName:EnvironmentFailureReason.PROTOCOL_VERSION_MISMATCH)(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:feederVersion))(SimpleName:getVersion))(StringLiteral:<STR>)(SimpleName:feederNameIdPair)(StringLiteral:<STR>)(SimpleName:replicaNameIdPair)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:defaultProtocol))(SimpleName:getVersion)))))))(ReturnStatement(SimpleName:configuredProtocol))))))