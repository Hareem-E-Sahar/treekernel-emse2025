(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:Difference)))(SimpleName:getChanges)(SingleVariableDeclaration(SimpleType(QualifiedName:Diff.change))(SimpleName:script))(SingleVariableDeclaration(SimpleType(SimpleName:DocumentImpl))(SimpleName:docA))(SingleVariableDeclaration(SimpleType(SimpleName:DocumentImpl))(SimpleName:docB))(SingleVariableDeclaration(ArrayType(SimpleType(SimpleName:DiffNode))(Dimension))(SimpleName:nodesA))(SingleVariableDeclaration(ArrayType(SimpleType(SimpleName:DiffNode))(Dimension))(SimpleName:nodesB))(SimpleType(SimpleName:XMLStreamException))(Block(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:Difference)))(VariableDeclarationFragment(SimpleName:changes)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Difference))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:NodeId))(SimpleType(SimpleName:Difference)))(VariableDeclarationFragment(SimpleName:inserts)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:TreeMap))(SimpleType(SimpleName:NodeId))(SimpleType(SimpleName:Difference))))))(VariableDeclarationStatement(SimpleType(QualifiedName:Diff.change))(VariableDeclarationFragment(SimpleName:next)(SimpleName:script)))(WhileStatement(InfixExpression(SimpleName:next)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:start0)(QualifiedName:next.line0)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:start)(QualifiedName:next.line1)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:last)(InfixExpression(SimpleName:start)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:next.inserted))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:lastDeleted)(InfixExpression(SimpleName:start0)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:next.deleted))))(IfStatement(InfixExpression(QualifiedName:next.inserted)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(IfStatement(InfixExpression(QualifiedName:next.deleted)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:offsetFix)(NumberLiteral:0)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(InfixExpression(SimpleName:last)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:>)(SimpleName:start))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:--))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DiffNode))(VariableDeclarationFragment(SimpleName:node)(ArrayAccess(SimpleName:nodesB)(SimpleName:i))))(IfStatement(InfixExpression(InfixExpression(QualifiedName:node.nodeType)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:XMLStreamReader.START_ELEMENT))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(InfixExpression(SimpleName:start)(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(SimpleName:last)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:i))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DiffNode))(VariableDeclarationFragment(SimpleName:before)(ArrayAccess(SimpleName:nodesB)(InfixExpression(SimpleName:start)(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(SimpleName:last)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:i)))))))(IfStatement(InfixExpression(InfixExpression(QualifiedName:before.nodeType)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:XMLStreamReader.START_ELEMENT))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:before.qname))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:node.qname))))(ExpressionStatement(PostfixExpression(SimpleName:offsetFix)(POSTFIX_EXPRESSION_OPERATOR:++)))))(BreakStatement))))(IfStatement(InfixExpression(SimpleName:offsetFix)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:start)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:start)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:offsetFix))))(ExpressionStatement(Assignment(SimpleName:start0)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:start0)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:offsetFix))))(ExpressionStatement(Assignment(SimpleName:last)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:start)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:next.inserted))))))))(VariableDeclarationStatement(SimpleType(QualifiedName:Difference.Insert))(VariableDeclarationFragment(SimpleName:diff)))(IfStatement(InfixExpression(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:start0))(SimpleName:nodeType))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:XMLStreamReader.END_ELEMENT))(Block(ExpressionStatement(Assignment(SimpleName:diff)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(QualifiedName:Difference.Append))(ClassInstanceCreation(SimpleType(SimpleName:NodeProxy))(SimpleName:docA)(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:start0))(SimpleName:nodeId)))(SimpleName:docB))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:changes))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:diff)))))(Block(ExpressionStatement(Assignment(SimpleName:diff)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(QualifiedName:Difference.Insert))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inserts))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:start0))(SimpleName:nodeId)))))))(IfStatement(InfixExpression(SimpleName:diff)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:diff)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(QualifiedName:Difference.Insert))(ClassInstanceCreation(SimpleType(SimpleName:NodeProxy))(SimpleName:docA)(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:start0))(SimpleName:nodeId)))(SimpleName:docB))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inserts))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:start0))(SimpleName:nodeId))(SimpleName:diff))))))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:DiffNode))(Dimension))(VariableDeclarationFragment(SimpleName:nodes)(ArrayCreation(ArrayType(SimpleType(SimpleName:DiffNode))(Dimension(InfixExpression(SimpleName:last)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:start)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:j)(NumberLiteral:0)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(SimpleName:start)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:last))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(PostfixExpression(SimpleName:j)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:isTraceEnabled))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Integer))(SimpleName:toString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i)))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(ArrayAccess(SimpleName:nodesB)(SimpleName:i)))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:nodes)(SimpleName:j))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:nodesB)(SimpleName:i))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:diff))(SimpleName:addNodes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:nodes))))))(IfStatement(InfixExpression(QualifiedName:next.deleted)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DiffNode))(VariableDeclarationFragment(SimpleName:beforeElement)(ArrayAccess(SimpleName:nodesA)(InfixExpression(SimpleName:start0)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(VariableDeclarationStatement(SimpleType(SimpleName:DiffNode))(VariableDeclarationFragment(SimpleName:lastElement)(ArrayAccess(SimpleName:nodesA)(InfixExpression(SimpleName:lastDeleted)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(IfStatement(InfixExpression(InfixExpression(InfixExpression(InfixExpression(InfixExpression(QualifiedName:beforeElement.qname)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(QualifiedName:lastElement.qname)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:beforeElement.qname))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:lastElement.qname))))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(QualifiedName:beforeElement.nodeType)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:XMLStreamReader.START_ELEMENT)))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(QualifiedName:lastElement.nodeType)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:XMLStreamReader.START_ELEMENT)))(Block(ExpressionStatement(PostfixExpression(SimpleName:start0)(POSTFIX_EXPRESSION_OPERATOR:--)))(ExpressionStatement(PostfixExpression(SimpleName:lastDeleted)(POSTFIX_EXPRESSION_OPERATOR:--)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:isTraceEnabled))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:start0)(StringLiteral:<STR>)(SimpleName:lastDeleted))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(SimpleName:start0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:lastDeleted))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:elementDeleted)(BooleanLiteral:false)))(IfStatement(InfixExpression(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:i))(SimpleName:nodeType))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:XMLStreamReader.START_ELEMENT))(Block(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:j)(SimpleName:i)))(InfixExpression(SimpleName:j)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:lastDeleted))(PostfixExpression(SimpleName:j)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(InfixExpression(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:j))(SimpleName:nodeType))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:XMLStreamReader.END_ELEMENT))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:j))(SimpleName:nodeId)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:i))(SimpleName:nodeId)))))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:Difference.Delete))(VariableDeclarationFragment(SimpleName:diff)(ClassInstanceCreation(SimpleType(QualifiedName:Difference.Delete))(ClassInstanceCreation(SimpleType(SimpleName:NodeProxy))(SimpleName:docA)(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:i))(SimpleName:nodeId))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:changes))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:diff))))(ExpressionStatement(Assignment(SimpleName:i)(ASSIGNMENT_OPERATOR:=)(SimpleName:j)))(ExpressionStatement(Assignment(SimpleName:elementDeleted)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(BreakStatement)))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:elementDeleted))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:Difference.Delete))(VariableDeclarationFragment(SimpleName:diff)(ClassInstanceCreation(SimpleType(QualifiedName:Difference.Delete))(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:i))(SimpleName:nodeType))(ClassInstanceCreation(SimpleType(SimpleName:NodeProxy))(SimpleName:docA)(FieldAccess(ArrayAccess(SimpleName:nodesA)(SimpleName:i))(SimpleName:nodeId))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:changes))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:diff))))))))))(ExpressionStatement(Assignment(SimpleName:next)(ASSIGNMENT_OPERATOR:=)(QualifiedName:next.link)))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Difference))(SimpleName:diff))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inserts))(SimpleName:values))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:changes))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:diff))))))(ReturnStatement(SimpleName:changes))))))