(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(PrimitiveType:void)(SimpleName:service)(SingleVariableDeclaration(SimpleType(SimpleName:HttpServletRequest))(SimpleName:request))(SingleVariableDeclaration(SimpleType(SimpleName:HttpServletResponse))(SimpleName:response))(SimpleType(SimpleName:ServletException))(SimpleType(SimpleName:IOException))(Block(IfStatement(InfixExpression(QualifiedName:Config.CONTEXT)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:404)(StringLiteral:<STR>))))(ReturnStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:f)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:PREVIEW_MODE)(BooleanLiteral:false)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:EDIT_MODE)(BooleanLiteral:false)))(VariableDeclarationStatement(SimpleType(SimpleName:HttpSession))(VariableDeclarationFragment(SimpleName:session)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getSession)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false)))))(IfStatement(InfixExpression(SimpleName:session)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:PREVIEW_MODE)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getAttribute)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:com.dotmarketing.util.WebKeys.PREVIEW_MODE_SESSION)))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))))))(ExpressionStatement(Assignment(SimpleName:EDIT_MODE)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getAttribute)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:com.dotmarketing.util.WebKeys.EDIT_MODE_SESSION)))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))))))))(VariableDeclarationStatement(SimpleType(SimpleName:User))(VariableDeclarationFragment(SimpleName:user)(NullLiteral)))(TryStatement(Block(IfStatement(InfixExpression(SimpleName:session)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(Assignment(SimpleName:user)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(QualifiedName:com.liferay.portal.model.User))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getAttribute)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:com.dotmarketing.util.WebKeys.CMS_USER))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:nsue))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nsue))(SimpleName:getMessage)))(SimpleName:nsue)))))))(TryStatement(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:StringTokenizer))(VariableDeclarationFragment(SimpleName:_st)(ClassInstanceCreation(SimpleType(SimpleName:StringTokenizer))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRequestURI))(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRequestURI))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:_fileName)(NullLiteral)))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_st))(SimpleName:hasMoreElements))(Block(ExpressionStatement(Assignment(SimpleName:_fileName)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_st))(SimpleName:nextToken))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:_fileName)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:identifier)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UtilMethods))(SimpleName:getFileName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:_fileName)))))(VariableDeclarationStatement(SimpleType(SimpleName:Identifier))(VariableDeclarationFragment(SimpleName:ident)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:SpeedyAssetServlet)))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:identifier)))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:ident)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IdentifierCache))(SimpleName:getIdentifierFromIdentifierCache)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Long))(SimpleName:identifier)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:SpeedyAssetServlet)))(StringLiteral:<STR>)(SimpleName:ex)))))))(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:ident)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ident))(SimpleName:getURI))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ident))(SimpleName:getURI)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(Block(IfStatement(InfixExpression(SimpleName:PREVIEW_MODE)(INFIX_EXPRESSION_OPERATOR:||)(SimpleName:EDIT_MODE))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:uri)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:WorkingCache))(SimpleName:getPathFromCache)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ident))(SimpleName:getURI))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ident))(SimpleName:getHostInode))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UtilMethods))(SimpleName:isSet)(METHOD_INVOCATION_ARGUMENTS(SimpleName:realPath))))(Block(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:Config.CONTEXT))(SimpleName:getRealPath)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:assetPath)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri))))))))(Block(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(InfixExpression(SimpleName:realPath)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri)))))))(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:uri)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:exists))))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:canRead))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:404))))(ReturnStatement))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:uri)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LiveCache))(SimpleName:getPathFromCache)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ident))(SimpleName:getURI))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ident))(SimpleName:getHostInode))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UtilMethods))(SimpleName:isSet)(METHOD_INVOCATION_ARGUMENTS(SimpleName:realPath))))(Block(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:Config.CONTEXT))(SimpleName:getRealPath)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:assetPath)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri))))))))(Block(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(InfixExpression(SimpleName:realPath)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uri)))))))(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:uri)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:exists))))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:canRead))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:404))))(ReturnStatement))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRequestURI))))))(ReturnStatement))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:relativePath)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileFactory))(SimpleName:getRealAssetsRootPath))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:relativePath)))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:exists)))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:canRead))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:relativePath)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:404))))(ReturnStatement)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:inode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UtilMethods))(SimpleName:getFileName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getName))))))(VariableDeclarationStatement(SimpleType(QualifiedName:com.dotmarketing.portlets.files.model.File))(VariableDeclarationFragment(SimpleName:file)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileCache))(SimpleName:getFileByInode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inode)))))(VariableDeclarationStatement(SimpleType(SimpleName:Identifier))(VariableDeclarationFragment(SimpleName:identifier)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IdentifierCache))(SimpleName:getIdentifierFromIdentifierCache)(METHOD_INVOCATION_ARGUMENTS(SimpleName:file)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:mimeType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileFactory))(SimpleName:getMimeType)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:getName))))))(IfStatement(InfixExpression(SimpleName:mimeType)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(Assignment(SimpleName:mimeType)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setContentType)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mimeType))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:permissionAPI))(SimpleName:doesUserHavePermission)(METHOD_INVOCATION_ARGUMENTS(SimpleName:identifier)(SimpleName:PERMISSION_READ)(SimpleName:user))))(Block(IfStatement(InfixExpression(SimpleName:user)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:401)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:403)(StringLiteral:<STR>)))))(ReturnStatement)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:file))(SimpleName:getFileName))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:url)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRequestURL)))(SimpleName:toString))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:filename)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:lastIndexOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:length))))))(ExpressionStatement(Assignment(SimpleName:filename)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:file))(SimpleName:getFileName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:filename))))))(Block(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:_adminMode)(BooleanLiteral:false)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:_adminMode)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getSession)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false))))(SimpleName:getAttribute)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:com.dotmarketing.util.WebKeys.ADMIN_MODE_SESSION)))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:_adminMode))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:_daysCache)(NumberLiteral:30)))(VariableDeclarationStatement(SimpleType(SimpleName:GregorianCalendar))(VariableDeclarationFragment(SimpleName:expiration)(ClassInstanceCreation(SimpleType(SimpleName:GregorianCalendar)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:expiration))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:java.util.Calendar.DAY_OF_MONTH)(SimpleName:_daysCache))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:seconds)(ParenthesizedExpression(InfixExpression(SimpleName:_daysCache)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:24)(NumberLiteral:60)(NumberLiteral:60)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:_lastModified)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:lastModified))))(IfStatement(InfixExpression(SimpleName:_lastModified)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(ExpressionStatement(Assignment(SimpleName:_lastModified)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0))))(ExpressionStatement(Assignment(SimpleName:_lastModified)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:_lastModified)(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:1000))))(ExpressionStatement(Assignment(SimpleName:_lastModified)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:_lastModified)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:1000))))(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:_lastModifiedDate)(ClassInstanceCreation(SimpleType(QualifiedName:java.util.Date))(SimpleName:_lastModified))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:_fileLength)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:length))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:_eTag)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:inode)(StringLiteral:<STR>)(SimpleName:_lastModified)(StringLiteral:<STR>)(SimpleName:_fileLength))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpDate))(SimpleName:format)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:expiration))(SimpleName:getTime)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:seconds)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ifModifiedSince)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ifNoneMatch)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:ifNoneMatch)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_eTag))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ifNoneMatch)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ifNoneMatch))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setStatus)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpServletResponse.SC_NOT_MODIFIED))))(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ReturnStatement)))))(IfStatement(InfixExpression(SimpleName:ifModifiedSince)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:ifModifiedSinceDate)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpDate))(SimpleName:parse)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ifModifiedSince)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_lastModifiedDate))(SimpleName:getTime))(INFIX_EXPRESSION_OPERATOR:<=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ifModifiedSinceDate))(SimpleName:getTime)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setStatus)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpServletResponse.SC_NOT_MODIFIED))))(ExpressionStatement(Assignment(SimpleName:f)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ReturnStatement))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpDate))(SimpleName:format)(METHOD_INVOCATION_ARGUMENTS(SimpleName:_lastModifiedDate))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:_fileLength))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:_eTag)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:GregorianCalendar))(VariableDeclarationFragment(SimpleName:expiration)(ClassInstanceCreation(SimpleType(SimpleName:GregorianCalendar)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:expiration))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:java.util.Calendar.MONTH)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpDate))(SimpleName:format)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:expiration))(SimpleName:getTime)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))))))(VariableDeclarationStatement(SimpleType(SimpleName:ServletOutputStream))(VariableDeclarationFragment(SimpleName:out)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:FileChannel))(VariableDeclarationFragment(SimpleName:from)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteBuffer))(VariableDeclarationFragment(SimpleName:bb)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream))))(ExpressionStatement(Assignment(SimpleName:from)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(SimpleName:f)))(SimpleName:getChannel))))(ExpressionStatement(Assignment(SimpleName:bb)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:allocateDirect)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:10)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:numRead)(NumberLiteral:0)))(WhileStatement(InfixExpression(SimpleName:numRead)(INFIX_EXPRESSION_OPERATOR:>=)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bb))(SimpleName:rewind)))(ExpressionStatement(Assignment(SimpleName:numRead)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:from))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bb)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bb))(SimpleName:rewind)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:numRead))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bb))(SimpleName:get))))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRequestURI))(ParenthesizedExpression(ConditionalExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getQueryString))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getQueryString)))(StringLiteral:<STR>))))(SimpleName:e))))))(Block(IfStatement(InfixExpression(SimpleName:bb)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bb))(SimpleName:clear))))(IfStatement(InfixExpression(SimpleName:from)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:from))(SimpleName:close))))(IfStatement(InfixExpression(SimpleName:out)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:close)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRequestURI))(ParenthesizedExpression(ConditionalExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getQueryString))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getQueryString)))(StringLiteral:<STR>))))(SimpleName:e)))))))))))