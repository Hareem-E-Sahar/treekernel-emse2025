(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:OutputStream))(SimpleName:getEncryptedStream)(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:outputStream))(SingleVariableDeclaration(ArrayType(PrimitiveType:char)(Dimension))(SimpleName:password))(SimpleType(SimpleName:CipherException))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:os)(ClassInstanceCreation(SimpleType(SimpleName:BufferedOutputStream))(SimpleName:outputStream))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getHeader)))))(IfStatement(MethodInvocation(SimpleName:isSaveDate))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteFunctions))(SimpleName:longToByte)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:Date))))(SimpleName:getTime))))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:salt)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:saltLength))))))(IfStatement(InfixExpression(SimpleName:password)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:fill)(METHOD_INVOCATION_ARGUMENTS(SimpleName:salt)(CastExpression(PrimitiveType:byte)(CharacterLiteral:<STR>))))))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:SecureRandom))(VariableDeclarationFragment(SimpleName:secureRandom)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecureRandom))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:secureRandomAlgorithm)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secureRandom))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:salt)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:nsae))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CipherException))(SimpleName:nsae))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:salt))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:cipher)))(IfStatement(InfixExpression(SimpleName:password)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:cipher)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:NullCipher))))))(Block(TryStatement(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:passwordKey)(MethodInvocation(SimpleName:getKeyFromPassword)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)(SimpleName:salt)(SimpleName:keyLength)))))(VariableDeclarationStatement(SimpleType(SimpleName:SecretKeySpec))(VariableDeclarationFragment(SimpleName:key)(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(SimpleName:passwordKey)(SimpleName:keyAlgorithm))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ivSpecKey)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:ivSpecLength))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:passwordKey)(NumberLiteral:0)(SimpleName:ivSpecKey)(NumberLiteral:0)(QualifiedName:ivSpecKey.length))))(VariableDeclarationStatement(SimpleType(SimpleName:IvParameterSpec))(VariableDeclarationFragment(SimpleName:ivSpec)(ClassInstanceCreation(SimpleType(SimpleName:IvParameterSpec))(SimpleName:ivSpecKey))))(ExpressionStatement(Assignment(SimpleName:cipher)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipherAlgorithm)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:key)(SimpleName:ivSpec)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CipherException))(SimpleName:e))))))))(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:cos)))(IfStatement(MethodInvocation(SimpleName:isCompressData))(ExpressionStatement(Assignment(SimpleName:cos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:GZIPOutputStream))(ClassInstanceCreation(SimpleType(SimpleName:CipherOutputStream))(SimpleName:os)(SimpleName:cipher)))))(ExpressionStatement(Assignment(SimpleName:cos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:CipherOutputStream))(SimpleName:os)(SimpleName:cipher)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cos))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getCanary)))))(ReturnStatement(SimpleName:cos))))))