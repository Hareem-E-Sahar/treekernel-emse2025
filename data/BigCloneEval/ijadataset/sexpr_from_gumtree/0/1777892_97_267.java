(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(SimpleType(SimpleName:String))(SimpleName:issue)(SingleVariableDeclaration(SimpleType(SimpleName:ManagedCard))(SimpleName:card))(SingleVariableDeclaration(SimpleType(SimpleName:Bag))(SimpleName:requestElements))(SingleVariableDeclaration(SimpleType(SimpleName:Locale))(SimpleName:clientLocale))(SingleVariableDeclaration(SimpleType(SimpleName:X509Certificate))(SimpleName:cert))(SingleVariableDeclaration(SimpleType(SimpleName:RSAPrivateKey))(SimpleName:key))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:issuer))(SingleVariableDeclaration(SimpleType(SimpleName:SupportedClaims))(SimpleName:supportedClaimsImpl))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:restrictedTo))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:relyingPartyCertB64))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:messageDigestAlgorithm))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:CryptoException))(SimpleType(SimpleName:TokenIssuanceException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:envelope)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.SOAP_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.SOAP12_NAMESPACE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envelope))(SimpleName:addNamespaceDeclaration)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:WSConstants.WSA_PREFIX)(QualifiedName:WSConstants.WSA_NAMESPACE_05_08))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envelope))(SimpleName:addNamespaceDeclaration)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:WSConstants.WSU_PREFIX)(QualifiedName:WSConstants.WSU_NAMESPACE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envelope))(SimpleName:addNamespaceDeclaration)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:WSConstants.WSSE_PREFIX)(QualifiedName:WSConstants.WSSE_NAMESPACE_OASIS_10))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envelope))(SimpleName:addNamespaceDeclaration)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:WSConstants.TRUST_PREFIX)(QualifiedName:WSConstants.TRUST_NAMESPACE_05_02))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envelope))(SimpleName:addNamespaceDeclaration)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:header)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.SOAP_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.SOAP12_NAMESPACE))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:body)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.SOAP_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.SOAP12_NAMESPACE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envelope))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:header))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envelope))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:body))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:rstr)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.TRUST_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.TRUST_NAMESPACE_05_02))))(VariableDeclarationStatement(SimpleType(SimpleName:Attribute))(VariableDeclarationFragment(SimpleName:context)(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rstr))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:context))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:tokentype)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestElements))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(InfixExpression(SimpleName:tokentype)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:tokentype)(ASSIGNMENT_OPERATOR:=)(QualifiedName:WSConstants.SAML11_NAMESPACE)))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:tokenTypeElt)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.TRUST_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.TRUST_NAMESPACE_05_02))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tokenTypeElt))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tokentype))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rstr))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tokenTypeElt))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:java.util.logging.Level.INFO)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:tokentype)))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:requestType)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.TRUST_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.TRUST_NAMESPACE_05_02))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestType))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rstr))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:requestType))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:rst)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.TRUST_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.TRUST_NAMESPACE_05_02))))(VariableDeclarationStatement(SimpleType(SimpleName:AsymmetricKeyInfo))(VariableDeclarationFragment(SimpleName:keyInfo)(ClassInstanceCreation(SimpleType(SimpleName:AsymmetricKeyInfo))(SimpleName:cert))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signatureAlgorithm)(InfixExpression(SimpleName:messageDigestAlgorithm)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getAlgorithm)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:java.util.logging.Level.INFO)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:signatureAlgorithm)))))(VariableDeclarationStatement(SimpleType(SimpleName:ManagedToken))(VariableDeclarationFragment(SimpleName:token)(ClassInstanceCreation(SimpleType(SimpleName:ManagedToken))(SimpleName:keyInfo)(SimpleName:key)(SimpleName:tokentype)(SimpleName:signatureAlgorithm))))(IfStatement(InfixExpression(SimpleName:restrictedTo)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setRestrictedTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:restrictedTo)(SimpleName:relyingPartyCertB64))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Set))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:cardClaims)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:card))(SimpleName:getClaims))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:claim))(SimpleName:cardClaims)(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:qm)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:claim))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:qm)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:claim)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:requestedClaims)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestElements))(SimpleName:getValues)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:iter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestedClaims))(SimpleName:iterator))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iter))(SimpleName:hasNext))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:requestedXClaim)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iter))(SimpleName:next)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:requestedClaim)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestedXClaim))(SimpleName:replace)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestedClaim))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(SimpleName:claim)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:requestedClaim)(StringLiteral:<STR>)(SimpleName:claim)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setClaim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:claim)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestedClaim))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(SimpleName:qm)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:requestedClaim)(StringLiteral:<STR>)(SimpleName:claim))))))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:requestedClaims)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestElements))(SimpleName:getValues)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:iter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestedClaims))(SimpleName:iterator))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iter))(SimpleName:hasNext))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:requestedClaim)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iter))(SimpleName:next)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:claim))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:requestedClaim)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:value)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:card))(SimpleName:getClaim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:claim)))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:value)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ParenthesizedExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:value))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setClaim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:claim)(SimpleName:value))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:claim)(StringLiteral:<STR>)))))))))))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:keyType)(NullLiteral)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:keyTypes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestElements))(SimpleName:getValues)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:keyTypes)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyTypes))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))))(Block(ExpressionStatement(Assignment(SimpleName:keyType)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyTypes))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))))))(IfStatement(InfixExpression(SimpleName:keyType)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:java.util.logging.Level.INFO)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keyType)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyType)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setConfirmationMethod)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Subject.BEARER)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyType)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:java.util.logging.Level.SEVERE)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keyType)(StringLiteral:<STR>)))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TokenIssuanceException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keyType)(StringLiteral:<STR>)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyType)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:java.util.logging.Level.SEVERE)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keyType)(StringLiteral:<STR>)))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TokenIssuanceException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keyType)(StringLiteral:<STR>)))))(Block))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ppid)(NullLiteral)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:ppids)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestElements))(SimpleName:getValues)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:ppids)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ppids))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))))(Block(ExpressionStatement(Assignment(SimpleName:ppid)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ppids))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))))))(IfStatement(InfixExpression(SimpleName:ppid)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:baos)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cardPPID)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:card))(SimpleName:getPrivatePersonalIdentifier))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cardPPID))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ppid))(SimpleName:getBytes)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CryptoUtils))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:toByteArray))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setPrivatePersonalIdentifier)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cardPPID)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:card))(SimpleName:getPrivatePersonalIdentifier))))(IfStatement(InfixExpression(SimpleName:relyingPartyCertB64)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:baos)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cardPPID))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:relyingPartyCertB64))(SimpleName:getBytes)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CryptoUtils))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:toByteArray))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setPrivatePersonalIdentifier)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest)))))(IfStatement(InfixExpression(SimpleName:restrictedTo)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:baos)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:restrictedTo))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cardPPID))(SimpleName:getBytes)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CryptoUtils))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:toByteArray))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setPrivatePersonalIdentifier)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setPrivatePersonalIdentifier)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cardPPID)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setValidityPeriod)(METHOD_INVOCATION_ARGUMENTS(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:3))(NumberLiteral:10))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:setIssuer)(METHOD_INVOCATION_ARGUMENTS(SimpleName:issuer))))(VariableDeclarationStatement(SimpleType(SimpleName:RandomGUID))(VariableDeclarationFragment(SimpleName:uuid)(ClassInstanceCreation(SimpleType(SimpleName:RandomGUID)))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rst))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:serialize)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uuid)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:SerializationException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rstr))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rst))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:requestedAttachedReference)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.TRUST_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.TRUST_NAMESPACE_05_02))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:securityTokenReference)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.WSSE_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.WSSE_NAMESPACE_OASIS_10))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:keyIdentifier)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.WSSE_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.WSSE_NAMESPACE_OASIS_10))))(VariableDeclarationStatement(SimpleType(SimpleName:Attribute))(VariableDeclarationFragment(SimpleName:valueType)(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyIdentifier))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:valueType))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyIdentifier))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uuid))(SimpleName:toString))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:securityTokenReference))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyIdentifier))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestedAttachedReference))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:securityTokenReference))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rstr))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:requestedAttachedReference))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:requestedUnAttachedReference)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.TRUST_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.TRUST_NAMESPACE_05_02))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:securityTokenReference1)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.WSSE_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.WSSE_NAMESPACE_OASIS_10))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:keyIdentifier1)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.WSSE_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.WSSE_NAMESPACE_OASIS_10))))(VariableDeclarationStatement(SimpleType(SimpleName:Attribute))(VariableDeclarationFragment(SimpleName:valueType1)(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyIdentifier1))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:valueType1))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyIdentifier1))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uuid))(SimpleName:toString))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:securityTokenReference1))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyIdentifier1))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestedUnAttachedReference))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:securityTokenReference1))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rstr))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:requestedUnAttachedReference))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:requestedDisplayToken)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.INFOCARD_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.INFOCARD_NAMESPACE))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:displayToken)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.INFOCARD_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.INFOCARD_NAMESPACE))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:languageIso639)))(IfStatement(InfixExpression(SimpleName:clientLocale)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:uri)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cardClaims))(SimpleName:iterator)))(SimpleName:next))))(VariableDeclarationStatement(SimpleType(SimpleName:DbSupportedClaim))(VariableDeclarationFragment(SimpleName:dbClaim)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:supportedClaimsImpl))(SimpleName:getClaimByUri)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri)))))(VariableDeclarationStatement(SimpleType(SimpleName:Locale))(VariableDeclarationFragment(SimpleName:locale)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dbClaim))(SimpleName:getLocale)(METHOD_INVOCATION_ARGUMENTS(SimpleName:clientLocale)))))(ExpressionStatement(Assignment(SimpleName:languageIso639)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:locale))(SimpleName:getLanguage)))))(Block(ExpressionStatement(Assignment(SimpleName:languageIso639)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Attribute))(VariableDeclarationFragment(SimpleName:lang)(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:languageIso639))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:displayToken))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lang)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestedDisplayToken))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:displayToken))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:uri))(SimpleName:cardClaims)(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:value)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:card))(SimpleName:getClaim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri)))))(VariableDeclarationStatement(SimpleType(SimpleName:DbSupportedClaim))(VariableDeclarationFragment(SimpleName:dbClaim)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:supportedClaimsImpl))(SimpleName:getClaimByUri)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:displayTag)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dbClaim))(SimpleName:getDisplayTag)(METHOD_INVOCATION_ARGUMENTS(SimpleName:clientLocale)))))(ExpressionStatement(MethodInvocation(SimpleName:addDisplayClaim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:displayToken)(SimpleName:uri)(SimpleName:displayTag)(SimpleName:value))))))(ExpressionStatement(MethodInvocation(SimpleName:addDisplayClaim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:displayToken)(QualifiedName:org.xmldap.infocard.Constants.IC_NAMESPACE)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:card))(SimpleName:getPrivatePersonalIdentifier)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rstr))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:requestedDisplayToken))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rstr))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envelope))(SimpleName:toXML)))))))