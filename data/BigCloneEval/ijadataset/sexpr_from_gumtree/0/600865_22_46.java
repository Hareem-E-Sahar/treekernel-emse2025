(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:timestamp)(SingleVariableDeclaration(SimpleType(SimpleName:PdfSignatureAppearance))(SimpleName:sap))(SingleVariableDeclaration(SimpleType(SimpleName:TSAClient))(SimpleName:tsa))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:signatureName))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:contentEstimated)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsa))(SimpleName:getTokenSizeEstimate))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setVisibleSignature)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Rectangle))(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0))(NumberLiteral:1)(SimpleName:signatureName))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignature))(VariableDeclarationFragment(SimpleName:dic)(ClassInstanceCreation(SimpleType(SimpleName:PdfSignature))(QualifiedName:PdfName.ADOBE_PPKLITE)(QualifiedName:PdfName.ETSI_RFC3161))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.TYPE)(QualifiedName:PdfName.DOCTIMESTAMP))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCryptoDictionary)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer)))(VariableDeclarationFragment(SimpleName:exc)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exc))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(ClassInstanceCreation(SimpleType(SimpleName:Integer))(InfixExpression(InfixExpression(SimpleName:contentEstimated)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:preClose)(METHOD_INVOCATION_ARGUMENTS(SimpleName:exc))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getRangeStream))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:messageDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsa))(SimpleName:getDigestAlgorithm))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:4096))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:n)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:n)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(NumberLiteral:0)(SimpleName:n))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tsImprint)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tsToken)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsa))(SimpleName:getTimeStampToken)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tsImprint)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:contentEstimated)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:tsToken.length))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:Exception))(StringLiteral:<STR>))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:paddedSig)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:contentEstimated))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tsToken)(NumberLiteral:0)(SimpleName:paddedSig)(NumberLiteral:0)(QualifiedName:tsToken.length))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfDictionary))(VariableDeclarationFragment(SimpleName:dic2)(ClassInstanceCreation(SimpleType(SimpleName:PdfDictionary)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic2))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:PdfString))(SimpleName:paddedSig)))(SimpleName:setHexWriting)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic2))))))))