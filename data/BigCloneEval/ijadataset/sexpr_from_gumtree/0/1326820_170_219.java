(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:DatagramChannel))(SimpleName:requestRelayedUDPChannel)(SingleVariableDeclaration(SimpleType(SimpleName:IPeer))(SimpleName:targetPeer))(SingleVariableDeclaration(SimpleType(SimpleName:InetSocketAddress))(SimpleName:relayPeerAddr))(SingleVariableDeclaration(SimpleType(SimpleName:InetSocketAddress))(SimpleName:bindTo))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:targetPeer)(StringLiteral:<STR>)(SimpleName:relayPeerAddr)))))(VariableDeclarationStatement(SimpleType(SimpleName:InetSocketAddress))(VariableDeclarationFragment(SimpleName:useAddress)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ICommFacade))(VariableDeclarationFragment(SimpleName:commFacade)(MethodInvocation(SimpleName:getCommFacade))))(VariableDeclarationStatement(SimpleType(SimpleName:IPeerID))(VariableDeclarationFragment(SimpleName:myPeerID)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getCallback)))(SimpleName:getOwnPeerID))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:SocketChannel))(VariableDeclarationFragment(SimpleName:controlConnection)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getControlChannelManager)))(SimpleName:getControlChannelWith)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:relayPeerAddr))(SimpleName:getAddress))))))(IfStatement(InfixExpression(SimpleName:controlConnection)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ReturnStatement(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:BlockingHook))(VariableDeclarationFragment(SimpleName:bh)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BlockingHook))(SimpleName:createAwaitMessageHook)(METHOD_INVOCATION_ARGUMENTS(SimpleName:controlConnection)(TypeLiteral(SimpleType(SimpleName:RelayAnswerMessage)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:commFacade))(SimpleName:getMessageProcessor)))(SimpleName:installHook)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bh)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bh))(SimpleName:getPredicate)))))(VariableDeclarationStatement(SimpleType(SimpleName:RelayAnswerMessage))(VariableDeclarationFragment(SimpleName:answer)(NullLiteral)))(TryStatement(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:commFacade))(SimpleName:sendTCPMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:controlConnection)(ClassInstanceCreation(SimpleType(SimpleName:RequestUDPRelayMessage))(SimpleName:myPeerID)(NullLiteral)(SimpleName:targetPeer))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block)))(VariableDeclarationStatement(SimpleType(SimpleName:IEnvelope))(VariableDeclarationFragment(SimpleName:env)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bh))(SimpleName:waitForMessage))))(ExpressionStatement(Assignment(SimpleName:answer)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:env)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(CastExpression(SimpleType(SimpleName:RelayAnswerMessage))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:env))(SimpleName:getMessage)))(NullLiteral))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:commFacade))(SimpleName:getMessageProcessor)))(SimpleName:removeHook)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bh))))))(IfStatement(InfixExpression(SimpleName:answer)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:logWarning)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ReturnStatement(NullLiteral))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:answer))(SimpleName:isRelayEstablished))(Block(ExpressionStatement(Assignment(SimpleName:useAddress)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:answer))(SimpleName:getUseAddress))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:answer))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:logWarning)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:answer))(SimpleName:getReason))))))))(ExpressionStatement(MethodInvocation(SimpleName:closeWithoutException)(METHOD_INVOCATION_ARGUMENTS(SimpleName:controlConnection))))(IfStatement(InfixExpression(SimpleName:useAddress)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:DatagramChannel))(VariableDeclarationFragment(SimpleName:result)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DatagramChannel))(SimpleName:open))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:result))(SimpleName:socket)))(SimpleName:bind)(METHOD_INVOCATION_ARGUMENTS(NullLiteral))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:result))(SimpleName:configureBlocking)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:commFacade))(SimpleName:getChannelManager)))(SimpleName:registerChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:result))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:commFacade))(SimpleName:sendUDPMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:result)(ClassInstanceCreation(SimpleType(SimpleName:RelayAnswerACK))(SimpleName:myPeerID)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:answer))(SimpleName:getSenderPeerID)))(SimpleName:useAddress))))(ExpressionStatement(MethodInvocation(SimpleName:waitForComplete)(METHOD_INVOCATION_ARGUMENTS(SimpleName:result))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:result))(SimpleName:isConnected)))(Block(ExpressionStatement(MethodInvocation(SimpleName:closeWithoutException)(METHOD_INVOCATION_ARGUMENTS(SimpleName:result))))(ReturnStatement(NullLiteral))))(ReturnStatement(SimpleName:result)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ReturnStatement(NullLiteral)))))))(ReturnStatement(NullLiteral))))))