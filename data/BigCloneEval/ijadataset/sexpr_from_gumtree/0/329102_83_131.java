(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(SingleMemberAnnotation(SimpleName:SuppressWarnings)(StringLiteral:<STR>))(Modifier:private)(SimpleType(SimpleName:Password))(SimpleName:findAllowedPassword)(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:isPasswordId))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:password))(SingleVariableDeclaration(SimpleType(SimpleName:User))(SimpleName:user))(SingleVariableDeclaration(SimpleType(SimpleName:AccessLevel))(SimpleName:accessLevel))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Password))(VariableDeclarationFragment(SimpleName:foundPassword)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:sqlAccessLevelIn)(NullLiteral)))(SwitchStatement(SimpleName:accessLevel)(SwitchCase(SimpleName:GRANT))(ExpressionStatement(Assignment(SimpleName:sqlAccessLevelIn)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(BreakStatement)(SwitchCase(SimpleName:WRITE))(ExpressionStatement(Assignment(SimpleName:sqlAccessLevelIn)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(BreakStatement)(SwitchCase(SimpleName:READ))(ExpressionStatement(Assignment(SimpleName:sqlAccessLevelIn)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(BreakStatement))(VariableDeclarationStatement(SimpleType(SimpleName:StringBuilder))(VariableDeclarationFragment(SimpleName:hqlString)(ClassInstanceCreation(SimpleType(SimpleName:StringBuilder)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlString))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlString))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(SimpleName:isPasswordId)(StringLiteral:<STR>)(StringLiteral:<STR>)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorizer))(SimpleName:isAuthorized)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user)(QualifiedName:Function.BYPASS_PASSWORD_PERMISSIONS))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlString))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlString))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sqlAccessLevelIn))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlString))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:Query))(VariableDeclarationFragment(SimpleName:hqlQuery)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getSession)))(SimpleName:createQuery)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlString))(SimpleName:toString))))))(IfStatement(SimpleName:isPasswordId)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlQuery))(SimpleName:setLong)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Long))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlQuery))(SimpleName:setString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:password))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorizer))(SimpleName:isAuthorized)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user)(QualifiedName:Function.BYPASS_PASSWORD_PERMISSIONS))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlQuery))(SimpleName:setEntity)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:user))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:accessLevel))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:AccessLevel.GRANT)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:accessLevel))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:AccessLevel.WRITE)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:accessLevel))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:AccessLevel.READ))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlQuery))(SimpleName:setString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:AccessLevel.GRANT))(SimpleName:name)))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:accessLevel))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:AccessLevel.WRITE)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:accessLevel))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:AccessLevel.READ))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlQuery))(SimpleName:setString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:AccessLevel.WRITE))(SimpleName:name)))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:accessLevel))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:AccessLevel.READ)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlQuery))(SimpleName:setString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:AccessLevel.READ))(SimpleName:name)))))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:Long)))(VariableDeclarationFragment(SimpleName:passwordIds)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hqlQuery))(SimpleName:list))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:passwordIds))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:foundPassword)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:findById)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:passwordIds))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:foundPassword))(SimpleName:getPermissions)))(SimpleName:size)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:foundPassword))(SimpleName:getTags)))(SimpleName:size)))))(ReturnStatement(SimpleName:foundPassword))))))