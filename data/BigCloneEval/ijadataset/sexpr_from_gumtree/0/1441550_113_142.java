(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(NormalAnnotation(SimpleName:Transactional)(MemberValuePair(SimpleName:propagation)(QualifiedName:Propagation.REQUIRED)))(Modifier:public)(PrimitiveType:void)(SimpleName:updateUser)(SingleVariableDeclaration(SimpleType(SimpleName:User))(SimpleName:updateUser))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:now)(ClassInstanceCreation(SimpleType(SimpleName:Date)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:action)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:User))(VariableDeclarationFragment(SimpleName:loggedInUser)(MethodInvocation(SimpleName:getLoggedInUser))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:authorizer))(SimpleName:isAuthorized)(METHOD_INVOCATION_ARGUMENTS(SimpleName:loggedInUser)(QualifiedName:Function.UPDATE_USER)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:User))(VariableDeclarationFragment(SimpleName:user)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userDAO))(SimpleName:findById)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:updateUser))(SimpleName:getId))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setFullname)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:updateUser))(SimpleName:getFullname)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setEmail)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:updateUser))(SimpleName:getEmail)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setActiveFlag)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:updateUser))(SimpleName:isActiveFlag)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:updateUser))(SimpleName:getAuthnPasswordValue)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:updateAuthnPasswordValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digester))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:updateUser))(SimpleName:getAuthnPasswordValue)))))))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Group))(SimpleName:oldGroup))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:getGroups))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Group))(VariableDeclarationFragment(SimpleName:group)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:groupDAO))(SimpleName:findById)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oldGroup))(SimpleName:getId))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:group))(SimpleName:removeUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))))(VariableDeclarationStatement(SimpleType(SimpleName:Group))(VariableDeclarationFragment(SimpleName:everyoneGroup)(MethodInvocation(SimpleName:getEveryoneGroup))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:everyoneGroup))(SimpleName:addUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Group))(SimpleName:newGroup))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:updateUser))(SimpleName:getGroups))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Group))(VariableDeclarationFragment(SimpleName:group)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:groupDAO))(SimpleName:findById)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newGroup))(SimpleName:getId))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:group))(SimpleName:addUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:auditLogger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(SimpleName:now)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ServerSessionUtil))(SimpleName:getUsername))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ServerSessionUtil))(SimpleName:getIP))(SimpleName:action)(MethodInvocation(SimpleName:userTarget)(METHOD_INVOCATION_ARGUMENTS(SimpleName:updateUser)))(BooleanLiteral:true)(StringLiteral:<STR>)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:auditLogger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(SimpleName:now)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ServerSessionUtil))(SimpleName:getUsername))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ServerSessionUtil))(SimpleName:getIP))(SimpleName:action)(MethodInvocation(SimpleName:userTarget)(METHOD_INVOCATION_ARGUMENTS(SimpleName:updateUser)))(BooleanLiteral:false)(StringLiteral:<STR>))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(StringLiteral:<STR>)))))))))