(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Test))(Modifier:public)(PrimitiveType:void)(SimpleName:testExternalXmlSignature)(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DocumentBuilderFactory))(VariableDeclarationFragment(SimpleName:documentBuilderFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DocumentBuilderFactory))(SimpleName:newInstance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilderFactory))(SimpleName:setNamespaceAware)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(VariableDeclarationStatement(SimpleType(SimpleName:DocumentBuilder))(VariableDeclarationFragment(SimpleName:documentBuilder)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilderFactory))(SimpleName:newDocumentBuilder))))(VariableDeclarationStatement(SimpleType(SimpleName:Document))(VariableDeclarationFragment(SimpleName:document)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilder))(SimpleName:newDocument))))(VariableDeclarationStatement(SimpleType(SimpleName:XMLSignature))(VariableDeclarationFragment(SimpleName:xmlSignature)(ClassInstanceCreation(SimpleType(SimpleName:XMLSignature))(SimpleName:document)(StringLiteral:<STR>)(QualifiedName:XMLSignature.ALGO_ID_SIGNATURE_RSA_SHA1)(QualifiedName:Canonicalizer.ALGO_ID_C14N_WITH_COMMENTS))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:signatureElement)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:getElement))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureElement))))(VariableDeclarationStatement(SimpleType(SimpleName:ObjectContainer))(VariableDeclarationFragment(SimpleName:objectContainer)(ClassInstanceCreation(SimpleType(SimpleName:ObjectContainer))(SimpleName:document))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:objectContainer))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:createTextNode)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:id)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UUID))(SimpleName:randomUUID)))(SimpleName:toString)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:objectContainer))(SimpleName:setId)(METHOD_INVOCATION_ARGUMENTS(SimpleName:id))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:appendObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:objectContainer))))(VariableDeclarationStatement(SimpleType(SimpleName:Transforms))(VariableDeclarationFragment(SimpleName:transforms)(ClassInstanceCreation(SimpleType(SimpleName:Transforms))(SimpleName:document))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:transforms))(SimpleName:addTransform)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Transforms.TRANSFORM_C14N_EXCL_WITH_COMMENTS))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:addDocument)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:id))(SimpleName:transforms)(QualifiedName:MessageDigestAlgorithm.ALGO_ID_DIGEST_SHA512)(NullLiteral)(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:keyPair)(MethodInvocation(SimpleName:generateKeyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:DateTime))(VariableDeclarationFragment(SimpleName:notBefore)(ClassInstanceCreation(SimpleType(SimpleName:DateTime)))))(VariableDeclarationStatement(SimpleType(SimpleName:DateTime))(VariableDeclarationFragment(SimpleName:notAfter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:notBefore))(SimpleName:plusYears)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:certificate)(MethodInvocation(SimpleName:generateCertificate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic))(StringLiteral:<STR>)(SimpleName:notBefore)(SimpleName:notAfter)(NullLiteral)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate))(BooleanLiteral:true)(NumberLiteral:0)(NullLiteral)(NullLiteral)(ClassInstanceCreation(SimpleType(SimpleName:KeyUsage))(QualifiedName:KeyUsage.nonRepudiation))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:addKeyInfo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate))))(VariableDeclarationStatement(SimpleType(SimpleName:SignedInfo))(VariableDeclarationFragment(SimpleName:signedInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:getSignedInfo))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedInfo))(SimpleName:generateDigestValues)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:octets)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedInfo))(SimpleName:getCanonicalizedOctetStream))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:messageDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digestValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:octets)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digestInfoValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ArrayUtils))(SimpleName:addAll)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SHA1_DIGEST_INFO_PREFIX)(SimpleName:digestValue)))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:cipher)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:signatureValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestInfoValue)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:encodedSignatureValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Base64))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureValue)))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:xmlSignatureElement)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:getElement))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:signatureValueElement)(CastExpression(SimpleType(SimpleName:Element))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XPathAPI))(SimpleName:selectSingleNode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:xmlSignatureElement)(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureValueElement))(SimpleName:setTextContent)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encodedSignatureValue))))(ExpressionStatement(Assignment(SimpleName:xmlSignature)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:XMLSignature))(SimpleName:xmlSignatureElement)(NullLiteral))))(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:checkSignatureValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Source))(VariableDeclarationFragment(SimpleName:source)(ClassInstanceCreation(SimpleType(SimpleName:DOMSource))(SimpleName:document))))(VariableDeclarationStatement(SimpleType(SimpleName:StringWriter))(VariableDeclarationFragment(SimpleName:stringWriter)(ClassInstanceCreation(SimpleType(SimpleName:StringWriter)))))(VariableDeclarationStatement(SimpleType(SimpleName:Result))(VariableDeclarationFragment(SimpleName:result)(ClassInstanceCreation(SimpleType(SimpleName:StreamResult))(SimpleName:stringWriter))))(VariableDeclarationStatement(SimpleType(SimpleName:Transformer))(VariableDeclarationFragment(SimpleName:xformer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TransformerFactory))(SimpleName:newInstance)))(SimpleName:newTransformer))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xformer))(SimpleName:setOutputProperty)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:OutputKeys.OMIT_XML_DECLARATION)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xformer))(SimpleName:transform)(METHOD_INVOCATION_ARGUMENTS(SimpleName:source)(SimpleName:result))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signedDocumentStr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:stringWriter))(SimpleName:getBuffer)))(SimpleName:toString))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:signedDocumentStr)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:tmpFile)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:File))(SimpleName:createTempFile)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtils))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedDocumentStr))(SimpleName:getBytes))(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:tmpFile)))))(VariableDeclarationStatement(SimpleType(SimpleName:StringReader))(VariableDeclarationFragment(SimpleName:stringReader)(ClassInstanceCreation(SimpleType(SimpleName:StringReader))(SimpleName:signedDocumentStr))))(VariableDeclarationStatement(SimpleType(SimpleName:InputSource))(VariableDeclarationFragment(SimpleName:inputSource)(ClassInstanceCreation(SimpleType(SimpleName:InputSource))(SimpleName:stringReader))))(VariableDeclarationStatement(SimpleType(SimpleName:Document))(VariableDeclarationFragment(SimpleName:signedDocument)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilder))(SimpleName:parse)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inputSource)))))(ExpressionStatement(Assignment(SimpleName:signatureElement)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:Element))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XPathAPI))(SimpleName:selectSingleNode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedDocument)(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureElement))))(ExpressionStatement(Assignment(SimpleName:xmlSignature)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:XMLSignature))(SimpleName:signatureElement)(NullLiteral))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpFile))(SimpleName:getAbsolutePath))))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:signatureResult)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:checkSignatureValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic))))))(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureResult))))))))