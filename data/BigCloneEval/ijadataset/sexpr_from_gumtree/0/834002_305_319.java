(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(SimpleType(SimpleName:CMSSignedData))(SimpleName:_getSignaturePkcs7)(SingleVariableDeclaration(SimpleType(SimpleName:KeyStore))(SimpleName:kstOpen))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:strAliasKpr))(SingleVariableDeclaration(SimpleType(SimpleName:PrivateKey))(SimpleName:pkyPrivate))(SingleVariableDeclaration(SimpleType(SimpleName:File))(SimpleName:fleOpenData))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:strCmsSigGenDigest))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(ArrayType(SimpleType(QualifiedName:java.security.cert.Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:crtsChain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kstOpen))(SimpleName:getCertificateChain)(METHOD_INVOCATION_ARGUMENTS(SimpleName:strAliasKpr)))))(VariableDeclarationStatement(SimpleType(SimpleName:ArrayList))(VariableDeclarationFragment(SimpleName:certList)(ClassInstanceCreation(SimpleType(SimpleName:ArrayList)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:crtsChain.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certList))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:crtsChain)(SimpleName:i))))))(VariableDeclarationStatement(SimpleType(SimpleName:CertStore))(VariableDeclarationFragment(SimpleName:cseCerts)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ClassInstanceCreation(SimpleType(SimpleName:CollectionCertStoreParameters))(SimpleName:certList))(QualifiedName:KTLAbs.f_s_strProviderKstBC)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:crt)(CastExpression(SimpleType(SimpleName:X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kstOpen))(SimpleName:getCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:strAliasKpr))))))(VariableDeclarationStatement(SimpleType(SimpleName:CMSSignedDataGenerator))(VariableDeclarationFragment(SimpleName:gen)(ClassInstanceCreation(SimpleType(SimpleName:CMSSignedDataGenerator)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:addSigner)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pkyPrivate)(SimpleName:crt)(SimpleName:strCmsSigGenDigest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:addCertificatesAndCRLs)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cseCerts))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:ism)(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(SimpleName:fleOpenData))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:bytsData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KTLKprOpenSigDetOCmsAbs))(SimpleName:_s_streamToByteArray)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ism)))))(VariableDeclarationStatement(SimpleType(SimpleName:CMSProcessable))(VariableDeclarationFragment(SimpleName:preData)(ClassInstanceCreation(SimpleType(SimpleName:CMSProcessableByteArray))(SimpleName:bytsData))))(VariableDeclarationStatement(SimpleType(SimpleName:CMSSignedData))(VariableDeclarationFragment(SimpleName:sdaSignature)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:generate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:preData)(FieldAccess(ThisExpression)(SimpleName:_blnDataEncapsulated))(QualifiedName:KTLAbs.f_s_strProviderKstBC)))))(ReturnStatement(SimpleName:sdaSignature))))))