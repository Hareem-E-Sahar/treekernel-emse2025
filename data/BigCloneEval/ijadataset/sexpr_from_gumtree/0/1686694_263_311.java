(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:writeKeyPairSSHCom)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:password))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:cipher))(SingleVariableDeclaration(SimpleType(SimpleName:KeyPair))(SimpleName:keyPair))(SimpleType(SimpleName:SSH2FatalException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:SSH2DataBuffer))(VariableDeclarationFragment(SimpleName:toBeEncrypted)(ClassInstanceCreation(SimpleType(SimpleName:SSH2DataBuffer))(NumberLiteral:8192))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:totLen)(NumberLiteral:0)))(VariableDeclarationStatement(SimpleType(SimpleName:DSAPublicKey))(VariableDeclarationFragment(SimpleName:pubKey)(CastExpression(SimpleType(SimpleName:DSAPublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic)))))(VariableDeclarationStatement(SimpleType(SimpleName:DSAPrivateKey))(VariableDeclarationFragment(SimpleName:prvKey)(CastExpression(SimpleType(SimpleName:DSAPrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate)))))(VariableDeclarationStatement(SimpleType(SimpleName:DSAParams))(VariableDeclarationFragment(SimpleName:params)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKey))(SimpleName:getParams))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ParenthesizedExpression(InstanceofExpression(SimpleName:pubKey)(SimpleType(SimpleName:DSAPublicKey)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SSH2FatalException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:pubKey))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:writeBigIntBits)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getP)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:writeBigIntBits)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getG)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:writeBigIntBits)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getQ)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:writeBigIntBits)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pubKey))(SimpleName:getY)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:writeBigIntBits)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prvKey))(SimpleName:getX)))))(ExpressionStatement(Assignment(SimpleName:totLen)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:getWPos))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:setWPos)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:totLen)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:4)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:keyLen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SSH2Preferences))(SimpleName:getCipherKeyLen)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipher)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cipherName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SSH2Preferences))(SimpleName:ssh2ToJCECipher)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipher)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:key)(MethodInvocation(SimpleName:expandPasswordToKeySSHCom)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)(SimpleName:keyLen)))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:encrypt)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipherName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypt))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(SimpleName:key)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypt))(SimpleName:getAlgorithm))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:getData))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypt))(SimpleName:getBlockSize))))(ExpressionStatement(Assignment(SimpleName:totLen)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:bs)(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(SimpleName:totLen)(INFIX_EXPRESSION_OPERATOR:%)(SimpleName:bs)))))(INFIX_EXPRESSION_OPERATOR:%)(SimpleName:bs))))(ExpressionStatement(Assignment(SimpleName:totLen)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypt))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(SimpleName:totLen)(SimpleName:data)(NumberLiteral:0))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SSH2FatalException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:cipher))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidKeyException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SSH2FatalException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:e)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:SSH2DataBuffer))(VariableDeclarationFragment(SimpleName:buf)(ClassInstanceCreation(SimpleType(SimpleName:SSH2DataBuffer))(InfixExpression(NumberLiteral:512)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:totLen)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SSH_PRIVATE_KEY_MAGIC))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:writeString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:writeString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipher))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:writeString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:toBeEncrypted))(SimpleName:getData))(NumberLiteral:0)(SimpleName:totLen))))(ExpressionStatement(Assignment(SimpleName:totLen)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:getWPos))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:setWPos)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:4))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:totLen))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:keyBlob)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:totLen))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:buf.data)(NumberLiteral:0)(SimpleName:keyBlob)(NumberLiteral:0)(SimpleName:totLen))))(ReturnStatement(SimpleName:keyBlob))))))