(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:void)(SimpleName:prepare)(SingleVariableDeclaration(SimpleType(SimpleName:WSSecHeader))(SimpleName:secHeader))(SimpleType(SimpleName:WSSecurityException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KerberosSession))(VariableDeclarationFragment(SimpleName:krbSession)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KerberosSessionCache))(SimpleName:getInstance)))(SimpleName:getCurrentSession))))(IfStatement(InfixExpression(SimpleName:krbSession)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:krbSession)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KerberosSessionCache))(SimpleName:getInstance)))(SimpleName:getSession)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user)(SimpleName:servicePrincipalName)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KerberosSessionCache))(SimpleName:getInstance)))(SimpleName:removeCurrentSession)))(ExpressionStatement(Assignment(SimpleName:secRef)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SecurityTokenReference))(SimpleName:document))))(ExpressionStatement(Assignment(SimpleName:strUri)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secRef))(SimpleName:hashCode)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secRef))(SimpleName:setID)(METHOD_INVOCATION_ARGUMENTS(SimpleName:strUri))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tokenData)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:krbSession)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:KerberosTicket))(VariableDeclarationFragment(SimpleName:tgt)(MethodInvocation(SimpleName:getTicketGrantingTicket))))(ExpressionStatement(Assignment(SimpleName:tokenData)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getServiceTicketData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:servicePrincipalName)))))(ExpressionStatement(Assignment(SimpleName:sessionKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getSessionKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tgt)))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tokenData))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:thumbPrintBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digest))(SimpleName:digest))))(ExpressionStatement(Assignment(SimpleName:krbSession)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:KerberosSession))(NullLiteral)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Base64))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:thumbPrintBytes)))(SimpleName:sessionKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:krbSession))(SimpleName:setClientPrincipalName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:krbSession))(SimpleName:setServerPrincipalName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:servicePrincipalName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KerberosSessionCache))(SimpleName:getInstance)))(SimpleName:addSession)(METHOD_INVOCATION_ARGUMENTS(SimpleName:krbSession)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:LoginException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:WSSecurityException))(QualifiedName:WSSecurityException.FAILED_AUTHENTICATION)(StringLiteral:<STR>)(ArrayCreation(ArrayType(SimpleType(SimpleName:Object))(Dimension))(ArrayInitializer(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:GSSException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:WSSecurityException))(QualifiedName:WSSecurityException.FAILED_AUTHENTICATION)(StringLiteral:<STR>)(ArrayCreation(ArrayType(SimpleType(SimpleName:Object))(Dimension))(ArrayInitializer(SimpleName:servicePrincipalName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:WSSecurityException))(QualifiedName:WSSecurityException.FAILED_AUTHENTICATION)(StringLiteral:<STR>)(ArrayCreation(ArrayType(SimpleType(SimpleName:Object))(Dimension))(ArrayInitializer(SimpleName:servicePrincipalName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))))))(IfStatement(InfixExpression(SimpleName:tokenData)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:WSSecurityException))(QualifiedName:WSSecurityException.FAILED_AUTHENTICATION)(StringLiteral:<STR>)(ArrayCreation(ArrayType(SimpleType(SimpleName:Object))(Dimension))(ArrayInitializer(SimpleName:servicePrincipalName)(StringLiteral:<STR>)))))))(ExpressionStatement(Assignment(SimpleName:tokenUri)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tokenData))(SimpleName:hashCode))))))(Block(ExpressionStatement(Assignment(SimpleName:keyIdentifierType)(ASSIGNMENT_OPERATOR:=)(QualifiedName:WSConstants.THUMBPRINT_IDENTIFIER)))))(ExpressionStatement(Assignment(SimpleName:wsDocInfo)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:WSDocInfo))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:hashCode)))))(SwitchStatement(SimpleName:keyIdentifierType)(SwitchCase(QualifiedName:WSConstants.BST_DIRECT_REFERENCE))(VariableDeclarationStatement(SimpleType(SimpleName:Reference))(VariableDeclarationFragment(SimpleName:ref)(ClassInstanceCreation(SimpleType(SimpleName:Reference))(SimpleName:document))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ref))(SimpleName:setURI)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:tokenUri)))))(ExpressionStatement(Assignment(SimpleName:bstToken)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:KerberosSecurity))(SimpleName:document))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:KerberosSecurity))(SimpleName:bstToken))))(SimpleName:setKerberosToken)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tokenData))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ref))(SimpleName:setValueType)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bstToken))(SimpleName:getValueType)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secRef))(SimpleName:setReference)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ref))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bstToken))(SimpleName:setID)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tokenUri))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wsDocInfo))(SimpleName:setBst)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bstToken))(SimpleName:getElement)))))(BreakStatement)(SwitchCase(QualifiedName:WSConstants.THUMBPRINT_IDENTIFIER))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secRef))(SimpleName:setKerberosIdentifierThumb)(METHOD_INVOCATION_ARGUMENTS(SimpleName:krbSession))))(ExpressionStatement(Assignment(SimpleName:sessionKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:krbSession))(SimpleName:getSessionKey))))(BreakStatement)(SwitchCase)(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:WSSecurityException))(QualifiedName:WSSecurityException.FAILURE)(StringLiteral:<STR>))))))))