(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:toBinaryPacket)(SimpleType(SimpleName:SSH2Exception))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:payload_bytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:payload))(SimpleName:toByteArray))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:packet)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:packet_length)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:padding_length)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:padding)(NullLiteral)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:mac)(NullLiteral)))(IfStatement(InfixExpression(QualifiedName:config.flater)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:compressed)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:BUF_SIZE))))))(ExpressionStatement(Assignment(QualifiedName:config.flater.next_in)(ASSIGNMENT_OPERATOR:=)(SimpleName:payload_bytes)))(ExpressionStatement(Assignment(QualifiedName:config.flater.next_in_index)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(ExpressionStatement(Assignment(QualifiedName:config.flater.avail_in)(ASSIGNMENT_OPERATOR:=)(QualifiedName:payload_bytes.length)))(DoStatement(Block(ExpressionStatement(Assignment(QualifiedName:config.flater.next_out)(ASSIGNMENT_OPERATOR:=)(SimpleName:buf)))(ExpressionStatement(Assignment(QualifiedName:config.flater.next_out_index)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(ExpressionStatement(Assignment(QualifiedName:config.flater.avail_out)(ASSIGNMENT_OPERATOR:=)(QualifiedName:buf.length)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:err)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:config.flater))(SimpleName:deflate)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:JZlib.Z_PARTIAL_FLUSH)))))(SwitchStatement(SimpleName:err)(SwitchCase(QualifiedName:JZlib.Z_OK))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:compressed))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(NumberLiteral:0)(InfixExpression(QualifiedName:buf.length)(INFIX_EXPRESSION_OPERATOR:-)(QualifiedName:config.flater.avail_out)))))(BreakStatement)(SwitchCase)(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SSH2Exception))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:err)(StringLiteral:<STR>)(QualifiedName:config.flater.msg))))))(InfixExpression(QualifiedName:config.flater.avail_out)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0)))(ExpressionStatement(Assignment(SimpleName:payload_bytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:compressed))(SimpleName:toByteArray))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:s)(NumberLiteral:8)))(IfStatement(InfixExpression(QualifiedName:config.cipher)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(Assignment(SimpleName:s)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Math))(SimpleName:max)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:8)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:config.cipher))(SimpleName:currentBlockSize)))))))(ExpressionStatement(Assignment(SimpleName:padding_length)(ASSIGNMENT_OPERATOR:=)(InfixExpression(InfixExpression(SimpleName:s)(INFIX_EXPRESSION_OPERATOR:*)(ParenthesizedExpression(InfixExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:5)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:payload_bytes.length)))(INFIX_EXPRESSION_OPERATOR:/)(SimpleName:s))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))))(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(NumberLiteral:5)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:payload_bytes.length))))))(IfStatement(InfixExpression(SimpleName:padding_length)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:s))(ExpressionStatement(Assignment(SimpleName:padding_length)(ASSIGNMENT_OPERATOR:+=)(SimpleName:s))))(ExpressionStatement(Assignment(SimpleName:padding)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:padding_length))))))(IfStatement(InfixExpression(InfixExpression(QualifiedName:config.random)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(QualifiedName:config.cipher)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:config.random))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:padding)))))(ExpressionStatement(Assignment(SimpleName:packet_length)(ASSIGNMENT_OPERATOR:=)(InfixExpression(NumberLiteral:1)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:payload_bytes.length)(QualifiedName:padding.length))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:plain)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:packet_length)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:4)))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:plain)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:packet_length)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:plain)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:packet_length)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:plain)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:packet_length)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:plain)(NumberLiteral:3))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:packet_length)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:plain)(NumberLiteral:4))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(QualifiedName:padding.length)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:payload_bytes)(NumberLiteral:0)(SimpleName:plain)(NumberLiteral:5)(QualifiedName:payload_bytes.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:padding)(NumberLiteral:0)(SimpleName:plain)(InfixExpression(NumberLiteral:5)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:payload_bytes.length))(QualifiedName:padding.length))))(IfStatement(InfixExpression(QualifiedName:config.mac)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:seq)(ArrayInitializer(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:sequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:sequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:sequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:sequence)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:config.mac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:seq)(NumberLiteral:0)(QualifiedName:seq.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:config.mac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:plain)(NumberLiteral:0)(QualifiedName:plain.length))))(ExpressionStatement(Assignment(SimpleName:mac)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:config.mac))(SimpleName:digest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:config.mac))(SimpleName:reset)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encrypted)(NullLiteral)))(IfStatement(InfixExpression(QualifiedName:config.cipher)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(Modifier:final)(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:config.cipher))(SimpleName:currentBlockSize))))(ExpressionStatement(Assignment(SimpleName:encrypted)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(QualifiedName:plain.length))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:plain.length))(Assignment(SimpleName:i)(ASSIGNMENT_OPERATOR:+=)(SimpleName:bs))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:config.cipher))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:plain)(SimpleName:i)(SimpleName:encrypted)(SimpleName:i)))))))(ExpressionStatement(Assignment(SimpleName:encrypted)(ASSIGNMENT_OPERATOR:=)(SimpleName:plain))))(ExpressionStatement(Assignment(SimpleName:plain)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(Assignment(SimpleName:packet)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(QualifiedName:encrypted.length)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:mac)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(NumberLiteral:0)(QualifiedName:mac.length)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encrypted)(NumberLiteral:0)(SimpleName:packet)(NumberLiteral:0)(QualifiedName:encrypted.length))))(IfStatement(InfixExpression(SimpleName:mac)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac)(NumberLiteral:0)(SimpleName:packet)(QualifiedName:encrypted.length)(QualifiedName:mac.length)))))(ExpressionStatement(Assignment(SimpleName:encrypted)(ASSIGNMENT_OPERATOR:=)(Assignment(SimpleName:mac)(ASSIGNMENT_OPERATOR:=)(NullLiteral))))(ExpressionStatement(PostfixExpression(SimpleName:sequence)(POSTFIX_EXPRESSION_OPERATOR:++)))(ExpressionStatement(Assignment(SimpleName:total_raw_out)(ASSIGNMENT_OPERATOR:+=)(QualifiedName:packet.length)))(ReturnStatement(SimpleName:packet))))))