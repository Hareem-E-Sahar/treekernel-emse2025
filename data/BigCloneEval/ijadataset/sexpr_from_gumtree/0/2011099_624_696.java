(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:StringBuffer))(SimpleName:getCompoundZip)(SingleVariableDeclaration(SimpleType(SimpleName:DmsDocument))(SimpleName:document))(SingleVariableDeclaration(SimpleType(SimpleName:HttpServletRequest))(SimpleName:request))(SingleVariableDeclaration(SimpleType(SimpleName:HttpServletResponse))(SimpleName:response))(SimpleType(SimpleName:ApplicationException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:SessionContainer))(VariableDeclarationFragment(SimpleName:sessionContainer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getSessionContainer)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)))))(VariableDeclarationStatement(SimpleType(SimpleName:Connection))(VariableDeclarationFragment(SimpleName:conn)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getConnection)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)))))(VariableDeclarationStatement(SimpleType(SimpleName:DocumentRetrievalManager))(VariableDeclarationFragment(SimpleName:docRetrievalManager)(ClassInstanceCreation(SimpleType(SimpleName:DocumentRetrievalManager))(SimpleName:sessionContainer)(SimpleName:conn))))(VariableDeclarationStatement(SimpleType(SimpleName:RootRetrievalManager))(VariableDeclarationFragment(SimpleName:rootRetrievalManager)(ClassInstanceCreation(SimpleType(SimpleName:RootRetrievalManager))(SimpleName:sessionContainer)(SimpleName:conn))))(VariableDeclarationStatement(SimpleType(SimpleName:DmsContentManager))(VariableDeclarationFragment(SimpleName:dmsContentManager)(ClassInstanceCreation(SimpleType(SimpleName:DmsContentManager))(SimpleName:sessionContainer)(SimpleName:conn))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:inputStream)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:dataStream)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:zipfilename)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:getDocumentName))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:StringBuffer))(VariableDeclarationFragment(SimpleName:comZipFile)(ClassInstanceCreation(SimpleType(SimpleName:StringBuffer)))))(VariableDeclarationStatement(SimpleType(SimpleName:DmsLocMaster))(VariableDeclarationFragment(SimpleName:locMaster)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rootRetrievalManager))(SimpleName:getTargetLocMasterByDocument)(METHOD_INVOCATION_ARGUMENTS(SimpleName:document)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:locMasterPath)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:locMaster))(SimpleName:getLocPath))))(ExpressionStatement(Assignment(SimpleName:comZipFile)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:comZipFile))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:locMasterPath))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zipfilename)))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:ZipOutputStream))(VariableDeclarationFragment(SimpleName:zipOutStream)(ClassInstanceCreation(SimpleType(SimpleName:ZipOutputStream))(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:comZipFile))(SimpleName:toString))))))(VariableDeclarationStatement(SimpleType(SimpleName:DocumentRetrievalManager))(VariableDeclarationFragment(SimpleName:docRetrieval)(ClassInstanceCreation(SimpleType(SimpleName:DocumentRetrievalManager))(SimpleName:sessionContainer)(SimpleName:conn))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOutStream))(SimpleName:setEncoding)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:docRetrieval))(SimpleName:getZipFileDefaultEncode)))))(VariableDeclarationStatement(SimpleType(SimpleName:DocumentOperationManager))(VariableDeclarationFragment(SimpleName:docOperationManager)(ClassInstanceCreation(SimpleType(SimpleName:DocumentOperationManager))(SimpleName:sessionContainer)(SimpleName:conn))))(VariableDeclarationStatement(SimpleType(SimpleName:MtmDocumentRelationshipDAObject))(VariableDeclarationFragment(SimpleName:docRelationshipDAO)(ClassInstanceCreation(SimpleType(SimpleName:MtmDocumentRelationshipDAObject))(SimpleName:sessionContainer)(SimpleName:conn))))(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:targetID)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:getID))))(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:contentID)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:list)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:docOperationManager))(SimpleName:getSubDocumentByParentID)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:getID))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:DmsDocument.COMPOUND_DOC_TYPE))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:getDocumentType))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:list))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:document))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Utility))(SimpleName:isEmpty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:list))))(Block(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:j)(NumberLiteral:0)))(InfixExpression(SimpleName:j)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:list))(SimpleName:size)))(PostfixExpression(SimpleName:j)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DmsDocument))(VariableDeclarationFragment(SimpleName:dmsDocument)(CastExpression(SimpleType(SimpleName:DmsDocument))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:list))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:j))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:fName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmsDocument))(SimpleName:getDocumentName))))(VariableDeclarationStatement(SimpleType(SimpleName:DmsVersion))(VariableDeclarationFragment(SimpleName:sVersion)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:docRetrievalManager))(SimpleName:getTopVersionByDocumentID)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmsDocument))(SimpleName:getID))))))(ExpressionStatement(Assignment(SimpleName:contentID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sVersion))(SimpleName:getContentID))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:DmsDocument.DOCUMENT_LINK))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmsDocument))(SimpleName:getDocumentType))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:targetDocID)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:docRelationshipDAO))(SimpleName:getTargetDocIDByRelatedDocID)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmsDocument))(SimpleName:getID))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmsDocument))(SimpleName:getDocumentType))))))(VariableDeclarationStatement(SimpleType(SimpleName:DmsDocument))(VariableDeclarationFragment(SimpleName:targetDoc)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:docRetrievalManager))(SimpleName:getDocument)(METHOD_INVOCATION_ARGUMENTS(SimpleName:targetDocID)))))(IfStatement(InfixExpression(SimpleName:targetDoc)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:targetDoc))(SimpleName:setDocumentName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmsDocument))(SimpleName:getDocumentName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:targetDoc))(SimpleName:setDocumentType)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmsDocument))(SimpleName:getDocumentType)))))(ExpressionStatement(Assignment(SimpleName:targetID)(ASSIGNMENT_OPERATOR:=)(SimpleName:targetDocID)))(ExpressionStatement(Assignment(SimpleName:dmsDocument)(ASSIGNMENT_OPERATOR:=)(SimpleName:targetDoc)))(ExpressionStatement(Assignment(SimpleName:sVersion)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:docRetrievalManager))(SimpleName:getTopVersionByDocumentID)(METHOD_INVOCATION_ARGUMENTS(SimpleName:targetID)))))(ExpressionStatement(Assignment(SimpleName:contentID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sVersion))(SimpleName:getContentID)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:setRecordStatus)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:GlobalConstant.RECORD_STATUS_INACTIVE))))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:GlobalConstant.RECORD_STATUS_INACTIVE))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:getRecordStatus)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DmsContent))(VariableDeclarationFragment(SimpleName:docContent)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:docRetrievalManager))(SimpleName:getContentByContentID)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentID)))))(ExpressionStatement(Assignment(SimpleName:dataStream)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmsContentManager))(SimpleName:readDmsDocumentStoreContent)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dmsDocument)(SimpleName:docContent)))))(VariableDeclarationStatement(SimpleType(SimpleName:ZipEntry))(VariableDeclarationFragment(SimpleName:theEntry)(ClassInstanceCreation(SimpleType(SimpleName:ZipEntry))(SimpleName:fName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOutStream))(SimpleName:putNextEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:theEntry))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buffer)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8192))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:length)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))(ExpressionStatement(Assignment(SimpleName:inputStream)(ASSIGNMENT_OPERATOR:=)(SimpleName:dataStream)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:length)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buffer)(NumberLiteral:0)(NumberLiteral:8192)))))(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOutStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buffer)(NumberLiteral:0)(SimpleName:length))))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOutStream))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOutStream))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e)(SimpleName:e))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ApplicationException))(QualifiedName:com.dcivision.framework.ErrorConstant.COMMON_FATAL_ERROR)(SimpleName:e)))))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ignore))(Block(ExpressionStatement(Assignment(SimpleName:inputStream)(ASSIGNMENT_OPERATOR:=)(NullLiteral))))))))(ReturnStatement(SimpleName:comZipFile))))))