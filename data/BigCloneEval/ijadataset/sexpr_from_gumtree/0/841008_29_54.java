(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:boolean)(SimpleName:isValidPassword)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:userId))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:password))(SimpleType(SimpleName:PortalException))(SimpleType(SimpleName:SystemException))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:passwordsRecycle)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:GetterUtil))(SimpleName:getInteger)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.PASSWORDS_RECYCLE)))))))(IfStatement(InfixExpression(SimpleName:passwordsRecycle)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:newEncPwd)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Encryptor))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)))))(VariableDeclarationStatement(SimpleType(SimpleName:User))(VariableDeclarationFragment(SimpleName:user)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserUtil))(SimpleName:findByPrimaryKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userId)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:oldEncPwd)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:getPassword))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:isPasswordEncrypted)))(Block(ExpressionStatement(Assignment(SimpleName:oldEncPwd)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Encryptor))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:getPassword))))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oldEncPwd))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newEncPwd)))(Block(ReturnStatement(BooleanLiteral:false))))(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:now)(ClassInstanceCreation(SimpleType(SimpleName:Date)))))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:itr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PasswordTrackerUtil))(SimpleName:findByUserId)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userId))))(SimpleName:iterator))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:itr))(SimpleName:hasNext))(Block(VariableDeclarationStatement(SimpleType(SimpleName:PasswordTracker))(VariableDeclarationFragment(SimpleName:passwordTracker)(CastExpression(SimpleType(SimpleName:PasswordTracker))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:itr))(SimpleName:next)))))(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:recycleDate)(ClassInstanceCreation(SimpleType(SimpleName:Date))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:passwordTracker))(SimpleName:getCreateDate)))(SimpleName:getTime))(INFIX_EXPRESSION_OPERATOR:+)(InfixExpression(QualifiedName:Time.DAY)(INFIX_EXPRESSION_OPERATOR:*)(SimpleName:passwordsRecycle))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:recycleDate))(SimpleName:after)(METHOD_INVOCATION_ARGUMENTS(SimpleName:now)))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:passwordTracker))(SimpleName:getPassword)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newEncPwd)))(Block(ReturnStatement(BooleanLiteral:false))))))))))(ReturnStatement(BooleanLiteral:true))))))