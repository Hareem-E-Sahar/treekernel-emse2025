(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:void)(SimpleName:upgradeToEMF)(SingleVariableDeclaration(SimpleType(SimpleName:SeriesStored))(SimpleName:seriesStored))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Dataset))(VariableDeclarationFragment(SimpleName:ian)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:seriesStored))(SimpleName:getIAN))))(VariableDeclarationStatement(SimpleType(SimpleName:Dataset))(VariableDeclarationFragment(SimpleName:refSeriesSeq)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ian))(SimpleName:getItem)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Tags.RefSeriesSeq)))))(VariableDeclarationStatement(SimpleType(SimpleName:DcmElement))(VariableDeclarationFragment(SimpleName:refSOPSeq)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:refSeriesSeq))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Tags.RefSOPSeq)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:numFrames)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:refSOPSeq))(SimpleName:countItems))))(VariableDeclarationStatement(SimpleType(SimpleName:EnhancedMFBuilder))(VariableDeclarationFragment(SimpleName:builder)(MethodInvocation(SimpleName:newEMFBuilder)(METHOD_INVOCATION_ARGUMENTS(SimpleName:seriesStored)(SimpleName:numFrames)))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:File))(Dimension))(VariableDeclarationFragment(SimpleName:files)(ArrayCreation(ArrayType(SimpleType(SimpleName:File))(Dimension(SimpleName:numFrames))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:numFrames))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Dataset))(VariableDeclarationFragment(SimpleName:refSOP)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:refSOPSeq))(SimpleName:getItem)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:iuid)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:refSOP))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Tags.RefSOPInstanceUID)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(Assignment(ArrayAccess(SimpleName:files)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:locateInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:iuid)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:Dataset))(VariableDeclarationFragment(SimpleName:mfds)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:build))))(IfStatement(SimpleName:mergePatientStudySeriesAttributesFromDB)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfds))(SimpleName:putAll)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:seriesStored))(SimpleName:getSeriesAttrs)))(SimpleName:exclude)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SERIES_IUID))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfds))(SimpleName:putAll)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:seriesStored))(SimpleName:getStudyAttrs)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfds))(SimpleName:putAll)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:seriesStored))(SimpleName:getPatientAttrs)))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:tsUID)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfds))(SimpleName:getFileMetaInfo)))(SimpleName:getTransferSyntaxUID))))(VariableDeclarationStatement(SimpleType(SimpleName:FileDTO))(VariableDeclarationFragment(SimpleName:fileDTO)(MethodInvocation(SimpleName:makeFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mfds)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:mffile)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:toFile)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileDTO))(SimpleName:getDirectoryPath))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileDTO))(SimpleName:getFilePath))))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:deleteFile)(BooleanLiteral:true)))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:mffile)))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:DigestOutputStream))(VariableDeclarationFragment(SimpleName:dos)(ClassInstanceCreation(SimpleType(SimpleName:DigestOutputStream))(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:mffile))(SimpleName:md))))(VariableDeclarationStatement(SimpleType(SimpleName:BufferedOutputStream))(VariableDeclarationFragment(SimpleName:out)(ClassInstanceCreation(SimpleType(SimpleName:BufferedOutputStream))(SimpleName:dos)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:bufferSize)))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:DcmEncodeParam))(VariableDeclarationFragment(SimpleName:encParam)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DcmEncodeParam))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tsUID)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfds))(SimpleName:writeFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out)(SimpleName:encParam))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:noPixelData))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfds))(SimpleName:writeHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out)(SimpleName:encParam)(QualifiedName:Tags.PixelData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:getPixelDataVR))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:getPixelDataLength)))))(IfStatement(QualifiedName:encParam.encapsulated)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfds))(SimpleName:writeHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out)(SimpleName:encParam)(QualifiedName:Tags.Item)(QualifiedName:VRs.NONE)(NumberLiteral:0))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:numFrames))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:off)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:getPixelDataOffset)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:len)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:getPixelDataLength)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i)))))(IfStatement(QualifiedName:encParam.encapsulated)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfds))(SimpleName:writeHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out)(SimpleName:encParam)(QualifiedName:Tags.Item)(QualifiedName:VRs.NONE)(SimpleName:len))))))(VariableDeclarationStatement(SimpleType(SimpleName:FileInputStream))(VariableDeclarationFragment(SimpleName:in)(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(ArrayAccess(SimpleName:files)(SimpleName:i)))))(TryStatement(Block(WhileStatement(InfixExpression(SimpleName:off)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:off)(ASSIGNMENT_OPERATOR:-=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:skip)(METHOD_INVOCATION_ARGUMENTS(SimpleName:off)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:copyFrom)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)(SimpleName:len)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:close)))))))(IfStatement(QualifiedName:encParam.encapsulated)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfds))(SimpleName:writeHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out)(SimpleName:encParam)(QualifiedName:Tags.SeqDelimitationItem)(QualifiedName:VRs.NONE)(NumberLiteral:0)))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:close)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileDTO))(SimpleName:setFileMd5)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileDTO))(SimpleName:setFileSize)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mffile))(SimpleName:length)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileDTO))(SimpleName:setFileTsuid)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tsUID))))(ExpressionStatement(MethodInvocation(SimpleName:importFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fileDTO)(SimpleName:mfds))))(ExpressionStatement(Assignment(SimpleName:deleteFile)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false))))(Block(IfStatement(SimpleName:deleteFile)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:mffile)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mffile))(SimpleName:delete)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:mffile)))))))))))))))