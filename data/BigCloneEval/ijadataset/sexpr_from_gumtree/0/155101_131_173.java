(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:write)(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:type))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:hashed))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:unhashed))(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:out))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:GeneralSecurityException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:b)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:num)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:2))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:sb)(ArrayInitializer(CastExpression(PrimitiveType:byte)(NumberLiteral:4))(CastExpression(PrimitiveType:byte)(SimpleName:type))(CastExpression(PrimitiveType:byte)(SimpleName:pkAlgo))(CastExpression(PrimitiveType:byte)(QualifiedName:Algo.SHA1))(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(QualifiedName:hashed.length)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(QualifiedName:hashed.length)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:len)(InfixExpression(NumberLiteral:6)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:hashed.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sb))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sb))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:b))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sb))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hashed))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hashed))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:b))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hashed))))(ExpressionStatement(Assignment(SimpleName:sb)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:6))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:sb)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(NumberLiteral:4))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:sb)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(NumberLiteral:0xFF))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:sb)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:sb)(NumberLiteral:3))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:sb)(NumberLiteral:4))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:sb)(NumberLiteral:5))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sb))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sb))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:num)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(QualifiedName:unhashed.length)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:num)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(QualifiedName:unhashed.length)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:b))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:num))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:b))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:unhashed))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:b))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest))(NumberLiteral:0)(NumberLiteral:2))))(ExpressionStatement(Assignment(SimpleName:sb)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:sign))))(SwitchStatement(SimpleName:pkAlgo)(SwitchCase(QualifiedName:Algo.RSA_ES))(SwitchCase(QualifiedName:Algo.RSA_S))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MPI))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:BigInteger))(SimpleName:sb))(SimpleName:b))))(BreakStatement)(SwitchCase(QualifiedName:Algo.DSA_S))(ExpressionStatement(Assignment(SimpleName:num)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(ArrayAccess(SimpleName:sb)(NumberLiteral:3))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sb)(NumberLiteral:4)(SimpleName:num)(NumberLiteral:0)(QualifiedName:num.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MPI))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:BigInteger))(SimpleName:num))(SimpleName:b))))(ExpressionStatement(Assignment(SimpleName:num)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(ArrayAccess(SimpleName:sb)(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:sb)(NumberLiteral:3))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:5)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sb)(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:sb)(NumberLiteral:3))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:6))(SimpleName:num)(NumberLiteral:0)(QualifiedName:num.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MPI))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:BigInteger))(SimpleName:num))(SimpleName:b)))))(ExpressionStatement(Assignment(SimpleName:sb)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:b))(SimpleName:toByteArray))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PacketHeader))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false)(CastExpression(PrimitiveType:byte)(QualifiedName:Packet.SIGNATURE))(QualifiedName:sb.length)(SimpleName:out))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sb))))))))