(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:void)(SimpleName:invokeRun0)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:LockProtectedRunnable))(SimpleName:task))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:sync))(SingleVariableDeclaration(SimpleType(SimpleName:Lock))(SimpleName:lock))(Block(VariableDeclarationStatement(Modifier:final)(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:write)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lock))(SimpleName:isWriteLock))))(TypeDeclarationStatement(TypeDeclaration(TYPE_DECLARATION_KIND:class)(SimpleName:Helper)(SimpleType(SimpleName:Runnable))(SimpleType(SimpleName:LockProtectedRunnable))(FieldDeclaration(Modifier:private)(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:executed)))(FieldDeclaration(Modifier:private)(SimpleType(SimpleName:Lock))(VariableDeclarationFragment(SimpleName:retainedLock)))(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:run)(Block(SynchronizedStatement(ThisExpression)(Block(ExpressionStatement(MethodInvocation(SimpleName:execute)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(SimpleName:write))))(IfStatement(SimpleName:executed)(Block(ReturnStatement)))(WhileStatement(InfixExpression(SimpleName:retainedLock)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(SimpleName:wait))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InterruptedException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace))))))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(SimpleName:executeForcedly)(METHOD_INVOCATION_ARGUMENTS(SimpleName:task)(SimpleName:retainedLock)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InterruptedException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace))))))))(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:run)(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:sync))(SingleVariableDeclaration(SimpleType(SimpleName:Lock))(SimpleName:lo))(Block(IfStatement(MethodInvocation(SimpleName:isAllowedThread)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lo))(SimpleName:isWriteLock))))(Block(ExpressionStatement(Assignment(SimpleName:executed)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ExpressionStatement(MethodInvocation(SimpleName:invokeRun)(METHOD_INVOCATION_ARGUMENTS(SimpleName:task)(BooleanLiteral:false)(SimpleName:lo)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lo))(SimpleName:retain)))(ExpressionStatement(Assignment(SimpleName:retainedLock)(ASSIGNMENT_OPERATOR:=)(SimpleName:lo)))(SynchronizedStatement(ThisExpression)(Block(ExpressionStatement(MethodInvocation(SimpleName:notifyAll)))))))))))(IfStatement(InstanceofExpression(SimpleName:task)(SimpleType(SimpleName:Helper)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:task))(SimpleName:run)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sync)(SimpleName:lock)))))(IfStatement(MethodInvocation(SimpleName:isAllowedThread)(METHOD_INVOCATION_ARGUMENTS(SimpleName:write)))(Block(ExpressionStatement(MethodInvocation(SimpleName:invokeRun)(METHOD_INVOCATION_ARGUMENTS(SimpleName:task)(SimpleName:sync)(SimpleName:lock)))))(Block(ExpressionStatement(MethodInvocation(SimpleName:executeInAllowedThread)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Helper)))))))))))))