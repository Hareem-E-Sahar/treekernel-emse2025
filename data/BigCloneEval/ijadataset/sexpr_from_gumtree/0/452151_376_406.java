(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:addMetadata)(SingleVariableDeclaration(SimpleType(SimpleName:Request))(SimpleName:request))(SingleVariableDeclaration(SimpleType(SimpleName:Entry))(SimpleName:entry))(SingleVariableDeclaration(SimpleType(SimpleName:ZipOutputStream))(SimpleName:zos))(SingleVariableDeclaration(SimpleType(SimpleName:Metadata))(SimpleName:metadata))(SingleVariableDeclaration(SimpleType(SimpleName:Element))(SimpleName:node))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MetadataType))(VariableDeclarationFragment(SimpleName:type)(MethodInvocation(SimpleName:getType)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:metadata))(SimpleName:getType))))))(IfStatement(InfixExpression(SimpleName:type)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:metadata))(SimpleName:getType)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Document))(VariableDeclarationFragment(SimpleName:doc)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:node))(SimpleName:getOwnerDocument))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:metadataNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XmlUtil))(SimpleName:create)(METHOD_INVOCATION_ARGUMENTS(SimpleName:doc)(SimpleName:TAG_METADATA)(SimpleName:node)(ArrayCreation(ArrayType(SimpleType(SimpleName:String))(Dimension))(ArrayInitializer(SimpleName:ATTR_TYPE)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:metadata))(SimpleName:getType))))))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:MetadataElement))(SimpleName:element))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:type))(SimpleName:getChildren))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:index)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:element))(SimpleName:getIndex))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:value)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:metadata))(SimpleName:getAttr)(METHOD_INVOCATION_ARGUMENTS(SimpleName:index)))))(IfStatement(InfixExpression(SimpleName:value)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ContinueStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:attrNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XmlUtil))(SimpleName:create)(METHOD_INVOCATION_ARGUMENTS(SimpleName:doc)(QualifiedName:Metadata.TAG_ATTR)(SimpleName:metadataNode)(ArrayCreation(ArrayType(SimpleType(SimpleName:String))(Dimension))(ArrayInitializer(QualifiedName:Metadata.ATTR_INDEX)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:index))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attrNode))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XmlUtil))(SimpleName:makeCDataNode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:doc)(SimpleName:value)(BooleanLiteral:true))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:zos)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:element))(SimpleName:getDataType)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:element.DATATYPE_FILE))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:f)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:type))(SimpleName:getFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:entry)(SimpleName:metadata)(SimpleName:element)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:f)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:exists))))(ContinueStatement))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:fileName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:repository))(SimpleName:getGUID))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attrNode))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:fileName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zos))(SimpleName:putNextEntry)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ZipEntry))(SimpleName:fileName)))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:fis)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getStorageManager)))(SimpleName:getFileInputStream)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:f))(SimpleName:toString))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtil))(SimpleName:writeTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fis)(SimpleName:zos)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtil))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fis))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zos))(SimpleName:closeEntry)))))))))))))