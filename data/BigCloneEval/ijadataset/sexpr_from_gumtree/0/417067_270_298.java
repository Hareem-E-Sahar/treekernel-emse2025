(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:void)(SimpleName:signHelper)(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:workerId))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:requestId))(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:Integer))(ArrayType(PrimitiveType:byte)(Dimension)))(SimpleName:dataGroups))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:signerDoesHashing))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:digestAlg))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:sigAlg))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:Integer))(ArrayType(PrimitiveType:byte)(Dimension)))(VariableDeclarationFragment(SimpleName:expectedHashes)))(IfStatement(SimpleName:signerDoesHashing)(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:d)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestAlg)(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:expectedHashes)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:Integer))(ArrayType(PrimitiveType:byte)(Dimension))))))(EnhancedForStatement(SingleVariableDeclaration(ParameterizedType(SimpleType(QualifiedName:Map.Entry))(SimpleType(SimpleName:Integer))(ArrayType(PrimitiveType:byte)(Dimension)))(SimpleName:entry))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dataGroups))(SimpleName:entrySet))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:expectedHashes))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:d))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getValue)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:d))(SimpleName:reset))))))(Block(ExpressionStatement(Assignment(SimpleName:expectedHashes)(ASSIGNMENT_OPERATOR:=)(SimpleName:dataGroups)))))(VariableDeclarationStatement(SimpleType(SimpleName:SODSignResponse))(VariableDeclarationFragment(SimpleName:res)(CastExpression(SimpleType(SimpleName:SODSignResponse))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:workerSession))(SimpleName:process)(METHOD_INVOCATION_ARGUMENTS(SimpleName:workerId)(ClassInstanceCreation(SimpleType(SimpleName:SODSignRequest))(SimpleName:requestId)(SimpleName:dataGroups))(ClassInstanceCreation(SimpleType(SimpleName:RequestContext))))))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:res))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:requestId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:getRequestID)))))(VariableDeclarationStatement(SimpleType(SimpleName:Certificate))(VariableDeclarationFragment(SimpleName:signercert)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:getSignerCertificate))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signercert))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:sodBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:getProcessedData))))(VariableDeclarationStatement(SimpleType(SimpleName:SODFile))(VariableDeclarationFragment(SimpleName:sod)(ClassInstanceCreation(SimpleType(SimpleName:SODFile))(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(SimpleName:sodBytes)))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:verify)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sod))(SimpleName:checkDocSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signercert)))))(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:verify))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:Integer))(ArrayType(PrimitiveType:byte)(Dimension)))(VariableDeclarationFragment(SimpleName:actualDataGroupHashes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sod))(SimpleName:getDataGroupHashes))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:expectedHashes))(SimpleName:size))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:actualDataGroupHashes))(SimpleName:size)))))(EnhancedForStatement(SingleVariableDeclaration(ParameterizedType(SimpleType(QualifiedName:Map.Entry))(SimpleType(SimpleName:Integer))(ArrayType(PrimitiveType:byte)(Dimension)))(SimpleName:entry))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:actualDataGroupHashes))(SimpleName:entrySet))(Block(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getKey)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:expectedHashes))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getKey))))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getValue)))))))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestAlg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sod))(SimpleName:getDigestAlgorithm)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sigAlg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sod))(SimpleName:getDigestEncryptionAlgorithm)))))))))