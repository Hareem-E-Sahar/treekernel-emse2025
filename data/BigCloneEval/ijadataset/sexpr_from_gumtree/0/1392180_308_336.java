(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:getSigndata)(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:NoSuchProviderException))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:CMSException))(SimpleType(SimpleName:CertificateEncodingException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:digestAlgOID)(QualifiedName:CMSSignedGenerator.DIGEST_SHA1)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:encAlgOID)(QualifiedName:CMSSignedGenerator.ENCRYPTION_RSA)))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:dig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestAlgOID)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bo)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:content))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bo))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bo))(SimpleName:toByteArray)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:contentDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:digest))))(VariableDeclarationStatement(SimpleType(SimpleName:DEREncodableVector))(VariableDeclarationFragment(SimpleName:v)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:PKCSObjectIdentifiers.pkcs_9_at_contentType)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(QualifiedName:PKCSObjectIdentifiers.data))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:PKCSObjectIdentifiers.pkcs_9_at_signingTime)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(ClassInstanceCreation(SimpleType(SimpleName:DERUTCTime))(SimpleName:signDate)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:PKCSObjectIdentifiers.pkcs_9_at_messageDigest)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(SimpleName:contentDigest)))))))(IfStatement(InfixExpression(SimpleName:certificate)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:reset)))(VariableDeclarationStatement(SimpleType(SimpleName:ESSCertID))(VariableDeclarationFragment(SimpleName:essCertid)(ClassInstanceCreation(SimpleType(SimpleName:ESSCertID))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificate))(SimpleName:getEncoded)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:PKCSObjectIdentifiers.id_aa_signingCertificate)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(ClassInstanceCreation(SimpleType(SimpleName:SigningCertificate))(SimpleName:essCertid)))))))))(ExpressionStatement(Assignment(SimpleName:signedAttr)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:v))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bOut)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:DEROutputStream))(VariableDeclarationFragment(SimpleName:dOut)(ClassInstanceCreation(SimpleType(SimpleName:DEROutputStream))(SimpleName:bOut))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dOut))(SimpleName:writeObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedAttr))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:dataToBeSigned)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bOut))(SimpleName:toByteArray))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:reset)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataToBeSigned))))(ExpressionStatement(Assignment(SimpleName:dataToBeSignedDigest)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:digest))))(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmIdentifier))(VariableDeclarationFragment(SimpleName:algId)(ClassInstanceCreation(SimpleType(SimpleName:AlgorithmIdentifier))(ClassInstanceCreation(SimpleType(SimpleName:DERObjectIdentifier))(SimpleName:digestAlgOID))(ClassInstanceCreation(SimpleType(SimpleName:DERNull))))))(ExpressionStatement(Assignment(SimpleName:contentDigestInfo)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DigestInfo))(SimpleName:algId)(SimpleName:dataToBeSignedDigest))))(ReturnStatement(SimpleName:dataToBeSigned))))))