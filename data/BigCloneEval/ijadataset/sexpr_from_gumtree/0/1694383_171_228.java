(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:readMessage)(SimpleType(SimpleName:SocketException))(SimpleType(SimpleName:IOException))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:reset)))(ExpressionStatement(Assignment(SimpleName:read)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:readBufferedData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:initial)(NumberLiteral:0)(SimpleName:cipherlen)))))(ExpressionStatement(Assignment(SimpleName:cipher)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithms))(SimpleName:getCipher))))(ExpressionStatement(Assignment(SimpleName:hmac)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithms))(SimpleName:getHmac))))(ExpressionStatement(Assignment(SimpleName:compression)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithms))(SimpleName:getCompression))))(IfStatement(InfixExpression(SimpleName:cipher)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:cipherlen)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:getBlockSize)))))(Block(ExpressionStatement(Assignment(SimpleName:cipherlen)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:8)))))(IfStatement(InfixExpression(QualifiedName:initial.length)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:cipherlen))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tmp)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:cipherlen))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:initial)(NumberLiteral:0)(SimpleName:tmp)(NumberLiteral:0)(QualifiedName:initial.length))))(ExpressionStatement(Assignment(SimpleName:initial)(ASSIGNMENT_OPERATOR:=)(SimpleName:tmp)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:count)(SimpleName:read)))(IfStatement(InfixExpression(SimpleName:count)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:initial.length))(Block(ExpressionStatement(Assignment(SimpleName:count)(ASSIGNMENT_OPERATOR:+=)(MethodInvocation(SimpleName:readBufferedData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:initial)(SimpleName:count)(InfixExpression(QualifiedName:initial.length)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:count))))))))(IfStatement(InfixExpression(SimpleName:hmac)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:maclen)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hmac))(SimpleName:getMacLength)))))(Block(ExpressionStatement(Assignment(SimpleName:maclen)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))))(IfStatement(InfixExpression(SimpleName:cipher)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:initial)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:transform)(METHOD_INVOCATION_ARGUMENTS(SimpleName:initial)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:initial))))(ExpressionStatement(Assignment(SimpleName:msglen)(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:int)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteArrayReader))(SimpleName:readInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:initial)(NumberLiteral:0))))))(ExpressionStatement(Assignment(SimpleName:padlen)(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:initial)(NumberLiteral:4))))(ExpressionStatement(Assignment(SimpleName:remaining)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(InfixExpression(SimpleName:msglen)(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(SimpleName:cipherlen)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:4)))))))(WhileStatement(InfixExpression(SimpleName:remaining)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:read)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:readBufferedData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:remaining)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:data.length)))(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:remaining)(INFIX_EXPRESSION_OPERATOR:/)(SimpleName:cipherlen)))(INFIX_EXPRESSION_OPERATOR:*)(SimpleName:cipherlen)))(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(QualifiedName:data.length)(INFIX_EXPRESSION_OPERATOR:/)(SimpleName:cipherlen)))(INFIX_EXPRESSION_OPERATOR:*)(SimpleName:cipherlen))))))))(ExpressionStatement(Assignment(SimpleName:remaining)(ASSIGNMENT_OPERATOR:-=)(SimpleName:read)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:cipher)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:transform)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(SimpleName:read))))(NumberLiteral:0)(SimpleName:read))))))(SynchronizedStatement(SimpleName:sequenceLock)(Block(IfStatement(InfixExpression(SimpleName:hmac)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:read)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:readBufferedData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(SimpleName:maclen)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(SimpleName:read))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hmac))(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sequenceNo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:toByteArray)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))))(IfStatement(InfixExpression(SimpleName:sequenceNo)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:sequenceWrapLimit))(Block(ExpressionStatement(PostfixExpression(SimpleName:sequenceNo)(POSTFIX_EXPRESSION_OPERATOR:++))))(Block(ExpressionStatement(Assignment(SimpleName:sequenceNo)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))))))(ExpressionStatement(Assignment(SimpleName:bytesTransfered)(ASSIGNMENT_OPERATOR:+=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:size))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:msg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:toByteArray))))(IfStatement(InfixExpression(SimpleName:compression)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:compression))(SimpleName:uncompress)(METHOD_INVOCATION_ARGUMENTS(SimpleName:msg)(NumberLiteral:5)(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:msglen)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:4)))(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:padlen)(NumberLiteral:5)))))))(ReturnStatement(SimpleName:msg))))))