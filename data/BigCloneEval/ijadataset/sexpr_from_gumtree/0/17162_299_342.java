(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:void)(SimpleName:doDecrypt)(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:createOutput))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:FileInputStream))(VariableDeclarationFragment(SimpleName:input)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:output)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:tempOutput)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:input)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(SimpleName:infile))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cipherBaseFilename)(MethodInvocation(SimpleName:basename)(METHOD_INVOCATION_ARGUMENTS(SimpleName:infile)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:magic)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(QualifiedName:MAGIC.length))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:input))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:magic))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:MAGIC.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(ArrayAccess(SimpleName:MAGIC)(SimpleName:i))(INFIX_EXPRESSION_OPERATOR:!=)(ArrayAccess(SimpleName:magic)(SimpleName:i)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))))(VariableDeclarationStatement(PrimitiveType:short)(VariableDeclarationFragment(SimpleName:version)(MethodInvocation(SimpleName:readShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:input)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:version)(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:1000))(INFIX_EXPRESSION_OPERATOR:>)(InfixExpression(SimpleName:VERSION)(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:1000)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:version)(StringLiteral:<STR>)(SimpleName:VERSION)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cipherName)(MethodInvocation(SimpleName:readString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:input)))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:cipher)(MethodInvocation(SimpleName:createCipher)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipherName)(MethodInvocation(SimpleName:createSessionKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)(SimpleName:cipherBaseFilename)))))))(VariableDeclarationStatement(SimpleType(SimpleName:CipherInputStream))(VariableDeclarationFragment(SimpleName:decryptedInput)(ClassInstanceCreation(SimpleType(SimpleName:CipherInputStream))(SimpleName:input)(SimpleName:cipher))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:headerCrc)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Unsigned))(SimpleName:promote)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:readInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:decryptedInput)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:decryptedInput))(SimpleName:resetCRC)))(ExpressionStatement(Assignment(SimpleName:outfile)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:outputDir)(MethodInvocation(SimpleName:readString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:decryptedInput))))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:createOutput))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outfile))(SimpleName:exists)))(Block(ExpressionStatement(Assignment(SimpleName:skipped)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ReturnStatement)))(ExpressionStatement(Assignment(SimpleName:tempOutput)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:File))(SimpleName:createTempFile)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(NullLiteral)(SimpleName:outputDir)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tempOutput))(SimpleName:deleteOnExit)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buffer)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:BUFFER_SIZE))))))(ExpressionStatement(Assignment(SimpleName:output)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:tempOutput))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bytesRead)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:bytesRead)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:decryptedInput))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buffer)))))(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buffer)(NumberLiteral:0)(SimpleName:bytesRead)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output))(SimpleName:close)))(ExpressionStatement(Assignment(SimpleName:output)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:headerCrc)(INFIX_EXPRESSION_OPERATOR:!=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:decryptedInput))(SimpleName:getCRC)))(Block(ExpressionStatement(Assignment(SimpleName:outfile)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tempOutput))(SimpleName:renameTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:outfile))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:tempOutput)(StringLiteral:<STR>)(SimpleName:outfile)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outfile))(SimpleName:setLastModified)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:infile))(SimpleName:lastModified))))))(Block(ExpressionStatement(MethodInvocation(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:input))))(ExpressionStatement(MethodInvocation(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:output))))(IfStatement(InfixExpression(SimpleName:tempOutput)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tempOutput))(SimpleName:delete))))))))))