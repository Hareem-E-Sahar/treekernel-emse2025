(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:signPdf)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:src))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:dest))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:withTS))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:withOCSP))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:DocumentException))(SimpleType(SimpleName:GeneralSecurityException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:keystore)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:password)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:ks)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:load)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(SimpleName:keystore))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:password))(SimpleName:toCharArray)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:alias)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:aliases)))(SimpleName:nextElement)))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:pk)(CastExpression(SimpleType(SimpleName:PrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:getKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:password))(SimpleName:toCharArray)))))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:chain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:getCertificateChain)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfReader))(VariableDeclarationFragment(SimpleName:reader)(ClassInstanceCreation(SimpleType(SimpleName:PdfReader))(SimpleName:src))))(VariableDeclarationStatement(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:fout)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:dest))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfStamper))(VariableDeclarationFragment(SimpleName:stp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfStamper))(SimpleName:createSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(SimpleName:fout)(CharacterLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignatureAppearance))(VariableDeclarationFragment(SimpleName:sap)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:stp))(SimpleName:getSignatureAppearance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setVisibleSignature)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Rectangle))(NumberLiteral:72)(NumberLiteral:732)(NumberLiteral:144)(NumberLiteral:780))(NumberLiteral:1)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCrypto)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:chain)(NullLiteral)(QualifiedName:PdfSignatureAppearance.SELF_SIGNED))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignature))(VariableDeclarationFragment(SimpleName:dic)(ClassInstanceCreation(SimpleType(SimpleName:PdfSignature))(QualifiedName:PdfName.ADOBE_PPKLITE)(ClassInstanceCreation(SimpleType(SimpleName:PdfName))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setReason)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getReason)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setLocation)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getLocation)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setContact)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getContact)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:setDate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:PdfDate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getSignDate))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCryptoDictionary)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:contentEstimated)(NumberLiteral:15000)))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer)))(VariableDeclarationFragment(SimpleName:exc)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exc))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(ClassInstanceCreation(SimpleType(SimpleName:Integer))(InfixExpression(InfixExpression(SimpleName:contentEstimated)(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:preClose)(METHOD_INVOCATION_ARGUMENTS(SimpleName:exc))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getRangeStream))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:messageDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:buf)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8192))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:n)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:n)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(NumberLiteral:0)(SimpleName:n))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:hash)(Dimension)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(VariableDeclarationStatement(SimpleType(SimpleName:Calendar))(VariableDeclarationFragment(SimpleName:cal)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Calendar))(SimpleName:getInstance))))(VariableDeclarationStatement(SimpleType(SimpleName:TSAClient))(VariableDeclarationFragment(SimpleName:tsc)(NullLiteral)))(IfStatement(SimpleName:withTS)(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:tsa_url)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:tsa_login)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:tsa_passw)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:tsc)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:TSAClientBouncyCastle))(SimpleName:tsa_url)(SimpleName:tsa_login)(SimpleName:tsa_passw))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ocsp)(NullLiteral)))(IfStatement(SimpleName:withOCSP)(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:url)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfPKCS7))(SimpleName:getOCSPURL)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(NumberLiteral:0)))))))(VariableDeclarationStatement(SimpleType(SimpleName:CertificateFactory))(VariableDeclarationFragment(SimpleName:cf)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:FileInputStream))(VariableDeclarationFragment(SimpleName:is)(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:properties))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:root)(CastExpression(SimpleType(SimpleName:X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cf))(SimpleName:generateCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:is))))))(ExpressionStatement(Assignment(SimpleName:ocsp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:OcspClientBouncyCastle))))(SimpleName:getEncoded)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(NumberLiteral:0)))(SimpleName:root)(SimpleName:url)))))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfPKCS7))(VariableDeclarationFragment(SimpleName:sgn)(ClassInstanceCreation(SimpleType(SimpleName:PdfPKCS7))(SimpleName:pk)(SimpleName:chain)(NullLiteral)(StringLiteral:<STR>)(NullLiteral)(BooleanLiteral:false))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:sh)(Dimension)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sgn))(SimpleName:getAuthenticatedAttributeBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:cal)(SimpleName:ocsp)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sgn))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sh)(NumberLiteral:0)(QualifiedName:sh.length))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encodedSig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sgn))(SimpleName:getEncodedPKCS7)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:cal)(SimpleName:tsc)(SimpleName:ocsp)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:contentEstimated)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:encodedSig.length))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:DocumentException))(StringLiteral:<STR>))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:paddedSig)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:contentEstimated))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encodedSig)(NumberLiteral:0)(SimpleName:paddedSig)(NumberLiteral:0)(QualifiedName:encodedSig.length))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfDictionary))(VariableDeclarationFragment(SimpleName:dic2)(ClassInstanceCreation(SimpleType(SimpleName:PdfDictionary)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic2))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:PdfString))(SimpleName:paddedSig)))(SimpleName:setHexWriting)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic2))))))))