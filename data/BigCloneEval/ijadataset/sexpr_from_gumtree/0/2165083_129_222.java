(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(SimpleType(SimpleName:PrivateKeyHolder))(SimpleName:build)(Block(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:time)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:subject)(FieldAccess(ThisExpression)(SimpleName:subject))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:keyPair)(FieldAccess(ThisExpression)(SimpleName:keyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:SignatureType))(VariableDeclarationFragment(SimpleName:signType)(FieldAccess(ThisExpression)(SimpleName:signType))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:issuer)(FieldAccess(ThisExpression)(SimpleName:issuerName))))(VariableDeclarationStatement(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:serialNumber)(FieldAccess(ThisExpression)(SimpleName:serialNumber))))(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:notBefore)(FieldAccess(ThisExpression)(SimpleName:notBefore))))(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:notAfter)(FieldAccess(ThisExpression)(SimpleName:notAfter))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:certificate)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:privateKey)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:keyPair)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:keyPair)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyPairGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:KeyPairType.RSA))(SimpleName:getAlgorithm)))))(SimpleName:generateKeyPair))))))(IfStatement(InfixExpression(SimpleName:signType)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:signType)(ASSIGNMENT_OPERATOR:=)(QualifiedName:SignatureType.SHA1_RSA)))))(IfStatement(InfixExpression(SimpleName:issuer)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:issuer)(ASSIGNMENT_OPERATOR:=)(QualifiedName:BouncyCastleCertificateBuilder.DEFAULT_ISSUER)))))(IfStatement(InfixExpression(SimpleName:serialNumber)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:serialNumber)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BigInteger))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:time)))))))(IfStatement(InfixExpression(SimpleName:notBefore)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DateBuilder))(VariableDeclarationFragment(SimpleName:dateBuilder)(ClassInstanceCreation(SimpleType(SimpleName:DateBuilder))(SimpleName:time))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dateBuilder))(SimpleName:removeDays)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1))))(ExpressionStatement(Assignment(SimpleName:notBefore)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dateBuilder))(SimpleName:getDate))))))(IfStatement(InfixExpression(SimpleName:notAfter)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DateBuilder))(VariableDeclarationFragment(SimpleName:dateBuilder)(ClassInstanceCreation(SimpleType(SimpleName:DateBuilder))(SimpleName:time))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dateBuilder))(SimpleName:addYears)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1))))(ExpressionStatement(Assignment(SimpleName:notAfter)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dateBuilder))(SimpleName:getDate))))))(IfStatement(FieldAccess(ThisExpression)(SimpleName:v3))(Block(VariableDeclarationStatement(SimpleType(SimpleName:JcaX509v3CertificateBuilder))(VariableDeclarationFragment(SimpleName:builder)(NullLiteral)))(IfStatement(InfixExpression(FieldAccess(ThisExpression)(SimpleName:issuerCertificate))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:builder)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:JcaX509v3CertificateBuilder))(CastExpression(SimpleType(SimpleName:X509Certificate))(FieldAccess(ThisExpression)(SimpleName:issuerCertificate)))(SimpleName:serialNumber)(SimpleName:notBefore)(SimpleName:notAfter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BouncyCastleProviderHelper))(SimpleName:toX500Principal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic))))))(Block(ExpressionStatement(Assignment(SimpleName:builder)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:JcaX509v3CertificateBuilder))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BouncyCastleProviderHelper))(SimpleName:toX500Name)(METHOD_INVOCATION_ARGUMENTS(SimpleName:issuer)))(SimpleName:serialNumber)(SimpleName:notBefore)(SimpleName:notAfter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BouncyCastleProviderHelper))(SimpleName:toX500Name)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic)))))))(VariableDeclarationStatement(SimpleType(SimpleName:JcaContentSignerBuilder))(VariableDeclarationFragment(SimpleName:contentSignerBuilder)(ClassInstanceCreation(SimpleType(SimpleName:JcaContentSignerBuilder))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signType))(SimpleName:getAlgorithm)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentSignerBuilder))(SimpleName:setProvider)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:BouncyCastleProviderHelper.PROVIDER_NAME))))(VariableDeclarationStatement(SimpleType(SimpleName:ContentSigner))(VariableDeclarationFragment(SimpleName:contentSigner)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentSignerBuilder))(SimpleName:build)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:keyUsage)))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:usage)(NumberLiteral:0)))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:KeyUsageType))(SimpleName:keyUsage))(FieldAccess(ThisExpression)(SimpleName:keyUsage))(Block(ExpressionStatement(Assignment(SimpleName:usage)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:usage)(INFIX_EXPRESSION_OPERATOR:|)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:toKeyUsage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyUsage))))))))(VariableDeclarationStatement(SimpleType(QualifiedName:org.bouncycastle.asn1.x509.KeyUsage))(VariableDeclarationFragment(SimpleName:ku)(ClassInstanceCreation(SimpleType(QualifiedName:org.bouncycastle.asn1.x509.KeyUsage))(SimpleName:usage))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:addExtension)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Extension.keyUsage)(BooleanLiteral:false)(SimpleName:ku))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:extendedKeyUsage)))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Vector))(SimpleType(SimpleName:DERObject)))(VariableDeclarationFragment(SimpleName:vector)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:Vector))(SimpleType(SimpleName:DERObject))))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:ExtendedKeyUsageType))(SimpleName:keyUsageType))(FieldAccess(ThisExpression)(SimpleName:extendedKeyUsage))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeyPurposeId))(VariableDeclarationFragment(SimpleName:keyPurposeId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:toExtendedKeyUsage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyUsageType)))))(IfStatement(InfixExpression(SimpleName:keyPurposeId)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vector))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyPurposeId))))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vector))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:org.bouncycastle.asn1.x509.ExtendedKeyUsage))(VariableDeclarationFragment(SimpleName:extendedKeyUsage)(ClassInstanceCreation(SimpleType(QualifiedName:org.bouncycastle.asn1.x509.ExtendedKeyUsage))(SimpleName:vector))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:addExtension)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Extension.extendedKeyUsage)(BooleanLiteral:true)(SimpleName:extendedKeyUsage)))))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:org.bouncycastle.asn1.x509.ExtendedKeyUsage))(VariableDeclarationFragment(SimpleName:extendedKeyUsage)(ClassInstanceCreation(SimpleType(QualifiedName:org.bouncycastle.asn1.x509.ExtendedKeyUsage))(QualifiedName:KeyPurposeId.anyExtendedKeyUsage))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:addExtension)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Extension.extendedKeyUsage)(BooleanLiteral:false)(SimpleName:extendedKeyUsage)))))))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:org.bouncycastle.asn1.x509.ExtendedKeyUsage))(VariableDeclarationFragment(SimpleName:extendedKeyUsage)(ClassInstanceCreation(SimpleType(QualifiedName:org.bouncycastle.asn1.x509.ExtendedKeyUsage))(QualifiedName:KeyPurposeId.anyExtendedKeyUsage))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:addExtension)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Extension.extendedKeyUsage)(BooleanLiteral:false)(SimpleName:extendedKeyUsage))))))(VariableDeclarationStatement(SimpleType(SimpleName:GeneralNames))(VariableDeclarationFragment(SimpleName:subjectAltName)(ClassInstanceCreation(SimpleType(SimpleName:GeneralNames))(ClassInstanceCreation(SimpleType(SimpleName:GeneralName))(QualifiedName:GeneralName.rfc822Name)(SimpleName:subject)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:addExtension)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Extension.subjectAlternativeName)(BooleanLiteral:false)(SimpleName:subjectAltName))))(VariableDeclarationStatement(SimpleType(SimpleName:SubjectKeyIdentifierStructure))(VariableDeclarationFragment(SimpleName:subjectKeyIdentifierStructure)(ClassInstanceCreation(SimpleType(SimpleName:SubjectKeyIdentifierStructure))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:addExtension)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Extension.subjectKeyIdentifier)(BooleanLiteral:false)(SimpleName:subjectKeyIdentifierStructure))))(VariableDeclarationStatement(SimpleType(SimpleName:X509CertificateHolder))(VariableDeclarationFragment(SimpleName:holder)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:build)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentSigner)))))(ExpressionStatement(Assignment(SimpleName:certificate)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecurityUtils))(SimpleName:getCertificateFromFile)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:holder))(SimpleName:getEncoded))(QualifiedName:CertificateType.X509))))))(ExpressionStatement(Assignment(SimpleName:privateKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:JcaX509v1CertificateBuilder))(VariableDeclarationFragment(SimpleName:builder)(ClassInstanceCreation(SimpleType(SimpleName:JcaX509v1CertificateBuilder))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BouncyCastleProviderHelper))(SimpleName:toX500Name)(METHOD_INVOCATION_ARGUMENTS(SimpleName:issuer)))(SimpleName:serialNumber)(SimpleName:notBefore)(SimpleName:notAfter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BouncyCastleProviderHelper))(SimpleName:toX500Name)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic)))))(VariableDeclarationStatement(SimpleType(SimpleName:JcaContentSignerBuilder))(VariableDeclarationFragment(SimpleName:contentSignerBuilder)(ClassInstanceCreation(SimpleType(SimpleName:JcaContentSignerBuilder))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signType))(SimpleName:getAlgorithm)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentSignerBuilder))(SimpleName:setProvider)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:BouncyCastleProviderHelper.PROVIDER_NAME))))(VariableDeclarationStatement(SimpleType(SimpleName:ContentSigner))(VariableDeclarationFragment(SimpleName:contentSigner)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentSignerBuilder))(SimpleName:build)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate))))))(VariableDeclarationStatement(SimpleType(SimpleName:X509CertificateHolder))(VariableDeclarationFragment(SimpleName:holder)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:build)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentSigner)))))(ExpressionStatement(Assignment(SimpleName:certificate)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecurityUtils))(SimpleName:getCertificateFromFile)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:holder))(SimpleName:getEncoded))(QualifiedName:CertificateType.X509))))))(ExpressionStatement(Assignment(SimpleName:privateKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate))))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKeyHolder))(VariableDeclarationFragment(SimpleName:privateKeyHolder)(ClassInstanceCreation(SimpleType(SimpleName:PrivateKeyHolder))(SimpleName:privateKey)(ArrayCreation(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(ArrayInitializer(SimpleName:certificate))))))(ReturnStatement(SimpleName:privateKeyHolder)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CertificateException))(SimpleName:e))))))))))