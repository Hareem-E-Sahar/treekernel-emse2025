(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:static)(SimpleType(SimpleName:String))(SimpleName:rsToChaiXML)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:ChaiResponseSet))(SimpleName:rs))(SimpleType(SimpleName:ChaiValidationException))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:rootElement)(ClassInstanceCreation(SimpleType(SimpleName:Element))(SimpleName:XML_NODE_ROOT))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rootElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_MIN_RANDOM_REQUIRED)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rs))(SimpleName:getChallengeSet)))(SimpleName:getMinRandomRequired)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rootElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_LOCALE)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rs))(SimpleName:getChallengeSet)))(SimpleName:getLocale)))(SimpleName:toString)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rootElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_VERSION)(SimpleName:VALUE_VERSION))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rootElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_CHAI_VERSION)(QualifiedName:ChaiConstant.CHAI_API_VERSION))))(IfStatement(QualifiedName:rs.caseInsensitive)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rootElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_CASE_INSENSITIVE)(StringLiteral:<STR>))))))(IfStatement(InfixExpression(QualifiedName:rs.csIdentifier)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rootElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_CHALLENGE_SET_IDENTIFER)(QualifiedName:rs.csIdentifier))))))(IfStatement(InfixExpression(QualifiedName:rs.timestamp)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rootElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_TIMESTAMP)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DATE_FORMATTER))(SimpleName:format)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:rs.timestamp))))))))(EnhancedForStatement(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:Challenge))(SimpleName:loopChallenge))(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:rs.crMap))(SimpleName:keySet))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:loopResponseText)(ConditionalExpression(QualifiedName:rs.caseInsensitive)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:rs.crMap))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:loopChallenge))))(SimpleName:toLowerCase))(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:rs.crMap))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:loopChallenge))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:loopElement)(ClassInstanceCreation(SimpleType(SimpleName:Element))(SimpleName:XML_NODE_RESPONSE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopElement))(SimpleName:addContent)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:Element))(SimpleName:XML_NODE_CHALLENGE)))(SimpleName:addContent)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:CDATA))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopChallenge))(SimpleName:getChallengeText))))))))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:contentElement)(ClassInstanceCreation(SimpleType(SimpleName:Element))(SimpleName:XML_NODE_ANSWER_VALUE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XNL_ATTRIBUTE_CONTENT_FORMAT)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:rs.formatType))(SimpleName:toString)))))(SwitchStatement(QualifiedName:rs.formatType)(SwitchCase(SimpleName:TEXT))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentElement))(SimpleName:addContent)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:CDATA))(SimpleName:loopResponseText)))))(BreakStatement)(SwitchCase(SimpleName:SHA1_SALT))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:salt)(MethodInvocation(SimpleName:generateSalt)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:32)))))(ExpressionStatement(Assignment(SimpleName:loopResponseText)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:salt)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:loopResponseText))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_SALT)(SimpleName:salt))))(SwitchCase(SimpleName:SHA1))(TryStatement(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(Modifier:final)(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hashedAnswer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(SimpleName:loopResponseText)))(SimpleName:getBytes))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:encodedAnswer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Base64Util))(SimpleName:encodeBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hashedAnswer)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentElement))(SimpleName:addContent)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:CDATA))(SimpleName:encodedAnswer))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOGGER))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopElement))(SimpleName:addContent)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentElement)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_ADMIN_DEFINED)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopChallenge))(SimpleName:isAdminDefined)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ATTRIBUTE_REQUIRED)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopChallenge))(SimpleName:isRequired)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XNL_ATTRIBUTE_MIN_LENGTH)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopChallenge))(SimpleName:getMinLength)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopElement))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XNL_ATTRIBUTE_MAX_LENGTH)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loopChallenge))(SimpleName:getMaxLength)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rootElement))(SimpleName:addContent)(METHOD_INVOCATION_ARGUMENTS(SimpleName:loopElement))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:Document))(VariableDeclarationFragment(SimpleName:doc)(ClassInstanceCreation(SimpleType(SimpleName:Document))(SimpleName:rootElement))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:XMLOutputter))(VariableDeclarationFragment(SimpleName:outputter)(ClassInstanceCreation(SimpleType(SimpleName:XMLOutputter)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outputter))(SimpleName:setFormat)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Format))(SimpleName:getCompactFormat)))(SimpleName:setTextMode)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Format.TextMode.NORMALIZE))))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outputter))(SimpleName:outputString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:doc))))))))