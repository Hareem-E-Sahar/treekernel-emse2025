(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:gw_soundness_proof))(SimpleName:getLatestProof)(Block(VariableDeclarationStatement(SimpleType(SimpleName:gw_signed_ss_set_config))(VariableDeclarationFragment(SimpleName:latest_config)(MethodInvocation(SimpleName:getLatestConfig))))(IfStatement(InfixExpression(SimpleName:_versionMapLog)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(EnhancedForStatement(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:BigInteger))(SimpleType(SimpleName:gw_log_entry)))(SimpleName:logEntries))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_versionMapLog))(SimpleName:values))(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logEntries))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>=)(QualifiedName:latest_config.config.threshold))(Block(VariableDeclarationStatement(SimpleType(SimpleName:gw_soundness_proof))(VariableDeclarationFragment(SimpleName:proof)(MethodInvocation(SimpleName:createProofFromLog)(METHOD_INVOCATION_ARGUMENTS(SimpleName:extent_key)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logEntries))(SimpleName:values))(TypeLiteral(SimpleType(SimpleName:gw_soundness_proof)))(SimpleName:_md)))))(IfStatement(InfixExpression(SimpleName:proof)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XdrUtils))(SimpleName:serialize)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:proof.cert.cert))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XdrUtils))(SimpleName:serialize)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:proof.config.config))))))(VariableDeclarationStatement(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:hash)(MethodInvocation(SimpleName:byteArrayToBigInteger)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_md))(SimpleName:digest))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:KeyTriple))(SimpleType(SimpleName:Long))(SimpleType(SimpleName:Long))(SimpleType(SimpleName:BigInteger)))(VariableDeclarationFragment(SimpleName:proofKey)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:KeyTriple))(SimpleType(SimpleName:Long))(SimpleType(SimpleName:Long))(SimpleType(SimpleName:BigInteger)))(QualifiedName:proof.config.config.seq_num)(QualifiedName:proof.cert.cert.seq_num)(SimpleName:hash))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_versionMapProof))(SimpleName:containsKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:proofKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_versionMapProof))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:proofKey)(SimpleName:proof)))))))))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:KeyTriple))(SimpleType(SimpleName:Long))(SimpleType(SimpleName:Long))(SimpleType(SimpleName:BigInteger)))(VariableDeclarationFragment(SimpleName:latestProofKey)(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:_versionMapProof)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_versionMapProof))(SimpleName:lastKey))(NullLiteral)))))(VariableDeclarationStatement(SimpleType(SimpleName:gw_soundness_proof))(VariableDeclarationFragment(SimpleName:latest_proof)(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:latestProofKey)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_versionMapProof))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:latestProofKey)))(NullLiteral)))))(ReturnStatement(SimpleName:latest_proof))))))