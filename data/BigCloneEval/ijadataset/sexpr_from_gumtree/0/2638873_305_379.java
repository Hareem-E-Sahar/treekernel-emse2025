(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(Modifier:synchronized)(PrimitiveType:void)(SimpleName:doLogin)(SingleVariableDeclaration(PrimitiveType:long)(SimpleName:timeout))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:eventMask))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:AuthenticationFailedException))(SimpleType(SimpleName:TimeoutException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ChallengeAction))(VariableDeclarationFragment(SimpleName:challengeAction)))(VariableDeclarationStatement(SimpleType(SimpleName:ManagerResponse))(VariableDeclarationFragment(SimpleName:challengeResponse)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:challenge)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:key)))(VariableDeclarationStatement(SimpleType(SimpleName:LoginAction))(VariableDeclarationFragment(SimpleName:loginAction)))(VariableDeclarationStatement(SimpleType(SimpleName:ManagerResponse))(VariableDeclarationFragment(SimpleName:loginResponse)))(IfStatement(InfixExpression(SimpleName:socket)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(SimpleName:connect)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:socket))(SimpleName:isConnected)))(Block(ExpressionStatement(MethodInvocation(SimpleName:connect)))))(SynchronizedStatement(SimpleName:protocolIdentifier)(Block(IfStatement(InfixExpression(QualifiedName:protocolIdentifier.value)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:protocolIdentifier))(SimpleName:wait)(METHOD_INVOCATION_ARGUMENTS(SimpleName:timeout)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InterruptedException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Thread))(SimpleName:currentThread)))(SimpleName:interrupt))))))))(IfStatement(InfixExpression(QualifiedName:protocolIdentifier.value)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(SimpleName:disconnect)))(IfStatement(InfixExpression(InfixExpression(SimpleName:reader)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getTerminationException))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ThrowStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getTerminationException))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TimeoutException))(StringLiteral:<STR>)))))))))(ExpressionStatement(Assignment(SimpleName:challengeAction)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ChallengeAction))(StringLiteral:<STR>))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:challengeResponse)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:sendAction)(METHOD_INVOCATION_ARGUMENTS(SimpleName:challengeAction))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:disconnect)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:AuthenticationFailedException))(StringLiteral:<STR>)(SimpleName:e))))))(IfStatement(InstanceofExpression(SimpleName:challengeResponse)(SimpleType(SimpleName:ChallengeResponse)))(Block(ExpressionStatement(Assignment(SimpleName:challenge)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:ChallengeResponse))(SimpleName:challengeResponse))))(SimpleName:getChallenge)))))(Block(ExpressionStatement(MethodInvocation(SimpleName:disconnect)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:AuthenticationFailedException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:challengeResponse))(SimpleName:getMessage)))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)))(ExpressionStatement(Assignment(SimpleName:md)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:challenge)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:challenge))(SimpleName:getBytes)))))))(IfStatement(InfixExpression(SimpleName:password)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:password))(SimpleName:getBytes)))))))(ExpressionStatement(Assignment(SimpleName:key)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ManagerUtil))(SimpleName:toHexString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(SimpleName:disconnect)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:AuthenticationFailedException))(StringLiteral:<STR>)(SimpleName:ex))))))(ExpressionStatement(Assignment(SimpleName:loginAction)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:LoginAction))(SimpleName:username)(StringLiteral:<STR>)(SimpleName:key)(SimpleName:eventMask))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:loginResponse)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:sendAction)(METHOD_INVOCATION_ARGUMENTS(SimpleName:loginAction))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:disconnect)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:AuthenticationFailedException))(StringLiteral:<STR>)(SimpleName:e))))))(IfStatement(InstanceofExpression(SimpleName:loginResponse)(SimpleType(SimpleName:ManagerError)))(Block(ExpressionStatement(MethodInvocation(SimpleName:disconnect)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:AuthenticationFailedException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:loginResponse))(SimpleName:getMessage))))))(ExpressionStatement(Assignment(SimpleName:version)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:determineVersion))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:setTargetVersion)(METHOD_INVOCATION_ARGUMENTS(SimpleName:version))))(VariableDeclarationStatement(SimpleType(SimpleName:ConnectEvent))(VariableDeclarationFragment(SimpleName:connectEvent)(ClassInstanceCreation(SimpleType(SimpleName:ConnectEvent))(ThisExpression))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:connectEvent))(SimpleName:setProtocolIdentifier)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getProtocolIdentifier)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:connectEvent))(SimpleName:setDateReceived)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DateUtil))(SimpleName:getDate)))))(ExpressionStatement(MethodInvocation(SimpleName:fireEvent)(METHOD_INVOCATION_ARGUMENTS(SimpleName:connectEvent))))))))