(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:synchronized)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:encrypt)(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:buf))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:off))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:len))(SingleVariableDeclaration(SimpleType(SimpleName:ContentType))(SimpleName:type))(SimpleType(SimpleName:SSLException))(SimpleType(SimpleName:OverflowException))(Block(IfStatement(InfixExpression(SimpleName:deflater)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf2)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:1024))))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bout)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream))(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:1)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:deflater))(SimpleName:setInput)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(SimpleName:off)(SimpleName:len))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:deflater))(SimpleName:finish)))(ExpressionStatement(Assignment(SimpleName:len)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:len)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:deflater))(SimpleName:deflate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf2)))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bout))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf2)(NumberLiteral:0)(SimpleName:len)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bout))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>)(InfixExpression(SimpleName:fragmentLength)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1024)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:OverflowException))(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:buf)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bout))(SimpleName:toByteArray))))(ExpressionStatement(Assignment(SimpleName:off)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(ExpressionStatement(Assignment(SimpleName:len)(ASSIGNMENT_OPERATOR:=)(QualifiedName:buf.length)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:deflater))(SimpleName:reset)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:mac)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:0))))))(IfStatement(InfixExpression(SimpleName:outMac)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:outSequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:56)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:outSequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:48)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:outSequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:40)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:outSequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:32)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:outSequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:24)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:outSequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:16)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:outSequence)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:8)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(SimpleName:outSequence)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:type))(SimpleName:getValue))))))(IfStatement(InfixExpression(SimpleName:version)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:ProtocolVersion.SSL_3))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:version))(SimpleName:getMajor))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:version))(SimpleName:getMinor))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:8)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(SimpleName:len)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(SimpleName:off)(SimpleName:len))))(ExpressionStatement(Assignment(SimpleName:mac)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:digest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outMac))(SimpleName:reset)))))(ExpressionStatement(PostfixExpression(SimpleName:outSequence)(POSTFIX_EXPRESSION_OPERATOR:++)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:pad)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:0))))))(IfStatement(InfixExpression(SimpleName:outCipher)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:padLen)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outCipher))(SimpleName:currentBlockSize))(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:mac.length)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:%)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outCipher))(SimpleName:currentBlockSize)))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:version)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:ProtocolVersion.SSL_3))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(QualifiedName:session.random)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:padLen)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Math))(SimpleName:abs)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:session.random))(SimpleName:nextInt))))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:7)))(INFIX_EXPRESSION_OPERATOR:*)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outCipher))(SimpleName:currentBlockSize)))))(WhileStatement(InfixExpression(SimpleName:padLen)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:255))(Block(ExpressionStatement(Assignment(SimpleName:padLen)(ASSIGNMENT_OPERATOR:-=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outCipher))(SimpleName:currentBlockSize))))))))(ExpressionStatement(Assignment(SimpleName:pad)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:padLen)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:fill)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pad)(CastExpression(PrimitiveType:byte)(SimpleName:padLen)))))))(VariableDeclarationStatement(Modifier:final)(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:fraglen)(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:mac.length)(QualifiedName:pad.length))))(IfStatement(InfixExpression(SimpleName:outCipher)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf2)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:fraglen))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(SimpleName:off)(SimpleName:buf2)(NumberLiteral:0)(SimpleName:len))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac)(NumberLiteral:0)(SimpleName:buf2)(SimpleName:len)(QualifiedName:mac.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pad)(NumberLiteral:0)(SimpleName:buf2)(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:mac.length))(QualifiedName:pad.length))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outCipher))(SimpleName:currentBlockSize))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:fraglen))(Assignment(SimpleName:i)(ASSIGNMENT_OPERATOR:+=)(SimpleName:bs))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outCipher))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf2)(SimpleName:i)(SimpleName:buf2)(SimpleName:i))))))(ReturnStatement(SimpleName:buf2)))(IfStatement(InfixExpression(SimpleName:outRandom)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf2)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:fraglen))))))(ExpressionStatement(MethodInvocation(SimpleName:transformRC4)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(SimpleName:off)(SimpleName:len)(SimpleName:buf2)(NumberLiteral:0)(SimpleName:outRandom))))(ExpressionStatement(MethodInvocation(SimpleName:transformRC4)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac)(NumberLiteral:0)(QualifiedName:mac.length)(SimpleName:buf2)(SimpleName:len)(SimpleName:outRandom))))(ReturnStatement(SimpleName:buf2)))(Block(IfStatement(InfixExpression(QualifiedName:mac.length)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(Block(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:trim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(SimpleName:off)(SimpleName:len)))))(Block(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:concat)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:trim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(SimpleName:off)(SimpleName:len)))(SimpleName:mac)))))))))))))