(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:boolean)(SimpleName:sendImage)(SingleVariableDeclaration(SimpleType(SimpleName:Molecule))(SimpleName:data))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:os))(VariableDeclarationFragment(SimpleName:os2)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:is))(VariableDeclarationFragment(SimpleName:is2)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ObjectOutputStream))(VariableDeclarationFragment(SimpleName:oos)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ObjectInputStream))(VariableDeclarationFragment(SimpleName:ois)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:StreamConnection))(VariableDeclarationFragment(SimpleName:con)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:GZIPOutputStream))(VariableDeclarationFragment(SimpleName:gzout)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bos)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayInputStream))(VariableDeclarationFragment(SimpleName:bis)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:data)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)))))(Block(ExpressionStatement(Assignment(SimpleName:data)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:NewXMLtoMolecule))(ClassInstanceCreation(SimpleType(SimpleName:File))(StringLiteral:<STR>))))(SimpleName:getMolecule))))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:con)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:StreamConnection))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Connector))(SimpleName:open)(METHOD_INVOCATION_ARGUMENTS(SimpleName:serverConnectionString))))))(ExpressionStatement(Assignment(SimpleName:os)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:openOutputStream))))(ExpressionStatement(Assignment(SimpleName:is)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:openInputStream))))(ExpressionStatement(Assignment(SimpleName:oos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ObjectOutputStream))(SimpleName:os))))(ExpressionStatement(Assignment(SimpleName:ois)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ObjectInputStream))(SimpleName:is))))(ExpressionStatement(Assignment(SimpleName:bos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPairGenerator))(VariableDeclarationFragment(SimpleName:keyGen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyPairGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmParameterGenerator))(VariableDeclarationFragment(SimpleName:paramGen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AlgorithmParameterGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:paramGen))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:512)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecureRandom))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmParameters))(VariableDeclarationFragment(SimpleName:params)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:paramGen))(SimpleName:generateParameters))))(VariableDeclarationStatement(SimpleType(SimpleName:DHParameterSpec))(VariableDeclarationFragment(SimpleName:dhSpec)(CastExpression(SimpleType(SimpleName:DHParameterSpec))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:getParameterSpec)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:DHParameterSpec))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyGen))(SimpleName:initialize)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dhSpec))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:keypair)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyGen))(SimpleName:generateKeyPair))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:privateKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypair))(SimpleName:getPrivate))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:publicKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypair))(SimpleName:getPublic))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getFormat)))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:rempub)(NullLiteral)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ourpublicKeyBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getEncoded))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:theirpublicKeyBytes)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(SimpleName:toHexString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ourpublicKeyBytes)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oos))(SimpleName:writeObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:publicKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Thread))(SimpleName:sleep)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1000))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:theirpublicKeyBytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:PublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ois))(SimpleName:readObject)))))(SimpleName:getEncoded))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(SimpleName:toHexString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:theirpublicKeyBytes)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:X509EncodedKeySpec))(VariableDeclarationFragment(SimpleName:x509KeySpec)(ClassInstanceCreation(SimpleType(SimpleName:X509EncodedKeySpec))(SimpleName:theirpublicKeyBytes))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyFactory))(VariableDeclarationFragment(SimpleName:keyFact)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:rempub)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyFact))(SimpleName:generatePublic)(METHOD_INVOCATION_ARGUMENTS(SimpleName:x509KeySpec)))))(VariableDeclarationStatement(SimpleType(SimpleName:DHParameterSpec))(VariableDeclarationFragment(SimpleName:paramspec)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:DHPublicKey))(SimpleName:rempub))))(SimpleName:getParams))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyAgreement))(VariableDeclarationFragment(SimpleName:ka)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyAgreement))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ka))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(SimpleName:privateKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ka))(SimpleName:doPhase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rempub)(BooleanLiteral:true))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:algorithm)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:SecretKey))(VariableDeclarationFragment(SimpleName:secretKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ka))(SimpleName:generateSecret)(METHOD_INVOCATION_ARGUMENTS(SimpleName:algorithm)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:toHexString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secretKey))(SimpleName:getEncoded)))))))(VariableDeclarationStatement(SimpleType(SimpleName:SecretKeySpec))(VariableDeclarationFragment(SimpleName:skeySpec)(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secretKey))(SimpleName:getEncoded))(SimpleName:algorithm))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:c)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:algorithm)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:skeySpec))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oos))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oos))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:close)))(ExpressionStatement(Assignment(SimpleName:os2)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:openOutputStream))))(ExpressionStatement(Assignment(SimpleName:oos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ObjectOutputStream))(SimpleName:os2))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:ttim)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))(VariableDeclarationStatement(SimpleType(SimpleName:NewMoleculetoXML))(VariableDeclarationFragment(SimpleName:mxml)(ClassInstanceCreation(SimpleType(SimpleName:NewMoleculetoXML))(SimpleName:data))))(VariableDeclarationStatement(SimpleType(QualifiedName:org.jdom.Document))(VariableDeclarationFragment(SimpleName:doc)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mxml))(SimpleName:getDocument))))(VariableDeclarationStatement(SimpleType(SimpleName:XMLOutputter))(VariableDeclarationFragment(SimpleName:out)(ClassInstanceCreation(SimpleType(SimpleName:XMLOutputter)))))(VariableDeclarationStatement(SimpleType(SimpleName:SealedObject))(VariableDeclarationFragment(SimpleName:so)(ClassInstanceCreation(SimpleType(SimpleName:SealedObject))(SimpleName:doc)(SimpleName:c))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oos))(SimpleName:writeObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:so))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oos))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:ttim)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oos))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oos))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os2))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os2))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:con))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e2))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e2))(SimpleName:printStackTrace)))(ReturnStatement(BooleanLiteral:false))))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:java.security.InvalidKeyException))(SimpleName:e))(Block))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:java.security.spec.InvalidKeySpecException))(SimpleName:e))(Block))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:java.security.InvalidAlgorithmParameterException))(SimpleName:e))(Block))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:java.security.NoSuchAlgorithmException))(SimpleName:e))(Block)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ReturnStatement(BooleanLiteral:true))))))