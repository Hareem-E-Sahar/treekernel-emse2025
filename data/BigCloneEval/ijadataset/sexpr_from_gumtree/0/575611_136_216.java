(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:test_GetPermissions)(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:PermissionCollection))(VariableDeclarationFragment(SimpleName:c)))(VariableDeclarationStatement(SimpleType(SimpleName:Permission))(VariableDeclarationFragment(SimpleName:per)))(VariableDeclarationStatement(SimpleType(SimpleName:Subject))(VariableDeclarationFragment(SimpleName:subject)))(VariableDeclarationStatement(SimpleType(SimpleName:CodeSource))(VariableDeclarationFragment(SimpleName:source)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:oldProp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:POLICY_PROP)))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:setProperty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:POLICY_PROP)(SimpleName:inputFile1))))(VariableDeclarationStatement(SimpleType(SimpleName:Policy))(VariableDeclarationFragment(SimpleName:p)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Policy))(SimpleName:getPolicy))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:refresh)))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(NullLiteral)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:isReadOnly)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(Assignment(SimpleName:subject)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Subject)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:MyPrincipal))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:OtherPrincipal))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:FakePrincipal))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:MyPrincipal))(StringLiteral:<STR>)))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Enumeration))(SimpleType(SimpleName:Permission)))(VariableDeclarationFragment(SimpleName:e)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral))))(SimpleName:elements))))(ExpressionStatement(Assignment(SimpleName:per)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:nextElement))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:per)(ClassInstanceCreation(SimpleType(SimpleName:FilePermission))(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:source)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:CodeSource))(ClassInstanceCreation(SimpleType(SimpleName:URL))(StringLiteral:<STR>))(CastExpression(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(NullLiteral)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(SimpleName:source)))))(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(Assignment(SimpleName:source)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:CodeSource))(ClassInstanceCreation(SimpleType(SimpleName:URL))(StringLiteral:<STR>))(CastExpression(ArrayType(SimpleType(SimpleName:CodeSigner))(Dimension))(NullLiteral)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(SimpleName:source)))))(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(Assignment(SimpleName:source)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:CodeSource))(ClassInstanceCreation(SimpleType(SimpleName:URL))(StringLiteral:<STR>))(CastExpression(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(NullLiteral)))))(ExpressionStatement(Assignment(SimpleName:subject)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Subject)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:MyPrincipal))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:e)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(SimpleName:source))))(SimpleName:elements))))(ExpressionStatement(Assignment(SimpleName:per)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:nextElement))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:per)(ClassInstanceCreation(SimpleType(SimpleName:RuntimePermission))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:subject)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Subject)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(SimpleName:source)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:MyPrincipal))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:OtherPrincipal))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(Assignment(SimpleName:subject)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Subject)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:MyPrincipal))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:elements)))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:OtherPrincipal))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:e)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral))))(SimpleName:elements))))(ExpressionStatement(Assignment(SimpleName:per)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:nextElement))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:hasMoreElements)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:per)(ClassInstanceCreation(SimpleType(SimpleName:AllPermission))))))(ExpressionStatement(Assignment(SimpleName:subject)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Subject)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subject))(SimpleName:getPrincipals)))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:MyPrincipal))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:e)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getPermissions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subject)(NullLiteral))))(SimpleName:elements))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Permission))(Dimension))(VariableDeclarationFragment(SimpleName:get)(ArrayCreation(ArrayType(SimpleType(SimpleName:Permission))(Dimension(NumberLiteral:2))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:get)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:nextElement))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:get)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:nextElement))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:hasMoreElements)))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Permission))(Dimension))(VariableDeclarationFragment(SimpleName:set)(ArrayCreation(ArrayType(SimpleType(SimpleName:Permission))(Dimension(NumberLiteral:2))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:set)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:FilePermission))(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:set)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:RuntimePermission))(StringLiteral:<STR>))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:get)(NumberLiteral:0)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:set)(NumberLiteral:0))))(Block(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ArrayAccess(SimpleName:set)(NumberLiteral:1))(ArrayAccess(SimpleName:get)(NumberLiteral:1))))))(Block(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ArrayAccess(SimpleName:set)(NumberLiteral:0))(ArrayAccess(SimpleName:get)(NumberLiteral:1)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ArrayAccess(SimpleName:set)(NumberLiteral:1))(ArrayAccess(SimpleName:get)(NumberLiteral:0))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TestUtils))(SimpleName:setSystemProperty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:POLICY_PROP)(SimpleName:oldProp))))))))))