(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:signPDFwithKS)(SingleVariableDeclaration(SimpleType(SimpleName:KeyStore))(SimpleName:ks))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:alias))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:pwd))(SingleVariableDeclaration(ArrayType(SimpleType(SimpleName:File))(Dimension))(SimpleName:pdfFiles))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:suffix))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:reason))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:signatureVisibility))(SingleVariableDeclaration(SimpleType(SimpleName:Calendar))(SimpleName:cal))(SimpleType(SimpleName:OpenSignatureException))(SimpleType(SimpleName:KeyStoreException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:UnrecoverableKeyException))(Block(IfStatement(InfixExpression(InfixExpression(SimpleName:pdfFiles)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:ks)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:OpenSignatureException))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:cal)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:cal)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Calendar))(SimpleName:getInstance))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:asList)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:Object))(Dimension))(ArrayInitializer(StringLiteral:<STR>)(SimpleName:alias)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:asList)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pdfFiles)))(SimpleName:suffix)(SimpleName:reason)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Boolean))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureVisibility)))))))))))(IfStatement(InfixExpression(SimpleName:alias)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Enumeration))(VariableDeclarationFragment(SimpleName:aliases)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:aliases))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aliases))(SimpleName:hasMoreElements))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:alTmp)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aliases))(SimpleName:nextElement)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:alTmp)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:x509certificate)(CastExpression(SimpleType(SimpleName:X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:getCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alTmp))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:boolean)(Dimension))(VariableDeclarationFragment(SimpleName:keyUsage)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:x509certificate))(SimpleName:getKeyUsage))))(IfStatement(InfixExpression(InfixExpression(SimpleName:keyUsage)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:keyUsage)(NumberLiteral:1))(INFIX_EXPRESSION_OPERATOR:||)(ArrayAccess(SimpleName:keyUsage)(NumberLiteral:0)))))(Block(ExpressionStatement(Assignment(SimpleName:alias)(ASSIGNMENT_OPERATOR:=)(SimpleName:alTmp)))(BreakStatement)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:alias)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:key)(CastExpression(SimpleType(SimpleName:PrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:getKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pwd))(SimpleName:toCharArray)))))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:certs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:getCertificateChain)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:pdfFiles.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:pdfFiles)(SimpleName:i)))(SimpleName:getAbsolutePath))))))(TryStatement(Block(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:pdfFiles)(SimpleName:i)))(SimpleName:exists)))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:pdfFiles)(SimpleName:i)))(SimpleName:canRead))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:FileNotFoundException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:pdfFiles)(SimpleName:i)))(SimpleName:getAbsolutePath))(StringLiteral:<STR>))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:signatureBytes)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:128))))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:fOut)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:addSuffix)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:pdfFiles)(SimpleName:i))(SimpleName:suffix)(BooleanLiteral:true)))))(VariableDeclarationStatement(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:fos)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:fOut))))(VariableDeclarationStatement(SimpleType(SimpleName:BufferedOutputStream))(VariableDeclarationFragment(SimpleName:bos)(ClassInstanceCreation(SimpleType(SimpleName:BufferedOutputStream))(SimpleName:fos))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfReader))(VariableDeclarationFragment(SimpleName:reader)(MethodInvocation(SimpleName:createPDFReader)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:pdfFiles)(SimpleName:i))))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfStamperOSP))(VariableDeclarationFragment(SimpleName:stamper)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:typeSignatureSelected)))(Block(ExpressionStatement(Assignment(SimpleName:stamper)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfStamperOSP))(SimpleName:createSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(SimpleName:bos)(CharacterLiteral:<STR>)(NullLiteral)(BooleanLiteral:true))))))(Block(ExpressionStatement(Assignment(SimpleName:stamper)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfStamperOSP))(SimpleName:createSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(SimpleName:bos)(CharacterLiteral:<STR>)))))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignatureAppearanceOSP))(VariableDeclarationFragment(SimpleName:sap)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:stamper))(SimpleName:getSignatureAppearance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCrypto)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:certs)(NullLiteral)(QualifiedName:PdfSignatureAppearance.WINCER_SIGNED))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setReason)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reason))))(IfStatement(SimpleName:signatureVisibility)(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:typeSignatureSelected)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCertified)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setVisibleSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fieldName)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCertified)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:2))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fieldName))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setVisibleSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fieldName)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setVisibleSignature)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(QualifiedName:com.lowagie.text.Rectangle))(NumberLiteral:340)(NumberLiteral:600)(NumberLiteral:560)(NumberLiteral:700))(NumberLiteral:1)(NullLiteral))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setExternalDigest)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:128))))(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:20))))(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfDictionary))(VariableDeclarationFragment(SimpleName:dic)(ClassInstanceCreation(SimpleType(SimpleName:PdfDictionary)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.FT)(QualifiedName:PdfName.SIG))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.FILTER)(ClassInstanceCreation(SimpleType(SimpleName:PdfName))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.SUBFILTER)(ClassInstanceCreation(SimpleType(SimpleName:PdfName))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:cal)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.M)(ClassInstanceCreation(SimpleType(SimpleName:PdfDate))(SimpleName:cal))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.M)(ClassInstanceCreation(SimpleType(SimpleName:PdfNull))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.NAME)(ClassInstanceCreation(SimpleType(SimpleName:PdfString))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfPKCS7))(SimpleName:getSubjectFields)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:certs)(NumberLiteral:0))))))(SimpleName:getField)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.REASON)(ClassInstanceCreation(SimpleType(SimpleName:PdfString))(SimpleName:reason)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:setCryptoDictionary)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic))))(VariableDeclarationStatement(SimpleType(SimpleName:HashMap))(VariableDeclarationFragment(SimpleName:exc)(ClassInstanceCreation(SimpleType(SimpleName:HashMap)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exc))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(ClassInstanceCreation(SimpleType(SimpleName:Integer))(NumberLiteral:0x5002)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:preClose)(METHOD_INVOCATION_ARGUMENTS(SimpleName:exc))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:content)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtils))(SimpleName:streamToByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:getRangeStream))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:content)))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:signedAttributes)(MethodInvocation(SimpleName:buildSignedAttributes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:cal)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:bytesForSecondHash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtils))(SimpleName:toByteArray)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:signedAttributes))))))(VariableDeclarationStatement(SimpleType(SimpleName:Signature))(VariableDeclarationFragment(SimpleName:signature)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Signature))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signature))(SimpleName:initSign)(METHOD_INVOCATION_ARGUMENTS(SimpleName:key))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signature))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bytesForSecondHash))))(ExpressionStatement(Assignment(SimpleName:signatureBytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signature))(SimpleName:sign))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encodedPkcs7)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:DERConstructedSet))(VariableDeclarationFragment(SimpleName:digestAlgorithms)(ClassInstanceCreation(SimpleType(SimpleName:DERConstructedSet)))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:algos)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algos))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERObjectIdentifier))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algos))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERNull))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestAlgorithms))(SimpleName:addObject)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:algos)))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:ev)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ev))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERObjectIdentifier))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:DERSequence))(VariableDeclarationFragment(SimpleName:contentinfo)(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:ev))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:v)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:c)(NumberLiteral:0)))(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:certs.length))(PostfixExpression(SimpleName:c)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ASN1InputStream))(VariableDeclarationFragment(SimpleName:tempstream)(ClassInstanceCreation(SimpleType(SimpleName:ASN1InputStream))(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:certs)(SimpleName:c)))(SimpleName:getEncoded))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tempstream))(SimpleName:readObject)))))))(VariableDeclarationStatement(SimpleType(SimpleName:DERSet))(VariableDeclarationFragment(SimpleName:dercertificates)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:v))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:signerinfo)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERInteger))(NumberLiteral:1)))))(ExpressionStatement(Assignment(SimpleName:v)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertUtil))(SimpleName:getIssuer)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:certs)(NumberLiteral:0))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERInteger))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:certs)(NumberLiteral:0)))))(SimpleName:getSerialNumber))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:v)))))(ExpressionStatement(Assignment(SimpleName:v)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERObjectIdentifier))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERNull))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:v)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERTaggedObject))(BooleanLiteral:false)(NumberLiteral:0)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:signedAttributes))))))(ExpressionStatement(Assignment(SimpleName:v)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERObjectIdentifier))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERNull))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:v)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(SimpleName:signatureBytes)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:serverTimestamp)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:serverTimestamp))(SimpleName:toString))))))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:timestampHash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureBytes)))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:unsignedAttributes)(MethodInvocation(SimpleName:buildUnsignedAttributes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:timestampHash)(SimpleName:serverTimestamp)(SimpleName:usernameTimestamp)(SimpleName:passwordTimestamp)))))(IfStatement(InfixExpression(SimpleName:unsignedAttributes)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERTaggedObject))(BooleanLiteral:false)(NumberLiteral:1)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:unsignedAttributes))))))))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:body)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERInteger))(NumberLiteral:1)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestAlgorithms))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentinfo))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERTaggedObject))(BooleanLiteral:false)(NumberLiteral:0)(SimpleName:dercertificates)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:signerinfo))))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:whole)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:whole))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERObjectIdentifier))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:whole))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERTaggedObject))(NumberLiteral:0)(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:body))))))(ExpressionStatement(Assignment(SimpleName:encodedPkcs7)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtils))(SimpleName:toByteArray)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:whole)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExceptionConverter))(SimpleName:e))))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfDictionary))(VariableDeclarationFragment(SimpleName:dic2)(ClassInstanceCreation(SimpleType(SimpleName:PdfDictionary)))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:out)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(NumberLiteral:0x5000)(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:2)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encodedPkcs7)(NumberLiteral:0)(SimpleName:out)(NumberLiteral:0)(QualifiedName:encodedPkcs7.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dic2))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:PdfString))(SimpleName:out)))(SimpleName:setHexWriting)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sap))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dic2))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bos))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fos))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))