(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Test))(Modifier:public)(PrimitiveType:void)(SimpleName:testValidation)(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Proxy))(VariableDeclarationFragment(SimpleName:proxy)(ClassInstanceCreation(SimpleType(SimpleName:Proxy))(QualifiedName:Proxy.Type.HTTP)(ClassInstanceCreation(SimpleType(SimpleName:InetSocketAddress))(StringLiteral:<STR>)(NumberLiteral:8080)))))(VariableDeclarationStatement(SimpleType(SimpleName:NetworkConfig))(VariableDeclarationFragment(SimpleName:networkConfig)(ClassInstanceCreation(SimpleType(SimpleName:NetworkConfig))(StringLiteral:<STR>)(NumberLiteral:8080))))(VariableDeclarationStatement(SimpleType(SimpleName:URL))(VariableDeclarationFragment(SimpleName:url)(ClassInstanceCreation(SimpleType(SimpleName:URL))(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpsURLConnection))(VariableDeclarationFragment(SimpleName:connection)(CastExpression(SimpleType(SimpleName:HttpsURLConnection))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:openConnection)(METHOD_INVOCATION_ARGUMENTS(SimpleName:proxy))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:connection))(SimpleName:connect)))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:serverCertificates)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:connection))(SimpleName:getServerCertificates))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:X509Certificate)))(VariableDeclarationFragment(SimpleName:certificateChain)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:X509Certificate))))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Certificate))(SimpleName:certificate))(SimpleName:serverCertificates)(Block(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:x509Cert)(CastExpression(SimpleType(SimpleName:X509Certificate))(SimpleName:certificate))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:x509Cert))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:x509Cert)))))))(IfStatement(BooleanLiteral:true)(Block(ReturnStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:CertificatePathBuilder))(VariableDeclarationFragment(SimpleName:certificatePathBuilder)(ClassInstanceCreation(SimpleType(SimpleName:CertificatePathBuilder)))))(ExpressionStatement(Assignment(SimpleName:certificateChain)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificatePathBuilder))(SimpleName:buildPath)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificateChain)))))(VariableDeclarationStatement(SimpleType(SimpleName:MemoryCertificateRepository))(VariableDeclarationFragment(SimpleName:certificateRepository)(ClassInstanceCreation(SimpleType(SimpleName:MemoryCertificateRepository)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateRepository))(SimpleName:addTrustPoint)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))))(VariableDeclarationStatement(SimpleType(SimpleName:TrustValidator))(VariableDeclarationFragment(SimpleName:trustValidator)(ClassInstanceCreation(SimpleType(SimpleName:TrustValidator))(SimpleName:certificateRepository))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:trustValidator))(SimpleName:setAlgorithmPolicy)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:AlgorithmPolicy))(AnonymousClassDeclaration(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(PrimitiveType:void)(SimpleName:checkSignatureAlgorithm)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:signatureAlgorithm))(SimpleType(SimpleName:SignatureException))(Block)))))))(VariableDeclarationStatement(SimpleType(SimpleName:TrustValidatorDecorator))(VariableDeclarationFragment(SimpleName:trustValidatorDecorator)(ClassInstanceCreation(SimpleType(SimpleName:TrustValidatorDecorator))(SimpleName:networkConfig))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:trustValidatorDecorator))(SimpleName:addDefaultTrustLinkerConfig)(METHOD_INVOCATION_ARGUMENTS(SimpleName:trustValidator))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:trustValidator))(SimpleName:isTrusted)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificateChain))))))))