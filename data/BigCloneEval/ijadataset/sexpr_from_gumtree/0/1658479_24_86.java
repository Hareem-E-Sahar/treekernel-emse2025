(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(SimpleName:CMSG_SESSION_KEY)(SingleVariableDeclaration(SimpleType(SimpleName:ITrueRandom))(SimpleName:trueRandom_))(SingleVariableDeclaration(SimpleType(SimpleName:SMSG_PUBLIC_KEY))(SimpleName:keypacket_))(SimpleType(SimpleName:SSHSetupException))(Block(SuperConstructorInvocation)(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:_md5)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SSHSetupException))(StringLiteral:<STR>))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:anti_spoofing_cookie)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypacket_))(SimpleName:getAntiSpoofingCookie))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:server_key_public_modulus)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypacket_))(SimpleName:getServerKeyPublicModulus))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:host_key_public_modulus)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypacket_))(SimpleName:getHostKeyPublicModulus))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:server_key_public_exponent)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypacket_))(SimpleName:getServerKeyPublicExponent))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:host_key_public_exponent)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypacket_))(SimpleName:getHostKeyPublicExponent))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:supported_ciphers_mask)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keypacket_))(SimpleName:getSupportedCiphersMask))))(ExpressionStatement(Assignment(SimpleName:_session_id)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(QualifiedName:host_key_public_modulus.length)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:server_key_public_modulus.length)(QualifiedName:anti_spoofing_cookie.length)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:host_key_public_modulus)(NumberLiteral:0)(SimpleName:_session_id)(NumberLiteral:0)(QualifiedName:host_key_public_modulus.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:server_key_public_modulus)(NumberLiteral:0)(SimpleName:_session_id)(QualifiedName:host_key_public_modulus.length)(QualifiedName:server_key_public_modulus.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:anti_spoofing_cookie)(NumberLiteral:0)(SimpleName:_session_id)(InfixExpression(QualifiedName:host_key_public_modulus.length)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:server_key_public_modulus.length))(QualifiedName:anti_spoofing_cookie.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_md5))(SimpleName:reset)))(ExpressionStatement(Assignment(SimpleName:_session_id)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_md5))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:_session_id)))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:supported_ciphers_mask)(NumberLiteral:3))(INFIX_EXPRESSION_OPERATOR:&)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(NumberLiteral:1)(INFIX_EXPRESSION_OPERATOR:<<)(QualifiedName:Cipher.SSH_CIPHER_BLOWFISH))))))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:_cipher_type)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Cipher.SSH_CIPHER_BLOWFISH)))(ExpressionStatement(Assignment(SimpleName:_cipher_name)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(Block(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:supported_ciphers_mask)(NumberLiteral:3))(INFIX_EXPRESSION_OPERATOR:&)(ParenthesizedExpression(InfixExpression(NumberLiteral:1)(INFIX_EXPRESSION_OPERATOR:<<)(QualifiedName:Cipher.SSH_CIPHER_IDEA)))))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:_cipher_type)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Cipher.SSH_CIPHER_IDEA)))(ExpressionStatement(Assignment(SimpleName:_cipher_name)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(Block(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:supported_ciphers_mask)(NumberLiteral:3))(INFIX_EXPRESSION_OPERATOR:&)(ParenthesizedExpression(InfixExpression(NumberLiteral:1)(INFIX_EXPRESSION_OPERATOR:<<)(QualifiedName:Cipher.SSH_CIPHER_3DES)))))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:_cipher_type)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Cipher.SSH_CIPHER_3DES)))(ExpressionStatement(Assignment(SimpleName:_cipher_name)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SSHSetupException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Integer))(SimpleName:toString)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:supported_ciphers_mask)(NumberLiteral:3))(NumberLiteral:16))))))))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:random_bits1)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:16))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:random_bits2)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:16))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:trueRandom_))(SimpleName:getRandomBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:random_bits1))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:trueRandom_))(SimpleName:getRandomBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:random_bits2))))(ExpressionStatement(Assignment(SimpleName:_session_key)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SSHMisc))(SimpleName:concatenate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:random_bits1)(SimpleName:random_bits2)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:session_keyXored)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SSHMisc))(SimpleName:XORByteArrays)(METHOD_INVOCATION_ARGUMENTS(SimpleName:random_bits1)(SimpleName:_session_id)))))(ExpressionStatement(Assignment(SimpleName:session_keyXored)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SSHMisc))(SimpleName:concatenate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:session_keyXored)(SimpleName:random_bits2)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encrypted_session_key)))(IfStatement(InfixExpression(QualifiedName:server_key_public_modulus.length)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:host_key_public_modulus.length))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:server_key_encrypted_data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSAAlgorithm))(SimpleName:publicKeyEncrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:session_keyXored)(SimpleName:server_key_public_exponent)(SimpleName:server_key_public_modulus)(SimpleName:_md5)))))(ExpressionStatement(Assignment(SimpleName:encrypted_session_key)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSAAlgorithm))(SimpleName:publicKeyEncrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:server_key_encrypted_data)(SimpleName:host_key_public_exponent)(SimpleName:host_key_public_modulus)(SimpleName:_md5))))))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:server_key_encrypted_data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSAAlgorithm))(SimpleName:publicKeyEncrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:session_keyXored)(SimpleName:host_key_public_exponent)(SimpleName:host_key_public_modulus)(SimpleName:_md5)))))(ExpressionStatement(Assignment(SimpleName:encrypted_session_key)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSAAlgorithm))(SimpleName:publicKeyEncrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:server_key_encrypted_data)(SimpleName:server_key_public_exponent)(SimpleName:server_key_public_modulus)(SimpleName:_md5)))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:protocol_flags)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:4))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:protocol_flags)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(Assignment(ArrayAccess(SimpleName:protocol_flags)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(Assignment(ArrayAccess(SimpleName:protocol_flags)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(Assignment(ArrayAccess(SimpleName:protocol_flags)(NumberLiteral:3))(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:block_length)(InfixExpression(NumberLiteral:1)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)(QualifiedName:anti_spoofing_cookie.length)(NumberLiteral:2)(QualifiedName:encrypted_session_key.length)(QualifiedName:protocol_flags.length))))(ExpressionStatement(Assignment(SuperFieldAccess(SimpleName:_data))(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:block_length))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:offset)(NumberLiteral:0)))(ExpressionStatement(Assignment(ArrayAccess(SuperFieldAccess(SimpleName:_data))(PostfixExpression(SimpleName:offset)(POSTFIX_EXPRESSION_OPERATOR:++)))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(SimpleName:SSH_CMSG_SESSION_KEY))))(ExpressionStatement(Assignment(ArrayAccess(SuperFieldAccess(SimpleName:_data))(PostfixExpression(SimpleName:offset)(POSTFIX_EXPRESSION_OPERATOR:++)))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(SimpleName:_cipher_type))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:8))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(ArrayAccess(SuperFieldAccess(SimpleName:_data))(PostfixExpression(SimpleName:offset)(POSTFIX_EXPRESSION_OPERATOR:++)))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:anti_spoofing_cookie)(SimpleName:i)))))(ExpressionStatement(Assignment(ArrayAccess(SuperFieldAccess(SimpleName:_data))(PostfixExpression(SimpleName:offset)(POSTFIX_EXPRESSION_OPERATOR:++)))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:8)(INFIX_EXPRESSION_OPERATOR:*)(QualifiedName:encrypted_session_key.length)))(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SuperFieldAccess(SimpleName:_data))(PostfixExpression(SimpleName:offset)(POSTFIX_EXPRESSION_OPERATOR:++)))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:8)(INFIX_EXPRESSION_OPERATOR:*)(QualifiedName:encrypted_session_key.length)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:encrypted_session_key.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(ArrayAccess(SuperFieldAccess(SimpleName:_data))(PostfixExpression(SimpleName:offset)(POSTFIX_EXPRESSION_OPERATOR:++)))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:encrypted_session_key)(SimpleName:i)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:4))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(ArrayAccess(SuperFieldAccess(SimpleName:_data))(PostfixExpression(SimpleName:offset)(POSTFIX_EXPRESSION_OPERATOR:++)))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:protocol_flags)(SimpleName:i)))))))))