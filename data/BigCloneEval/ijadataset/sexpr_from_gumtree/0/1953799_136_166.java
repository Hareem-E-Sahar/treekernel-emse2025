(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(SimpleType(SimpleName:SignerInfo))(SimpleName:toSignerInfo)(SingleVariableDeclaration(SimpleType(SimpleName:DERObjectIdentifier))(SimpleName:contentType))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:SignatureException))(SimpleType(SimpleName:CertificateEncodingException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmIdentifier))(VariableDeclarationFragment(SimpleName:digAlgId)(ClassInstanceCreation(SimpleType(SimpleName:AlgorithmIdentifier))(ClassInstanceCreation(SimpleType(SimpleName:DERObjectIdentifier))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getDigestAlgOID)))(ClassInstanceCreation(SimpleType(SimpleName:DERNull))))))(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmIdentifier))(VariableDeclarationFragment(SimpleName:encAlgId)(MethodInvocation(SimpleName:getEncAlgorithmIdentifier)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getEncryptionAlgOID))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_digest))(SimpleName:digest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_digests))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:_digestOID)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hash))(SimpleName:clone)))))(VariableDeclarationStatement(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:parameters)(MethodInvocation(SimpleName:getBaseParameters)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentType)(SimpleName:digAlgId)(SimpleName:hash)))))(VariableDeclarationStatement(SimpleType(SimpleName:AttributeTable))(VariableDeclarationFragment(SimpleName:signed)(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:_sAttr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_sAttr))(SimpleName:getAttributes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Collections))(SimpleName:unmodifiableMap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:parameters)))))(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1Set))(VariableDeclarationFragment(SimpleName:signedAttr)(MethodInvocation(SimpleName:getAttributeSet)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signed)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tmp)))(IfStatement(InfixExpression(SimpleName:signedAttr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:tmp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedAttr))(SimpleName:getEncoded)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ASN1Encodable.DER))))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_signature))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1OctetString))(VariableDeclarationFragment(SimpleName:encDigest)(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_signature))(SimpleName:sign)))))(ExpressionStatement(Assignment(SimpleName:parameters)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getBaseParameters)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentType)(SimpleName:digAlgId)(SimpleName:hash)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:parameters))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributeTableGenerator.SIGNATURE)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encDigest))(SimpleName:getOctets)))(SimpleName:clone)))))(VariableDeclarationStatement(SimpleType(SimpleName:AttributeTable))(VariableDeclarationFragment(SimpleName:unsigned)(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:_unsAttr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_unsAttr))(SimpleName:getAttributes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Collections))(SimpleName:unmodifiableMap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:parameters)))))(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1Set))(VariableDeclarationFragment(SimpleName:unsignedAttr)(MethodInvocation(SimpleName:getAttributeSet)(METHOD_INVOCATION_ARGUMENTS(SimpleName:unsigned)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:cert)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getCertificate))))(VariableDeclarationStatement(SimpleType(SimpleName:SignerIdentifier))(VariableDeclarationFragment(SimpleName:signerIdentifier)))(IfStatement(InfixExpression(SimpleName:cert)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:TBSCertificateStructure))(VariableDeclarationFragment(SimpleName:tbs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TBSCertificateStructure))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ASN1Object))(SimpleName:fromByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getTBSCertificate))))))))(VariableDeclarationStatement(SimpleType(SimpleName:IssuerAndSerialNumber))(VariableDeclarationFragment(SimpleName:encSid)(ClassInstanceCreation(SimpleType(SimpleName:IssuerAndSerialNumber))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tbs))(SimpleName:getIssuer))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tbs))(SimpleName:getSerialNumber)))(SimpleName:getValue)))))(ExpressionStatement(Assignment(SimpleName:signerIdentifier)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SignerIdentifier))(SimpleName:encSid)))))(Block(ExpressionStatement(Assignment(SimpleName:signerIdentifier)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SignerIdentifier))(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(SimpleName:_subjectKeyID)))))))(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:SignerInfo))(SimpleName:signerIdentifier)(SimpleName:digAlgId)(SimpleName:signedAttr)(SimpleName:encAlgId)(SimpleName:encDigest)(SimpleName:unsignedAttr)))))))