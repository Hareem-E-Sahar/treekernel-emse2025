(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:protected)(PrimitiveType:boolean)(SimpleName:authenticate)(SingleVariableDeclaration(SimpleType(SimpleName:Request))(SimpleName:request))(SingleVariableDeclaration(SimpleType(SimpleName:Response))(SimpleName:response))(SingleVariableDeclaration(SimpleType(SimpleName:LoginConfig))(SimpleName:loginConfig))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:HttpServletRequest))(VariableDeclarationFragment(SimpleName:httpRequest)(CastExpression(SimpleType(SimpleName:HttpServletRequest))(SimpleName:request))))(VariableDeclarationStatement(SimpleType(SimpleName:Principal))(VariableDeclarationFragment(SimpleName:principal)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpRequest))(SimpleName:getUserPrincipal))))(IfStatement(InfixExpression(InfixExpression(SimpleName:principal)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:principal))(SimpleName:getName))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ReturnStatement(BooleanLiteral:true))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:codeParameter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpRequest))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:codeParameter)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:login)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpRequest))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:login)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:currentUri)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpRequest))(SimpleName:getRequestURL)))(SimpleName:toString))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpRequest))(SimpleName:getRequestURI))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendRedirect)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:page)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:currentUri))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendRedirect)(METHOD_INVOCATION_ARGUMENTS(SimpleName:page))))))(ReturnStatement(BooleanLiteral:false)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:currentUri)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpRequest))(SimpleName:getRequestURL)))(SimpleName:toString))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:queryString)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpRequest))(SimpleName:getQueryString))))(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:queryString)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:queryString)))))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:queryString))(SimpleName:contains)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:query)(StringLiteral:<STR>)))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:String))(Dimension))(VariableDeclarationFragment(SimpleName:paramPairArray)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:queryString))(SimpleName:split)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:paramPair))(SimpleName:paramPairArray)(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:paramPair))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:query))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:1))(ExpressionStatement(Assignment(SimpleName:query)(ASSIGNMENT_OPERATOR:+=)(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:query)(ASSIGNMENT_OPERATOR:+=)(SimpleName:paramPair)))))))(ExpressionStatement(Assignment(SimpleName:currentUri)(ASSIGNMENT_OPERATOR:+=)(SimpleName:query)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:encodedCurrentUri)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:URLEncoder))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:currentUri)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:myuriredirect)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpRequest))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:myuriredirect)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:encodedCurrentUri)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:URLEncoder))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:myuriredirect)(StringLiteral:<STR>)))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:redirectUri)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:encodedCurrentUri))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:uri)(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:APP_ID)(StringLiteral:<STR>)(SimpleName:SCOPE)(StringLiteral:<STR>)(SimpleName:redirectUri)(StringLiteral:<STR>)(SimpleName:DISPLAY_TYPE)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendRedirect)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri))))(ReturnStatement(BooleanLiteral:false)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:accessTokenUri)(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:APP_ID)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:APP_SECRET)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:codeParameter))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:responseAsString)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:URL))(VariableDeclarationFragment(SimpleName:url)(ClassInstanceCreation(SimpleType(SimpleName:URL))(SimpleName:accessTokenUri))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpURLConnection))(VariableDeclarationFragment(SimpleName:conn)(CastExpression(SimpleType(SimpleName:HttpURLConnection))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:openConnection)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:conn))(SimpleName:setDoOutput)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:conn))(SimpleName:setRequestMethod)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:conn))(SimpleName:setRequestProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:inputStream)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:conn))(SimpleName:getInputStream))))(ExpressionStatement(Assignment(SimpleName:responseAsString)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:convertStreamToString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inputStream))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:String))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:params)(MethodInvocation(SimpleName:parseJsonAsParams)(METHOD_INVOCATION_ARGUMENTS(SimpleName:responseAsString)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:vkUserId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:params))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:vkUserId)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:username)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:vkUserId))))(ExpressionStatement(Assignment(SimpleName:principal)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:GenericPrincipal))(NullLiteral)(SimpleName:username)(StringLiteral:<STR>)(SimpleName:roles))))(ExpressionStatement(MethodInvocation(SimpleName:register)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:response)(SimpleName:principal)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:principal))(SimpleName:getName))(StringLiteral:<STR>))))(ReturnStatement(BooleanLiteral:true)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:page)(StringLiteral:<STR>)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:sendRedirect)(METHOD_INVOCATION_ARGUMENTS(SimpleName:page))))(ReturnStatement(BooleanLiteral:false))))))))))