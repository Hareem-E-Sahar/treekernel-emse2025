(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:testStaleVersionedInstanceFoundOnLock)(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(SimpleName:readCommittedIsolationMaintained)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(ReturnStatement)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getDialect)))(SimpleName:doesReadCommittedCauseWritersToBlockReaders))(Block(ExpressionStatement(MethodInvocation(SimpleName:reportSkip)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ReturnStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:check)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:Session))(VariableDeclarationFragment(SimpleName:s1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getSessions)))(SimpleName:openSession))))(VariableDeclarationStatement(SimpleType(SimpleName:Transaction))(VariableDeclarationFragment(SimpleName:t1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:beginTransaction))))(VariableDeclarationStatement(SimpleType(SimpleName:Item))(VariableDeclarationFragment(SimpleName:item)(ClassInstanceCreation(SimpleType(SimpleName:Item))(SimpleName:check))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:save)(METHOD_INVOCATION_ARGUMENTS(SimpleName:item))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:t1))(SimpleName:commit)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:close)))(VariableDeclarationStatement(SimpleType(SimpleName:Long))(VariableDeclarationFragment(SimpleName:itemId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:item))(SimpleName:getId))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:initialVersion)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:item))(SimpleName:getVersion))))(ExpressionStatement(Assignment(SimpleName:s1)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getSessions)))(SimpleName:openSession))))(ExpressionStatement(Assignment(SimpleName:t1)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:beginTransaction))))(ExpressionStatement(Assignment(SimpleName:item)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:Item))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:Item)))(SimpleName:itemId))))))(VariableDeclarationStatement(SimpleType(SimpleName:Session))(VariableDeclarationFragment(SimpleName:s2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getSessions)))(SimpleName:openSession))))(VariableDeclarationStatement(SimpleType(SimpleName:Transaction))(VariableDeclarationFragment(SimpleName:t2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s2))(SimpleName:beginTransaction))))(VariableDeclarationStatement(SimpleType(SimpleName:Item))(VariableDeclarationFragment(SimpleName:item2)(CastExpression(SimpleType(SimpleName:Item))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s2))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:Item)))(SimpleName:itemId))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:item2))(SimpleName:setName)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:t2))(SimpleName:commit)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s2))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:lock)(METHOD_INVOCATION_ARGUMENTS(SimpleName:item)(QualifiedName:LockMode.READ))))(ExpressionStatement(Assignment(SimpleName:item2)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:Item))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:Item)))(SimpleName:itemId))))))(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:item)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:item2)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:check)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:item2))(SimpleName:getName)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:initialVersion)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:item2))(SimpleName:getVersion)))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:lock)(METHOD_INVOCATION_ARGUMENTS(SimpleName:item)(QualifiedName:LockMode.UPGRADE))))(ExpressionStatement(MethodInvocation(SimpleName:fail)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:StaleObjectStateException))(SimpleName:expected))(Block))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:SQLGrammarException))(SimpleName:t))(Block(IfStatement(InstanceofExpression(MethodInvocation(SimpleName:getDialect))(SimpleType(SimpleName:SQLServerDialect)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:t1))(SimpleName:rollback)))(ExpressionStatement(Assignment(SimpleName:t1)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:beginTransaction)))))(Block(ThrowStatement(SimpleName:t)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:t1))(SimpleName:commit)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:close)))(ExpressionStatement(Assignment(SimpleName:s1)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getSessions)))(SimpleName:openSession))))(ExpressionStatement(Assignment(SimpleName:t1)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:beginTransaction))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:createQuery)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:executeUpdate)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:t1))(SimpleName:commit)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s1))(SimpleName:close)))))))