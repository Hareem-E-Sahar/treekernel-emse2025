(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:main)(SingleVariableDeclaration(ArrayType(SimpleType(SimpleName:String))(Dimension))(SimpleName:args))(Block(IfStatement(InfixExpression(QualifiedName:args.length)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:2))(Block(ExpressionStatement(MethodInvocation(SimpleName:printUsage)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Security))(SimpleName:addProvider)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:IAIK))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Class))(VariableDeclarationFragment(SimpleName:eccProviderClass)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Class))(SimpleName:forName)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Provider))(VariableDeclarationFragment(SimpleName:eccProvider)(CastExpression(SimpleType(SimpleName:Provider))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:eccProviderClass))(SimpleName:newInstance)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Security))(SimpleName:addProvider)(METHOD_INVOCATION_ARGUMENTS(SimpleName:eccProvider)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block)))(VariableDeclarationStatement(SimpleType(SimpleName:Module))(VariableDeclarationFragment(SimpleName:pkcs11Module)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Module))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(NumberLiteral:0))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11Module))(SimpleName:initialize)(METHOD_INVOCATION_ARGUMENTS(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:Token))(VariableDeclarationFragment(SimpleName:token)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:selectToken)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pkcs11Module)(SimpleName:output_)(SimpleName:input_)))))(IfStatement(InfixExpression(SimpleName:token)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(VariableDeclarationStatement(SimpleType(SimpleName:TokenInfo))(VariableDeclarationFragment(SimpleName:tokenInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:getTokenInfo))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tokenInfo))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ArrayAccess(SimpleName:args)(NumberLiteral:1))))))(VariableDeclarationStatement(SimpleType(SimpleName:Session))(VariableDeclarationFragment(SimpleName:session)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:openAuthorizedSession)(METHOD_INVOCATION_ARGUMENTS(SimpleName:token)(QualifiedName:Token.SessionReadWriteBehavior.RW_SESSION)(SimpleName:output_)(SimpleName:input_)))))(VariableDeclarationStatement(SimpleType(SimpleName:CertificateFactory))(VariableDeclarationFragment(SimpleName:certificateFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:FileInputStream))(VariableDeclarationFragment(SimpleName:fileInputStream)(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(ArrayAccess(SimpleName:args)(NumberLiteral:1)))))(VariableDeclarationStatement(SimpleType(SimpleName:Collection))(VariableDeclarationFragment(SimpleName:certificateChain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateFactory))(SimpleName:generateCertificates)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fileInputStream)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:1))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(VariableDeclarationStatement(SimpleType(QualifiedName:iaik.x509.X509Certificate))(VariableDeclarationFragment(SimpleName:x509Certificate)(CastExpression(SimpleType(QualifiedName:iaik.x509.X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:iterator)))(SimpleName:next)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(SimpleName:x509Certificate))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:publicKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:x509Certificate))(SimpleName:getPublicKey))))(VariableDeclarationStatement(SimpleType(SimpleName:Object))(VariableDeclarationFragment(SimpleName:searchTemplate)(NullLiteral)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getAlgorithm)))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:java.security.interfaces.RSAPublicKey))(VariableDeclarationFragment(SimpleName:rsaPublicKey)(CastExpression(SimpleType(QualifiedName:java.security.interfaces.RSAPublicKey))(SimpleName:publicKey))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPrivateKey))(VariableDeclarationFragment(SimpleName:rsaPrivateKeySearchTemplate)(ClassInstanceCreation(SimpleType(SimpleName:RSAPrivateKey)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:modulus)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:iaik.pkcs.pkcs11.Util))(SimpleName:unsignedBigIntergerToByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaPublicKey))(SimpleName:getModulus))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaPrivateKeySearchTemplate))(SimpleName:getModulus)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:modulus))))(ExpressionStatement(Assignment(SimpleName:searchTemplate)(ASSIGNMENT_OPERATOR:=)(SimpleName:rsaPrivateKeySearchTemplate))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getAlgorithm)))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:java.security.interfaces.DSAPublicKey))(VariableDeclarationFragment(SimpleName:dsaPublicKey)(CastExpression(SimpleType(QualifiedName:java.security.interfaces.DSAPublicKey))(SimpleName:publicKey))))(VariableDeclarationStatement(SimpleType(SimpleName:DSAParams))(VariableDeclarationFragment(SimpleName:dsaParams)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dsaPublicKey))(SimpleName:getParams))))(VariableDeclarationStatement(SimpleType(SimpleName:DSAPrivateKey))(VariableDeclarationFragment(SimpleName:dsaPrivateKeySearchTemplate)(ClassInstanceCreation(SimpleType(SimpleName:DSAPrivateKey)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:g)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:iaik.pkcs.pkcs11.Util))(SimpleName:unsignedBigIntergerToByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dsaParams))(SimpleName:getG))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:p)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:iaik.pkcs.pkcs11.Util))(SimpleName:unsignedBigIntergerToByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dsaParams))(SimpleName:getP))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:q)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:iaik.pkcs.pkcs11.Util))(SimpleName:unsignedBigIntergerToByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dsaParams))(SimpleName:getQ))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dsaPrivateKeySearchTemplate))(SimpleName:getBase)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:g))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dsaPrivateKeySearchTemplate))(SimpleName:getPrime)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:p))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dsaPrivateKeySearchTemplate))(SimpleName:getSubprime)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:q))))(ExpressionStatement(Assignment(SimpleName:searchTemplate)(ASSIGNMENT_OPERATOR:=)(SimpleName:dsaPrivateKeySearchTemplate))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getAlgorithm)))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getAlgorithm)))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:javax.crypto.interfaces.DHPublicKey))(VariableDeclarationFragment(SimpleName:dhPublicKey)(CastExpression(SimpleType(QualifiedName:javax.crypto.interfaces.DHPublicKey))(SimpleName:publicKey))))(VariableDeclarationStatement(SimpleType(SimpleName:DHParameterSpec))(VariableDeclarationFragment(SimpleName:dhParams)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dhPublicKey))(SimpleName:getParams))))(VariableDeclarationStatement(SimpleType(SimpleName:DHPrivateKey))(VariableDeclarationFragment(SimpleName:dhPrivateKeySearchTemplate)(ClassInstanceCreation(SimpleType(SimpleName:DHPrivateKey)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:g)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:iaik.pkcs.pkcs11.Util))(SimpleName:unsignedBigIntergerToByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dhParams))(SimpleName:getG))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:p)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:iaik.pkcs.pkcs11.Util))(SimpleName:unsignedBigIntergerToByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dhParams))(SimpleName:getP))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dhPrivateKeySearchTemplate))(SimpleName:getBase)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:g))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dhPrivateKeySearchTemplate))(SimpleName:getPrime)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:p))))(ExpressionStatement(Assignment(SimpleName:searchTemplate)(ASSIGNMENT_OPERATOR:=)(SimpleName:dhPrivateKeySearchTemplate)))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:objectID)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:searchTemplate)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:findObjectsInit)(METHOD_INVOCATION_ARGUMENTS(SimpleName:searchTemplate))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Object))(Dimension))(VariableDeclarationFragment(SimpleName:foundKeyObjects)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:findObjects)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)))))(IfStatement(InfixExpression(QualifiedName:foundKeyObjects.length)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Key))(VariableDeclarationFragment(SimpleName:foundKey)(CastExpression(SimpleType(SimpleName:Key))(ArrayAccess(SimpleName:foundKeyObjects)(NumberLiteral:0)))))(ExpressionStatement(Assignment(SimpleName:objectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:foundKey))(SimpleName:getId)))(SimpleName:getByteArrayValue))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(SimpleName:foundKey)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:findObjectsFinal))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(QualifiedName:iaik.x509.X509Certificate))(VariableDeclarationFragment(SimpleName:currentCertificate)(SimpleName:x509Certificate)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:importedCompleteChain)(BooleanLiteral:false)))(WhileStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:importedCompleteChain))(Block(VariableDeclarationStatement(SimpleType(SimpleName:X509PublicKeyCertificate))(VariableDeclarationFragment(SimpleName:pkcs11X509PublicKeyCertificate)(ClassInstanceCreation(SimpleType(SimpleName:X509PublicKeyCertificate)))))(VariableDeclarationStatement(SimpleType(SimpleName:Name))(VariableDeclarationFragment(SimpleName:subjectName)(CastExpression(SimpleType(SimpleName:Name))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentCertificate))(SimpleName:getSubjectDN)))))(VariableDeclarationStatement(SimpleType(SimpleName:Name))(VariableDeclarationFragment(SimpleName:issuerName)(CastExpression(SimpleType(SimpleName:Name))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentCertificate))(SimpleName:getIssuerDN)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:subjectCommonName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subjectName))(SimpleName:getRDN)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ObjectID.commonName)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:issuerCommonName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:issuerName))(SimpleName:getRDN)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ObjectID.commonName)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:char)(Dimension))(VariableDeclarationFragment(SimpleName:label)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(InfixExpression(SimpleName:subjectCommonName)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(ParenthesizedExpression(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:issuerCommonName)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(InfixExpression(SimpleName:issuerCommonName)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(StringLiteral:<STR>)))(StringLiteral:<STR>))))(SimpleName:toCharArray))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:newObjectID)))(IfStatement(InfixExpression(SimpleName:objectID)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(IfStatement(InstanceofExpression(SimpleName:publicKey)(SimpleType(QualifiedName:java.security.interfaces.RSAPublicKey)))(Block(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(QualifiedName:java.security.interfaces.RSAPublicKey))(SimpleName:publicKey))))(SimpleName:getModulus)))(SimpleName:toByteArray))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digest))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newObjectID))))))(IfStatement(InstanceofExpression(SimpleName:publicKey)(SimpleType(QualifiedName:java.security.interfaces.DSAPublicKey)))(Block(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(QualifiedName:java.security.interfaces.DSAPublicKey))(SimpleName:publicKey))))(SimpleName:getY)))(SimpleName:toByteArray))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digest))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newObjectID))))))(Block(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentCertificate))(SimpleName:getFingerprint)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))))(Block(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(SimpleName:objectID)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encodedSubject)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Name))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentCertificate))(SimpleName:getSubjectDN)))))(SimpleName:getEncoded))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encodedIssuer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Name))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentCertificate))(SimpleName:getIssuerDN)))))(SimpleName:getEncoded))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:serialNumber)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentCertificate))(SimpleName:getSerialNumber)))(SimpleName:toByteArray))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11X509PublicKeyCertificate))(SimpleName:getToken)))(SimpleName:setBooleanValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Boolean.TRUE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11X509PublicKeyCertificate))(SimpleName:getPrivate)))(SimpleName:setBooleanValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Boolean.FALSE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11X509PublicKeyCertificate))(SimpleName:getLabel)))(SimpleName:setCharArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:label))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11X509PublicKeyCertificate))(SimpleName:getId)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newObjectID))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11X509PublicKeyCertificate))(SimpleName:getSubject)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encodedSubject))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11X509PublicKeyCertificate))(SimpleName:getIssuer)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encodedIssuer))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11X509PublicKeyCertificate))(SimpleName:getSerialNumber)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:serialNumber))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11X509PublicKeyCertificate))(SimpleName:getValue)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentCertificate))(SimpleName:getEncoded)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pkcs11X509PublicKeyCertificate))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:createObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pkcs11X509PublicKeyCertificate))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:currentCertificate)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(QualifiedName:iaik.x509.X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:iterator)))(SimpleName:next)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(SimpleName:currentCertificate))))(ExpressionStatement(Assignment(SimpleName:objectID)(ASSIGNMENT_OPERATOR:=)(NullLiteral))))(Block(ExpressionStatement(Assignment(SimpleName:importedCompleteChain)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:closeSession)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11Module))(SimpleName:finalize)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:thr))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:thr))(SimpleName:printStackTrace))))))))))