(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:timeStamp)(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:data))(SingleVariableDeclaration(SimpleType(SimpleName:RevocationData))(SimpleName:revocationData))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:messageDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:digestAlgo))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)))))(VariableDeclarationStatement(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:nonce)(ClassInstanceCreation(SimpleType(SimpleName:BigInteger))(NumberLiteral:128)(ClassInstanceCreation(SimpleType(SimpleName:SecureRandom))))))(VariableDeclarationStatement(SimpleType(SimpleName:TimeStampRequestGenerator))(VariableDeclarationFragment(SimpleName:requestGenerator)(ClassInstanceCreation(SimpleType(SimpleName:TimeStampRequestGenerator)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestGenerator))(SimpleName:setCertReq)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(FieldAccess(ThisExpression)(SimpleName:requestPolicy)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestGenerator))(SimpleName:setReqPolicy)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:requestPolicy)))))))(VariableDeclarationStatement(SimpleType(SimpleName:TimeStampRequest))(VariableDeclarationFragment(SimpleName:request)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:requestGenerator))(SimpleName:generate)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:digestAlgoOid))(SimpleName:digest)(SimpleName:nonce)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encodedRequest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getEncoded))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpClient))(VariableDeclarationFragment(SimpleName:httpClient)(ClassInstanceCreation(SimpleType(SimpleName:HttpClient)))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(FieldAccess(ThisExpression)(SimpleName:username)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Credentials))(VariableDeclarationFragment(SimpleName:credentials)(ClassInstanceCreation(SimpleType(SimpleName:UsernamePasswordCredentials))(FieldAccess(ThisExpression)(SimpleName:username))(FieldAccess(ThisExpression)(SimpleName:password)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpClient))(SimpleName:getState)))(SimpleName:setCredentials)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:AuthScope.ANY)(SimpleName:credentials))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(FieldAccess(ThisExpression)(SimpleName:proxyHost)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpClient))(SimpleName:getHostConfiguration)))(SimpleName:setProxy)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:proxyHost))(FieldAccess(ThisExpression)(SimpleName:proxyPort)))))))(VariableDeclarationStatement(SimpleType(SimpleName:PostMethod))(VariableDeclarationFragment(SimpleName:postMethod)(ClassInstanceCreation(SimpleType(SimpleName:PostMethod))(FieldAccess(ThisExpression)(SimpleName:tspServiceUrl)))))(VariableDeclarationStatement(SimpleType(SimpleName:RequestEntity))(VariableDeclarationFragment(SimpleName:requestEntity)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayRequestEntity))(SimpleName:encodedRequest)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:postMethod))(SimpleName:addRequestHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(FieldAccess(ThisExpression)(SimpleName:userAgent)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:postMethod))(SimpleName:setRequestEntity)(METHOD_INVOCATION_ARGUMENTS(SimpleName:requestEntity))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:statusCode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpClient))(SimpleName:executeMethod)(METHOD_INVOCATION_ARGUMENTS(SimpleName:postMethod)))))(IfStatement(InfixExpression(QualifiedName:HttpStatus.SC_OK)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:statusCode))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(FieldAccess(ThisExpression)(SimpleName:tspServiceUrl))))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:Exception))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(FieldAccess(ThisExpression)(SimpleName:tspServiceUrl)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Header))(VariableDeclarationFragment(SimpleName:responseContentTypeHeader)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:postMethod))(SimpleName:getResponseHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:responseContentTypeHeader))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:contentType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:responseContentTypeHeader))(SimpleName:getValue))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentType))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:postMethod))(SimpleName:getResponseBodyAsString))))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:contentType))))))(IfStatement(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:==)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:postMethod))(SimpleName:getResponseContentLength)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:inputStream)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:postMethod))(SimpleName:getResponseBodyAsStream))))(VariableDeclarationStatement(SimpleType(SimpleName:TimeStampResponse))(VariableDeclarationFragment(SimpleName:timeStampResponse)(ClassInstanceCreation(SimpleType(SimpleName:TimeStampResponse))(SimpleName:inputStream))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampResponse))(SimpleName:validate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request))))(IfStatement(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:!=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampResponse))(SimpleName:getStatus)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampResponse))(SimpleName:getStatus))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampResponse))(SimpleName:getStatusString))))))(VariableDeclarationStatement(SimpleType(SimpleName:PKIFailureInfo))(VariableDeclarationFragment(SimpleName:failInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampResponse))(SimpleName:getFailInfo))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:failInfo))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:failInfo))(SimpleName:intValue))))))(IfStatement(InfixExpression(QualifiedName:PKIFailureInfo.unacceptedPolicy)(INFIX_EXPRESSION_OPERATOR:==)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:failInfo))(SimpleName:intValue)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampResponse))(SimpleName:getStatus)))))))(VariableDeclarationStatement(SimpleType(SimpleName:TimeStampToken))(VariableDeclarationFragment(SimpleName:timeStampToken)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampResponse))(SimpleName:getTimeStampToken))))(VariableDeclarationStatement(SimpleType(SimpleName:SignerId))(VariableDeclarationFragment(SimpleName:signerId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampToken))(SimpleName:getSID))))(VariableDeclarationStatement(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:signerCertSerialNumber)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerId))(SimpleName:getSerialNumber))))(VariableDeclarationStatement(SimpleType(SimpleName:X500Principal))(VariableDeclarationFragment(SimpleName:signerCertIssuer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerId))(SimpleName:getIssuer))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:signerCertSerialNumber)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:signerCertIssuer)))))(VariableDeclarationStatement(SimpleType(SimpleName:CertStore))(VariableDeclarationFragment(SimpleName:certStore)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampToken))(SimpleName:getCertificatesAndCRLs)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(QualifiedName:BouncyCastleProvider.PROVIDER_NAME)))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Collection))(WildcardType(SimpleType(SimpleName:Certificate))))(VariableDeclarationFragment(SimpleName:certificates)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certStore))(SimpleName:getCertificates)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:signerCert)(NullLiteral)))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:String))(SimpleType(SimpleName:X509Certificate)))(VariableDeclarationFragment(SimpleName:certificateMap)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:String))(SimpleType(SimpleName:X509Certificate))))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Certificate))(SimpleName:certificate))(SimpleName:certificates)(Block(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:x509Certificate)(CastExpression(SimpleType(SimpleName:X509Certificate))(SimpleName:certificate))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerCertIssuer))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:x509Certificate))(SimpleName:getIssuerX500Principal))))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerCertSerialNumber))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:x509Certificate))(SimpleName:getSerialNumber)))))(Block(ExpressionStatement(Assignment(SimpleName:signerCert)(ASSIGNMENT_OPERATOR:=)(SimpleName:x509Certificate)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ski)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Hex))(SimpleName:encodeHexString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getSubjectKeyId)(METHOD_INVOCATION_ARGUMENTS(SimpleName:x509Certificate)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ski)(SimpleName:x509Certificate))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:x509Certificate))(SimpleName:getSubjectX500Principal))(StringLiteral:<STR>)(SimpleName:ski)))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:signerCert))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:X509Certificate)))(VariableDeclarationFragment(SimpleName:tspCertificateChain)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:X509Certificate))))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:certificate)(SimpleName:signerCert)))(DoStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificate))(SimpleName:getSubjectX500Principal))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tspCertificateChain))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificate))(SimpleName:getSubjectX500Principal)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificate))(SimpleName:getIssuerX500Principal))))(Block(BreakStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:aki)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Hex))(SimpleName:encodeHexString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getAuthorityKeyId)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate)))))))(ExpressionStatement(Assignment(SimpleName:certificate)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateMap))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aki))))))(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:certificate)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampToken))(SimpleName:validate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tspCertificateChain))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))(QualifiedName:BouncyCastleProvider.PROVIDER_NAME))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:validator)))(SimpleName:validate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tspCertificateChain)(SimpleName:revocationData))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampToken))(SimpleName:getTimeStampInfo)))(SimpleName:getGenTime))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:timestamp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:timeStampToken))(SimpleName:getEncoded))))(ReturnStatement(SimpleName:timestamp))))))