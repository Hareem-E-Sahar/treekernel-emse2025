(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:processCredentialGroup)(SingleVariableDeclaration(SimpleType(SimpleName:CertificateGroupDetail))(SimpleName:certGroup))(SingleVariableDeclaration(ArrayType(PrimitiveType:char)(Dimension))(SimpleName:password))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:GeneralSecurityException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:CertificateDetail))(VariableDeclarationFragment(SimpleName:cert)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getCertificate))))(VariableDeclarationStatement(SimpleType(SimpleName:CertificateKeyDetail))(VariableDeclarationFragment(SimpleName:key)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getKey))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(InfixExpression(SimpleName:key)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:cert)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))))(INFIX_EXPRESSION_OPERATOR:||)(ParenthesizedExpression(InfixExpression(InfixExpression(SimpleName:key)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:cert)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getId))(StringLiteral:<STR>))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:key)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:cert)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:certFile)(ClassInstanceCreation(SimpleType(SimpleName:File))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getSource)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:keyFile)(ClassInstanceCreation(SimpleType(SimpleName:File))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getSource)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:isCommercial))(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certFile))(SimpleName:exists))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyFile))(SimpleName:exists)))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getId))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certFile))(SimpleName:getPath))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyFile))(SimpleName:getPath))(StringLiteral:<STR>))))))(Block(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certFile))(SimpleName:exists)))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyFile))(SimpleName:exists))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getId))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getTolvenConfigWrapper)))(SimpleName:getBuildDir)))(SimpleName:mkdirs)))(VariableDeclarationStatement(SimpleType(SimpleName:X500Principal))(VariableDeclarationFragment(SimpleName:x500Principal)(MethodInvocation(SimpleName:getX500Principal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certGroup)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509CertificatePrivateKeyPair))(VariableDeclarationFragment(SimpleName:certPrivateKeyPair)(MethodInvocation(SimpleName:createSelfSignedCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:x500Principal)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:certificate)(NullLiteral)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getId)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getCaRefId))))(Block(ExpressionStatement(Assignment(SimpleName:certificate)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certPrivateKeyPair))(SimpleName:getX509Certificate)))))(Block(ExpressionStatement(Assignment(SimpleName:certificate)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:signCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cert)(SimpleName:x500Principal)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certPrivateKeyPair))(SimpleName:getX509Certificate)))(SimpleName:getPublicKey))))))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:tmpCertFile)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:tmpKeyFile)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:tmpCertFile)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:File))(SimpleName:createTempFile)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getTolvenConfigWrapper)))(SimpleName:getBuildDir))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpCertFile))(SimpleName:delete)))(ExpressionStatement(Assignment(SimpleName:tmpKeyFile)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:File))(SimpleName:createTempFile)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getTolvenConfigWrapper)))(SimpleName:getBuildDir))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpKeyFile))(SimpleName:delete)))(VariableDeclarationStatement(ArrayType(PrimitiveType:char)(Dimension))(VariableDeclarationFragment(SimpleName:keypass)(SimpleName:password)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:isPasswordProtected))(Block(IfStatement(InfixExpression(SimpleName:keypass)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:keypass)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getPasswordHolder)))(SimpleName:getPassword)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getId))))))(IfStatement(InfixExpression(SimpleName:keypass)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getId))(StringLiteral:<STR>))))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getPasswordHolder)))(SimpleName:getPassword)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getId))))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getPasswordHolder)))(SimpleName:addPassword)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getId))(QualifiedName:PasswordHolder.CREDENTIAL_PASSWORD)(SimpleName:keypass)))))))(Block(IfStatement(InfixExpression(SimpleName:password)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getId))(StringLiteral:<STR>))))))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:privateKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certPrivateKeyPair))(SimpleName:getPrivateKey))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:TolvenConfigWrapper.TOLVEN_CREDENTIAL_FORMAT_PEM))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getFormat))))(Block(ExpressionStatement(MethodInvocation(SimpleName:writePEMObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate)(SimpleName:tmpCertFile))))(ExpressionStatement(MethodInvocation(SimpleName:writePEMObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keypass)(SimpleName:privateKey)(SimpleName:tmpKeyFile)))))(Block(ExpressionStatement(MethodInvocation(SimpleName:writeDER)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate)(SimpleName:tmpCertFile))))(ExpressionStatement(MethodInvocation(SimpleName:writeDER)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keypass)(SimpleName:privateKey)(SimpleName:tmpKeyFile))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:copyFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmpCertFile)(SimpleName:certFile))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:copyFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmpKeyFile)(SimpleName:keyFile)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ex))(SimpleName:printStackTrace)))(IfStatement(InfixExpression(SimpleName:certFile)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certFile))(SimpleName:delete))))(IfStatement(InfixExpression(SimpleName:keyFile)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyFile))(SimpleName:delete))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getId)))(SimpleName:ex)))))(Block(IfStatement(InfixExpression(SimpleName:tmpCertFile)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpCertFile))(SimpleName:delete))))(IfStatement(InfixExpression(SimpleName:tmpKeyFile)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpKeyFile))(SimpleName:delete)))))))(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certFile))(SimpleName:exists))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyFile))(SimpleName:exists)))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getId))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certFile))(SimpleName:getPath))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyFile))(SimpleName:getPath))(StringLiteral:<STR>)))))))))))(VariableDeclarationStatement(SimpleType(SimpleName:CertificateKeyStoreDetail))(VariableDeclarationFragment(SimpleName:certificateKeyStoreDetail)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certGroup))(SimpleName:getKeyStore))))(IfStatement(InfixExpression(InfixExpression(SimpleName:certificateKeyStoreDetail)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:File))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateKeyStoreDetail))(SimpleName:getSource))))(SimpleName:exists))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateKeyStoreDetail))(SimpleName:getId))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateKeyStoreDetail))(SimpleName:getSource))))))(ExpressionStatement(MethodInvocation(SimpleName:createKeyStore)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certGroup)(SimpleName:password))))))))))