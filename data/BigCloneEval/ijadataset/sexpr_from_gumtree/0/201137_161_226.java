(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:prepareDocumentForEncryption)(SingleVariableDeclaration(SimpleType(SimpleName:PDDocument))(SimpleName:doc))(SimpleType(SimpleName:CryptographyException))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Security))(SimpleName:addProvider)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:BouncyCastleProvider))))))(VariableDeclarationStatement(SimpleType(SimpleName:PDEncryptionDictionary))(VariableDeclarationFragment(SimpleName:dictionary)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:getEncryptionDictionary))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:setFilter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FILTER))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:setLength)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:keyLength)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:setVersion)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:2))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:setSubFilter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SUBFILTER))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension)(Dimension))(VariableDeclarationFragment(SimpleName:recipientsField)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:policy))(SimpleName:getRecipientsNumber)))(Dimension)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:seed)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:20))))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyGenerator))(VariableDeclarationFragment(SimpleName:key)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:192)(ClassInstanceCreation(SimpleType(SimpleName:SecureRandom))))))(VariableDeclarationStatement(SimpleType(SimpleName:SecretKey))(VariableDeclarationFragment(SimpleName:sk)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:generateKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sk))(SimpleName:getEncoded))(NumberLiteral:0)(SimpleName:seed)(NumberLiteral:0)(NumberLiteral:20))))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:it)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:policy))(SimpleName:getRecipientsIterator))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:hasNext))(Block(VariableDeclarationStatement(SimpleType(SimpleName:PublicKeyRecipient))(VariableDeclarationFragment(SimpleName:recipient)(CastExpression(SimpleType(SimpleName:PublicKeyRecipient))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:next)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:certificate)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:recipient))(SimpleName:getX509))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:permission)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:recipient))(SimpleName:getPermission)))(SimpleName:getPermissionBytesForPublicKey))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:pkcs7input)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:24))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:one)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(SimpleName:permission)))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:two)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:permission)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:8))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:three)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:permission)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:16))))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:four)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:permission)(INFIX_EXPRESSION_OPERATOR:>>>)(NumberLiteral:24))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:seed)(NumberLiteral:0)(SimpleName:pkcs7input)(NumberLiteral:0)(NumberLiteral:20))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:pkcs7input)(NumberLiteral:20))(ASSIGNMENT_OPERATOR:=)(SimpleName:four)))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:pkcs7input)(NumberLiteral:21))(ASSIGNMENT_OPERATOR:=)(SimpleName:three)))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:pkcs7input)(NumberLiteral:22))(ASSIGNMENT_OPERATOR:=)(SimpleName:two)))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:pkcs7input)(NumberLiteral:23))(ASSIGNMENT_OPERATOR:=)(SimpleName:one)))(VariableDeclarationStatement(SimpleType(SimpleName:DERObject))(VariableDeclarationFragment(SimpleName:obj)(MethodInvocation(SimpleName:createDERForRecipient)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pkcs7input)(SimpleName:certificate)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:baos)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:DEROutputStream))(VariableDeclarationFragment(SimpleName:k)(ClassInstanceCreation(SimpleType(SimpleName:DEROutputStream))(SimpleName:baos))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:k))(SimpleName:writeObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:obj))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:recipientsField)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:toByteArray))))(ExpressionStatement(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:setRecipients)(METHOD_INVOCATION_ARGUMENTS(SimpleName:recipientsField))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:sha1InputLength)(QualifiedName:seed.length)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:j)(NumberLiteral:0)))(InfixExpression(SimpleName:j)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:getRecipientsLength)))(PostfixExpression(SimpleName:j)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:COSString))(VariableDeclarationFragment(SimpleName:string)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:getRecipientStringAt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:j)))))(ExpressionStatement(Assignment(SimpleName:sha1InputLength)(ASSIGNMENT_OPERATOR:+=)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:string))(SimpleName:getBytes))(SimpleName:length))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:sha1Input)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:sha1InputLength))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:seed)(NumberLiteral:0)(SimpleName:sha1Input)(NumberLiteral:0)(NumberLiteral:20))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:sha1InputOffset)(NumberLiteral:20)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:j)(NumberLiteral:0)))(InfixExpression(SimpleName:j)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:getRecipientsLength)))(PostfixExpression(SimpleName:j)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:COSString))(VariableDeclarationFragment(SimpleName:string)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:getRecipientStringAt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:j)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:string))(SimpleName:getBytes))(NumberLiteral:0)(SimpleName:sha1Input)(SimpleName:sha1InputOffset)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:string))(SimpleName:getBytes))(SimpleName:length)))))(ExpressionStatement(Assignment(SimpleName:sha1InputOffset)(ASSIGNMENT_OPERATOR:+=)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:string))(SimpleName:getBytes))(SimpleName:length))))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:mdResult)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sha1Input)))))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:encryptionKey))(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(FieldAccess(ThisExpression)(SimpleName:keyLength))(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:8)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mdResult)(NumberLiteral:0)(FieldAccess(ThisExpression)(SimpleName:encryptionKey))(NumberLiteral:0)(InfixExpression(FieldAccess(ThisExpression)(SimpleName:keyLength))(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:8)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:setEncryptionDictionary)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dictionary))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:getDocument)))(SimpleName:setEncryptionDictionary)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:dictionary.encryptionDictionary)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(SimpleName:ex)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchProviderException))(SimpleName:ex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(SimpleName:ex)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(SimpleName:e))))))))))