(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(SimpleType(SimpleName:HttpRequest))(SimpleName:create)(SingleVariableDeclaration(SimpleType(SimpleName:HttpExchange))(SimpleName:exchange))(SimpleType(QualifiedName:org.owasp.oss.httpserver.HttpHandlerException))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Method))(VariableDeclarationFragment(SimpleName:method)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exchange))(SimpleName:getRequestMethod)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:method)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Method.GET)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exchange))(SimpleName:getRequestMethod)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:method)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Method.POST)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exchange))(SimpleName:getRequestMethod)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:method)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Method.PUT)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exchange))(SimpleName:getRequestMethod)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:method)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Method.DELETE)))(ThrowStatement(ClassInstanceCreation(SimpleType(QualifiedName:org.owasp.oss.httpserver.HttpHandlerException))(StringLiteral:<STR>)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:method)))))(VariableDeclarationStatement(SimpleType(SimpleName:URI))(VariableDeclarationFragment(SimpleName:uri)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exchange))(SimpleName:getRequestURI))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:path)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uri))(SimpleName:getPath))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:path)))))(VariableDeclarationStatement(SimpleType(SimpleName:Headers))(VariableDeclarationFragment(SimpleName:headers)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exchange))(SimpleName:getRequestHeaders))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:String))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:parameters)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:String))(SimpleType(SimpleName:String))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cookieStr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headers))(SimpleName:getFirst)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:cookieStr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cookieStr))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:HttpRequest))(SimpleName:parseCookiesParameters)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cookieStr)(SimpleName:parameters)))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:body)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exchange))(SimpleName:getRequestBody))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:bodyLenStr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headers))(SimpleName:getFirst)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:bodyLenStr)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:bodyBytes)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:bodyLenStr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bodyLen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Integer))(SimpleName:parseInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bodyLenStr)))))(ExpressionStatement(Assignment(SimpleName:bodyBytes)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:bodyLen))))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:os)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream))(SimpleName:bodyLen))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:readByteNum)(NumberLiteral:0)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:readByteNum)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bodyBytes)))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bodyBytes)(NumberLiteral:0)(SimpleName:readByteNum))))))(ExpressionStatement(Assignment(SimpleName:bodyBytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:toByteArray))))(IfStatement(InfixExpression(SimpleName:bodyBytes)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:HttpRequest))(SimpleName:parsePostParameters)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(SimpleName:bodyBytes))(QualifiedName:bodyBytes.length)(SimpleName:parameters)))))))(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:HttpRequest))(SimpleName:method)(SimpleName:path)(SimpleName:bodyBytes)(SimpleName:parameters)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exchange))(SimpleName:getPrincipal))))))))