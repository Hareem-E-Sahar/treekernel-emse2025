(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:encrypt)(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:data))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:keySignature))(SimpleType(SimpleName:CryptographicException))(Block(ExpressionStatement(Assignment(SimpleName:tmpData)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(QualifiedName:data.length))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(SimpleName:tmpData)(NumberLiteral:0)(QualifiedName:data.length))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyBL))(VariableDeclarationFragment(SimpleName:key)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyCache))(SimpleName:searchKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keySignature)))))(IfStatement(InfixExpression(SimpleName:key)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ReturnStatement(NullLiteral))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:dataSize)(QualifiedName:data.length)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:isTraceEnabled))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:dataSize)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getKeyCSP))))))))(VariableDeclarationStatement(SimpleType(SimpleName:BlockCipherBL))(VariableDeclarationFragment(SimpleName:blockCipher)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CSPManager))(SimpleName:getBlockCipher)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getKeyCSP))))))(IfStatement(InfixExpression(SimpleName:blockCipher)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographicException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getKeyCSP))(StringLiteral:<STR>))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:blockSize)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:blockCipher))(SimpleName:getBlockSize))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:cryptedDataSize)(InfixExpression(SimpleName:dataSize)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:8))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:cryptedDataBlockCount)(InfixExpression(ParenthesizedExpression(InfixExpression(InfixExpression(SimpleName:cryptedDataSize)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:blockSize))(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:/)(SimpleName:blockSize))))(VariableDeclarationStatement(SimpleType(SimpleName:CRC32))(VariableDeclarationFragment(SimpleName:crc32)(ClassInstanceCreation(SimpleType(SimpleName:CRC32)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc32))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:crcValue)(CastExpression(PrimitiveType:int)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc32))(SimpleName:getValue)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:cryptedData)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:blockSize)(INFIX_EXPRESSION_OPERATOR:*)(SimpleName:cryptedDataBlockCount)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(SimpleName:cryptedData)(NumberLiteral:0)(SimpleName:dataSize))))(ExpressionStatement(MethodInvocation(SimpleName:intToBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cryptedData)(InfixExpression(QualifiedName:cryptedData.length)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:8))(SimpleName:dataSize))))(ExpressionStatement(MethodInvocation(SimpleName:intToBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cryptedData)(InfixExpression(QualifiedName:cryptedData.length)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:4))(SimpleName:crcValue))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:blockCipher))(SimpleName:getBlockCipher)))(SimpleName:encrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cryptedData)(NumberLiteral:0)(SimpleName:blockSize)(SimpleName:cryptedDataBlockCount)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getKey)))))(ReturnStatement(SimpleName:cryptedData))))))