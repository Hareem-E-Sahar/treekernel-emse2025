(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:engineSign)(SimpleType(SimpleName:SignatureException))(Block(ExpressionStatement(MethodInvocation(SimpleName:ensureInitialized)))(TryStatement(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:signature)))(IfStatement(InfixExpression(SimpleName:type)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:T_UPDATE))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:len)(ConditionalExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyAlgorithm))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(NumberLiteral:40)(NumberLiteral:0))))(ExpressionStatement(Assignment(SimpleName:signature)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:token.p11))(SimpleName:C_SignFinal)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:id))(SimpleName:len))))))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digest)))(IfStatement(InfixExpression(SimpleName:type)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:T_DIGEST))(Block(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)))))(Block(IfStatement(InfixExpression(SimpleName:mechanism)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:CKM_DSA))(Block(IfStatement(InfixExpression(SimpleName:bytesProcessed)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:buffer.length))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(SimpleName:buffer))))(Block(IfStatement(InfixExpression(SimpleName:bytesProcessed)(INFIX_EXPRESSION_OPERATOR:>)(QualifiedName:buffer.length))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:RAW_ECDSA_MAX)(StringLiteral:<STR>))))))(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:bytesProcessed))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buffer)(NumberLiteral:0)(SimpleName:digest)(NumberLiteral:0)(SimpleName:bytesProcessed))))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyAlgorithm))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:==)(BooleanLiteral:false))(Block(ExpressionStatement(Assignment(SimpleName:signature)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:token.p11))(SimpleName:C_Sign)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:id))(SimpleName:digest))))))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(SimpleName:encodeSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest)))))(IfStatement(InfixExpression(SimpleName:mechanism)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:CKM_RSA_X_509))(Block(ExpressionStatement(Assignment(SimpleName:data)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:pkcs1Pad)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)))))))(ExpressionStatement(Assignment(SimpleName:signature)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:token.p11))(SimpleName:C_Sign)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:id))(SimpleName:data)))))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyAlgorithm))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:==)(BooleanLiteral:false))(Block(ReturnStatement(MethodInvocation(SimpleName:dsaToASN1)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signature)))))(Block(ReturnStatement(SimpleName:signature)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:PKCS11Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ProviderException))(SimpleName:e)))))(Block(ExpressionStatement(Assignment(SimpleName:initialized)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))(ExpressionStatement(Assignment(SimpleName:session)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:releaseSession)(METHOD_INVOCATION_ARGUMENTS(SimpleName:session)))))))))))