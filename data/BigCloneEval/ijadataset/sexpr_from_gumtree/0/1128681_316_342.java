(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:ByteBlock))(SimpleName:genChatSecurityInfo)(SingleVariableDeclaration(SimpleType(SimpleName:FullRoomInfo))(SimpleName:chatInfo))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:sn))(SimpleType(SimpleName:SecureSessionException))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:SecretKey))(VariableDeclarationFragment(SimpleName:key)(MethodInvocation(SimpleName:getChatKey)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chatInfo))(SimpleName:getRoomName))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:keyData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getEncoded))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:c)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:cert)(MethodInvocation(SimpleName:getCert)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sn)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:cert))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encryptedKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyData)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Name))(VariableDeclarationFragment(SimpleName:xname)(ClassInstanceCreation(SimpleType(SimpleName:X509Name))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getSubjectDN)))(SimpleName:getName)))))(VariableDeclarationStatement(SimpleType(SimpleName:IssuerAndSerialNumber))(VariableDeclarationFragment(SimpleName:ias)(ClassInstanceCreation(SimpleType(SimpleName:IssuerAndSerialNumber))(SimpleName:xname)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getSerialNumber)))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyTransRecipientInfo))(VariableDeclarationFragment(SimpleName:ktr)(ClassInstanceCreation(SimpleType(SimpleName:KeyTransRecipientInfo))(ClassInstanceCreation(SimpleType(SimpleName:RecipientIdentifier))(SimpleName:ias))(ClassInstanceCreation(SimpleType(SimpleName:AlgorithmIdentifier))(StringLiteral:<STR>))(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(SimpleName:encryptedKey)))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:vec)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vec))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ktr))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vec))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERObjectIdentifier))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bout)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1OutputStream))(VariableDeclarationFragment(SimpleName:aout)(ClassInstanceCreation(SimpleType(SimpleName:ASN1OutputStream))(SimpleName:bout))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aout))(SimpleName:writeObject)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:vec)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aout))(SimpleName:close)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bout2)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:MiniRoomInfo))(SimpleName:chatInfo)))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bout2))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BinaryTools))(SimpleName:writeUShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bout2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bout))(SimpleName:size)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bout))(SimpleName:writeTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bout2))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBlock))(SimpleName:wrap)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:signData)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bout2))(SimpleName:toByteArray))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SecureSessionException))(SimpleName:e))))))))))