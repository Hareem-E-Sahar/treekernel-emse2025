(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:String))(SimpleName:fileUpload)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:ResourceType))(SimpleName:type))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:String))(SimpleName:currentFolder))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:String))(SimpleName:fileName))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:InputStream))(SimpleName:inputStream))(SimpleType(SimpleName:InvalidCurrentFolderException))(SimpleType(SimpleName:WriteException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:absolutePath)(MethodInvocation(SimpleName:getRealUserFilesAbsolutePath)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RequestCycleHandler))(SimpleName:getUserFilesAbsolutePath)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ThreadLocalData))(SimpleName:getRequest))))))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:typeDir)(MethodInvocation(SimpleName:getOrCreateResourceTypeDir)(METHOD_INVOCATION_ARGUMENTS(SimpleName:absolutePath)(SimpleName:type)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:currentDir)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:typeDir)(SimpleName:currentFolder))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentDir))(SimpleName:exists)))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentDir))(SimpleName:isDirectory))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:InvalidCurrentFolderException)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:newFile)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:currentDir)(SimpleName:fileName))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:fileToSave)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UtilsFile))(SimpleName:getUniqueFile)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newFile))(SimpleName:getAbsoluteFile))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtils))(SimpleName:copyLarge)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inputStream)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:fileToSave))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:WriteException)))))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileToSave))(SimpleName:getName)))))))