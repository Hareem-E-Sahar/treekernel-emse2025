(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(SimpleType(SimpleName:SignerInfo))(SimpleName:toSignerInfo)(SingleVariableDeclaration(SimpleType(SimpleName:DERObjectIdentifier))(SimpleName:contentType))(SingleVariableDeclaration(SimpleType(SimpleName:CMSProcessable))(SimpleName:content))(SingleVariableDeclaration(SimpleType(SimpleName:SecureRandom))(SimpleName:random))(SingleVariableDeclaration(SimpleType(SimpleName:Provider))(SimpleName:sigProvider))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:addDefaultAttributes))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:isCounterSignature))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:SignatureException))(SimpleType(SimpleName:InvalidKeyException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:CertificateEncodingException))(SimpleType(SimpleName:CMSException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmIdentifier))(VariableDeclarationFragment(SimpleName:digAlgId)(ClassInstanceCreation(SimpleType(SimpleName:AlgorithmIdentifier))(ClassInstanceCreation(SimpleType(SimpleName:DERObjectIdentifier))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getDigestAlgOID)))(ClassInstanceCreation(SimpleType(SimpleName:DERNull))))))(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmIdentifier))(VariableDeclarationFragment(SimpleName:encAlgId)(MethodInvocation(SimpleName:getEncAlgorithmIdentifier)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getEncryptionAlgOID))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:digestName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:CMSSignedHelper.INSTANCE))(SimpleName:getDigestAlgName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestOID)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signatureName)(InfixExpression(SimpleName:digestName)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:CMSSignedHelper.INSTANCE))(SimpleName:getEncryptionAlgName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encOID))))))(VariableDeclarationStatement(SimpleType(SimpleName:Signature))(VariableDeclarationFragment(SimpleName:sig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:CMSSignedHelper.INSTANCE))(SimpleName:getSignatureInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureName)(SimpleName:sigProvider)))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:dig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:CMSSignedHelper.INSTANCE))(SimpleName:getDigestInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestName)(SimpleName:sigProvider)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hash)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:content)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:content))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DigOutputStream))(SimpleName:dig)))))(ExpressionStatement(Assignment(SimpleName:hash)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:digest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_digests))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestOID)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hash))(SimpleName:clone)))))))(VariableDeclarationStatement(SimpleType(SimpleName:AttributeTable))(VariableDeclarationFragment(SimpleName:signed)))(IfStatement(SimpleName:addDefaultAttributes)(Block(VariableDeclarationStatement(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:parameters)(MethodInvocation(SimpleName:getBaseParameters)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentType)(SimpleName:digAlgId)(SimpleName:hash)))))(ExpressionStatement(Assignment(SimpleName:signed)(ASSIGNMENT_OPERATOR:=)(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:sAttr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sAttr))(SimpleName:getAttributes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Collections))(SimpleName:unmodifiableMap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:parameters)))))(NullLiteral)))))(Block(ExpressionStatement(Assignment(SimpleName:signed)(ASSIGNMENT_OPERATOR:=)(SimpleName:baseSignedTable)))))(IfStatement(SimpleName:isCounterSignature)(Block(VariableDeclarationStatement(SimpleType(SimpleName:Hashtable))(VariableDeclarationFragment(SimpleName:ats)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signed))(SimpleName:toHashtable))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ats))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributes.contentType))))(ExpressionStatement(Assignment(SimpleName:signed)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:AttributeTable))(SimpleName:ats))))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1Set))(VariableDeclarationFragment(SimpleName:signedAttr)(MethodInvocation(SimpleName:getAttributeSet)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signed)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tmp)))(IfStatement(InfixExpression(SimpleName:signedAttr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:tmp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedAttr))(SimpleName:getEncoded)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ASN1Encodable.DER))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bOut)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:content))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bOut))))(ExpressionStatement(Assignment(SimpleName:tmp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bOut))(SimpleName:toByteArray))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:initSign)(METHOD_INVOCATION_ARGUMENTS(SimpleName:key)(SimpleName:random))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1OctetString))(VariableDeclarationFragment(SimpleName:encDigest)(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:sign)))))(VariableDeclarationStatement(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:parameters)(MethodInvocation(SimpleName:getBaseParameters)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentType)(SimpleName:digAlgId)(SimpleName:hash)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:parameters))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSAttributeTableGenerator.SIGNATURE)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encDigest))(SimpleName:getOctets)))(SimpleName:clone)))))(VariableDeclarationStatement(SimpleType(SimpleName:AttributeTable))(VariableDeclarationFragment(SimpleName:unsigned)(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:unsAttr)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:unsAttr))(SimpleName:getAttributes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Collections))(SimpleName:unmodifiableMap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:parameters)))))(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1Set))(VariableDeclarationFragment(SimpleName:unsignedAttr)(MethodInvocation(SimpleName:getAttributeSet)(METHOD_INVOCATION_ARGUMENTS(SimpleName:unsigned)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:cert)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getCertificate))))(VariableDeclarationStatement(SimpleType(SimpleName:SignerIdentifier))(VariableDeclarationFragment(SimpleName:identifier)))(IfStatement(InfixExpression(SimpleName:cert)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:TBSCertificateStructure))(VariableDeclarationFragment(SimpleName:tbs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TBSCertificateStructure))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ASN1Object))(SimpleName:fromByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getTBSCertificate))))))))(VariableDeclarationStatement(SimpleType(SimpleName:IssuerAndSerialNumber))(VariableDeclarationFragment(SimpleName:encSid)(ClassInstanceCreation(SimpleType(SimpleName:IssuerAndSerialNumber))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tbs))(SimpleName:getIssuer))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tbs))(SimpleName:getSerialNumber)))(SimpleName:getValue)))))(ExpressionStatement(Assignment(SimpleName:identifier)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SignerIdentifier))(SimpleName:encSid)))))(Block(ExpressionStatement(Assignment(SimpleName:identifier)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SignerIdentifier))(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(SimpleName:keyIdentifier)))))))(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:SignerInfo))(SimpleName:identifier)(SimpleName:digAlgId)(SimpleName:signedAttr)(SimpleName:encAlgId)(SimpleName:encDigest)(SimpleName:unsignedAttr)))))))