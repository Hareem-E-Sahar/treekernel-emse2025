(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(SimpleType(SimpleName:KeyStore))(SimpleName:createKeyStore)(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:keystoreWriteStream))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:keyStoreType))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:keyAlias))(SingleVariableDeclaration(ArrayType(PrimitiveType:char)(Dimension))(SimpleName:password))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:userName))(SimpleType(SimpleName:ConfigurationException))(SimpleType(SimpleName:IOException))(Block(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:keyStoreType))(Block(ExpressionStatement(Assignment(SimpleName:keyStoreType)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserConfiguration))(SimpleName:defaultKeystoreType))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:keyAlias))(Block(ExpressionStatement(Assignment(SimpleName:keyAlias)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserConfiguration))(SimpleName:defaultKeyAlias))))))(ExpressionStatement(Assignment(SimpleName:keyAlias)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyAlias))(SimpleName:toLowerCase))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:password))(Block(ExpressionStatement(Assignment(SimpleName:password)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserConfiguration))(SimpleName:keystorePassword)))(SimpleName:toCharArray))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:userName))(Block(ExpressionStatement(Assignment(SimpleName:userName)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserConfiguration))(SimpleName:userName))))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:ks)(NullLiteral)))(TryStatement(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:finest)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keyStoreType))))))(ExpressionStatement(Assignment(SimpleName:ks)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyStoreType)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:finest)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:load)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:password))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:finest)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:generateConfigurationException)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CertificateException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:generateConfigurationException)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:KeyStoreException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:generateConfigurationException)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:generateConfigurationException)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e)))))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPairGenerator))(VariableDeclarationFragment(SimpleName:kpg)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:kpg)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyPairGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserConfiguration))(SimpleName:defaultKeyAlgorithm)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:generateConfigurationException)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserConfiguration))(SimpleName:defaultKeyAlgorithm)))(SimpleName:e)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kpg))(SimpleName:initialize)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserConfiguration))(SimpleName:defaultKeyLength)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:finest)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserConfiguration))(SimpleName:defaultKeyLength))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserConfiguration))(SimpleName:defaultKeyAlgorithm))(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:userKeyPair)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kpg))(SimpleName:generateKeyPair))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:finest)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:userName))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:subjectDN)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:userName))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:ssCert)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:ssCert)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MinimalCertificateGenerator))(SimpleName:GenerateUserCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userKeyPair)(SimpleName:subjectDN)(QualifiedName:MinimalCertificateGenerator.MSEC_IN_YEAR)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:finest)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:generateConfigurationException)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e)))))))(VariableDeclarationStatement(SimpleType(QualifiedName:KeyStore.PrivateKeyEntry))(VariableDeclarationFragment(SimpleName:entry)(ClassInstanceCreation(SimpleType(QualifiedName:KeyStore.PrivateKeyEntry))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userKeyPair))(SimpleName:getPrivate))(ArrayCreation(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension))(ArrayInitializer(SimpleName:ssCert))))))(TryStatement(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:finest)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:setEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyAlias)(SimpleName:entry)(ClassInstanceCreation(SimpleType(QualifiedName:KeyStore.PasswordProtection))(SimpleName:password)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:finest)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:store)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keystoreWriteStream)(SimpleName:password))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:finest)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Log.FAC_KEYS)(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:generateConfigurationException)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CertificateException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:generateConfigurationException)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:KeyStoreException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:generateConfigurationException)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:e))))))(Block(IfStatement(InfixExpression(SimpleName:keystoreWriteStream)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keystoreWriteStream))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:warning)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Log))(SimpleName:warningStackTrace)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e)))))))))))(ReturnStatement(SimpleName:ks))))))