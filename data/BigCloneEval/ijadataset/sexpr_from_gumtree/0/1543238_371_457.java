(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:int)(SimpleName:rcvSrvrKeyExch)(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:msgLength)(MethodInvocation(SimpleName:getNextMsg)(METHOD_INVOCATION_ARGUMENTS(SimpleName:S_KEYEXCH)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:idx)(InfixExpression(SimpleName:start)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:HDR_SIZE))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:endOfMsg)(InfixExpression(SimpleName:start)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:msgLength))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPublicKey))(VariableDeclarationFragment(SimpleName:sKey)(CastExpression(SimpleType(SimpleName:RSAPublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sCert))(SimpleName:getPublicKey)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:keyUsage)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sCert))(SimpleName:getKeyUsage))))(IfStatement(InfixExpression(SimpleName:msgLength)(INFIX_EXPRESSION_OPERATOR:==)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(Block(ExpressionStatement(Assignment(SimpleName:eKey)(ASSIGNMENT_OPERATOR:=)(SimpleName:sKey)))(IfStatement(InfixExpression(InfixExpression(SimpleName:keyUsage)(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:keyUsage)(INFIX_EXPRESSION_OPERATOR:&)(QualifiedName:X509Certificate.KEY_ENCIPHER_KEY_USAGE)))(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:X509Certificate.KEY_ENCIPHER_KEY_USAGE)))(Block(IfStatement(InfixExpression(QualifiedName:Logging.REPORT_LEVEL)(INFIX_EXPRESSION_OPERATOR:<=)(QualifiedName:Logging.ERROR))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logging))(SimpleName:report)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Logging.ERROR)(QualifiedName:LogChannels.LC_SECURITY)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>)))))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CertificateException))(SimpleName:sCert)(QualifiedName:CertificateException.INAPPROPRIATE_KEY_USAGE)))))(ReturnStatement(NumberLiteral:0))))(IfStatement(InfixExpression(SimpleName:endOfMsg)(INFIX_EXPRESSION_OPERATOR:<)(ParenthesizedExpression(InfixExpression(SimpleName:idx)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:4))))(Block(ReturnStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:len)(InfixExpression(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(QualifiedName:rec.inputData)(PostfixExpression(SimpleName:idx)(POSTFIX_EXPRESSION_OPERATOR:++)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff)))(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(ArrayAccess(QualifiedName:rec.inputData)(PostfixExpression(SimpleName:idx)(POSTFIX_EXPRESSION_OPERATOR:++)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(IfStatement(InfixExpression(SimpleName:endOfMsg)(INFIX_EXPRESSION_OPERATOR:<)(ParenthesizedExpression(InfixExpression(SimpleName:idx)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:len)(NumberLiteral:2))))(Block(ReturnStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:modulusPos)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:modulusLen)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:exponentPos)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:exponentLen)))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:65)))(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(ArrayAccess(QualifiedName:rec.inputData)(SimpleName:idx))(INFIX_EXPRESSION_OPERATOR:==)(CastExpression(PrimitiveType:byte)(NumberLiteral:0x00)))))(Block(ExpressionStatement(Assignment(SimpleName:modulusPos)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:idx)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))))(ExpressionStatement(Assignment(SimpleName:modulusLen)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:64))))(Block(ExpressionStatement(Assignment(SimpleName:modulusPos)(ASSIGNMENT_OPERATOR:=)(SimpleName:idx)))(ExpressionStatement(Assignment(SimpleName:modulusLen)(ASSIGNMENT_OPERATOR:=)(SimpleName:len)))))(ExpressionStatement(Assignment(SimpleName:idx)(ASSIGNMENT_OPERATOR:+=)(SimpleName:len)))(ExpressionStatement(Assignment(SimpleName:len)(ASSIGNMENT_OPERATOR:=)(InfixExpression(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(QualifiedName:rec.inputData)(PostfixExpression(SimpleName:idx)(POSTFIX_EXPRESSION_OPERATOR:++)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff)))(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(ArrayAccess(QualifiedName:rec.inputData)(PostfixExpression(SimpleName:idx)(POSTFIX_EXPRESSION_OPERATOR:++)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(IfStatement(InfixExpression(SimpleName:endOfMsg)(INFIX_EXPRESSION_OPERATOR:<)(ParenthesizedExpression(InfixExpression(SimpleName:idx)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:len))))(Block(ReturnStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(ExpressionStatement(Assignment(SimpleName:exponentPos)(ASSIGNMENT_OPERATOR:=)(SimpleName:idx)))(ExpressionStatement(Assignment(SimpleName:exponentLen)(ASSIGNMENT_OPERATOR:=)(SimpleName:len)))(ExpressionStatement(Assignment(SimpleName:eKey)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:RSAPublicKey))(QualifiedName:rec.inputData)(SimpleName:modulusPos)(SimpleName:modulusLen)(QualifiedName:rec.inputData)(SimpleName:exponentPos)(SimpleName:exponentLen))))(ExpressionStatement(Assignment(SimpleName:idx)(ASSIGNMENT_OPERATOR:+=)(SimpleName:len)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:end)(SimpleName:idx)))(ExpressionStatement(Assignment(SimpleName:len)(ASSIGNMENT_OPERATOR:=)(InfixExpression(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(QualifiedName:rec.inputData)(PostfixExpression(SimpleName:idx)(POSTFIX_EXPRESSION_OPERATOR:++)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff)))(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(ArrayAccess(QualifiedName:rec.inputData)(PostfixExpression(SimpleName:idx)(POSTFIX_EXPRESSION_OPERATOR:++)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(IfStatement(InfixExpression(SimpleName:endOfMsg)(INFIX_EXPRESSION_OPERATOR:<)(ParenthesizedExpression(InfixExpression(SimpleName:idx)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:len))))(Block(ReturnStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:sig)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:len))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:rec.inputData)(SimpleName:idx)(SimpleName:sig)(NumberLiteral:0)(QualifiedName:sig.length))))(ExpressionStatement(Assignment(SimpleName:idx)(ASSIGNMENT_OPERATOR:+=)(SimpleName:len)))(IfStatement(InfixExpression(SimpleName:endOfMsg)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:idx))(Block(ReturnStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:dat)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:MD5_SIZE)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:SHA_SIZE)))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:di)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:di))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:crand)(NumberLiteral:0)(QualifiedName:crand.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:di))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:srand)(NumberLiteral:0)(QualifiedName:srand.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:di))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:rec.inputData)(SimpleName:HDR_SIZE)(InfixExpression(SimpleName:end)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:HDR_SIZE)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:di))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dat)(NumberLiteral:0)(SimpleName:MD5_SIZE))))(ExpressionStatement(Assignment(SimpleName:di)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:di))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:crand)(NumberLiteral:0)(QualifiedName:crand.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:di))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:srand)(NumberLiteral:0)(QualifiedName:srand.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:di))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:rec.inputData)(SimpleName:HDR_SIZE)(InfixExpression(SimpleName:end)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:HDR_SIZE)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:di))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dat)(SimpleName:MD5_SIZE)(SimpleName:SHA_SIZE)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(StringLiteral:<STR>))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:rsa)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsa))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.DECRYPT_MODE)(SimpleName:sKey))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:res)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sKey))(SimpleName:getModulusLen)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:val)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsa))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sig)(NumberLiteral:0)(QualifiedName:sig.length)(SimpleName:res)(NumberLiteral:0)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Utils))(SimpleName:byteMatch)(METHOD_INVOCATION_ARGUMENTS(SimpleName:res)(NumberLiteral:0)(SimpleName:dat)(NumberLiteral:0)(QualifiedName:dat.length))))(Block(IfStatement(InfixExpression(QualifiedName:Logging.REPORT_LEVEL)(INFIX_EXPRESSION_OPERATOR:<=)(QualifiedName:Logging.ERROR))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logging))(SimpleName:report)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Logging.ERROR)(QualifiedName:LogChannels.LC_SECURITY)(StringLiteral:<STR>))))))(ReturnStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:e)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ourMD5))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:rec.inputData)(SimpleName:start)(SimpleName:msgLength))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ourSHA))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:rec.inputData)(SimpleName:start)(SimpleName:msgLength))))(ReturnStatement(NumberLiteral:0))))))