(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Test))(Modifier:public)(PrimitiveType:void)(SimpleName:testWSSecurity)(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:keyPair)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TestUtils))(SimpleName:generateKeyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:certificate)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TestUtils))(SimpleName:generateSelfSignedCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyPair)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:fooKeyPair)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TestUtils))(SimpleName:generateKeyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:fooCertificate)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TestUtils))(SimpleName:generateSelfSignedCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fooKeyPair)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:wsSecurityClientHandler)))(SimpleName:setServerCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStoreType))(VariableDeclarationFragment(SimpleName:keyStoreType)(QualifiedName:KeyStoreType.PKCS12)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:keyStorePassword)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:keyEntryPassword)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:alias)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:tmpP12File)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:File))(SimpleName:createTempFile)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpP12File))(SimpleName:deleteOnExit)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TestUtils))(SimpleName:persistInKeyStore)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmpP12File)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate))(SimpleName:certificate)(SimpleName:keyStorePassword)(SimpleName:keyEntryPassword)(SimpleName:alias))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:keyStorePath)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpP12File))(SimpleName:getAbsolutePath))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageFactory))(VariableDeclarationFragment(SimpleName:messageFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageFactory))(SimpleName:newInstance)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SOAPConstants.SOAP_1_1_PROTOCOL)))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:testSoapMessageInputStream)(MethodInvocation(METHOD_INVOCATION_RECEIVER(TypeLiteral(SimpleType(SimpleName:WSSecurityTest))))(SimpleName:getResourceAsStream)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:testSoapMessageInputStream))))(VariableDeclarationStatement(SimpleType(SimpleName:SOAPMessage))(VariableDeclarationFragment(SimpleName:message)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageFactory))(SimpleName:createMessage)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:testSoapMessageInputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:SOAPMessageContext))(VariableDeclarationFragment(SimpleName:soapMessageContext)(ClassInstanceCreation(SimpleType(SimpleName:TestSOAPMessageContext))(SimpleName:message)(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:soapMessageContext))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:MessageContext.SERVLET_CONTEXT)(FieldAccess(ThisExpression)(SimpleName:mockServletContext)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:expect)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:mockServletContext)))(SimpleName:getAttribute)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(TypeLiteral(SimpleType(SimpleName:TrustService))))(SimpleName:getName)))))))(SimpleName:andReturn)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mockTrustService))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:expect)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:mockTrustService)))(SimpleName:getWsSecurityConfig)))))(SimpleName:andReturn)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:WSSecurityConfigEntity))(StringLiteral:<STR>)(BooleanLiteral:true)(SimpleName:keyStoreType)(SimpleName:keyStorePath)(SimpleName:keyStorePassword)(SimpleName:keyEntryPassword)(SimpleName:alias)))))(ExpressionStatement(MethodInvocation(SimpleName:replay)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:mockObjects)))))(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:wsSecurityServerHandler)))(SimpleName:handleMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:soapMessageContext))))))(ExpressionStatement(MethodInvocation(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:mockObjects)))))(VariableDeclarationStatement(SimpleType(SimpleName:SOAPMessage))(VariableDeclarationFragment(SimpleName:resultMessage)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:soapMessageContext))(SimpleName:getMessage))))(VariableDeclarationStatement(SimpleType(SimpleName:SOAPPart))(VariableDeclarationFragment(SimpleName:resultSoapPart)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:resultMessage))(SimpleName:getSOAPPart))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TestUtils))(SimpleName:domToString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:resultSoapPart)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:nsElement)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:resultSoapPart))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nsElement))(SimpleName:setAttributeNS)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.NamespaceSpecNS)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nsElement))(SimpleName:setAttributeNS)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.NamespaceSpecNS)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nsElement))(SimpleName:setAttributeNS)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.NamespaceSpecNS)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nsElement))(SimpleName:setAttributeNS)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.NamespaceSpecNS)(StringLiteral:<STR>)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Node))(VariableDeclarationFragment(SimpleName:resultNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XPathAPI))(SimpleName:selectSingleNode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:resultSoapPart)(StringLiteral:<STR>)(SimpleName:nsElement)))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:resultNode))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XPathAPI))(SimpleName:selectSingleNode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:resultSoapPart)(StringLiteral:<STR>)(SimpleName:nsElement))))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:2.0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XPathAPI))(SimpleName:eval)(METHOD_INVOCATION_ARGUMENTS(SimpleName:resultSoapPart)(StringLiteral:<STR>)(SimpleName:nsElement))))(SimpleName:num)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:soapMessageContext))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:MessageContext.MESSAGE_OUTBOUND_PROPERTY)(BooleanLiteral:false))))(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:wsSecurityClientHandler)))(SimpleName:handleMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:soapMessageContext))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:wsSecurityClientHandler)))(SimpleName:setServerCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fooCertificate))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:wsSecurityClientHandler)))(SimpleName:handleMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:soapMessageContext))))(ExpressionStatement(MethodInvocation(SimpleName:fail))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:SOAPFaultException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))))))))))