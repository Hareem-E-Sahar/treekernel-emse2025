(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:int)(SimpleName:readwrite)(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:cmd))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:ref_num))(SingleVariableDeclaration(PrimitiveType:byte)(SimpleName:data_buffer)(Dimension))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:offset))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:len))(Block(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:params)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8))))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:offset)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:len)))(INFIX_EXPRESSION_OPERATOR:>)(QualifiedName:data_buffer.length))(ReturnStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:256))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:hmem)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vm02))(SimpleName:refAsBits)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:Object))(SimpleName:data_buffer))))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFFFF))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bufferptr)(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vm02))(SimpleName:call)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hmem)(NumberLiteral:0x0E)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFFFF)))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2)(SimpleName:offset))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:params)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(NumberLiteral:4)))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:params)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(SimpleName:ref_num))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:params)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(SimpleName:bufferptr))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:params)(NumberLiteral:3))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:bufferptr)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:params)(NumberLiteral:4))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(SimpleName:len))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:params)(NumberLiteral:5))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:result)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vm02))(SimpleName:call)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:cmd)(INFIX_EXPRESSION_OPERATOR:|)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vm02))(SimpleName:refAsBits)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:Object))(SimpleName:params))))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFFFF))))(NumberLiteral:0x54)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:vm02))(SimpleName:call)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hmem)(NumberLiteral:0x10))))(ReturnStatement(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:result)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0)))(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(SimpleName:result))(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(CastExpression(PrimitiveType:int)(ArrayAccess(SimpleName:params)(NumberLiteral:6)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0x00FF)))(INFIX_EXPRESSION_OPERATOR:|)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(CastExpression(PrimitiveType:int)(ArrayAccess(SimpleName:params)(NumberLiteral:7)))(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF00)))))))))))