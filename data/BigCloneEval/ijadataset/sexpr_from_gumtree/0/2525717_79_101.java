(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:OutputStream))(SimpleName:encrypt)(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:out))(SimpleType(SimpleName:Exception))(Block(IfStatement(InfixExpression(FieldAccess(ThisExpression)(SimpleName:encrypted))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:choice)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:JOptionPane))(SimpleName:showConfirmDialog)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.ENCRYPT_DATA_FILE_YES_NO)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.ENCRYPT_DATA_FILE_TITLE)))(QualifiedName:JOptionPane.YES_NO_OPTION)))))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:encrypted))(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Boolean))(InfixExpression(QualifiedName:JOptionPane.YES_OPTION)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:choice)))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:encrypted)))(SimpleName:booleanValue)))(Block(ReturnStatement(SimpleName:out))))(IfStatement(InfixExpression(FieldAccess(ThisExpression)(SimpleName:key))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:JPasswordInputDialog))(VariableDeclarationFragment(SimpleName:jpid)(ClassInstanceCreation(SimpleType(SimpleName:JPasswordInputDialog))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.ENTER_PASSWORD)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.ENTER_PASSWORD_TITLE)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.PASSWORD)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.CONFIRM_PASSWORD)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.PASSWORDS_DONT_MATCH)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.ERROR)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.NO_PASSWORD_ENTERED)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.ERROR)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.OK)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Translate))(SimpleName:getInstance)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TranslateKeys.CANCEL))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:password)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:jpid))(SimpleName:askForPassword)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true)(BooleanLiteral:true)))))(IfStatement(InfixExpression(SimpleName:password)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:encrypted))(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))(ReturnStatement(SimpleName:out))))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:salt))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:randomBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SALT_LENGTH)))))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:key))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PBKDF2))(SimpleName:getInstance)))(SimpleName:passwordToKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)(FieldAccess(ThisExpression)(SimpleName:keySize))(SimpleName:KEY_ALGORITHM)(FieldAccess(ThisExpression)(SimpleName:salt))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:salt)))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:cipher)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ALGORITHM)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(FieldAccess(ThisExpression)(SimpleName:key))(ClassInstanceCreation(SimpleType(SimpleName:IvParameterSpec))(FieldAccess(ThisExpression)(SimpleName:salt))))))(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:CipherOutputStream))(SimpleName:out)(SimpleName:cipher)))))))