(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:Element))(SimpleName:serialize)(SimpleType(SimpleName:SerializationException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:keyInfo)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.DSIG_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.DSIG_NAMESPACE))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:encryptedKey)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.ENC_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.ENC_NAMESPACE))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:encryptionMethod)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.ENC_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.ENC_NAMESPACE))))(VariableDeclarationStatement(SimpleType(SimpleName:Attribute))(VariableDeclarationFragment(SimpleName:encMethAlg)(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encryptionMethod))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encMethAlg))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:digestMethod)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.DSIG_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.DSIG_NAMESPACE))))(VariableDeclarationStatement(SimpleType(SimpleName:Attribute))(VariableDeclarationFragment(SimpleName:digMethAlg)(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestMethod))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digMethAlg))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encryptionMethod))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestMethod))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encryptedKey))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptionMethod))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:subKeyInfo)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.DSIG_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.DSIG_NAMESPACE))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:securityTokenReference)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.WSSE_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.WSSE_NAMESPACE_OASIS_10))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:keyIdentifier)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.WSSE_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.WSSE_NAMESPACE_OASIS_10))))(VariableDeclarationStatement(SimpleType(SimpleName:Attribute))(VariableDeclarationFragment(SimpleName:valueType)(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(StringLiteral:<STR>)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Attribute))(VariableDeclarationFragment(SimpleName:encodingType)(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyIdentifier))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:valueType))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyIdentifier))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encodingType))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:fingerPrint)(StringLiteral:<STR>)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:fingerPrint)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CryptoUtils))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getEncoded))(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:org.xmldap.exceptions.CryptoException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SerializationException))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CertificateEncodingException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SerializationException))(SimpleName:e))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyIdentifier))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fingerPrint))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:securityTokenReference))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyIdentifier))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subKeyInfo))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:securityTokenReference))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encryptedKey))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subKeyInfo))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:cipherData)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.ENC_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.ENC_NAMESPACE))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:cipherValue)(ClassInstanceCreation(SimpleType(SimpleName:Element))(InfixExpression(QualifiedName:WSConstants.ENC_PREFIX)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(QualifiedName:WSConstants.ENC_NAMESPACE))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:RSAPublicKey))(VariableDeclarationFragment(SimpleName:rsaPublicKey)(CastExpression(SimpleType(SimpleName:RSAPublicKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getPublicKey)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cipherText)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CryptoUtils))(SimpleName:rsaoaepEncrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:secretKey)(SimpleName:rsaPublicKey)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipherValue))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipherText)))))(CatchClause(SingleVariableDeclaration(SimpleType(QualifiedName:org.xmldap.exceptions.CryptoException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SerializationException))(SimpleName:e))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipherData))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipherValue))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encryptedKey))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipherData))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyInfo))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptedKey))))(ReturnStatement(SimpleName:keyInfo))))))