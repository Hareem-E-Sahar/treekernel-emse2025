(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(PrimitiveType:void)(SimpleName:filter)(SingleVariableDeclaration(Modifier:final)(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:String))(SimpleType(SimpleName:String)))(SimpleName:mailHeaders))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:String))(SimpleName:sBody))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:Mail))(SimpleName:mail))(Block(VariableDeclarationStatement(Modifier:final)(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:String))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:fields)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedHashMap))(SimpleType(SimpleName:String))(SimpleType(SimpleName:String))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(FieldAccess(ThisExpression)(SimpleName:dnsSelector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(FieldAccess(ThisExpression)(SimpleName:domain)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Format))(SimpleName:extractAddress)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:mail.sFrom))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:1000)))))))(VariableDeclarationStatement(Modifier:final)(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:foundHeaders)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:String))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:StringBuilder))(VariableDeclarationFragment(SimpleName:sbHeader)(ClassInstanceCreation(SimpleType(SimpleName:StringBuilder))(NumberLiteral:1024))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:header))(FieldAccess(ThisExpression)(SimpleName:headers))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mailHeaders))(SimpleName:containsKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:header)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:foundHeaders))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:header))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sbHeader))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:relaxedHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:header)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mailHeaders))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:header))))))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Sendmail.CRLF))))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:StringBuilder))(VariableDeclarationFragment(SimpleName:hField)(ClassInstanceCreation(SimpleType(SimpleName:StringBuilder)))))(EnhancedForStatement(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:String))(SimpleName:header))(SimpleName:foundHeaders)(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hField))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hField))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hField))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:header))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hField))(SimpleName:toString)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:sCanonBody)(MethodInvocation(SimpleName:simpleBody)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sBody)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sCanonBody))(SimpleName:length)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Utils))(SimpleName:base64Encode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:digester)))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sCanonBody))(SimpleName:getBytes)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:DKIM)(StringLiteral:<STR>)))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:StringBuilder))(VariableDeclarationFragment(SimpleName:sbValue)(ClassInstanceCreation(SimpleType(SimpleName:StringBuilder))(NumberLiteral:256))))(EnhancedForStatement(SingleVariableDeclaration(ParameterizedType(SimpleType(QualifiedName:Map.Entry))(SimpleType(SimpleName:String))(SimpleType(SimpleName:String)))(SimpleName:me))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fields))(SimpleName:entrySet))(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sbValue))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sbValue))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sbValue))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:me))(SimpleName:getKey)))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>))))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:me))(SimpleName:getValue)))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:sKeyValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sbValue))(SimpleName:toString))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sbHeader))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:relaxedHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:DKIM)(SimpleName:sKeyValue))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:sHeaders)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sbHeader))(SimpleName:toString))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:signer)))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sHeaders))(SimpleName:getBytes)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:signedSignature)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:signer)))(SimpleName:sign))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mailHeaders))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:DKIM)(InfixExpression(SimpleName:sKeyValue)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Utils))(SimpleName:base64Encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedSignature))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:SignatureException))(SimpleName:se))(Block)))))))