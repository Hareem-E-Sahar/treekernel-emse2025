(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:ScanResult))(SimpleName:doScan)(SimpleType(SimpleName:ScanException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Timestamp))(VariableDeclarationFragment(SimpleName:timeOfScan)(ClassInstanceCreation(SimpleType(SimpleName:Timestamp))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(SimpleName:isReady)))(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:HttpStaticScanResult))(QualifiedName:ScanResultCode.UNREADY)(SimpleName:timeOfScan))))(VariableDeclarationStatement(SimpleType(SimpleName:HostConfiguration))(VariableDeclarationFragment(SimpleName:hostConfig)(ClassInstanceCreation(SimpleType(SimpleName:HostConfiguration)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:port)(NumberLiteral:80)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:protocol)(StringLiteral:<STR>)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specimenUrl))(SimpleName:getPort))(INFIX_EXPRESSION_OPERATOR:>=)(NumberLiteral:0))(ExpressionStatement(Assignment(SimpleName:port)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specimenUrl))(SimpleName:getPort)))))(IfStatement(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specimenUrl))(SimpleName:getProtocol))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specimenUrl))(SimpleName:getProtocol))(INFIX_EXPRESSION_OPERATOR:!=)(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:protocol)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specimenUrl))(SimpleName:getProtocol)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hostConfig))(SimpleName:setHost)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specimenUrl))(SimpleName:getHost))(SimpleName:port)(SimpleName:protocol))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpMethod))(VariableDeclarationFragment(SimpleName:httpMethod)(ClassInstanceCreation(SimpleType(SimpleName:GetMethod))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specimenUrl))(SimpleName:toString)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpMethod))(SimpleName:setFollowRedirects)(METHOD_INVOCATION_ARGUMENTS(SimpleName:followRedirects))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpClient))(VariableDeclarationFragment(SimpleName:httpClient)(ClassInstanceCreation(SimpleType(SimpleName:HttpClient)))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpClient))(SimpleName:executeMethod)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hostConfig)(SimpleName:httpMethod)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:HttpException))(SimpleName:e))(Block))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(VariableDeclarationStatement(SimpleType(SimpleName:HttpStaticScanResult))(VariableDeclarationFragment(SimpleName:scanResult)(ClassInstanceCreation(SimpleType(SimpleName:HttpStaticScanResult))(QualifiedName:ScanResultCode.SCAN_FAILED)(SimpleName:timeOfScan))))(ExpressionStatement(Assignment(QualifiedName:scanResult.expectedResponseCode)(ASSIGNMENT_OPERATOR:=)(SimpleName:expectedResponseCode)))(ExpressionStatement(Assignment(QualifiedName:scanResult.expectedDataHash)(ASSIGNMENT_OPERATOR:=)(SimpleName:expectedDataHash)))(ExpressionStatement(Assignment(QualifiedName:scanResult.expectedDataHashAlgorithm)(ASSIGNMENT_OPERATOR:=)(SimpleName:expectedDataHashAlgorithm)))(ExpressionStatement(Assignment(QualifiedName:scanResult.specimenUrl)(ASSIGNMENT_OPERATOR:=)(SimpleName:specimenUrl)))(ExpressionStatement(MethodInvocation(SimpleName:logScanResult)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ScanResultCode.SCAN_FAILED)(QualifiedName:scanResult.deviations)(QualifiedName:HttpStaticScanRule.RULE_TYPE)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specimenUrl))(SimpleName:toString))(StringLiteral:<STR>))))(ReturnStatement(SimpleName:scanResult)))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:httpDataInStream)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:inputError)(BooleanLiteral:false)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:httpDataInStream)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpMethod))(SimpleName:getResponseBodyAsStream)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ExpressionStatement(Assignment(SimpleName:inputError)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:messageDigest)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:messageDigest)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:expectedDataHashAlgorithm))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ScanException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:expectedDataHashAlgorithm)(StringLiteral:<STR>))(SimpleName:e))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:inputBytes)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:4096))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bytesRead)(NumberLiteral:0)))(IfStatement(InfixExpression(InfixExpression(SimpleName:inputError)(INFIX_EXPRESSION_OPERATOR:==)(BooleanLiteral:false))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:httpDataInStream)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(TryStatement(Block(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:bytesRead)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpDataInStream))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inputBytes)))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inputBytes)(NumberLiteral:0)(SimpleName:bytesRead)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ExpressionStatement(Assignment(SimpleName:inputError)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hashBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:observedHashValue)(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Hex))(SimpleName:encodeHex)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hashBytes))))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Header))(Dimension))(VariableDeclarationFragment(SimpleName:headers)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpMethod))(SimpleName:getResponseHeaders))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Vector))(SimpleType(SimpleName:HttpHeaderScanResult)))(VariableDeclarationFragment(SimpleName:headerRuleMatches)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:Vector))(SimpleType(SimpleName:HttpHeaderScanResult))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:c)(NumberLiteral:0)))(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:headers.length))(PostfixExpression(SimpleName:c)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:HttpHeaderScanResult))(VariableDeclarationFragment(SimpleName:ruleResult)(MethodInvocation(SimpleName:analyzeHeader)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:headers)(SimpleName:c)))(SimpleName:getName))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:headers)(SimpleName:c)))(SimpleName:getValue))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headerRuleMatches))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ruleResult))))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpStaticScanResult))(VariableDeclarationFragment(SimpleName:scanResult)))(IfStatement(SimpleName:inputError)(ExpressionStatement(Assignment(SimpleName:scanResult)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:HttpStaticScanResult))(QualifiedName:ScanResultCode.SCAN_FAILED)(SimpleName:timeOfScan))))(ExpressionStatement(Assignment(SimpleName:scanResult)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:HttpStaticScanResult))(QualifiedName:ScanResultCode.SCAN_COMPLETED)(SimpleName:timeOfScan)))))(ExpressionStatement(Assignment(QualifiedName:scanResult.expectedResponseCode)(ASSIGNMENT_OPERATOR:=)(SimpleName:expectedResponseCode)))(ExpressionStatement(Assignment(QualifiedName:scanResult.expectedDataHash)(ASSIGNMENT_OPERATOR:=)(SimpleName:expectedDataHash)))(ExpressionStatement(Assignment(QualifiedName:scanResult.expectedDataHashAlgorithm)(ASSIGNMENT_OPERATOR:=)(SimpleName:expectedDataHashAlgorithm)))(ExpressionStatement(Assignment(QualifiedName:scanResult.specimenUrl)(ASSIGNMENT_OPERATOR:=)(SimpleName:specimenUrl)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:scanResult))(SimpleName:setActualHash)(METHOD_INVOCATION_ARGUMENTS(SimpleName:expectedDataHashAlgorithm)(SimpleName:observedHashValue))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:scanResult))(SimpleName:setActualResponseCode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpMethod))(SimpleName:getStatusCode)))))(ExpressionStatement(Assignment(QualifiedName:scanResult.headerResults)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(SimpleType(SimpleName:HttpHeaderScanResult))(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headerRuleMatches))(SimpleName:size)))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:c)(NumberLiteral:0)))(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headerRuleMatches))(SimpleName:size)))(PostfixExpression(SimpleName:c)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(Assignment(ArrayAccess(QualifiedName:scanResult.headerResults)(SimpleName:c))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headerRuleMatches))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:c)))))))(ExpressionStatement(MethodInvocation(SimpleName:logScanResult)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ScanResultCode.SCAN_COMPLETED)(QualifiedName:scanResult.deviations)(QualifiedName:HttpStaticScanRule.RULE_TYPE)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specimenUrl))(SimpleName:toString)))))(ReturnStatement(SimpleName:scanResult))))))