(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:encrypt)(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:b))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeyGenerator))(VariableDeclarationFragment(SimpleName:key_gen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key_gen))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:128)(SimpleName:sec_rand))))(VariableDeclarationStatement(SimpleType(SimpleName:Key))(VariableDeclarationFragment(SimpleName:aes_key)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key_gen))(SimpleName:generateKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:output_cipher)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:aes_key)(SimpleName:sec_rand))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:aes_iv)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_cipher))(SimpleName:getIV))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:aes_key_enc)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aes_key))(SimpleName:getEncoded))))(VariableDeclarationStatement(SimpleType(SimpleName:Mac))(VariableDeclarationFragment(SimpleName:mac)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Mac))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:mac_key_bytes)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:20))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sec_rand))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_key_bytes))))(VariableDeclarationStatement(SimpleType(SimpleName:Key))(VariableDeclarationFragment(SimpleName:mac_key)(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(SimpleName:mac_key_bytes)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mac))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_key))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:rsa_eng)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:msg_str)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:MacOutputStream))(VariableDeclarationFragment(SimpleName:mac_str)(ClassInstanceCreation(SimpleType(SimpleName:MacOutputStream))(SimpleName:msg_str)(SimpleName:mac))))(VariableDeclarationStatement(SimpleType(SimpleName:DataOutputStream))(VariableDeclarationFragment(SimpleName:data_str)(ClassInstanceCreation(SimpleType(SimpleName:DataOutputStream))(SimpleName:mac_str))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FILE_HEADER))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:CERT_BLOCK))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:certs.length))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:pub_key)(Dimension)(ArrayCreation(ArrayType(SimpleType(SimpleName:PublicKey))(Dimension(QualifiedName:certs.length))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:certs.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(Assignment(ArrayAccess(SimpleName:pub_key)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:certs)(SimpleName:i)))(SimpleName:getPublicKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:certs)(SimpleName:i)))(SimpleName:hashCode)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:KEY_BLOCK))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:pub_key.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsa_eng))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(ArrayAccess(SimpleName:pub_key)(SimpleName:i))(SimpleName:sec_rand))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tmp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsa_eng))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aes_key_enc)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:tmp.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))(ExpressionStatement(MethodInvocation(SimpleName:blank)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:IV_BLOCK))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:pub_key.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsa_eng))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(ArrayAccess(SimpleName:pub_key)(SimpleName:i))(SimpleName:sec_rand))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tmp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsa_eng))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aes_iv)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:tmp.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))(ExpressionStatement(MethodInvocation(SimpleName:blank)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:HMAC_KEY_BLOCK))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tmp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_cipher))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mac_key))(SimpleName:getEncoded))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:tmp.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))(ExpressionStatement(MethodInvocation(SimpleName:blank)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:l)(NumberLiteral:0)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8192))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:out)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayInputStream))(VariableDeclarationFragment(SimpleName:in_str)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(SimpleName:b))))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:l)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in_str))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))(INFIX_EXPRESSION_OPERATOR:>)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(Block(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_cipher))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(NumberLiteral:0)(SimpleName:l)))))(IfStatement(InfixExpression(SimpleName:out)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:DATA_BLOCK))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:out.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:out.length)(StringLiteral:<STR>)))))))))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_cipher))(SimpleName:doFinal))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FINAL_DATA_BLOCK))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:out.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:out.length)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(SimpleName:blank)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf))))(ExpressionStatement(Assignment(SimpleName:buf)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:HMAC_BLOCK))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:flush)))(ExpressionStatement(Assignment(SimpleName:tmp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mac))(SimpleName:doFinal))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:tmp.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))(ExpressionStatement(MethodInvocation(SimpleName:blank)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmp))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_str))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(SimpleName:blank)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aes_key_enc))))(ExpressionStatement(Assignment(SimpleName:aes_key_enc)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(Assignment(SimpleName:aes_key)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(Assignment(SimpleName:tmp)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:msg_str))(SimpleName:toByteArray))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:fatal)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:toString)))))(ReturnStatement(NullLiteral)))))))))