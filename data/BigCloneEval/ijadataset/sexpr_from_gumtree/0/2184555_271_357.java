(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:CipherText))(SimpleName:encrypt)(SingleVariableDeclaration(SimpleType(SimpleName:SecretKey))(SimpleName:key))(SingleVariableDeclaration(SimpleType(SimpleName:PlainText))(SimpleName:plain))(SimpleType(SimpleName:EncryptionException))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:plaintext)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:plain))(SimpleName:asBytes))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:overwritePlaintext)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ESAPI))(SimpleName:securityConfiguration)))(SimpleName:overwritePlainText))))(AssertStatement(InfixExpression(SimpleName:key)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(StringLiteral:<STR>))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:success)(BooleanLiteral:false)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:xform)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:keySize)(InfixExpression(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getEncoded))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:*)(NumberLiteral:8))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:xform)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ESAPI))(SimpleName:securityConfiguration)))(SimpleName:getCipherTransformation))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:String))(Dimension))(VariableDeclarationFragment(SimpleName:parts)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xform))(SimpleName:split)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(AssertStatement(InfixExpression(QualifiedName:parts.length)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:3))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:xform)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cipherMode)(ArrayAccess(SimpleName:parts)(NumberLiteral:1))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CryptoHelper))(SimpleName:isAllowedCipherMode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipherMode))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EncryptionException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:cipherMode)(StringLiteral:<STR>))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:xform)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:cipherMode))))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:encrypter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:xform)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cipherAlg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypter))(SimpleName:getAlgorithm))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:keyLen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ESAPI))(SimpleName:securityConfiguration)))(SimpleName:getEncryptionKeyLength))))(IfStatement(InfixExpression(SimpleName:keySize)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:keyLen))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:warning)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Logger.SECURITY_FAILURE)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keyLen)(StringLiteral:<STR>)(SimpleName:keySize)(StringLiteral:<STR>)))))))(IfStatement(InfixExpression(SimpleName:keySize)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:keyLen))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:warning)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Logger.SECURITY_FAILURE)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keySize)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:keyLen)(StringLiteral:<STR>)(SimpleName:cipherAlg)))))))(IfStatement(InfixExpression(SimpleName:keySize)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:112))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:warning)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Logger.SECURITY_FAILURE)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keySize)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:cipherAlg)(StringLiteral:<STR>)(StringLiteral:<STR>)))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:skeyAlg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getAlgorithm))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipherAlg))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:skeyAlg)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipherAlg))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:skeyAlg))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:warning)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Logger.SECURITY_FAILURE)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:cipherAlg)(StringLiteral:<STR>)(SimpleName:skeyAlg)(StringLiteral:<STR>)(SimpleName:cipherAlg)))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ivBytes)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:CipherSpec))(VariableDeclarationFragment(SimpleName:cipherSpec)(ClassInstanceCreation(SimpleType(SimpleName:CipherSpec))(SimpleName:encrypter)(SimpleName:keySize))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:preferredCipherMode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CryptoHelper))(SimpleName:isCombinedCipherMode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipherMode)))))(VariableDeclarationStatement(SimpleType(SimpleName:SecretKey))(VariableDeclarationFragment(SimpleName:encKey)(NullLiteral)))(IfStatement(SimpleName:preferredCipherMode)(Block(ExpressionStatement(Assignment(SimpleName:encKey)(ASSIGNMENT_OPERATOR:=)(SimpleName:key))))(Block(ExpressionStatement(Assignment(SimpleName:encKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:computeDerivedKey)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:KeyDerivationFunction.kdfVersion)(MethodInvocation(SimpleName:getDefaultPRF))(SimpleName:key)(SimpleName:keySize)(StringLiteral:<STR>)))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipherSpec))(SimpleName:requiresIV))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ivType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ESAPI))(SimpleName:securityConfiguration)))(SimpleName:getIVType))))(VariableDeclarationStatement(SimpleType(SimpleName:IvParameterSpec))(VariableDeclarationFragment(SimpleName:ivSpec)(NullLiteral)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ivType))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:ivBytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ESAPI))(SimpleName:randomizer)))(SimpleName:getRandomBytes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypter))(SimpleName:getBlockSize)))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ivType))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:fixedIVAsHex)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ESAPI))(SimpleName:securityConfiguration)))(SimpleName:getFixedIV))))(ExpressionStatement(Assignment(SimpleName:ivBytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Hex))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fixedIVAsHex))))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ConfigurationException))(StringLiteral:<STR>))))))(ExpressionStatement(Assignment(SimpleName:ivSpec)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:IvParameterSpec))(SimpleName:ivBytes))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipherSpec))(SimpleName:setIV)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ivBytes))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypter))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:encKey)(SimpleName:ivSpec)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypter))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:encKey))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Logger.EVENT_SUCCESS)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:cipherSpec)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:raw)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypter))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:plaintext)))))(VariableDeclarationStatement(SimpleType(SimpleName:CipherText))(VariableDeclarationFragment(SimpleName:ciphertext)(ClassInstanceCreation(SimpleType(SimpleName:CipherText))(SimpleName:cipherSpec)(SimpleName:raw))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:preferredCipherMode))(Block(VariableDeclarationStatement(SimpleType(SimpleName:SecretKey))(VariableDeclarationFragment(SimpleName:authKey)(MethodInvocation(SimpleName:computeDerivedKey)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:KeyDerivationFunction.kdfVersion)(MethodInvocation(SimpleName:getDefaultPRF))(SimpleName:key)(SimpleName:keySize)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ciphertext))(SimpleName:computeAndStoreMAC)(METHOD_INVOCATION_ARGUMENTS(SimpleName:authKey))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Logger.EVENT_SUCCESS)(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:success)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ReturnStatement(SimpleName:ciphertext)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidKeyException))(SimpleName:ike))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EncryptionException))(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:keySize)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ike))(SimpleName:getMessage)))(SimpleName:ike)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:ConfigurationException))(SimpleName:cex))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EncryptionException))(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(SimpleName:cex)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidAlgorithmParameterException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EncryptionException))(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IllegalBlockSizeException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EncryptionException))(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:xform)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:BadPaddingException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EncryptionException))(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EncryptionException))(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:xform)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchPaddingException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:EncryptionException))(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:xform)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))(SimpleName:e)))))(Block(IfStatement(InfixExpression(SimpleName:success)(INFIX_EXPRESSION_OPERATOR:&&)(SimpleName:overwritePlaintext))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:plain))(SimpleName:overwrite)))))))))))