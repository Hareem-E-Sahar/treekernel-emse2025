(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:connect)(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:InetAddress))(VariableDeclarationFragment(SimpleName:serverAddress)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:servername)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_options))(SimpleName:getHostname))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:serverAddress)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:InetAddress))(SimpleName:getByName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:servername))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:UnknownHostException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.err))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:servername)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:servername)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Socket))(VariableDeclarationFragment(SimpleName:socket)(ClassInstanceCreation(SimpleType(SimpleName:Socket))(SimpleName:serverAddress)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_options))(SimpleName:getPort)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:_handler)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ClientProtocolHandler))(SimpleName:socket)(SimpleName:_options))))(VariableDeclarationStatement(SimpleType(SimpleName:ReaderThread))(VariableDeclarationFragment(SimpleName:reader_thread)(ClassInstanceCreation(SimpleType(SimpleName:ReaderThread))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:getSTDOUT)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader_thread))(SimpleName:setDaemon)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader_thread))(SimpleName:start)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:exchangeIdStrings)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:receiveServerKey)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:server)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:socket))(SimpleName:getInetAddress)))(SimpleName:getHostAddress))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:server))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:==)(BooleanLiteral:false))(Block(ExpressionStatement(MethodInvocation(SimpleName:check_host_key)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:getServerKeyPacket))(SimpleName:servername)))))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:ITrueRandom))(VariableDeclarationFragment(SimpleName:trueRandom)(ClassInstanceCreation(SimpleType(SimpleName:DevURandom)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:sendSessionKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:trueRandom))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStreamReader))(VariableDeclarationFragment(SimpleName:inreader)(ClassInstanceCreation(SimpleType(SimpleName:InputStreamReader))(QualifiedName:System.in))))(VariableDeclarationStatement(SimpleType(SimpleName:BufferedReader))(VariableDeclarationFragment(SimpleName:keyboardReader)(ClassInstanceCreation(SimpleType(SimpleName:BufferedReader))(SimpleName:inreader))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:userName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_options))(SimpleName:getUser))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:authRequired)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:declareUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userName)))))(IfStatement(SimpleName:authRequired)(Block(VariableDeclarationStatement(SimpleType(SimpleName:RSAPrivateKeyFile))(VariableDeclarationFragment(SimpleName:keyfile)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:keyfile)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:RSAPrivateKeyFile))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_options))(SimpleName:getIdentityFile))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:FileNotFoundException))(SimpleName:e))(Block)))(IfStatement(InfixExpression(SimpleName:keyfile)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:RSAPrivateKey))(VariableDeclarationFragment(SimpleName:privateKey)(NullLiteral)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyfile))(SimpleName:getCipherType))(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:Cipher.SSH_CIPHER_NONE))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_options))(SimpleName:getIdentityFile))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:passphrase)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyboardReader))(SimpleName:readLine))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)))(ExpressionStatement(Assignment(SimpleName:privateKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyfile))(SimpleName:getPrivateKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:passphrase))))))(Block(ExpressionStatement(Assignment(SimpleName:privateKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyfile))(SimpleName:getPrivateKey))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:authenticateUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:privateKey)))(INFIX_EXPRESSION_OPERATOR:==)(BooleanLiteral:true))(Block(ExpressionStatement(Assignment(SimpleName:authRequired)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_options))(SimpleName:getIdentityFile))))))))(IfStatement(SimpleName:authRequired)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:userName)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:password)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyboardReader))(SimpleName:readLine))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:authenticateUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userName)(SimpleName:password))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SSHAuthFailedException)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:preparatoryOperations)))(ExpressionStatement(Assignment(SimpleName:_setupSucceeded)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:command)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_options))(SimpleName:getCommand))))(IfStatement(InfixExpression(SimpleName:command)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:execCmd)(METHOD_INVOCATION_ARGUMENTS(SimpleName:command)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:STDIN_OutputStream))(VariableDeclarationFragment(SimpleName:out)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:getSTDIN))))(VariableDeclarationStatement(SimpleType(SimpleName:WriterThread))(VariableDeclarationFragment(SimpleName:writer_thread)(ClassInstanceCreation(SimpleType(SimpleName:WriterThread))(SimpleName:out))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer_thread))(SimpleName:start)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:execShell)))))(ReturnStatement)))))