(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:int)(SimpleName:write)(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:out))(SingleVariableDeclaration(SimpleType(SimpleName:ByteBuffer))(SimpleName:data))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(Modifier:final)(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:count)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:remaining))))(IfStatement(InfixExpression(SimpleName:count)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(Block(ReturnStatement(NumberLiteral:0)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:hasArray))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:array))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:arrayOffset))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:position)))(SimpleName:count))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:position)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:limit))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:WritableByteChannel))(VariableDeclarationFragment(SimpleName:ch)))(IfStatement(InstanceofExpression(SimpleName:out)(SimpleType(SimpleName:WritableByteChannel)))(ExpressionStatement(Assignment(SimpleName:ch)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:WritableByteChannel))(SimpleName:out))))(IfStatement(InstanceofExpression(SimpleName:out)(SimpleType(SimpleName:FileOutputStream)))(ExpressionStatement(Assignment(SimpleName:ch)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:FileOutputStream))(SimpleName:out))))(SimpleName:getChannel))))(ExpressionStatement(Assignment(SimpleName:ch)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))))(IfStatement(InfixExpression(SimpleName:ch)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:r)(SimpleName:count)))(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:--)(SimpleName:r))(INFIX_EXPRESSION_OPERATOR:>=)(NumberLiteral:0))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:get)))))))(Block(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:r)(SimpleName:count)))(InfixExpression(SimpleName:r)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:step)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ch))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:step)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0)))(INFIX_EXPRESSION_OPERATOR:||)(ParenthesizedExpression(InfixExpression(SimpleName:step)(INFIX_EXPRESSION_OPERATOR:>)(SimpleName:r))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ReturnValueException))(SimpleName:ch)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:step))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:r)))))(ExpressionStatement(Assignment(SimpleName:r)(ASSIGNMENT_OPERATOR:-=)(SimpleName:step))))))))))(ReturnStatement(SimpleName:count))))))