(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(SimpleName:PdfStamperImp)(SingleVariableDeclaration(SimpleType(SimpleName:PdfReader))(SimpleName:reader))(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:os))(SingleVariableDeclaration(PrimitiveType:char)(SimpleName:pdfVersion))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:append))(SimpleType(SimpleName:DocumentException))(SimpleType(SimpleName:IOException))(Block(SuperConstructorInvocation(ClassInstanceCreation(SimpleType(SimpleName:PdfDocument)))(SimpleName:os))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:isOpenedWithFullPermissions)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:BadPasswordException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageLocalization))(SimpleName:getComposedMessage)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:isTampered))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:DocumentException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageLocalization))(SimpleName:getComposedMessage)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:setTampered)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:reader))(ASSIGNMENT_OPERATOR:=)(SimpleName:reader)))(ExpressionStatement(Assignment(SimpleName:file)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getSafeFile))))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:append))(ASSIGNMENT_OPERATOR:=)(SimpleName:append)))(IfStatement(SimpleName:append)(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:isRebuilt))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:DocumentException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageLocalization))(SimpleName:getComposedMessage)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:isEncrypted))(ExpressionStatement(Assignment(SimpleName:crypto)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:PdfEncryption))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getDecrypt))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pdf_version))(SimpleName:setAppendmode)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:file))(SimpleName:reOpen)))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:buf)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8192))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:n)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:n)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:file))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)))))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:os)))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(NumberLiteral:0)(SimpleName:n)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:file))(SimpleName:close)))(ExpressionStatement(Assignment(SimpleName:prevxref)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getLastXref))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:setAppendable)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true)))))(Block(IfStatement(InfixExpression(SimpleName:pdfVersion)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(ExpressionStatement(SuperMethodInvocation(SimpleName:setPdfVersion)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getPdfVersion))))(ExpressionStatement(SuperMethodInvocation(SimpleName:setPdfVersion)(SimpleName:pdfVersion))))))(ExpressionStatement(SuperMethodInvocation(SimpleName:open)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pdf))(SimpleName:addWriter)(METHOD_INVOCATION_ARGUMENTS(ThisExpression))))(IfStatement(SimpleName:append)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:setRefnum)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getXrefSize)))))(ExpressionStatement(Assignment(SimpleName:marked)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:IntHashtable)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:isNewXrefType))(ExpressionStatement(Assignment(SimpleName:fullCompression)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:isHybridXref))(ExpressionStatement(Assignment(SimpleName:fullCompression)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false))))))(ExpressionStatement(Assignment(SimpleName:initialXrefSize)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getXrefSize))))))))