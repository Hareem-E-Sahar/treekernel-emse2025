(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:wrapCommandAPDU)(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:capdu))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:len))(SimpleType(SimpleName:GeneralSecurityException))(SimpleType(SimpleName:IOException))(Block(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:capdu)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(QualifiedName:capdu.length)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:4)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:4)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalArgumentException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:lc)(NumberLiteral:0)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:le)(InfixExpression(ArrayAccess(SimpleName:capdu)(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0x000000FF))))(IfStatement(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:4))(Block(ExpressionStatement(Assignment(SimpleName:lc)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(ExpressionStatement(Assignment(SimpleName:le)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0))))(IfStatement(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:5))(Block(ExpressionStatement(Assignment(SimpleName:lc)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0))))(IfStatement(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:5))(Block(ExpressionStatement(Assignment(SimpleName:lc)(ASSIGNMENT_OPERATOR:=)(InfixExpression(ArrayAccess(SimpleName:capdu)(QualifiedName:ISO7816.OFFSET_LC))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0x000000FF))))))))(IfStatement(InfixExpression(InfixExpression(NumberLiteral:4)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:lc))(INFIX_EXPRESSION_OPERATOR:>=)(SimpleName:len))(Block(ExpressionStatement(Assignment(SimpleName:le)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:out)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:maskedHeader)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:4))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:capdu)(NumberLiteral:0)(SimpleName:maskedHeader)(NumberLiteral:0)(NumberLiteral:4))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:maskedHeader)(QualifiedName:ISO7816.OFFSET_CLA))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:capdu)(QualifiedName:ISO7816.OFFSET_CLA))(INFIX_EXPRESSION_OPERATOR:|)(NumberLiteral:0x0C))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:paddedHeader)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:pad)(METHOD_INVOCATION_ARGUMENTS(SimpleName:maskedHeader)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:do87)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:0))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:do8E)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:0))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:do97)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:0))))))(IfStatement(InfixExpression(SimpleName:le)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:reset)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(NumberLiteral:0x97)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(NumberLiteral:0x01)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(SimpleName:le)))))(ExpressionStatement(Assignment(SimpleName:do97)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:toByteArray))))))(IfStatement(InfixExpression(SimpleName:lc)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:pad)(METHOD_INVOCATION_ARGUMENTS(SimpleName:capdu)(QualifiedName:ISO7816.OFFSET_CDATA)(SimpleName:lc)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:ksEnc)(SimpleName:ZERO_IV_PARAM_SPEC))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ciphertext)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:reset)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(NumberLiteral:0x87)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BERTLVObject))(SimpleName:getLengthAsBytes)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(QualifiedName:ciphertext.length)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0x01))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ciphertext)(NumberLiteral:0)(QualifiedName:ciphertext.length))))(ExpressionStatement(Assignment(SimpleName:do87)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:toByteArray))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:reset)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:paddedHeader)(NumberLiteral:0)(QualifiedName:paddedHeader.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:do87)(NumberLiteral:0)(QualifiedName:do87.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:do97)(NumberLiteral:0)(QualifiedName:do97.length))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:m)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:toByteArray))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:reset)))(VariableDeclarationStatement(SimpleType(SimpleName:DataOutputStream))(VariableDeclarationFragment(SimpleName:dataOut)(ClassInstanceCreation(SimpleType(SimpleName:DataOutputStream))(SimpleName:out))))(ExpressionStatement(PostfixExpression(SimpleName:ssc)(POSTFIX_EXPRESSION_OPERATOR:++)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dataOut))(SimpleName:writeLong)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ssc))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dataOut))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:m)(NumberLiteral:0)(QualifiedName:m.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dataOut))(SimpleName:flush)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:n)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:pad)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:toByteArray))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mac))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ksMac))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:cc)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mac))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:n)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:reset)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(NumberLiteral:0x8E)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:cc.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cc)(NumberLiteral:0)(QualifiedName:cc.length))))(ExpressionStatement(Assignment(SimpleName:do8E)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:toByteArray))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:reset)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:maskedHeader)(NumberLiteral:0)(NumberLiteral:4))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(QualifiedName:do87.length)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:do97.length)(QualifiedName:do8E.length)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:do87)(NumberLiteral:0)(QualifiedName:do87.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:do97)(NumberLiteral:0)(QualifiedName:do97.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:do8E)(NumberLiteral:0)(QualifiedName:do8E.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0x00))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:toByteArray)))))))