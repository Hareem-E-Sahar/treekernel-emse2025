(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(PrimitiveType:long)(SimpleName:transferFrom)(SingleVariableDeclaration(SimpleType(SimpleName:Readable))(SimpleName:in))(SingleVariableDeclaration(PrimitiveType:long)(SimpleName:maxCount))(SimpleType(SimpleName:IOException))(Block(ExpressionStatement(MethodInvocation(SimpleName:ensureOpen)))(VariableDeclarationStatement(SimpleType(SimpleName:CharBuffer))(VariableDeclarationFragment(SimpleName:buf)(FieldAccess(ThisExpression)(SimpleName:buffer))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CheckArg))(SimpleName:maxCount)(METHOD_INVOCATION_ARGUMENTS(SimpleName:maxCount))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:count)(NumberLiteral:0)))(WhileStatement(BooleanLiteral:true)(Block(IfStatement(InfixExpression(SimpleName:count)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:maxCount))(BreakStatement))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:maxStep)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:remaining))))(IfStatement(InfixExpression(SimpleName:maxStep)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:buf)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:prepareBuffer)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(ParenthesizedExpression(SimpleName:maxCount))(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(NumberLiteral:1)(CastExpression(PrimitiveType:int)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Math))(SimpleName:min)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:capacity))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))(InfixExpression(SimpleName:maxCount)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:count))))))))))(ExpressionStatement(Assignment(SimpleName:maxStep)(ASSIGNMENT_OPERATOR:=)(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:maxCount)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:remaining))(CastExpression(PrimitiveType:int)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Math))(SimpleName:min)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:remaining))(InfixExpression(SimpleName:maxCount)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:count))))))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:pos)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:position))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:lim)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:limit))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:limit)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:position))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:maxStep)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:step)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:step)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:limit)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lim))))))(IfStatement(InfixExpression(SimpleName:step)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(BreakStatement)(IfStatement(InfixExpression(SimpleName:step)(INFIX_EXPRESSION_OPERATOR:>)(SimpleName:maxStep))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ReturnValueException))(SimpleName:in)(StringLiteral:<STR>)(SimpleName:step)(StringLiteral:<STR>)(SimpleName:maxStep)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:position))(INFIX_EXPRESSION_OPERATOR:!=)(InfixExpression(SimpleName:pos)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:step)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExternalAssertionException))(SimpleName:in)(StringLiteral:<STR>))))))(ExpressionStatement(Assignment(SimpleName:count)(ASSIGNMENT_OPERATOR:+=)(SimpleName:step)))))(ReturnStatement(SimpleName:count))))))