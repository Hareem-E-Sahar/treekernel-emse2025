(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:run)(Block(VariableDeclarationStatement(SimpleType(SimpleName:Socket))(VariableDeclarationFragment(SimpleName:s)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:out)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:DataInputStream))(VariableDeclarationFragment(SimpleName:in)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:count)(NumberLiteral:0)))(WhileStatement(InfixExpression(SimpleName:count)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:3))(Block(ExpressionStatement(PostfixExpression(SimpleName:count)(POSTFIX_EXPRESSION_OPERATOR:++)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:portAsInt)(NumberLiteral:0)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:portAsInt)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Integer))(SimpleName:parseInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:port))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NumberFormatException))(SimpleName:ee))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:Exception))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:port)))))))(ExpressionStatement(Assignment(SimpleName:s)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Socket)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:setKeepAlive)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:setSoTimeout)(METHOD_INVOCATION_ARGUMENTS(SimpleName:timeout))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:setTcpNoDelay)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false))))(VariableDeclarationStatement(SimpleType(QualifiedName:java.net.InetSocketAddress))(VariableDeclarationFragment(SimpleName:socketAddress)(ClassInstanceCreation(SimpleType(SimpleName:InetSocketAddress))(SimpleName:host)(SimpleName:portAsInt))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:connect)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socketAddress))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:isBound))(BreakStatement)(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block)))(ExpressionStatement(Assignment(SimpleName:s)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))))))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:getOutputStream))))(ExpressionStatement(Assignment(SimpleName:in)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DataInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:getInputStream)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:received_iv)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:128))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readFully)(METHOD_INVOCATION_ARGUMENTS(SimpleName:received_iv)(NumberLiteral:0)(NumberLiteral:128))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:time)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readInt))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:temp)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:host_name)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:64))))))(ExpressionStatement(Assignment(SimpleName:temp)(ASSIGNMENT_OPERATOR:=)(ConditionalExpression(ParenthesizedExpression(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:reportingHost)))(StringLiteral:<STR>)(SimpleName:reportingHost))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:temp))(SimpleName:getBytes))(NumberLiteral:0)(SimpleName:host_name)(NumberLiteral:0)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:temp))(SimpleName:getBytes))(SimpleName:length)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:service_name)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:128))))))(ExpressionStatement(Assignment(SimpleName:temp)(ASSIGNMENT_OPERATOR:=)(ConditionalExpression(ParenthesizedExpression(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:reportingService)))(StringLiteral:<STR>)(SimpleName:reportingService))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:temp))(SimpleName:getBytes))(NumberLiteral:0)(SimpleName:service_name)(NumberLiteral:0)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:temp))(SimpleName:getBytes))(SimpleName:length)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:plugin_output)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:512))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:replaceAll)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:message)))(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:getBytes))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:<=)(NumberLiteral:512))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:getBytes))(NumberLiteral:0)(SimpleName:plugin_output)(NumberLiteral:0)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:getBytes))(SimpleName:length))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:message))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:message))(SimpleName:getBytes))(NumberLiteral:0)(SimpleName:plugin_output)(NumberLiteral:0)(QualifiedName:plugin_output.length)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:getBytes))(NumberLiteral:0)(SimpleName:plugin_output)(NumberLiteral:0)(QualifiedName:plugin_output.length)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:alert_size)(InfixExpression(NumberLiteral:4)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:4)(NumberLiteral:4)(NumberLiteral:4)(QualifiedName:host_name.length)(QualifiedName:service_name.length)(QualifiedName:plugin_output.length))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:alert)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:alert_size))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:nsca_version)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:nsca_version)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:4))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:5))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:6))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:7))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:8))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:time)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:9))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:time)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:10))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:time)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:11))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:time)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:12))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:return_code)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:13))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:return_code)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:offset)(NumberLiteral:14)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:host_name)(NumberLiteral:0)(SimpleName:alert)(SimpleName:offset)(QualifiedName:host_name.length))))(ExpressionStatement(Assignment(SimpleName:offset)(ASSIGNMENT_OPERATOR:+=)(QualifiedName:host_name.length)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:service_name)(NumberLiteral:0)(SimpleName:alert)(SimpleName:offset)(QualifiedName:service_name.length))))(ExpressionStatement(Assignment(SimpleName:offset)(ASSIGNMENT_OPERATOR:+=)(QualifiedName:service_name.length)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:plugin_output)(NumberLiteral:0)(SimpleName:alert)(SimpleName:offset)(QualifiedName:plugin_output.length))))(ExpressionStatement(Assignment(SimpleName:offset)(ASSIGNMENT_OPERATOR:+=)(QualifiedName:plugin_output.length)))(VariableDeclarationStatement(SimpleType(SimpleName:CRC32))(VariableDeclarationFragment(SimpleName:crc)(ClassInstanceCreation(SimpleType(SimpleName:CRC32)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alert))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:crc_value)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:crc))(SimpleName:getValue))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:4))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:crc_value)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:5))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:crc_value)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:6))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:crc_value)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:alert)(NumberLiteral:7))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:crc_value)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))))(ExpressionStatement(MethodInvocation(SimpleName:encrypt_buffer)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryption_method)(SimpleName:alert)(SimpleName:received_iv))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alert)(NumberLiteral:0)(QualifiedName:alert.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:close)))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:close)))(ExpressionStatement(Assignment(SimpleName:in)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:close)))(ExpressionStatement(Assignment(SimpleName:s)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(Assignment(SimpleName:finished)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block))(Block(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:out))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ee))(Block)))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:out))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ee))(Block)))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:s))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ee))(Block)))))(SynchronizedStatement(ThisExpression)(Block(ExpressionStatement(MethodInvocation(SimpleName:notifyAll)))))))))))