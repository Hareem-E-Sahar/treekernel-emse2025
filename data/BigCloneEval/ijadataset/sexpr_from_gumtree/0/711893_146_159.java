(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Test))(Modifier:public)(PrimitiveType:void)(SimpleName:staleSpecReturnedFromCacheOnError)(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:HttpRequest))(VariableDeclarationFragment(SimpleName:request)(MethodInvocation(SimpleName:createIgnoreCacheRequest))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpRequest))(VariableDeclarationFragment(SimpleName:retriedRequest)(MethodInvocation(SimpleName:createCacheableRequest))))(VariableDeclarationStatement(SimpleType(SimpleName:HttpResponse))(VariableDeclarationFragment(SimpleName:expiredResponse)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:HttpResponseBuilder))))(SimpleName:setResponse)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOCAL_SPEC_XML))(SimpleName:getBytes)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(SimpleName:create))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:expect)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pipeline))(SimpleName:execute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request))))))(SimpleName:andReturn)(METHOD_INVOCATION_ARGUMENTS(SimpleName:expiredResponse))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:expect)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pipeline))(SimpleName:execute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:retriedRequest))))))(SimpleName:andReturn)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:HttpResponse))(SimpleName:notFound)))))(SimpleName:once)))(ExpressionStatement(MethodInvocation(SimpleName:replay)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pipeline))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specFactory))(SimpleName:getGadgetSpec)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:createContext)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SPEC_URL)(BooleanLiteral:true))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(QualifiedName:SoftExpiringCache.CachedObject))(SimpleType(SimpleName:Object)))(VariableDeclarationFragment(SimpleName:inCache)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:specFactory.cache))(SimpleName:getElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SPEC_URL)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:specFactory.cache))(SimpleName:addElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SPEC_URL)(QualifiedName:inCache.obj)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(VariableDeclarationStatement(SimpleType(SimpleName:GadgetSpec))(VariableDeclarationFragment(SimpleName:spec)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:specFactory))(SimpleName:getGadgetSpec)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:createContext)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SPEC_URL)(BooleanLiteral:false)))))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ALT_LOCAL_CONTENT)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:spec))(SimpleName:getView)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:GadgetSpec.DEFAULT_VIEW))))(SimpleName:getContent)))))))))