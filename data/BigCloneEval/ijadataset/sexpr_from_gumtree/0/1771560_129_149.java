(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:engineSign)(SimpleType(SimpleName:SignatureException))(Block(IfStatement(InstanceofExpression(SimpleName:privateKey)(SimpleType(SimpleName:PoorPrivateKey)))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:privateKeyAliasBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateKey))(SimpleName:toString)))(SimpleName:getBytes))))(IfStatement(InfixExpression(SimpleName:privateKeyAliasBytes)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignatureException))(StringLiteral:<STR>))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:signedDataB)(NullLiteral)))(SwitchStatement(SimpleName:signatureType)(SwitchCase(QualifiedName:PoorSettings.SIGNATURE_RAW_RSA))(Block(ExpressionStatement(Assignment(SimpleName:signedDataB)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PoorSignature))(SimpleName:signRaw)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest))(ClassInstanceCreation(SimpleType(SimpleName:String))(SimpleName:privateKeyAliasBytes))(SimpleName:SIGNATURE_OID)(SimpleName:hStore))))))(BreakStatement)(SwitchCase(QualifiedName:PoorSettings.SIGNATURE_PKCS_7))(Block(ExpressionStatement(Assignment(SimpleName:signedDataB)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PoorSignature))(SimpleName:signPkcs7)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:toByteArray))(ClassInstanceCreation(SimpleType(SimpleName:String))(SimpleName:privateKeyAliasBytes))(SimpleName:SIGNATURE_OID)(SimpleName:hStore)(SimpleName:includeSigner)(SimpleName:detachedSignature)))))))(ReturnStatement(SimpleName:signedDataB))))(ExpressionStatement(Assignment(SimpleName:mode)(ASSIGNMENT_OPERATOR:=)(SimpleName:MODE_UNINITIALIZED)))(ReturnStatement(NullLiteral))))))