(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:engineLoad)(SingleVariableDeclaration(SimpleType(SimpleName:InputStream))(SimpleName:stream))(SingleVariableDeclaration(ArrayType(PrimitiveType:char)(Dimension))(SimpleName:password))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:CertificateException))(Block(SynchronizedStatement(SimpleName:entries)(Block(VariableDeclarationStatement(SimpleType(SimpleName:DataInputStream))(VariableDeclarationFragment(SimpleName:dis)))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:CertificateFactory))(VariableDeclarationFragment(SimpleName:cf)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:Hashtable))(VariableDeclarationFragment(SimpleName:cfs)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayInputStream))(VariableDeclarationFragment(SimpleName:bais)(NullLiteral)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encoded)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:stream)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ReturnStatement))(IfStatement(InfixExpression(SimpleName:password)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:md)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getPreKeyedHash)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)))))(ExpressionStatement(Assignment(SimpleName:dis)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DataInputStream))(ClassInstanceCreation(SimpleType(SimpleName:DigestInputStream))(SimpleName:stream)(SimpleName:md))))))(Block(ExpressionStatement(Assignment(SimpleName:dis)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DataInputStream))(SimpleName:stream))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:xMagic)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readInt))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:xVersion)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readInt))))(IfStatement(InfixExpression(InfixExpression(SimpleName:xMagic)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:MAGIC))(INFIX_EXPRESSION_OPERATOR:||)(ParenthesizedExpression(InfixExpression(InfixExpression(SimpleName:xVersion)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:VERSION_1))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:xVersion)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:VERSION_2)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:xVersion)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:VERSION_1))(Block(ExpressionStatement(Assignment(SimpleName:cf)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(Block(ExpressionStatement(Assignment(SimpleName:cfs)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Hashtable))(NumberLiteral:3))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entries))(SimpleName:clear)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:count)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readInt))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:count))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:tag)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:alias)))(ExpressionStatement(Assignment(SimpleName:tag)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readInt))))(IfStatement(InfixExpression(SimpleName:tag)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:1))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeyEntry))(VariableDeclarationFragment(SimpleName:entry)(ClassInstanceCreation(SimpleType(SimpleName:KeyEntry)))))(ExpressionStatement(Assignment(SimpleName:alias)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readUTF))))(ExpressionStatement(Assignment(QualifiedName:entry.date)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Date))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readLong)))))(TryStatement(Block(ExpressionStatement(Assignment(QualifiedName:entry.protectedPrivKey)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readInt))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:OutOfMemoryError))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readFully)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:entry.protectedPrivKey))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:numOfCerts)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readInt))))(TryStatement(Block(IfStatement(InfixExpression(SimpleName:numOfCerts)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(QualifiedName:entry.chain)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(SimpleType(SimpleName:Certificate))(Dimension(SimpleName:numOfCerts)))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:OutOfMemoryError))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:j)(NumberLiteral:0)))(InfixExpression(SimpleName:j)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:numOfCerts))(PostfixExpression(SimpleName:j)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(SimpleName:xVersion)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:2))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:certType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readUTF))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cfs))(SimpleName:containsKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)))(Block(ExpressionStatement(Assignment(SimpleName:cf)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:CertificateFactory))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cfs))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)))))))(Block(ExpressionStatement(Assignment(SimpleName:cf)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cfs))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)(SimpleName:cf))))))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:encoded)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readInt))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:OutOfMemoryError))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readFully)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encoded))))(ExpressionStatement(Assignment(SimpleName:bais)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(SimpleName:encoded))))(ExpressionStatement(Assignment(ArrayAccess(QualifiedName:entry.chain)(SimpleName:j))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cf))(SimpleName:generateCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bais)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bais))(SimpleName:close)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entries))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)(SimpleName:entry)))))(IfStatement(InfixExpression(SimpleName:tag)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:2))(Block(VariableDeclarationStatement(SimpleType(SimpleName:TrustedCertEntry))(VariableDeclarationFragment(SimpleName:entry)(ClassInstanceCreation(SimpleType(SimpleName:TrustedCertEntry)))))(ExpressionStatement(Assignment(SimpleName:alias)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readUTF))))(ExpressionStatement(Assignment(QualifiedName:entry.date)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Date))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readLong)))))(IfStatement(InfixExpression(SimpleName:xVersion)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:2))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:certType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readUTF))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cfs))(SimpleName:containsKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)))(Block(ExpressionStatement(Assignment(SimpleName:cf)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:CertificateFactory))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cfs))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)))))))(Block(ExpressionStatement(Assignment(SimpleName:cf)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cfs))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certType)(SimpleName:cf))))))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:encoded)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readInt))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:OutOfMemoryError))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readFully)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encoded))))(ExpressionStatement(Assignment(SimpleName:bais)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(SimpleName:encoded))))(ExpressionStatement(Assignment(QualifiedName:entry.cert)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cf))(SimpleName:generateCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bais)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bais))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entries))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)(SimpleName:entry)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))))))(IfStatement(InfixExpression(SimpleName:password)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:computed)(Dimension))(VariableDeclarationFragment(SimpleName:actual)(Dimension)))(ExpressionStatement(Assignment(SimpleName:computed)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest))))(ExpressionStatement(Assignment(SimpleName:actual)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(QualifiedName:computed.length))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readFully)(METHOD_INVOCATION_ARGUMENTS(SimpleName:actual))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:computed.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(ArrayAccess(SimpleName:computed)(SimpleName:i))(INFIX_EXPRESSION_OPERATOR:!=)(ArrayAccess(SimpleName:actual)(SimpleName:i)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))))))))))))))