(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleName:EncryptStream)(SingleVariableDeclaration(SimpleType(SimpleName:Key))(SimpleName:key))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:fname))(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:output))(SingleVariableDeclaration(SimpleType(SimpleName:SecureRandom))(SimpleName:rnd))(SingleVariableDeclaration(PrimitiveType:char)(SimpleName:mode))(SingleVariableDeclaration(SimpleType(SimpleName:Signer))(SimpleName:signer))(SimpleType(SimpleName:Exception))(Block(SuperConstructorInvocation(SimpleName:output))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:salt)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:prefix)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:10))))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:c)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:time)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:Date))))(SimpleName:getTime))(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:1000))))(ExpressionStatement(Assignment(SimpleName:sig)(ASSIGNMENT_OPERATOR:=)(SimpleName:signer)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(NumberLiteral:0xc0)(INFIX_EXPRESSION_OPERATOR:|)(QualifiedName:Packet.PROCRYPTED)))))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:PacketOutputStream))(SimpleName:out)(NumberLiteral:13))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rnd))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:salt))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:salt)(NumberLiteral:0)(SimpleName:prefix)(NumberLiteral:0)(NumberLiteral:8))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:salt)(NumberLiteral:6)(SimpleName:prefix)(NumberLiteral:8)(NumberLiteral:2))))(ExpressionStatement(Assignment(SimpleName:md)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:key)(ClassInstanceCreation(SimpleType(SimpleName:IvParameterSpec))(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8))))))))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:CipherOutputStream))(SimpleName:out)(SimpleName:c))))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DigestOutputStream))(SimpleName:out)(SimpleName:md))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:prefix))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(NumberLiteral:0xc0)(INFIX_EXPRESSION_OPERATOR:|)(QualifiedName:Packet.COMPRESSED)))))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(Assignment(SimpleName:pos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:PacketOutputStream))(SimpleName:out)(NumberLiteral:13)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:2))))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DeflaterOutputStream))(SimpleName:out))))(IfStatement(InfixExpression(SimpleName:sig)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:writePreamble)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(NumberLiteral:0xc0)(INFIX_EXPRESSION_OPERATOR:|)(QualifiedName:Packet.LITERAL)))))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(Assignment(SimpleName:sos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:PacketOutputStream))(SimpleName:out)(NumberLiteral:13)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mode))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fname))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:255))(ExpressionStatement(Assignment(SimpleName:fname)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fname))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(NumberLiteral:255))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fname))(SimpleName:length)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fname))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:Long))(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:time)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))(SimpleName:byteValue)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:Long))(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:time)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))(SimpleName:byteValue)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:Long))(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:time)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))(SimpleName:byteValue)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:Long))(InfixExpression(SimpleName:time)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xff))))(SimpleName:byteValue)))))(IfStatement(InfixExpression(SimpleName:sig)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(Assignment(SimpleName:out)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SignerStream))(SimpleName:sig)(SimpleName:out)))))))))