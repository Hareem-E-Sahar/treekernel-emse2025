(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:perform)(SingleVariableDeclaration(SimpleType(SimpleName:Socket))(SimpleName:connection))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:DataInputStream))(VariableDeclarationFragment(SimpleName:in)(ClassInstanceCreation(SimpleType(SimpleName:DataInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:connection))(SimpleName:getInputStream)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:out)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:connection))(SimpleName:getOutputStream))))(VariableDeclarationStatement(Modifier:final)(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:io_error)(NumberLiteral:1)))(VariableDeclarationStatement(Modifier:final)(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:hk_error)(NumberLiteral:2)))(VariableDeclarationStatement(Modifier:final)(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:done)(NumberLiteral:4)))(VariableDeclarationStatement(SimpleType(SimpleName:Thread))(VariableDeclarationFragment(SimpleName:read)(ClassInstanceCreation(SimpleType(SimpleName:Thread))(ClassInstanceCreation(SimpleType(SimpleName:Runnable))(AnonymousClassDeclaration(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:run)(Block(TryStatement(Block(SynchronizedStatement(SimpleName:monitor)(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:STR))(SimpleName:getBytes))(SimpleName:length)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readFully)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:String))(SimpleName:data)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:STR))))(Block(ExpressionStatement(Assignment(SimpleName:status)(ASSIGNMENT_OPERATOR:|=)(SimpleName:hk_error)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:monitor))(SimpleName:notifyAll)))(ExpressionStatement(Assignment(SimpleName:status)(ASSIGNMENT_OPERATOR:|=)(SimpleName:done))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ExpressionStatement(Assignment(SimpleName:status)(ASSIGNMENT_OPERATOR:|=)(SimpleName:io_error)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace)))))))))))))(VariableDeclarationStatement(SimpleType(SimpleName:Thread))(VariableDeclarationFragment(SimpleName:write)(ClassInstanceCreation(SimpleType(SimpleName:Thread))(ClassInstanceCreation(SimpleType(SimpleName:Runnable))(AnonymousClassDeclaration(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:run)(Block(TryStatement(Block(SynchronizedStatement(SimpleName:monitor)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:STR))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:monitor))(SimpleName:notifyAll)))(ExpressionStatement(Assignment(SimpleName:status)(ASSIGNMENT_OPERATOR:|=)(SimpleName:done))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace)))(ExpressionStatement(Assignment(SimpleName:status)(ASSIGNMENT_OPERATOR:|=)(SimpleName:io_error)))))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:read))(SimpleName:start)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:write))(SimpleName:start)))(SynchronizedStatement(SimpleName:monitor)(Block(WhileStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:status)(INFIX_EXPRESSION_OPERATOR:&)(SimpleName:done)))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:1))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:monitor))(SimpleName:wait))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InterruptedException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace))))))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:status)(INFIX_EXPRESSION_OPERATOR:&)(SimpleName:hk_error)))(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:hk_error))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:status)(INFIX_EXPRESSION_OPERATOR:&)(SimpleName:io_error)))(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:io_error))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))))))))))