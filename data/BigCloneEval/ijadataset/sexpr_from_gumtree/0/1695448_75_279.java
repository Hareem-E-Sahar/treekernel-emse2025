(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:signJar)(SingleVariableDeclaration(SimpleType(SimpleName:JSParameters))(SimpleName:param))(SimpleType(SimpleName:JarSignerException))(Block(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:aliasUsed)(BooleanLiteral:false)))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:tsaCert)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ZipFile))(VariableDeclarationFragment(SimpleName:zipFile)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:sigfile)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:sigfile)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:sigfile)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:getAlias))))(ExpressionStatement(Assignment(SimpleName:aliasUsed)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigfile))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:8))(Block(ExpressionStatement(Assignment(SimpleName:sigfile)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigfile))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(NumberLiteral:8))))(SimpleName:toUpperCase)))))(Block(ExpressionStatement(Assignment(SimpleName:sigfile)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigfile))(SimpleName:toUpperCase))))))(VariableDeclarationStatement(SimpleType(SimpleName:StringBuilder))(VariableDeclarationFragment(SimpleName:tmpSigFile)(ClassInstanceCreation(SimpleType(SimpleName:StringBuilder))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigfile))(SimpleName:length)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:j)(NumberLiteral:0)))(InfixExpression(SimpleName:j)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigfile))(SimpleName:length)))(PostfixExpression(SimpleName:j)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(PrimitiveType:char)(VariableDeclarationFragment(SimpleName:c)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigfile))(SimpleName:charAt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:j)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:>=)(CharacterLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<=)(CharacterLiteral:<STR>))))(INFIX_EXPRESSION_OPERATOR:||)(ParenthesizedExpression(InfixExpression(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:>=)(CharacterLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<=)(CharacterLiteral:<STR>))))(ParenthesizedExpression(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:==)(CharacterLiteral:<STR>)))(ParenthesizedExpression(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:==)(CharacterLiteral:<STR>))))))(Block(IfStatement(SimpleName:aliasUsed)(Block(ExpressionStatement(Assignment(SimpleName:c)(ASSIGNMENT_OPERATOR:=)(CharacterLiteral:<STR>))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(StringLiteral:<STR>)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpSigFile))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:c))))))(ExpressionStatement(Assignment(SimpleName:sigfile)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpSigFile))(SimpleName:toString))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:tmpJarName)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:getSignedJARName))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(Assignment(SimpleName:tmpJarName)(ASSIGNMENT_OPERATOR:=)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:getJarName))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:tmpJarName)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:getSignedJARName)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:jarFile)(ClassInstanceCreation(SimpleType(SimpleName:File))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:getJarName)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:signedJarFile)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:tmpJarName))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:nombre)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:getJarName))))(ExpressionStatement(Assignment(SimpleName:zipFile)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ZipFile))(SimpleName:nombre)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioe))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:getJarName))))))))(VariableDeclarationStatement(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:fos)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:fos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:signedJarFile)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioe))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:tmpJarName)))))))(VariableDeclarationStatement(SimpleType(SimpleName:PrintStream))(VariableDeclarationFragment(SimpleName:ps)(ClassInstanceCreation(SimpleType(SimpleName:PrintStream))(SimpleName:fos))))(VariableDeclarationStatement(SimpleType(SimpleName:ZipOutputStream))(VariableDeclarationFragment(SimpleName:zos)(ClassInstanceCreation(SimpleType(SimpleName:ZipOutputStream))(SimpleName:ps))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:sfFilename)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(InfixExpression(SimpleName:META_INF)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:sigfile)(StringLiteral:<STR>))))(SimpleName:toUpperCase))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:bkFilename)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(InfixExpression(SimpleName:META_INF)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:sigfile)(StringLiteral:<STR>))))(SimpleName:toUpperCase))))(VariableDeclarationStatement(SimpleType(SimpleName:Manifest))(VariableDeclarationFragment(SimpleName:manifest)(ClassInstanceCreation(SimpleType(SimpleName:Manifest)))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:String))(SimpleType(SimpleName:Attributes)))(VariableDeclarationFragment(SimpleName:mfEntries)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifest))(SimpleName:getEntries))))(VariableDeclarationStatement(SimpleType(SimpleName:Attributes))(VariableDeclarationFragment(SimpleName:oldAttr)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:mfCreated)(BooleanLiteral:false)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:mfModified)(BooleanLiteral:false)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:mfRawBytes)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:digests)(Dimension)(ArrayInitializer(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestalg))))))(VariableDeclarationStatement(SimpleType(SimpleName:ZipEntry))(VariableDeclarationFragment(SimpleName:mfFile)))(IfStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:mfFile)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getManifestFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zipFile)))))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:mfRawBytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zipFile)(SimpleName:mfFile)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifest))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(SimpleName:mfRawBytes)))))(ExpressionStatement(Assignment(SimpleName:oldAttr)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:Attributes))(ParenthesizedExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifest))(SimpleName:getMainAttributes)))(SimpleName:clone)))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Attributes))(VariableDeclarationFragment(SimpleName:mattr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifest))(SimpleName:getMainAttributes))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mattr))(SimpleName:putValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:Attributes.Name.MANIFEST_VERSION))(SimpleName:toString))(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:javaVendor)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:jdkVersion)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mattr))(SimpleName:putValue)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(InfixExpression(SimpleName:jdkVersion)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:javaVendor)(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:mfFile)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ZipEntry))(QualifiedName:JarFile.MANIFEST_NAME))))(ExpressionStatement(Assignment(SimpleName:mfCreated)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))))(VariableDeclarationStatement(SimpleType(SimpleName:BASE64Encoder))(VariableDeclarationFragment(SimpleName:encoder)(ClassInstanceCreation(SimpleType(SimpleName:JarBASE64Encoder)))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Vector))(SimpleType(SimpleName:ZipEntry)))(VariableDeclarationFragment(SimpleName:mfFiles)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:Vector))(SimpleType(SimpleName:ZipEntry))))))(ForStatement(VariableDeclarationExpression(ParameterizedType(SimpleType(SimpleName:Enumeration))(WildcardType(SimpleType(SimpleName:ZipEntry))))(VariableDeclarationFragment(SimpleName:enum_)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipFile))(SimpleName:entries))))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:enum_))(SimpleName:hasMoreElements))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ZipEntry))(VariableDeclarationFragment(SimpleName:ze)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:enum_))(SimpleName:nextElement))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ze))(SimpleName:getName)))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(SimpleName:META_INF)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfFiles))(SimpleName:addElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ze))))(IfStatement(MethodInvocation(SimpleName:signatureRelated)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ze))(SimpleName:getName))))(Block(ContinueStatement)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifest))(SimpleName:getAttributes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ze))(SimpleName:getName))))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(IfStatement(InfixExpression(MethodInvocation(SimpleName:updateDigests)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ze)(SimpleName:zipFile)(SimpleName:digests)(SimpleName:encoder)(SimpleName:manifest)))(INFIX_EXPRESSION_OPERATOR:==)(BooleanLiteral:true))(Block(ExpressionStatement(Assignment(SimpleName:mfModified)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ze))(SimpleName:isDirectory)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Attributes))(VariableDeclarationFragment(SimpleName:attrs)(MethodInvocation(SimpleName:getDigestAttributes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ze)(SimpleName:zipFile)(SimpleName:digests)(SimpleName:encoder)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfEntries))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ze))(SimpleName:getName))(SimpleName:attrs))))(ExpressionStatement(Assignment(SimpleName:mfModified)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))))))(IfStatement(SimpleName:mfModified)(Block(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:baos)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifest))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:baos))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:newBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:toByteArray))))(IfStatement(InfixExpression(InfixExpression(SimpleName:mfRawBytes)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oldAttr))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifest))(SimpleName:getMainAttributes)))))(Block(ExpressionStatement(Assignment(SimpleName:mfRawBytes)(ASSIGNMENT_OPERATOR:=)(SimpleName:newBytes)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:newPos)(MethodInvocation(SimpleName:findHeaderEnd)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newBytes)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:oldPos)(MethodInvocation(SimpleName:findHeaderEnd)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mfRawBytes)))))(IfStatement(InfixExpression(SimpleName:newPos)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:oldPos))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mfRawBytes)(NumberLiteral:0)(SimpleName:newBytes)(NumberLiteral:0)(SimpleName:oldPos)))))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:lastBytes)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(InfixExpression(SimpleName:oldPos)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:newBytes.length))(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:newPos)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mfRawBytes)(NumberLiteral:0)(SimpleName:lastBytes)(NumberLiteral:0)(SimpleName:oldPos))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newBytes)(SimpleName:newPos)(SimpleName:lastBytes)(SimpleName:oldPos)(InfixExpression(QualifiedName:newBytes.length)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:newPos)))))(ExpressionStatement(Assignment(SimpleName:newBytes)(ASSIGNMENT_OPERATOR:=)(SimpleName:lastBytes)))))))(ExpressionStatement(Assignment(SimpleName:mfRawBytes)(ASSIGNMENT_OPERATOR:=)(SimpleName:newBytes)))))(IfStatement(SimpleName:mfModified)(Block(ExpressionStatement(Assignment(SimpleName:mfFile)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ZipEntry))(QualifiedName:JarFile.MANIFEST_NAME))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:isVerbose))(Block(IfStatement(SimpleName:mfCreated)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(ParenthesizedExpression(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfFile))(SimpleName:getName)))))))(IfStatement(SimpleName:mfModified)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(ParenthesizedExpression(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfFile))(SimpleName:getName)))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zos))(SimpleName:putNextEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mfFile))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zos))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mfRawBytes))))(VariableDeclarationStatement(SimpleType(SimpleName:ManifestDigester))(VariableDeclarationFragment(SimpleName:manDig)(ClassInstanceCreation(SimpleType(SimpleName:ManifestDigester))(SimpleName:mfRawBytes))))(VariableDeclarationStatement(SimpleType(SimpleName:SignatureFile))(VariableDeclarationFragment(SimpleName:sf)(ClassInstanceCreation(SimpleType(SimpleName:SignatureFile))(SimpleName:digests)(SimpleName:manifest)(SimpleName:manDig)(SimpleName:sigfile)(SimpleName:signManifest))))(VariableDeclarationStatement(SimpleType(QualifiedName:SignatureFile.Block))(VariableDeclarationFragment(SimpleName:block)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:block)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sf))(SimpleName:generateBlock)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:certChain)(BooleanLiteral:true)(NullLiteral)(SimpleName:tsaCert)(NullLiteral)(SimpleName:param)(SimpleName:zipFile))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:SocketTimeoutException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>)(StringLiteral:<STR>)(StringLiteral:<STR>)(StringLiteral:<STR>))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidKeyException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:UnrecoverableKeyException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:SignatureException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CertificateException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:KeyStoreException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:JarSignerException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))(ExpressionStatement(Assignment(SimpleName:sfFilename)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sf))(SimpleName:getMetaName))))(ExpressionStatement(Assignment(SimpleName:bkFilename)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:block))(SimpleName:getMetaName))))(VariableDeclarationStatement(SimpleType(SimpleName:ZipEntry))(VariableDeclarationFragment(SimpleName:sfFile)(ClassInstanceCreation(SimpleType(SimpleName:ZipEntry))(SimpleName:sfFilename))))(VariableDeclarationStatement(SimpleType(SimpleName:ZipEntry))(VariableDeclarationFragment(SimpleName:bkFile)(ClassInstanceCreation(SimpleType(SimpleName:ZipEntry))(SimpleName:bkFilename))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:time)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sfFile))(SimpleName:setTime)(METHOD_INVOCATION_ARGUMENTS(SimpleName:time))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bkFile))(SimpleName:setTime)(METHOD_INVOCATION_ARGUMENTS(SimpleName:time))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zos))(SimpleName:putNextEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sfFile))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sf))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zos))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zos))(SimpleName:putNextEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bkFile))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:block))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zos))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfFiles))(SimpleName:size)))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ZipEntry))(VariableDeclarationFragment(SimpleName:ze)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mfFiles))(SimpleName:elementAt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i)))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ze))(SimpleName:getName)))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:JarFile.MANIFEST_NAME))))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ze))(SimpleName:getName)))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sfFilename))))(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ze))(SimpleName:getName)))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bkFilename)))))(Block(ExpressionStatement(MethodInvocation(SimpleName:writeEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zipFile)(SimpleName:zos)(SimpleName:ze))))))))(ForStatement(VariableDeclarationExpression(ParameterizedType(SimpleType(SimpleName:Enumeration))(WildcardType(SimpleType(SimpleName:ZipEntry))))(VariableDeclarationFragment(SimpleName:enum_)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipFile))(SimpleName:entries))))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:enum_))(SimpleName:hasMoreElements))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ZipEntry))(VariableDeclarationFragment(SimpleName:ze)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:enum_))(SimpleName:nextElement))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ze))(SimpleName:getName)))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(SimpleName:META_INF))))(Block(ExpressionStatement(MethodInvocation(SimpleName:writeEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zipFile)(SimpleName:zos)(SimpleName:ze)))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioe))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ioe))(SimpleName:ioe)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:e))(SimpleName:e)))))(Block(IfStatement(InfixExpression(SimpleName:zipFile)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipFile))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(StringLiteral:<STR>))))))(ExpressionStatement(Assignment(SimpleName:zipFile)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))))(IfStatement(InfixExpression(SimpleName:zos)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zos))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(StringLiteral:<STR>))))))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:getSignedJARName))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedJarFile))(SimpleName:renameTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jarFile))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:origJar)(ClassInstanceCreation(SimpleType(SimpleName:File))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:param))(SimpleName:getJarName))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:jarFile))(SimpleName:renameTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:origJar)))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedJarFile))(SimpleName:renameTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jarFile)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:origJar))(SimpleName:delete))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageFormat))(VariableDeclarationFragment(SimpleName:form)(ClassInstanceCreation(SimpleType(SimpleName:MessageFormat))(StringLiteral:<STR>))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Object))(Dimension))(VariableDeclarationFragment(SimpleName:source)(ArrayInitializer(SimpleName:signedJarFile)(SimpleName:jarFile))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:form))(SimpleName:format)(METHOD_INVOCATION_ARGUMENTS(SimpleName:source))))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageFormat))(VariableDeclarationFragment(SimpleName:form)(ClassInstanceCreation(SimpleType(SimpleName:MessageFormat))(StringLiteral:<STR>))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Object))(Dimension))(VariableDeclarationFragment(SimpleName:source)(ArrayInitializer(SimpleName:jarFile)(SimpleName:origJar))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:JarSignerException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:form))(SimpleName:format)(METHOD_INVOCATION_ARGUMENTS(SimpleName:source)))))))))))))))