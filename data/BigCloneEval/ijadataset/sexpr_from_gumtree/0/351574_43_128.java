(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(SimpleName:verifySignature)(SingleVariableDeclaration(SimpleType(SimpleName:InputStream))(SimpleName:signature))(SingleVariableDeclaration(SimpleType(SimpleName:InputStream))(SimpleName:signatureBlock))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:GeneralSecurityException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:BerInputStream))(VariableDeclarationFragment(SimpleName:bis)(ClassInstanceCreation(SimpleType(SimpleName:BerInputStream))(SimpleName:signatureBlock))))(VariableDeclarationStatement(SimpleType(SimpleName:ContentInfo))(VariableDeclarationFragment(SimpleName:info)(CastExpression(SimpleType(SimpleName:ContentInfo))(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:ContentInfo.ASN1))(SimpleName:decode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:bis))))))(VariableDeclarationStatement(SimpleType(SimpleName:SignedData))(VariableDeclarationFragment(SimpleName:signedData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:info))(SimpleName:getSignedData))))(IfStatement(InfixExpression(SimpleName:signedData)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Messages))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Collection))(VariableDeclarationFragment(SimpleName:encCerts)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedData))(SimpleName:getCertificates))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encCerts))(SimpleName:isEmpty))(Block(ReturnStatement(NullLiteral))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:certs)(ArrayCreation(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encCerts))(SimpleName:size)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(ForStatement(VariableDeclarationExpression(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:it)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encCerts))(SimpleName:iterator))))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:hasNext))(Block(ExpressionStatement(Assignment(ArrayAccess(SimpleName:certs)(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++)))(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:X509CertImpl))(CastExpression(SimpleType(QualifiedName:org.apache.harmony.security.x509.Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:next))))))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:sigInfos)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedData))(SimpleName:getSignerInfos))))(VariableDeclarationStatement(SimpleType(SimpleName:SignerInfo))(VariableDeclarationFragment(SimpleName:sigInfo)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfos))(SimpleName:isEmpty)))(Block(ExpressionStatement(Assignment(SimpleName:sigInfo)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:SignerInfo))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfos))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))))(Block(ReturnStatement(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:X500Principal))(VariableDeclarationFragment(SimpleName:issuer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfo))(SimpleName:getIssuer))))(VariableDeclarationStatement(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:snum)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfo))(SimpleName:getSerialNumber))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:issuerSertIndex)(NumberLiteral:0)))(ForStatement(Assignment(SimpleName:i)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:certs.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:issuer))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:certs)(SimpleName:i)))(SimpleName:getIssuerDN))))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:snum))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:certs)(SimpleName:i)))(SimpleName:getSerialNumber)))))(Block(ExpressionStatement(Assignment(SimpleName:issuerSertIndex)(ASSIGNMENT_OPERATOR:=)(SimpleName:i)))(BreakStatement)))))(IfStatement(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:certs.length))(Block(ReturnStatement(NullLiteral))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:certs)(SimpleName:issuerSertIndex)))(SimpleName:hasUnsupportedCriticalExtension))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SecurityException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Messages))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Signature))(VariableDeclarationFragment(SimpleName:sig)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:da)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfo))(SimpleName:getdigestAlgorithm))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:dea)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfo))(SimpleName:getDigestEncryptionAlgorithm))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:alg)(NullLiteral)))(IfStatement(InfixExpression(InfixExpression(SimpleName:da)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:dea)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:alg)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:da)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:dea))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:sig)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Signature))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alg))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block)))))(IfStatement(InfixExpression(SimpleName:sig)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:alg)(ASSIGNMENT_OPERATOR:=)(SimpleName:da)))(IfStatement(InfixExpression(SimpleName:alg)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ReturnStatement(NullLiteral))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:sig)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Signature))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alg))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ReturnStatement(NullLiteral)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:initVerify)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:certs)(SimpleName:issuerSertIndex)))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:atr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfo))(SimpleName:getAuthenticatedAttributes))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:sfBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:InputStreamHelper))(SimpleName:readFullyAndClose)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signature)))))(IfStatement(InfixExpression(SimpleName:atr)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sfBytes)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfo))(SimpleName:getEncodedAuthenticatedAttributes)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:existingDigest)(NullLiteral)))(ForStatement(VariableDeclarationExpression(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:it)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:atr))(SimpleName:iterator))))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:hasNext))(Block(VariableDeclarationStatement(SimpleType(SimpleName:AttributeTypeAndValue))(VariableDeclarationFragment(SimpleName:a)(CastExpression(SimpleType(SimpleName:AttributeTypeAndValue))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:next)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:a))(SimpleName:getType)))(SimpleName:getOid))(SimpleName:MESSAGE_DIGEST_OID)))(Block))))(IfStatement(InfixExpression(SimpleName:existingDigest)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfo))(SimpleName:getDigestAlgorithm))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:computedDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sfBytes)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:existingDigest)(SimpleName:computedDigest))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SecurityException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Messages))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sigInfo))(SimpleName:getEncryptedDigest)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SecurityException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Messages))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(ReturnStatement(MethodInvocation(SimpleName:createChain)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:certs)(SimpleName:issuerSertIndex))(SimpleName:certs))))))))