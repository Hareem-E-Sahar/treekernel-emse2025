(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(SimpleType(SimpleName:String))(SimpleName:PopulateTemplate)(SingleVariableDeclaration(SimpleType(SimpleName:HttpServletRequest))(SimpleName:request))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:getTemplateFullPathOnly))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:getTemplateFilenameOnly))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:populateDMCodes))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:selectedBeamlineName))(SingleVariableDeclaration(SimpleType(SimpleName:List))(SimpleName:hashDMCodesForBeamline))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:populateForExport))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:nbContainersToExport))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:populateForShipment))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:shippingId))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:populatedTemplatePath)(StringLiteral:<STR>)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:xlsPath)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:proposalCode)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:proposalNumber)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:populatedTemplateFileName)))(VariableDeclarationStatement(SimpleType(SimpleName:GregorianCalendar))(VariableDeclarationFragment(SimpleName:calendar)(ClassInstanceCreation(SimpleType(SimpleName:GregorianCalendar)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:today)(StringLiteral:<STR>)))(IfStatement(InfixExpression(SimpleName:request)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Constants.TEMPLATE_POPULATED_RELATIVE_PATH)))(IfStatement(SimpleName:populateForShipment)(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FROM_SHIPMENT))))(IfStatement(SimpleName:populateForExport)(Block(SwitchStatement(SimpleName:nbContainersToExport)(SwitchCase(NumberLiteral:1))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME1))))(BreakStatement)(SwitchCase(NumberLiteral:2))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME2))))(BreakStatement)(SwitchCase(NumberLiteral:3))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME3))))(BreakStatement)(SwitchCase(NumberLiteral:4))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME4))))(BreakStatement)(SwitchCase(NumberLiteral:5))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME5))))(BreakStatement)(SwitchCase(NumberLiteral:6))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME6))))(BreakStatement)(SwitchCase(NumberLiteral:7))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME7))))(BreakStatement)(SwitchCase(NumberLiteral:8))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME8))))(BreakStatement)(SwitchCase(NumberLiteral:9))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME9))))(BreakStatement)(SwitchCase(NumberLiteral:10))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_XLS_POPULATED_FOR_EXPORT_FILENAME10))))(BreakStatement)))))(ExpressionStatement(Assignment(SimpleName:proposalCode)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getSession)))(SimpleName:getAttribute)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.PROPOSAL_CODE))))))(ExpressionStatement(Assignment(SimpleName:proposalNumber)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getSession)))(SimpleName:getAttribute)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.PROPOSAL_NUMBER)))))))(IfStatement(SimpleName:populateForShipment)(ExpressionStatement(Assignment(SimpleName:populatedTemplateFileName)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:proposalCode)(SimpleName:proposalNumber)(StringLiteral:<STR>)(SimpleName:shippingId)(SimpleName:today))))(ExpressionStatement(Assignment(SimpleName:populatedTemplateFileName)(ASSIGNMENT_OPERATOR:=)(InfixExpression(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:proposalCode)(SimpleName:proposalNumber)(ParenthesizedExpression(ConditionalExpression(ParenthesizedExpression(SimpleName:populateDMCodes))(StringLiteral:<STR>)(StringLiteral:<STR>)))(SimpleName:today)))))(ExpressionStatement(Assignment(SimpleName:populatedTemplatePath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getContextPath))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:populatedTemplateFileName))))(IfStatement(InfixExpression(SimpleName:getTemplateFilenameOnly)(INFIX_EXPRESSION_OPERATOR:&&)(SimpleName:populateForShipment))(ReturnStatement(InfixExpression(SimpleName:proposalCode)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:proposalNumber)(StringLiteral:<STR>)(SimpleName:shippingId)(SimpleName:today))))(IfStatement(InfixExpression(SimpleName:getTemplateFilenameOnly)(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:populateForShipment)))(ReturnStatement(InfixExpression(SimpleName:proposalCode)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:proposalNumber)(ParenthesizedExpression(ConditionalExpression(ParenthesizedExpression(SimpleName:populateDMCodes))(StringLiteral:<STR>)(StringLiteral:<STR>)))(SimpleName:today))))(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRealPath)(METHOD_INVOCATION_ARGUMENTS(SimpleName:xlsPath)))))(ExpressionStatement(Assignment(SimpleName:populatedTemplateFileName)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRealPath)(METHOD_INVOCATION_ARGUMENTS(SimpleName:populatedTemplateFileName))))))(Block(ExpressionStatement(Assignment(SimpleName:xlsPath)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_POPULATED_RELATIVE_PATH))))(ExpressionStatement(Assignment(SimpleName:proposalCode)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:proposalNumber)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(ExpressionStatement(Assignment(SimpleName:populatedTemplateFileName)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:Constants.TEMPLATE_RELATIVE_DIRECTORY_PATH)(SimpleName:proposalCode)(SimpleName:proposalNumber)(SimpleName:today))))))(IfStatement(SimpleName:getTemplateFullPathOnly)(ReturnStatement(SimpleName:populatedTemplateFileName)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:beamlineName)(SimpleName:selectedBeamlineName)))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:String))(Dimension)(Dimension))(VariableDeclarationFragment(SimpleName:dmCodesinSC)(NullLiteral)))(IfStatement(SimpleName:populateDMCodes)(Block(ExpressionStatement(Assignment(SimpleName:dmCodesinSC)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(SimpleType(SimpleName:String))(Dimension(InfixExpression(QualifiedName:Constants.SC_BASKET_CAPACITY)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)))(Dimension(InfixExpression(QualifiedName:Constants.BASKET_SAMPLE_CAPACITY)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)))))))(VariableDeclarationStatement(SimpleType(SimpleName:DatamatrixInSampleChangerFacadeLocal))(VariableDeclarationFragment(SimpleName:dms)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DatamatrixInSampleChangerFacadeUtil))(SimpleName:getLocalHome)))(SimpleName:create))))(VariableDeclarationStatement(SimpleType(SimpleName:ProposalLightValue))(VariableDeclarationFragment(SimpleName:prop)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DBTools))(SimpleName:getProposal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:proposalCode)(ClassInstanceCreation(SimpleType(SimpleName:Integer))(SimpleName:proposalNumber))))))(IfStatement(InfixExpression(SimpleName:prop)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:proposalId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prop))(SimpleName:getProposalId))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:lstDMCodes)(CastExpression(SimpleType(SimpleName:List))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dms))(SimpleName:findByProposalIdAndBeamlineName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:proposalId)(SimpleName:beamlineName))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lstDMCodes))(SimpleName:size)))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DatamatrixInSampleChangerValue))(VariableDeclarationFragment(SimpleName:dmInSC)(CastExpression(SimpleType(SimpleName:DatamatrixInSampleChangerValue))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lstDMCodes))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i))))))(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:basketLocation)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmInSC))(SimpleName:getContainerLocationInSc))))(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:sampleLocation)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmInSC))(SimpleName:getLocationInContainer))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:dmCode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmInSC))(SimpleName:getDatamatrixCode))))(IfStatement(InfixExpression(InfixExpression(SimpleName:basketLocation)(INFIX_EXPRESSION_OPERATOR:<=)(QualifiedName:Constants.SC_BASKET_CAPACITY))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:sampleLocation)(INFIX_EXPRESSION_OPERATOR:<=)(QualifiedName:Constants.BASKET_SAMPLE_CAPACITY)))(Block(ExpressionStatement(Assignment(ArrayAccess(ArrayAccess(SimpleName:dmCodesinSC)(SimpleName:basketLocation))(SimpleName:sampleLocation))(ASSIGNMENT_OPERATOR:=)(SimpleName:dmCode)))))))))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:originalTemplate)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:xlsPath))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:populatedTemplate)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:populatedTemplateFileName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:copyFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:originalTemplate)(SimpleName:populatedTemplate))))(VariableDeclarationStatement(SimpleType(SimpleName:eHTPXXLSParser))(VariableDeclarationFragment(SimpleName:parser)(ClassInstanceCreation(SimpleType(SimpleName:eHTPXXLSParser)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:xlsTemplate)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:xlsPath))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:xlsPopulatedTemplate)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:populatedTemplateFileName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:copyFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:xlsTemplate)(SimpleName:xlsPopulatedTemplate))))(VariableDeclarationStatement(SimpleType(SimpleName:ProposalFacadeLocal))(VariableDeclarationFragment(SimpleName:_proposal)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ProposalFacadeUtil))(SimpleName:getLocalHome)))(SimpleName:create))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:proposals)(CastExpression(SimpleType(SimpleName:List))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_proposal))(SimpleName:findByCodeAndNumber)(METHOD_INVOCATION_ARGUMENTS(SimpleName:proposalCode)(ClassInstanceCreation(SimpleType(SimpleName:Integer))(SimpleName:proposalNumber)))))))(VariableDeclarationStatement(SimpleType(SimpleName:ProposalLightValue))(VariableDeclarationFragment(SimpleName:proposalLight)(CastExpression(SimpleType(SimpleName:ProposalLightValue))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:proposals))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(VariableDeclarationStatement(SimpleType(SimpleName:ProteinFacadeLocal))(VariableDeclarationFragment(SimpleName:_protein)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ProteinFacadeUtil))(SimpleName:getLocalHome)))(SimpleName:create))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:listProteins)(CastExpression(SimpleType(SimpleName:List))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_protein))(SimpleName:findByProposalId)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:proposalLight))(SimpleName:getPrimaryKey)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:parser))(SimpleName:populate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:xlsPath)(SimpleName:populatedTemplateFileName)(SimpleName:listProteins)(SimpleName:dmCodesinSC))))(IfStatement(SimpleName:populateForShipment)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:parser))(SimpleName:populateExistingShipment)(METHOD_INVOCATION_ARGUMENTS(SimpleName:populatedTemplateFileName)(SimpleName:populatedTemplateFileName)(SimpleName:shippingId))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ex))(SimpleName:printStackTrace))))))(ReturnStatement(SimpleName:populatedTemplatePath))))))