(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(SimpleName:InitSecContextToken)(SingleVariableDeclaration(SimpleType(SimpleName:Krb5Context))(SimpleName:context))(SingleVariableDeclaration(ArrayType(SimpleType(SimpleName:EncryptionKey))(Dimension))(SimpleName:keys))(SingleVariableDeclaration(SimpleType(SimpleName:InputStream))(SimpleName:is))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:GSSException))(SimpleType(SimpleName:KrbException))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:tokenId)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:is))(SimpleName:read))(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:|)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:is))(SimpleName:read))))))(IfStatement(InfixExpression(SimpleName:tokenId)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:Krb5Token.AP_REQ_ID))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GSSException))(QualifiedName:GSSException.DEFECTIVE_TOKEN)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))(StringLiteral:<STR>))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:apReqBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(QualifiedName:sun.security.util.DerValue))(SimpleName:is)))(SimpleName:toByteArray))))(VariableDeclarationStatement(SimpleType(SimpleName:InetAddress))(VariableDeclarationFragment(SimpleName:addr)(NullLiteral)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getChannelBinding))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:addr)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getChannelBinding)))(SimpleName:getInitiatorAddress))))))(ExpressionStatement(Assignment(SimpleName:apReq)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:KrbApReq))(SimpleName:apReqBytes)(SimpleName:keys)(SimpleName:addr))))(VariableDeclarationStatement(SimpleType(SimpleName:EncryptionKey))(VariableDeclarationFragment(SimpleName:sessionKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:apReq))(SimpleName:getCreds)))(SimpleName:getSessionKey))))(VariableDeclarationStatement(SimpleType(SimpleName:EncryptionKey))(VariableDeclarationFragment(SimpleName:subKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:apReq))(SimpleName:getSubKey))))(IfStatement(InfixExpression(SimpleName:subKey)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:setKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:subKey)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:setKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sessionKey))))))(VariableDeclarationStatement(SimpleType(SimpleName:OverloadedChecksum))(VariableDeclarationFragment(SimpleName:gssChecksum)(ClassInstanceCreation(SimpleType(SimpleName:OverloadedChecksum))(SimpleName:context)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:apReq))(SimpleName:getChecksum))(SimpleName:sessionKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gssChecksum))(SimpleName:setContextFlags)(METHOD_INVOCATION_ARGUMENTS(SimpleName:context))))(VariableDeclarationStatement(SimpleType(SimpleName:Credentials))(VariableDeclarationFragment(SimpleName:delegCred)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gssChecksum))(SimpleName:getDelegatedCreds))))(IfStatement(InfixExpression(SimpleName:delegCred)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Krb5CredElement))(VariableDeclarationFragment(SimpleName:credElement)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Krb5InitCredential))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:Krb5NameElement))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getSrcName)))(SimpleName:delegCred)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:setDelegCred)(METHOD_INVOCATION_ARGUMENTS(SimpleName:credElement))))))(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:apReqSeqNumber)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:apReq))(SimpleName:getSeqNumber))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:peerSeqNumber)(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:apReqSeqNumber)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:apReqSeqNumber))(SimpleName:intValue))(NumberLiteral:0)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:resetPeerSequenceNumber)(METHOD_INVOCATION_ARGUMENTS(SimpleName:peerSeqNumber))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getMutualAuthState)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:resetMySequenceNumber)(METHOD_INVOCATION_ARGUMENTS(SimpleName:peerSeqNumber)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:setAuthTime)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:KerberosTime))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:apReq))(SimpleName:getCreds)))(SimpleName:getAuthTime))))(SimpleName:toString)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:setTktFlags)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:apReq))(SimpleName:getCreds)))(SimpleName:getFlags)))))(VariableDeclarationStatement(SimpleType(SimpleName:AuthorizationData))(VariableDeclarationFragment(SimpleName:ad)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:apReq))(SimpleName:getCreds)))(SimpleName:getAuthzData))))(IfStatement(InfixExpression(SimpleName:ad)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:setAuthzData)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)))))(Block(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:AuthorizationDataEntry))(Dimension))(VariableDeclarationFragment(SimpleName:authzData)(ArrayCreation(ArrayType(SimpleType(SimpleName:AuthorizationDataEntry))(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ad))(SimpleName:count)))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ad))(SimpleName:count)))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(Assignment(ArrayAccess(SimpleName:authzData)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:AuthorizationDataEntry))(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ad))(SimpleName:item)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i)))(SimpleName:adType))(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ad))(SimpleName:item)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i)))(SimpleName:adData)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:setAuthzData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:authzData))))))))))