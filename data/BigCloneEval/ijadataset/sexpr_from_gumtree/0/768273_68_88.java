(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Test))(Modifier:public)(PrimitiveType:void)(SimpleName:testIncomingBatch)(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:String))(Dimension))(VariableDeclarationFragment(SimpleName:insertValues)(ArrayCreation(ArrayType(SimpleType(SimpleName:String))(Dimension(QualifiedName:TEST_COLUMNS.length))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:insertValues)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(Assignment(ArrayAccess(SimpleName:insertValues)(NumberLiteral:4))(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:out)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:CsvWriter))(VariableDeclarationFragment(SimpleName:writer)(MethodInvocation(SimpleName:getWriter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:writeRecord)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:String))(Dimension))(ArrayInitializer(QualifiedName:CsvConstants.NODEID)(QualifiedName:TestConstants.TEST_CLIENT_EXTERNAL_ID))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:writeRecord)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:String))(Dimension))(ArrayInitializer(QualifiedName:CsvConstants.CHANNEL)(QualifiedName:TestConstants.TEST_CHANNEL_ID))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:nextBatchId)(MethodInvocation(SimpleName:getNextBatchId))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:writeRecord)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:String))(Dimension))(ArrayInitializer(QualifiedName:CsvConstants.BATCH)(SimpleName:nextBatchId))))))(ExpressionStatement(MethodInvocation(SimpleName:writeTable)(METHOD_INVOCATION_ARGUMENTS(SimpleName:writer)(SimpleName:TEST_TABLE)(SimpleName:TEST_KEYS)(SimpleName:TEST_COLUMNS))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:insertValues)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getNextId))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CsvConstants.INSERT))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:writeRecord)(METHOD_INVOCATION_ARGUMENTS(SimpleName:insertValues)(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:writeRecord)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:String))(Dimension))(ArrayInitializer(QualifiedName:CsvConstants.COMMIT)(SimpleName:nextBatchId))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:close)))(ExpressionStatement(MethodInvocation(SimpleName:load)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out))))(VariableDeclarationStatement(SimpleType(SimpleName:IncomingBatch))(VariableDeclarationFragment(SimpleName:batch)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getIncomingBatchService)))(SimpleName:findIncomingBatch)(METHOD_INVOCATION_ARGUMENTS(SimpleName:batchId)(QualifiedName:TestConstants.TEST_CLIENT_EXTERNAL_ID)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:batch))(SimpleName:getStatus))(QualifiedName:IncomingBatch.Status.OK)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(SimpleName:printDatabase))))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:batch))(SimpleName:getChannelId))(QualifiedName:TestConstants.TEST_CHANNEL_ID)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(SimpleName:printDatabase))))))))))