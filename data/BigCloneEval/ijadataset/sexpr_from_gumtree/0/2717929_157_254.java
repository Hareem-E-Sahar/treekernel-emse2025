(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:boolean)(SimpleName:verificarFirma)(SingleVariableDeclaration(SimpleType(SimpleName:OMElement))(SimpleName:omRequest))(SingleVariableDeclaration(SimpleType(SimpleName:MessageContext))(SimpleName:synCtx))(Block(VariableDeclarationStatement(SimpleType(SimpleName:SynapseLog))(VariableDeclarationFragment(SimpleName:synLog)(MethodInvocation(SimpleName:getLog)(METHOD_INVOCATION_ARGUMENTS(SimpleName:synCtx)))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:verificacionOK)(BooleanLiteral:false)))(VariableDeclarationStatement(SimpleType(SimpleName:OMElement))(VariableDeclarationFragment(SimpleName:node)(NullLiteral))(VariableDeclarationFragment(SimpleName:response)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:nodeName))(VariableDeclarationFragment(SimpleName:nodeValue)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:datos)(StringLiteral:<STR>))(VariableDeclarationFragment(SimpleName:firma)(StringLiteral:<STR>))(VariableDeclarationFragment(SimpleName:formatoFirma)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:TAG_DATOS)(StringLiteral:<STR>))(VariableDeclarationFragment(SimpleName:TAG_FIRMA)(StringLiteral:<STR>))(VariableDeclarationFragment(SimpleName:TAG_FORMATO_FIRMA)(StringLiteral:<STR>)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:FORMATO_FIRMA_XADES_BES)(StringLiteral:<STR>))(VariableDeclarationFragment(SimpleName:FORMATO_FIRMA_XADES_T)(StringLiteral:<STR>))(VariableDeclarationFragment(SimpleName:FORMATO_FIRMA_CADES_BES)(StringLiteral:<STR>))(VariableDeclarationFragment(SimpleName:FORMATO_FIRMA_CADES_T)(StringLiteral:<STR>)))(ForStatement(VariableDeclarationExpression(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:it)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omRequest))(SimpleName:getChildElements))))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:hasNext))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Object))(VariableDeclarationFragment(SimpleName:o)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:next))))(IfStatement(InstanceofExpression(SimpleName:o)(SimpleType(SimpleName:OMElement)))(Block(ExpressionStatement(Assignment(SimpleName:node)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:OMElement))(SimpleName:o))))(ExpressionStatement(Assignment(SimpleName:nodeName)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:node))(SimpleName:getLocalName))))(ExpressionStatement(Assignment(SimpleName:nodeValue)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:node))(SimpleName:getText))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nodeName))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:TAG_DATOS)))(Block(ExpressionStatement(Assignment(SimpleName:datos)(ASSIGNMENT_OPERATOR:=)(SimpleName:nodeValue))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nodeName))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:TAG_FIRMA)))(Block(ExpressionStatement(Assignment(SimpleName:firma)(ASSIGNMENT_OPERATOR:=)(SimpleName:nodeValue))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nodeName))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:TAG_FORMATO_FIRMA)))(Block(ExpressionStatement(Assignment(SimpleName:formatoFirma)(ASSIGNMENT_OPERATOR:=)(SimpleName:nodeValue)))))))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:String))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:res)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:String))(SimpleType(SimpleName:String))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:TAG_DATOS)(SimpleName:datos))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:TAG_FIRMA)(SimpleName:firma))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:TAG_FORMATO_FIRMA)(SimpleName:formatoFirma))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:datos)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:firma)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:formatoFirma)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:firmaBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:org.apache.commons.codec.binary.Base64))(SimpleName:decodeBase64)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:firma))(SimpleName:getBytes))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:documentoBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:org.apache.commons.codec.binary.Base64))(SimpleName:decodeBase64)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:datos))(SimpleName:getBytes))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:datosEnFirma)(NullLiteral)))(TryStatement(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:formatoFirma))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FORMATO_FIRMA_CADES_BES)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:formatoFirma))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FORMATO_FIRMA_CADES_T))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:firmaBytes))(SimpleName:toString))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentoBytes))(SimpleName:toString))))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayInputStream))(VariableDeclarationFragment(SimpleName:bis)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(SimpleName:firmaBytes))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1InputStream))(VariableDeclarationFragment(SimpleName:lObjDerOut)(ClassInstanceCreation(SimpleType(SimpleName:ASN1InputStream))(SimpleName:bis))))(VariableDeclarationStatement(SimpleType(SimpleName:DERObject))(VariableDeclarationFragment(SimpleName:lObjDER)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:lObjDerOut)))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:lObjDER)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lObjDerOut))(SimpleName:readObject))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:lObjDER))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(SimpleName:handleException)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:synCtx)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:ContentInfo))(VariableDeclarationFragment(SimpleName:lObjPKCS7)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ContentInfo))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lObjDER)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:SignedData))(VariableDeclarationFragment(SimpleName:lObjSignedData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SignedData))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lObjPKCS7))(SimpleName:getContent))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:ContentInfo))(VariableDeclarationFragment(SimpleName:lObjContent)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lObjSignedData))(SimpleName:getContentInfo))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:datosEnFirma)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:ASN1OctetString))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lObjContent))(SimpleName:getContent)))))(SimpleName:getOctets))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:documentoBytes)(SimpleName:datosEnFirma)))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:documentoBytes)(SimpleName:datosEnFirma)))(Block(ExpressionStatement(Assignment(SimpleName:verificacionOK)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:formatoFirma))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FORMATO_FIRMA_XADES_BES)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:formatoFirma))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FORMATO_FIRMA_XADES_T))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:in)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(SimpleName:firmaBytes))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:XMLStreamReader))(VariableDeclarationFragment(SimpleName:reader)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:StAXUtils))(SimpleName:createXMLStreamReader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:StAXOMBuilder))(VariableDeclarationFragment(SimpleName:builder)(ClassInstanceCreation(SimpleType(SimpleName:StAXOMBuilder))(SimpleName:reader))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:OMElement))(VariableDeclarationFragment(SimpleName:documentElement)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:builder))(SimpleName:getDocumentElement))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:AXIOMXPath))(VariableDeclarationFragment(SimpleName:xpath)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:OMElement))(VariableDeclarationFragment(SimpleName:nodo)(NullLiteral)))(ExpressionStatement(Assignment(SimpleName:xpath)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:AXIOMXPath))(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:nodo)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:OMElement))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xpath))(SimpleName:selectSingleNode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:documentElement))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:hashB64Xades)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nodo))(SimpleName:getText))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:hashB64Xades)))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:dig)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dig))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:documentoBytes)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:hashB64Doc)(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:org.apache.commons.codec.binary.Base64))(SimpleName:encodeBase64)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:hashB64Doc)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hashB64Doc))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hashB64Xades)))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hashB64Doc))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hashB64Xades)))(Block(ExpressionStatement(Assignment(SimpleName:verificacionOK)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))))(Block(ExpressionStatement(MethodInvocation(SimpleName:handleException)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:formatoFirma)(StringLiteral:<STR>))(SimpleName:synCtx))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:synLog))(SimpleName:traceOrDebug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(SimpleName:stackTraceToString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ex))))))))))(ReturnStatement(SimpleName:verificacionOK))))))