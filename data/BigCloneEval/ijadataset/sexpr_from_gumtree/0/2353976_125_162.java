(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(SimpleType(SimpleName:OutputStream))(SimpleName:open)(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:out))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:encryptionOID))(SingleVariableDeclaration(SimpleType(SimpleName:SecretKey))(SimpleName:encKey))(SingleVariableDeclaration(SimpleType(SimpleName:AlgorithmParameters))(SimpleName:params))(SingleVariableDeclaration(SimpleType(SimpleName:ASN1EncodableVector))(SimpleName:recipientInfos))(SingleVariableDeclaration(SimpleType(SimpleName:Provider))(SimpleName:provider))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:CMSException))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:BERSequenceGenerator))(VariableDeclarationFragment(SimpleName:cGen)(ClassInstanceCreation(SimpleType(SimpleName:BERSequenceGenerator))(SimpleName:out))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cGen))(SimpleName:addObject)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CMSObjectIdentifiers.envelopedData))))(VariableDeclarationStatement(SimpleType(SimpleName:BERSequenceGenerator))(VariableDeclarationFragment(SimpleName:envGen)(ClassInstanceCreation(SimpleType(SimpleName:BERSequenceGenerator))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cGen))(SimpleName:getRawOutputStream))(NumberLiteral:0)(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envGen))(SimpleName:addObject)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getVersion)))))(IfStatement(SimpleName:_berEncodeRecipientSet)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envGen))(SimpleName:getRawOutputStream)))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:BERSet))(SimpleName:recipientInfos)))(SimpleName:getEncoded))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envGen))(SimpleName:getRawOutputStream)))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:recipientInfos)))(SimpleName:getEncoded)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:cipher)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:CMSEnvelopedHelper.INSTANCE))(SimpleName:getSymmetricCipher)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptionOID)(SimpleName:provider)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:encKey)(SimpleName:params)(SimpleName:rand))))(VariableDeclarationStatement(SimpleType(SimpleName:BERSequenceGenerator))(VariableDeclarationFragment(SimpleName:eiGen)(ClassInstanceCreation(SimpleType(SimpleName:BERSequenceGenerator))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:envGen))(SimpleName:getRawOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:eiGen))(SimpleName:addObject)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PKCSObjectIdentifiers.data))))(IfStatement(InfixExpression(SimpleName:params)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:params)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:getParameters))))))(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmIdentifier))(VariableDeclarationFragment(SimpleName:encAlgId)(MethodInvocation(SimpleName:getAlgorithmIdentifier)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptionOID)(SimpleName:params)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:eiGen))(SimpleName:getRawOutputStream)))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encAlgId))(SimpleName:getEncoded)))))(VariableDeclarationStatement(SimpleType(SimpleName:BEROctetStringGenerator))(VariableDeclarationFragment(SimpleName:octGen)(ClassInstanceCreation(SimpleType(SimpleName:BEROctetStringGenerator))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:eiGen))(SimpleName:getRawOutputStream))(NumberLiteral:0)(BooleanLiteral:false))))(VariableDeclarationStatement(SimpleType(SimpleName:CipherOutputStream))(VariableDeclarationFragment(SimpleName:cOut)))(IfStatement(InfixExpression(SimpleName:_bufferSize)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:cOut)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:CipherOutputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:octGen))(SimpleName:getOctetOutputStream)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:_bufferSize))))))(SimpleName:cipher)))))(Block(ExpressionStatement(Assignment(SimpleName:cOut)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:CipherOutputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:octGen))(SimpleName:getOctetOutputStream))(SimpleName:cipher))))))(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:CmsEnvelopedDataOutputStream))(SimpleName:cOut)(SimpleName:cGen)(SimpleName:envGen)(SimpleName:eiGen))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidKeyException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CMSException))(StringLiteral:<STR>)(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchPaddingException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CMSException))(StringLiteral:<STR>)(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidAlgorithmParameterException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CMSException))(StringLiteral:<STR>)(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CMSException))(StringLiteral:<STR>)(SimpleName:e))))))))))