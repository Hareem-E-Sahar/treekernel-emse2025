(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:invoke)(SingleVariableDeclaration(Modifier:final)(SimpleType(QualifiedName:java.util.Map))(SimpleName:mapGlobalSettings))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:String))(SimpleName:strComponentName))(SingleVariableDeclaration(Modifier:final)(SimpleType(QualifiedName:java.util.Map))(SimpleName:mapComponentSettings))(SingleVariableDeclaration(Modifier:final)(SimpleType(QualifiedName:java.util.Map))(SimpleName:mapInvocationSettings))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:IConstants))(SimpleName:constants))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:ISTSRequest))(SimpleName:request))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:ISTSResponse))(SimpleName:response))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:log)))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:strComponentName)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(FieldAccess(ThisExpression)(SimpleName:bConfigured)))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ReturnStatement)))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.net.URI))(VariableDeclarationFragment(SimpleName:uriDefaultKeyType)(CastExpression(SimpleType(QualifiedName:java.net.URI))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mapComponentSettings))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:log)))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uriDefaultKeyType))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uriDefaultKeyType))(SimpleName:toString))(NullLiteral)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.lang.Boolean))(VariableDeclarationFragment(SimpleName:bIncludeBearerSubjectName)(CastExpression(SimpleType(QualifiedName:java.lang.Boolean))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mapComponentSettings))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:log)))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:bIncludeBearerSubjectName))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bIncludeBearerSubjectName))(SimpleName:toString))(NullLiteral)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.net.URI))(VariableDeclarationFragment(SimpleName:uriTokenIssuer)(CastExpression(SimpleType(QualifiedName:java.net.URI))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mapComponentSettings))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:log)))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uriTokenIssuer))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uriTokenIssuer))(SimpleName:toString))(NullLiteral)))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:uriTokenIssuer))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ReturnStatement)))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.net.URI))(VariableDeclarationFragment(SimpleName:uriSubjectNameIdentifier)(CastExpression(SimpleType(QualifiedName:java.net.URI))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mapComponentSettings))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:uriSubjectNameIdentifier))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:log)))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uriSubjectNameIdentifier))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uriSubjectNameIdentifier))(SimpleName:toString))(NullLiteral))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.net.URI))(VariableDeclarationFragment(SimpleName:uriSubjectNameIdentifierFormat)(CastExpression(SimpleType(QualifiedName:java.net.URI))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mapComponentSettings))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:uriSubjectNameIdentifierFormat))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:log)))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uriSubjectNameIdentifierFormat))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uriSubjectNameIdentifierFormat))(SimpleName:toString))(NullLiteral))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.lang.Boolean))(VariableDeclarationFragment(SimpleName:bEncryptToken)(CastExpression(SimpleType(QualifiedName:java.lang.Boolean))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mapComponentSettings))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:log)))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:bEncryptToken))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bEncryptToken))(SimpleName:toString))(NullLiteral)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.util.List))(VariableDeclarationFragment(SimpleName:listRST)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getRequestSecurityTokenCollection))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:IRequestSecurityToken))(VariableDeclarationFragment(SimpleName:RST)(CastExpression(SimpleType(SimpleName:IRequestSecurityToken))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listRST))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.eclipse.higgins.sts.api.ILifetime))(VariableDeclarationFragment(SimpleName:ltLifetime)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RST))(SimpleName:getLifetime))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.net.URI))(VariableDeclarationFragment(SimpleName:uriTokenType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RST))(SimpleName:getTokenType))))(IfStatement(InfixExpression(InfixExpression(SimpleName:uriTokenType)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(ParenthesizedExpression(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:OpenIDTokenType.OPENID20_TOKEN))(SimpleName:toString)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uriTokenType))(SimpleName:toString)))))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:OpenIDTokenType.OPENID11_TOKEN))(SimpleName:toString)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uriTokenType))(SimpleName:toString))))))))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:uriTokenType)))))(ReturnStatement)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:compat)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:OpenIDTokenType.OPENID11_TOKEN))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uriTokenType))(SimpleName:toString))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.eclipse.higgins.sts.api.IAppliesTo))(VariableDeclarationFragment(SimpleName:appliesToRequest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RST))(SimpleName:getAppliesTo))))(VariableDeclarationStatement(SimpleType(QualifiedName:java.net.URI))(VariableDeclarationFragment(SimpleName:uriAppliesTo)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:log)))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(IfStatement(InfixExpression(SimpleName:appliesToRequest)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:log)))(SimpleName:trace)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.eclipse.higgins.sts.api.IEndpointReference))(VariableDeclarationFragment(SimpleName:eprAppliesTo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appliesToRequest))(SimpleName:getEndpointReference))))(ExpressionStatement(Assignment(SimpleName:uriAppliesTo)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:eprAppliesTo))(SimpleName:getAddress))))))(IfStatement(InfixExpression(SimpleName:uriAppliesTo)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ReturnStatement)))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.eclipse.higgins.sts.api.IDigitalIdentity))(VariableDeclarationFragment(SimpleName:digitalIdentity)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RST))(SimpleName:getDigitalIdentity))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:digitalIdentity))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ReturnStatement)))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:OMFactory))(VariableDeclarationFragment(SimpleName:omFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:OMAbstractFactory))(SimpleName:getOMFactory))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:OMNamespace))(VariableDeclarationFragment(SimpleName:omIdentityNamespace)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMNamespace)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:constants))(SimpleName:getIdentityNamespace)))(SimpleName:toString))(StringLiteral:<STR>)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:OMNamespace))(VariableDeclarationFragment(SimpleName:omWSTrustNamespace)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMNamespace)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:constants))(SimpleName:getWSTrustNamespace)))(SimpleName:toString))(StringLiteral:<STR>)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:OMElement))(VariableDeclarationFragment(SimpleName:omRequestedDisplayToken)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omIdentityNamespace)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:OMElement))(VariableDeclarationFragment(SimpleName:omDisplayToken)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omIdentityNamespace)(SimpleName:omRequestedDisplayToken)))))(VariableDeclarationStatement(SimpleType(SimpleName:OMElement))(VariableDeclarationFragment(SimpleName:omRequestedSecurityToken)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omWSTrustNamespace)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.apache.axiom.om.OMElement))(VariableDeclarationFragment(SimpleName:omRequestedAttachedReference)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omWSTrustNamespace)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.apache.axiom.om.OMElement))(VariableDeclarationFragment(SimpleName:omRequestedUnattachedReference)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omWSTrustNamespace)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.apache.axiom.om.OMNamespace))(VariableDeclarationFragment(SimpleName:omWSSNamespace)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMNamespace)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:constants))(SimpleName:getWSSecurityNamespace)))(SimpleName:toString))(StringLiteral:<STR>)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.apache.axiom.om.OMElement))(VariableDeclarationFragment(SimpleName:omSecurityTokenReference1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omWSSNamespace)(SimpleName:omRequestedAttachedReference)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.apache.axiom.om.OMElement))(VariableDeclarationFragment(SimpleName:omSecurityTokenReference2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omWSSNamespace)(SimpleName:omRequestedUnattachedReference)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.apache.axiom.om.OMElement))(VariableDeclarationFragment(SimpleName:omKeyIdentifier1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omWSSNamespace)(SimpleName:omSecurityTokenReference1)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.apache.axiom.om.OMElement))(VariableDeclarationFragment(SimpleName:omKeyIdentifier2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omWSSNamespace)(SimpleName:omSecurityTokenReference2)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:keyIdentifierValueType)(StringLiteral:<STR>)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omKeyIdentifier1))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:keyIdentifierValueType)(NullLiteral))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omKeyIdentifier2))(SimpleName:addAttribute)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:keyIdentifierValueType)(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:claimedID)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:Map))(VariableDeclarationFragment(SimpleName:attrs)(ClassInstanceCreation(SimpleType(SimpleName:HashMap)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.util.List))(VariableDeclarationFragment(SimpleName:listClaims)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digitalIdentity))(SimpleName:getClaims))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.util.Map))(VariableDeclarationFragment(SimpleName:mapAttributeClaim)(CastExpression(SimpleType(QualifiedName:java.util.Map))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mapGlobalSettings))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:claimTypeUri)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:value)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:displayTag)))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:claimsIter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listClaims))(SimpleName:iterator))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:claimsIter))(SimpleName:hasNext))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:IClaim))(VariableDeclarationFragment(SimpleName:claim)(CastExpression(SimpleType(SimpleName:IClaim))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:claimsIter))(SimpleName:next)))))(ExpressionStatement(Assignment(SimpleName:value)(ASSIGNMENT_OPERATOR:=)(ConditionalExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:claim))(SimpleName:getValues)))(SimpleName:hasNext))(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:claim))(SimpleName:getValues)))(SimpleName:next)))(NullLiteral))))(IfStatement(InfixExpression(SimpleName:value)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ContinueStatement))(ExpressionStatement(Assignment(SimpleName:claimTypeUri)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:claim))(SimpleName:getType)))(SimpleName:getName)))(SimpleName:toString))))(ExpressionStatement(Assignment(SimpleName:displayTag)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Map))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mapAttributeClaim))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:claimTypeUri))))))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:OpenIDTokenType.OPENID_CLAIM))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:claimTypeUri)))(Block(ExpressionStatement(Assignment(SimpleName:claimedID)(ASSIGNMENT_OPERATOR:=)(SimpleName:value)))(ExpressionStatement(MethodInvocation(SimpleName:addDisplayClaim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:claimTypeUri)(SimpleName:claimedID)(SimpleName:displayTag)(SimpleName:omDisplayToken)(SimpleName:omIdentityNamespace)(SimpleName:omFactory))))(IfStatement(SimpleName:compat)(BreakStatement)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:compat))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attrs))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:claimTypeUri)(SimpleName:value))))(ExpressionStatement(MethodInvocation(SimpleName:addDisplayClaim)(METHOD_INVOCATION_ARGUMENTS(SimpleName:claimTypeUri)(SimpleName:value)(SimpleName:displayTag)(SimpleName:omDisplayToken)(SimpleName:omIdentityNamespace)(SimpleName:omFactory)))))))))(IfStatement(InfixExpression(SimpleName:claimedID)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ReturnStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:Association))(VariableDeclarationFragment(SimpleName:assoc)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:assoc)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_privateAssociations))(SimpleName:generate)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:org.openid4java.association.Association.TYPE_HMAC_SHA1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_expireIn))(SimpleName:intValue)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:AssociationException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))(ReturnStatement))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:compat))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:_opEndpoint)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ReturnStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:nonce)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_nonceGenerator))(SimpleName:next))))(VariableDeclarationStatement(SimpleType(SimpleName:AuthSuccess))(VariableDeclarationFragment(SimpleName:openidResp)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:openidResp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AuthSuccess))(SimpleName:createAuthSuccess)(METHOD_INVOCATION_ARGUMENTS(SimpleName:_opEndpoint)(SimpleName:claimedID)(SimpleName:claimedID)(SimpleName:compat)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uriAppliesTo))(SimpleName:toString))(SimpleName:nonce)(NullLiteral)(SimpleName:assoc)(BooleanLiteral:false)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:compat))(Block(VariableDeclarationStatement(SimpleType(SimpleName:FetchResponse))(VariableDeclarationFragment(SimpleName:fetchResp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FetchResponse))(SimpleName:createFetchResponse))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fetchResp))(SimpleName:addAttributes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:attrs))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openidResp))(SimpleName:addExtension)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fetchResp))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openidResp))(SimpleName:setSignature)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:assoc))(SimpleName:sign)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openidResp))(SimpleName:getSignedText))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:OpenIDException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))(ReturnStatement))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:md)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))(ReturnStatement))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:sha1base64)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:sha1base64)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Base64))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openidResp))(SimpleName:keyValueFormEncoding)))(SimpleName:getBytes)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:UnsupportedEncodingException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))))(ReturnStatement))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omKeyIdentifier1))(SimpleName:setText)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sha1base64))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omKeyIdentifier2))(SimpleName:setText)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sha1base64))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:OMNamespace))(VariableDeclarationFragment(SimpleName:omOpenIDNamespace)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMNamespace)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:org.openid4java.message.Message.OPENID2_NS)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:OMElement))(VariableDeclarationFragment(SimpleName:omOpenIDToken)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omFactory))(SimpleName:createOMElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:omOpenIDNamespace)(SimpleName:omRequestedSecurityToken)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:omOpenIDToken))(SimpleName:setText)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:openidResp))(SimpleName:keyValueFormEncoding)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:java.util.List))(VariableDeclarationFragment(SimpleName:listRSTR)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getRequestSecurityTokenResponseCollection))))(IfStatement(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:==)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listRSTR))(SimpleName:size)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listRSTR))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(QualifiedName:org.eclipse.higgins.sts.common.RequestSecurityTokenResponse))))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(QualifiedName:org.eclipse.higgins.sts.api.IRequestSecurityTokenResponse))(VariableDeclarationFragment(SimpleName:RSTR)(CastExpression(SimpleType(QualifiedName:org.eclipse.higgins.sts.common.RequestSecurityTokenResponse))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listRSTR))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSTR))(SimpleName:setTokenType)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uriTokenType))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSTR))(SimpleName:setLifetime)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ltLifetime))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSTR))(SimpleName:setRequestedSecurityToken)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMLHelper))(SimpleName:toElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:omRequestedSecurityToken))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSTR))(SimpleName:setRequestedDisplayToken)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMLHelper))(SimpleName:toElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:omRequestedDisplayToken))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSTR))(SimpleName:setRequestedAttachedReference)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:org.eclipse.higgins.sts.utilities.XMLHelper))(SimpleName:toElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:omRequestedAttachedReference))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:RSTR))(SimpleName:setRequestedUnattachedReference)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:org.eclipse.higgins.sts.utilities.XMLHelper))(SimpleName:toElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:omRequestedUnattachedReference)))))))(CatchClause(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:org.eclipse.higgins.sts.utilities.ExceptionHelper))(SimpleName:Log)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:log))(SimpleName:e))))(ExpressionStatement(MethodInvocation(SimpleName:setWstFault)(METHOD_INVOCATION_ARGUMENTS(SimpleName:constants)(SimpleName:response)(StringLiteral:<STR>)(StringLiteral:<STR>)))))))))))