(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:getXmlSignatureDigestValue)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:digestAlgo))(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:DigestInfo)))(SimpleName:digestInfos))(SingleVariableDeclaration(SimpleType(SimpleName:HttpSession))(SimpleName:httpSession))(SimpleType(SimpleName:ParserConfigurationException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:InvalidAlgorithmParameterException))(SimpleType(SimpleName:MarshalException))(SimpleType(QualifiedName:javax.xml.crypto.dsig.XMLSignatureException))(SimpleType(SimpleName:TransformerFactoryConfigurationError))(SimpleType(SimpleName:TransformerException))(SimpleType(SimpleName:MalformedURLException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DocumentBuilderFactory))(VariableDeclarationFragment(SimpleName:documentBuilderFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DocumentBuilderFactory))(SimpleName:newInstance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilderFactory))(SimpleName:setNamespaceAware)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(VariableDeclarationStatement(SimpleType(SimpleName:DocumentBuilder))(VariableDeclarationFragment(SimpleName:documentBuilder)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilderFactory))(SimpleName:newDocumentBuilder))))(VariableDeclarationStatement(SimpleType(SimpleName:Document))(VariableDeclarationFragment(SimpleName:document)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilder))(SimpleName:newDocument))))(VariableDeclarationStatement(SimpleType(SimpleName:XMLSignatureFactory))(VariableDeclarationFragment(SimpleName:signatureFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMLSignatureFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ClassInstanceCreation(SimpleType(QualifiedName:org.jcp.xml.dsig.internal.dom.XMLDSigRI)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Key))(VariableDeclarationFragment(SimpleName:key)(ClassInstanceCreation(SimpleType(SimpleName:Key))(AnonymousClassDeclaration(FieldDeclaration(Modifier:private)(Modifier:static)(Modifier:final)(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:serialVersionUID)(NumberLiteral:1L)))(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:String))(SimpleName:getAlgorithm)(Block(ReturnStatement(NullLiteral))))(MethodDeclaration(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:getEncoded)(Block(ReturnStatement(NullLiteral))))(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:String))(SimpleName:getFormat)(Block(ReturnStatement(NullLiteral))))))))(VariableDeclarationStatement(SimpleType(SimpleName:XMLSignContext))(VariableDeclarationFragment(SimpleName:signContext)(ClassInstanceCreation(SimpleType(SimpleName:DOMSignContext))(SimpleName:key)(SimpleName:document))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signContext))(SimpleName:putNamespacePrefix)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:javax.xml.crypto.dsig.XMLSignature.XMLNS)(StringLiteral:<STR>))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:Reference)))(VariableDeclarationFragment(SimpleName:references)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:Reference))))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:DigestInfo))(SimpleName:digestInfo))(SimpleName:digestInfos)(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:documentDigestValue)(QualifiedName:digestInfo.digestValue)))(VariableDeclarationStatement(SimpleType(SimpleName:DigestMethod))(VariableDeclarationFragment(SimpleName:digestMethod)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newDigestMethod)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getXmlDigestAlgo)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:digestInfo.digestAlgo)))(NullLiteral)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:uri)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FilenameUtils))(SimpleName:getName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:File))(QualifiedName:digestInfo.description)))(SimpleName:toURI)))(SimpleName:toURL)))(SimpleName:getFile))))))(VariableDeclarationStatement(SimpleType(SimpleName:Reference))(VariableDeclarationFragment(SimpleName:reference)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newReference)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uri)(SimpleName:digestMethod)(NullLiteral)(NullLiteral)(NullLiteral)(SimpleName:documentDigestValue)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:references))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reference))))))(VariableDeclarationStatement(SimpleType(SimpleName:SignatureMethod))(VariableDeclarationFragment(SimpleName:signatureMethod)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newSignatureMethod)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getSignatureMethod)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestAlgo)))(NullLiteral)))))(VariableDeclarationStatement(SimpleType(SimpleName:CanonicalizationMethod))(VariableDeclarationFragment(SimpleName:canonicalizationMethod)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newCanonicalizationMethod)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:CanonicalizationMethod.EXCLUSIVE_WITH_COMMENTS)(CastExpression(SimpleType(SimpleName:C14NMethodParameterSpec))(NullLiteral))))))(VariableDeclarationStatement(SimpleType(QualifiedName:javax.xml.crypto.dsig.SignedInfo))(VariableDeclarationFragment(SimpleName:signedInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newSignedInfo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:canonicalizationMethod)(SimpleName:signatureMethod)(SimpleName:references)))))(VariableDeclarationStatement(SimpleType(QualifiedName:javax.xml.crypto.dsig.XMLSignature))(VariableDeclarationFragment(SimpleName:xmlSignature)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newXMLSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedInfo)(NullLiteral)))))(VariableDeclarationStatement(SimpleType(SimpleName:DOMXMLSignature))(VariableDeclarationFragment(SimpleName:domXmlSignature)(CastExpression(SimpleType(SimpleName:DOMXMLSignature))(SimpleName:xmlSignature))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:domXmlSignature))(SimpleName:marshal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:document)(StringLiteral:<STR>)(CastExpression(SimpleType(SimpleName:DOMCryptoContext))(SimpleName:signContext)))))(VariableDeclarationStatement(SimpleType(SimpleName:Source))(VariableDeclarationFragment(SimpleName:source)(ClassInstanceCreation(SimpleType(SimpleName:DOMSource))(SimpleName:document))))(VariableDeclarationStatement(SimpleType(SimpleName:StringWriter))(VariableDeclarationFragment(SimpleName:stringWriter)(ClassInstanceCreation(SimpleType(SimpleName:StringWriter)))))(VariableDeclarationStatement(SimpleType(SimpleName:Result))(VariableDeclarationFragment(SimpleName:result)(ClassInstanceCreation(SimpleType(SimpleName:StreamResult))(SimpleName:stringWriter))))(VariableDeclarationStatement(SimpleType(SimpleName:Transformer))(VariableDeclarationFragment(SimpleName:xformer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TransformerFactory))(SimpleName:newInstance)))(SimpleName:newTransformer))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xformer))(SimpleName:setOutputProperty)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:OutputKeys.OMIT_XML_DECLARATION)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xformer))(SimpleName:transform)(METHOD_INVOCATION_ARGUMENTS(SimpleName:source)(SimpleName:result))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:documentStr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:stringWriter))(SimpleName:getBuffer)))(SimpleName:toString))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:httpSession))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:documentStr))))(VariableDeclarationStatement(SimpleType(SimpleName:DOMSignedInfo))(VariableDeclarationFragment(SimpleName:domSignedInfo)(CastExpression(SimpleType(SimpleName:DOMSignedInfo))(SimpleName:signedInfo))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:dataStream)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:domSignedInfo))(SimpleName:canonicalize)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signContext)(SimpleName:dataStream))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:octets)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dataStream))(SimpleName:toByteArray))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:jcaMessageDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestAlgo)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digestValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:jcaMessageDigest))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:octets)))))(ReturnStatement(SimpleName:digestValue))))))