(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(SimpleType(SimpleName:MailBox))(SimpleName:authenticate)(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:line)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:mChallenge)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(StringLiteral:<STR>)(ParenthesizedExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:mChallenge))))))))(VariableDeclarationStatement(SimpleType(SimpleName:MailBox))(VariableDeclarationFragment(SimpleName:mailbox)(NullLiteral)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeOk)(METHOD_INVOCATION_ARGUMENTS(SimpleName:line))))(WhileStatement(InfixExpression(SimpleName:mailbox)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:line)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:readLine))))(IfStatement(MethodInvocation(SimpleName:isQuit)(METHOD_INVOCATION_ARGUMENTS(SimpleName:line)))(BreakStatement))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:body)))(IfStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:body)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:isCommand)(METHOD_INVOCATION_ARGUMENTS(SimpleName:line)(StringLiteral:<STR>)))))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:user)(SimpleName:body)))(VariableDeclarationStatement(SimpleType(SimpleName:MailBox))(VariableDeclarationFragment(SimpleName:mb)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mRepository))(SimpleName:getMailBox)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user)))))(IfStatement(InfixExpression(SimpleName:mb)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeErr)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:line)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeOk)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:pswd))(VariableDeclarationFragment(SimpleName:line2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:readLine))))(IfStatement(MethodInvocation(SimpleName:isQuit)(METHOD_INVOCATION_ARGUMENTS(SimpleName:line2)))(BreakStatement))(IfStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:pswd)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:isCommand)(METHOD_INVOCATION_ARGUMENTS(SimpleName:line2)(StringLiteral:<STR>)))))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeErr)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:line2)(StringLiteral:<STR>)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:realPswd)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mb))(SimpleName:getPassword))))(IfStatement(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:realPswd)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pswd))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:realPswd)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mb))(SimpleName:checkPassword)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pswd))))(Block(ExpressionStatement(Assignment(SimpleName:mailbox)(ASSIGNMENT_OPERATOR:=)(SimpleName:mb)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeOk))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeErr)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:user)))))))))))(IfStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:body)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:isCommand)(METHOD_INVOCATION_ARGUMENTS(SimpleName:line)(StringLiteral:<STR>)))))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(IfStatement(InfixExpression(SimpleName:mChallenge)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeErr)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:space)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:space)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeErr)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:line)(StringLiteral:<STR>)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:user)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(SimpleName:space)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:hash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:space)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))))))(VariableDeclarationStatement(SimpleType(SimpleName:MailBox))(VariableDeclarationFragment(SimpleName:mb)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mRepository))(SimpleName:getMailBox)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user)))))(IfStatement(InfixExpression(SimpleName:mb)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeErr)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:line)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mb))(SimpleName:getPassword))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeErr)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:user)(StringLiteral:<STR>)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:secret)(InfixExpression(SimpleName:mChallenge)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mb))(SimpleName:getPassword)))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md5)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md5))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secret))(SimpleName:getBytes)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md5))(SimpleName:digest))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:digestStr)(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Hex))(SimpleName:encodeHex)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hash))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestStr)))(Block(ExpressionStatement(Assignment(SimpleName:mailbox)(ASSIGNMENT_OPERATOR:=)(SimpleName:mb)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeOk))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeErr)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:user))))))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mStream))(SimpleName:writeErr)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:line)(StringLiteral:<STR>)))))))))(ReturnStatement(SimpleName:mailbox))))))