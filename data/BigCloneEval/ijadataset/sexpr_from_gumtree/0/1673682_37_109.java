(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:main)(SingleVariableDeclaration(ArrayType(SimpleType(SimpleName:String))(Dimension))(SimpleName:args))(Block(IfStatement(InfixExpression(QualifiedName:args.length)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:3))(Block(ExpressionStatement(MethodInvocation(SimpleName:printUsage)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Module))(VariableDeclarationFragment(SimpleName:pkcs11Module)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Module))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(NumberLiteral:0))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11Module))(SimpleName:initialize)(METHOD_INVOCATION_ARGUMENTS(NullLiteral))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Slot))(Dimension))(VariableDeclarationFragment(SimpleName:slots)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11Module))(SimpleName:getSlotList)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Module.SlotRequirement.TOKEN_PRESENT)))))(IfStatement(InfixExpression(QualifiedName:slots.length)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(VariableDeclarationStatement(SimpleType(SimpleName:Slot))(VariableDeclarationFragment(SimpleName:selectedSlot)(ArrayAccess(SimpleName:slots)(NumberLiteral:0))))(VariableDeclarationStatement(SimpleType(SimpleName:Token))(VariableDeclarationFragment(SimpleName:token)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:selectedSlot))(SimpleName:getToken))))(VariableDeclarationStatement(SimpleType(SimpleName:Session))(VariableDeclarationFragment(SimpleName:session)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:openSession)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Token.SessionType.SERIAL_SESSION)(QualifiedName:Token.SessionReadWriteBehavior.RO_SESSION)(NullLiteral)(NullLiteral)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:login)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Session.UserType.USER)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:args)(NumberLiteral:1)))(SimpleName:toCharArray)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Mechanism))(VariableDeclarationFragment(SimpleName:keyMechanism)(QualifiedName:Mechanism.DES3_KEY_GEN)))(VariableDeclarationStatement(SimpleType(SimpleName:DES3SecretKey))(VariableDeclarationFragment(SimpleName:secretEncryptionKeyTemplate)(ClassInstanceCreation(SimpleType(SimpleName:DES3SecretKey)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secretEncryptionKeyTemplate))(SimpleName:getEncrypt)))(SimpleName:setBooleanValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Boolean.TRUE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:secretEncryptionKeyTemplate))(SimpleName:getDecrypt)))(SimpleName:setBooleanValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Boolean.TRUE))))(VariableDeclarationStatement(SimpleType(SimpleName:DES3SecretKey))(VariableDeclarationFragment(SimpleName:encryptionKey)(CastExpression(SimpleType(SimpleName:DES3SecretKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:generateKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyMechanism)(SimpleName:secretEncryptionKeyTemplate))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ArrayAccess(SimpleName:args)(NumberLiteral:2))))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:dataInputStream)(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(ArrayAccess(SimpleName:args)(NumberLiteral:2)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:dataBuffer)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:1024))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bytesRead)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:streamBuffer)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:bytesRead)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dataInputStream))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataBuffer)))))(INFIX_EXPRESSION_OPERATOR:>=)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:streamBuffer))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataBuffer)(NumberLiteral:0)(SimpleName:bytesRead))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:fill)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataBuffer)(CastExpression(PrimitiveType:byte)(NumberLiteral:0)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:streamBuffer))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:streamBuffer))(SimpleName:close)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:rawData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:streamBuffer))(SimpleName:toByteArray))))(VariableDeclarationStatement(SimpleType(SimpleName:Mechanism))(VariableDeclarationFragment(SimpleName:encryptionMechanism)(QualifiedName:Mechanism.DES3_CBC_PAD)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encryptInitializationVector)(ArrayInitializer(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0))))(VariableDeclarationStatement(SimpleType(SimpleName:InitializationVectorParameters))(VariableDeclarationFragment(SimpleName:encryptInitializationVectorParameters)(ClassInstanceCreation(SimpleType(SimpleName:InitializationVectorParameters))(SimpleName:encryptInitializationVector))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encryptionMechanism))(SimpleName:setParameters)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptInitializationVectorParameters))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:encryptInit)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptionMechanism)(SimpleName:encryptionKey))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encryptedData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:encrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rawData)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Mechanism))(VariableDeclarationFragment(SimpleName:decryptionMechanism)(QualifiedName:Mechanism.DES3_CBC_PAD)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:decryptInitializationVector)(ArrayInitializer(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0)(NumberLiteral:0))))(VariableDeclarationStatement(SimpleType(SimpleName:InitializationVectorParameters))(VariableDeclarationFragment(SimpleName:decryptInitializationVectorParameters)(ClassInstanceCreation(SimpleType(SimpleName:InitializationVectorParameters))(SimpleName:decryptInitializationVector))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:decryptionMechanism))(SimpleName:setParameters)(METHOD_INVOCATION_ARGUMENTS(SimpleName:decryptInitializationVectorParameters))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:decryptInit)(METHOD_INVOCATION_ARGUMENTS(SimpleName:decryptionMechanism)(SimpleName:encryptionKey))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:decryptedData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:decrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptedData)))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:equal)(BooleanLiteral:false)))(IfStatement(InfixExpression(QualifiedName:rawData.length)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:decryptedData.length))(Block(ExpressionStatement(Assignment(SimpleName:equal)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false))))(Block(ExpressionStatement(Assignment(SimpleName:equal)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:rawData.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(ArrayAccess(SimpleName:rawData)(SimpleName:i))(INFIX_EXPRESSION_OPERATOR:!=)(ArrayAccess(SimpleName:decryptedData)(SimpleName:i)))(Block(ExpressionStatement(Assignment(SimpleName:equal)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))(BreakStatement)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(ConditionalExpression(ParenthesizedExpression(SimpleName:equal))(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:closeSession)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11Module))(SimpleName:finalize)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:thr))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:thr))(SimpleName:printStackTrace))))))))))