(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:Cipher))(SimpleName:create)(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:encryptMode))(Block(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:mode)(ConditionalExpression(ParenthesizedExpression(SimpleName:encryptMode))(QualifiedName:Cipher.ENCRYPT_MODE)(QualifiedName:Cipher.DECRYPT_MODE))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:cipher)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:algorithm)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:keyAlgorithm)(SimpleName:algorithm)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithm))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(Block(ExpressionStatement(Assignment(SimpleName:keyAlgorithm)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithm))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithm))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteBuffer))(VariableDeclarationFragment(SimpleName:bbPass)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:allocate)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:32)))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bbPass))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:passPhrase))(SimpleName:getBytes)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:reset)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:saltDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:salt)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bbPass))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:saltDigest))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:isCBC)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithm))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(VariableDeclarationStatement(SimpleType(SimpleName:SecretKey))(VariableDeclarationFragment(SimpleName:key)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:ivLength)(NumberLiteral:8)))(VariableDeclarationStatement(SimpleType(SimpleName:AlgorithmParameterSpec))(VariableDeclarationFragment(SimpleName:paramSpec)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:keyBytes)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:keyBytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bbPass))(SimpleName:array))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithm))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:ivLength)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:16)))(ExpressionStatement(Assignment(SimpleName:key)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(SimpleName:keyBytes)(StringLiteral:<STR>)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithm))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:key)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SecretKeySpec))(SimpleName:keyBytes)(StringLiteral:<STR>)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithm))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeySpec))(VariableDeclarationFragment(SimpleName:keySpec)(ClassInstanceCreation(SimpleType(SimpleName:DESedeKeySpec))(SimpleName:keyBytes))))(ExpressionStatement(Assignment(SimpleName:key)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecretKeyFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:generateSecret)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keySpec))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithm))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeySpec))(VariableDeclarationFragment(SimpleName:keySpec)(ClassInstanceCreation(SimpleType(SimpleName:DESKeySpec))(SimpleName:keyBytes))))(ExpressionStatement(Assignment(SimpleName:key)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecretKeyFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:generateSecret)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keySpec))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algorithm))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:paramSpec)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:PBEParameterSpec))(SimpleName:salt)(SimpleName:iterationCount))))(VariableDeclarationStatement(SimpleType(SimpleName:KeySpec))(VariableDeclarationFragment(SimpleName:keySpec)(ClassInstanceCreation(SimpleType(SimpleName:PBEKeySpec))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:passPhrase))(SimpleName:toCharArray))(SimpleName:salt)(SimpleName:iterationCount))))(ExpressionStatement(Assignment(SimpleName:key)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecretKeyFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyAlgorithm))))(SimpleName:generateSecret)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keySpec)))))))))))(IfStatement(SimpleName:isCBC)(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:iv)(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:ivLength)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:8)))(SimpleName:salt)(SimpleName:saltDigest))))(ExpressionStatement(Assignment(SimpleName:paramSpec)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:IvParameterSpec))(SimpleName:iv))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mode)(SimpleName:key)(SimpleName:paramSpec))))(ReturnStatement(SimpleName:cipher)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))))(ReturnStatement(NullLiteral))))))