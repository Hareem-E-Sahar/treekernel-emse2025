(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:run)(Block(VariableDeclarationStatement(SimpleType(SimpleName:Mid))(VariableDeclarationFragment(SimpleName:mid)(ClassInstanceCreation(SimpleType(SimpleName:Mid)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i))(VariableDeclarationFragment(SimpleName:m))(VariableDeclarationFragment(SimpleName:nbtlen)))(VariableDeclarationStatement(SimpleType(SimpleName:ServerMessageBlock))(VariableDeclarationFragment(SimpleName:response)))(WhileStatement(InfixExpression(SimpleName:thread)(INFIX_EXPRESSION_OPERATOR:==)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Thread))(SimpleName:currentThread)))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:socket))(SimpleName:setSoTimeout)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SO_TIMEOUT))))(ExpressionStatement(Assignment(SimpleName:m)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(WhileStatement(InfixExpression(SimpleName:m)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:4))(Block(IfStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:i)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read))))(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(Block(ReturnStatement)))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))(INFIX_EXPRESSION_OPERATOR:==)(ArrayAccess(SimpleName:MAGIC)(SimpleName:m)))(Block(ExpressionStatement(PostfixExpression(SimpleName:m)(POSTFIX_EXPRESSION_OPERATOR:++))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0xFF))(Block(ExpressionStatement(Assignment(SimpleName:m)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:1))))(Block(ExpressionStatement(Assignment(SimpleName:m)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0))))))))(ExpressionStatement(Assignment(SimpleName:nbtlen)(ASSIGNMENT_OPERATOR:=)(InfixExpression(NumberLiteral:4)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:available)))))(SynchronizedStatement(SimpleName:rcv_buf)(Block(ExpressionStatement(Assignment(ArrayAccess(SimpleName:rcv_buf)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(NumberLiteral:0xFF))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:rcv_buf)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(CharacterLiteral:<STR>))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:rcv_buf)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(CharacterLiteral:<STR>))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:rcv_buf)(NumberLiteral:3))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(CharacterLiteral:<STR>))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rcv_buf)(NumberLiteral:4)(InfixExpression(QualifiedName:ServerMessageBlock.HEADER_LENGTH)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:4))))(INFIX_EXPRESSION_OPERATOR:!=)(ParenthesizedExpression(InfixExpression(QualifiedName:ServerMessageBlock.HEADER_LENGTH)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:4))))(Block(BreakStatement)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:PushbackInputStream))(SimpleName:in))))(SimpleName:unread)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rcv_buf)(NumberLiteral:0)(QualifiedName:ServerMessageBlock.HEADER_LENGTH))))(IfStatement(InfixExpression(InfixExpression(InfixExpression(InfixExpression(ArrayAccess(SimpleName:rcv_buf)(NumberLiteral:0))(INFIX_EXPRESSION_OPERATOR:!=)(CastExpression(PrimitiveType:byte)(NumberLiteral:0xFF)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(ArrayAccess(SimpleName:rcv_buf)(NumberLiteral:1))(INFIX_EXPRESSION_OPERATOR:!=)(CastExpression(PrimitiveType:byte)(CharacterLiteral:<STR>))))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(ArrayAccess(SimpleName:rcv_buf)(NumberLiteral:2))(INFIX_EXPRESSION_OPERATOR:!=)(CastExpression(PrimitiveType:byte)(CharacterLiteral:<STR>))))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(ArrayAccess(SimpleName:rcv_buf)(NumberLiteral:3))(INFIX_EXPRESSION_OPERATOR:!=)(CastExpression(PrimitiveType:byte)(CharacterLiteral:<STR>))))(Block(IfStatement(QualifiedName:DebugFile.trace)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DebugFile))(SimpleName:writeln)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:address))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:skip)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:available)))))(ContinueStatement)))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:rcv_buf)(QualifiedName:ServerMessageBlock.FLAGS_OFFSET))(INFIX_EXPRESSION_OPERATOR:&)(QualifiedName:ServerMessageBlock.FLAGS_RESPONSE)))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:ServerMessageBlock.FLAGS_RESPONSE))(Block(ExpressionStatement(Assignment(QualifiedName:mid.mid)(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:short)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ServerMessageBlock))(SimpleName:readInt2)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rcv_buf)(SimpleName:MID_OFFSET)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFFFF))))))(ExpressionStatement(Assignment(SimpleName:response)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:ServerMessageBlock))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:responseTable))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mid))))))(IfStatement(InfixExpression(SimpleName:response)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(IfStatement(QualifiedName:DebugFile.trace)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DebugFile))(SimpleName:writeln)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:mid.mid)(StringLiteral:<STR>)(SimpleName:address)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:skip)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:available)))))(ContinueStatement)))(SynchronizedStatement(SimpleName:response)(Block(ExpressionStatement(Assignment(QualifiedName:response.useUnicode)(ASSIGNMENT_OPERATOR:=)(SimpleName:useUnicode)))(IfStatement(QualifiedName:DebugFile.trace)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DebugFile))(SimpleName:writeln)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:address))))))(IfStatement(InstanceofExpression(SimpleName:response)(SimpleType(SimpleName:SmbComTransactionResponse)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Enumeration))(VariableDeclarationFragment(SimpleName:e)(CastExpression(SimpleType(SimpleName:Enumeration))(SimpleName:response))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:hasMoreElements))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:nextElement))))(Block(IfStatement(QualifiedName:DebugFile.trace)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DebugFile))(SimpleName:writeln)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ContinueStatement)))(IfStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:m)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:readWireFormat)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)(SimpleName:rcv_buf)(NumberLiteral:0)))))(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:nbtlen))(Block(IfStatement(QualifiedName:DebugFile.trace)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DebugFile))(SimpleName:writeln)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:m)(StringLiteral:<STR>)(SimpleName:nbtlen)(StringLiteral:<STR>)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:skip)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:available)))))))(ExpressionStatement(Assignment(QualifiedName:response.received)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(IfStatement(InfixExpression(InfixExpression(QualifiedName:response.errorCode)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:hasMoreElements))(INFIX_EXPRESSION_OPERATOR:==)(BooleanLiteral:false)))(Block(ExpressionStatement(Assignment(FieldAccess(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:SmbComTransactionResponse))(SimpleName:response)))(SimpleName:hasMore))(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))(IfStatement(InfixExpression(SimpleName:digest)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(SynchronizedStatement(SimpleName:outLock)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digest))(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rcv_buf)(NumberLiteral:0)(SimpleName:response))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:notify))))(Block(ExpressionStatement(MethodInvocation(SimpleName:ensureOpen))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:readWireFormat)(METHOD_INVOCATION_ARGUMENTS(SimpleName:in)(SimpleName:rcv_buf)(NumberLiteral:0))))(ExpressionStatement(Assignment(QualifiedName:response.received)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(IfStatement(InfixExpression(SimpleName:digest)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(SynchronizedStatement(SimpleName:outLock)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digest))(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rcv_buf)(NumberLiteral:0)(SimpleName:response))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:notify))))))))(Block)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InterruptedIOException))(SimpleName:iioe))(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:responseTable))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(SimpleName:tryClose)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false)))))(IfStatement(QualifiedName:DebugFile.trace)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DebugFile))(SimpleName:writeln)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:responseTable))(SimpleName:size))(StringLiteral:<STR>))))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioe))(Block(SynchronizedStatement(ThisExpression)(Block(ExpressionStatement(MethodInvocation(SimpleName:tryClose)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))))(IfStatement(InfixExpression(QualifiedName:DebugFile.trace)(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ioe))(SimpleName:getMessage)))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:==)(BooleanLiteral:false)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DebugFile))(SimpleName:writeln)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ioe))(SimpleName:getMessage))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:address)))))(ExpressionStatement(ClassInstanceCreation(SimpleType(SimpleName:ErrorHandler))(SimpleName:ioe))))))))))))))