(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(SingleMemberAnnotation(SimpleName:SuppressWarnings)(StringLiteral:<STR>))(Modifier:private)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:getXmlSignatureDigestValue)(SingleVariableDeclaration(SimpleType(SimpleName:DigestAlgo))(SimpleName:digestAlgo))(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:DigestInfo)))(SimpleName:digestInfos))(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:X509Certificate)))(SimpleName:signingCertificateChain))(SimpleType(SimpleName:ParserConfigurationException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:InvalidAlgorithmParameterException))(SimpleType(SimpleName:MarshalException))(SimpleType(QualifiedName:javax.xml.crypto.dsig.XMLSignatureException))(SimpleType(SimpleName:TransformerFactoryConfigurationError))(SimpleType(SimpleName:TransformerException))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:SAXException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Document))(VariableDeclarationFragment(SimpleName:document)(MethodInvocation(SimpleName:getEnvelopingDocument))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:document))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DocumentBuilderFactory))(VariableDeclarationFragment(SimpleName:documentBuilderFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DocumentBuilderFactory))(SimpleName:newInstance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilderFactory))(SimpleName:setNamespaceAware)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(VariableDeclarationStatement(SimpleType(SimpleName:DocumentBuilder))(VariableDeclarationFragment(SimpleName:documentBuilder)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilderFactory))(SimpleName:newDocumentBuilder))))(ExpressionStatement(Assignment(SimpleName:document)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:documentBuilder))(SimpleName:newDocument))))))(VariableDeclarationStatement(SimpleType(SimpleName:Key))(VariableDeclarationFragment(SimpleName:key)(ClassInstanceCreation(SimpleType(SimpleName:Key))(AnonymousClassDeclaration(FieldDeclaration(Modifier:private)(Modifier:static)(Modifier:final)(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:serialVersionUID)(NumberLiteral:1L)))(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:String))(SimpleName:getAlgorithm)(Block(ReturnStatement(NullLiteral))))(MethodDeclaration(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:getEncoded)(Block(ReturnStatement(NullLiteral))))(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:String))(SimpleName:getFormat)(Block(ReturnStatement(NullLiteral))))))))(VariableDeclarationStatement(SimpleType(SimpleName:XMLSignContext))(VariableDeclarationFragment(SimpleName:xmlSignContext)(ClassInstanceCreation(SimpleType(SimpleName:DOMSignContext))(SimpleName:key)(SimpleName:document))))(VariableDeclarationStatement(SimpleType(SimpleName:URIDereferencer))(VariableDeclarationFragment(SimpleName:uriDereferencer)(MethodInvocation(SimpleName:getURIDereferencer))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:uriDereferencer))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignContext))(SimpleName:setURIDereferencer)(METHOD_INVOCATION_ARGUMENTS(SimpleName:uriDereferencer))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(FieldAccess(ThisExpression)(SimpleName:signatureNamespacePrefix)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignContext))(SimpleName:putNamespacePrefix)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:javax.xml.crypto.dsig.XMLSignature.XMLNS)(FieldAccess(ThisExpression)(SimpleName:signatureNamespacePrefix)))))))(VariableDeclarationStatement(SimpleType(SimpleName:XMLSignatureFactory))(VariableDeclarationFragment(SimpleName:signatureFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMLSignatureFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ClassInstanceCreation(SimpleType(QualifiedName:org.jcp.xml.dsig.internal.dom.XMLDSigRI)))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:Reference)))(VariableDeclarationFragment(SimpleName:references)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:Reference))))))(ExpressionStatement(MethodInvocation(SimpleName:addDigestInfosAsReferences)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestInfos)(SimpleName:signatureFactory)(SimpleName:references))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:localSignatureId)))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(FieldAccess(ThisExpression)(SimpleName:signatureId)))(Block(ExpressionStatement(Assignment(SimpleName:localSignatureId)(ASSIGNMENT_OPERATOR:=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UUID))(SimpleName:randomUUID)))(SimpleName:toString))))))(Block(ExpressionStatement(Assignment(SimpleName:localSignatureId)(ASSIGNMENT_OPERATOR:=)(FieldAccess(ThisExpression)(SimpleName:signatureId))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:XMLObject)))(VariableDeclarationFragment(SimpleName:objects)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:XMLObject))))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:SignatureFacet))(SimpleName:signatureFacet))(FieldAccess(ThisExpression)(SimpleName:signatureFacets))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFacet))(SimpleName:getClass)))(SimpleName:getSimpleName))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFacet))(SimpleName:preSign)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureFactory)(SimpleName:document)(SimpleName:localSignatureId)(SimpleName:signingCertificateChain)(SimpleName:references)(SimpleName:objects))))))(VariableDeclarationStatement(SimpleType(SimpleName:SignatureMethod))(VariableDeclarationFragment(SimpleName:signatureMethod)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newSignatureMethod)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getSignatureMethod)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestAlgo)))(NullLiteral)))))(VariableDeclarationStatement(SimpleType(SimpleName:CanonicalizationMethod))(VariableDeclarationFragment(SimpleName:canonicalizationMethod)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newCanonicalizationMethod)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getCanonicalizationMethod))(CastExpression(SimpleType(SimpleName:C14NMethodParameterSpec))(NullLiteral))))))(VariableDeclarationStatement(SimpleType(SimpleName:SignedInfo))(VariableDeclarationFragment(SimpleName:signedInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newSignedInfo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:canonicalizationMethod)(SimpleName:signatureMethod)(SimpleName:references)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signatureValueId)(InfixExpression(SimpleName:localSignatureId)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(QualifiedName:javax.xml.crypto.dsig.XMLSignature))(VariableDeclarationFragment(SimpleName:xmlSignature)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureFactory))(SimpleName:newXMLSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedInfo)(NullLiteral)(SimpleName:objects)(SimpleName:localSignatureId)(SimpleName:signatureValueId)))))(VariableDeclarationStatement(SimpleType(SimpleName:DOMXMLSignature))(VariableDeclarationFragment(SimpleName:domXmlSignature)(CastExpression(SimpleType(SimpleName:DOMXMLSignature))(SimpleName:xmlSignature))))(VariableDeclarationStatement(SimpleType(SimpleName:Node))(VariableDeclarationFragment(SimpleName:documentNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:document))(SimpleName:getDocumentElement))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:documentNode))(Block(ExpressionStatement(Assignment(SimpleName:documentNode)(ASSIGNMENT_OPERATOR:=)(SimpleName:document)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:domXmlSignature))(SimpleName:marshal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:documentNode)(FieldAccess(ThisExpression)(SimpleName:signatureNamespacePrefix))(CastExpression(SimpleType(SimpleName:DOMCryptoContext))(SimpleName:xmlSignContext)))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:XMLObject))(SimpleName:object))(SimpleName:objects)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:object))(SimpleName:getClass)))(SimpleName:getName))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:XMLStructure)))(VariableDeclarationFragment(SimpleName:objectContentList)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:object))(SimpleName:getContent))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:XMLStructure))(SimpleName:objectContent))(SimpleName:objectContentList)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:objectContent))(SimpleName:getClass)))(SimpleName:getName))))))(IfStatement(InfixExpression(BooleanLiteral:false)(INFIX_EXPRESSION_OPERATOR:==)(InstanceofExpression(SimpleName:objectContent)(SimpleType(SimpleName:Manifest))))(Block(ContinueStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:Manifest))(VariableDeclarationFragment(SimpleName:manifest)(CastExpression(SimpleType(SimpleName:Manifest))(SimpleName:objectContent))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:Reference)))(VariableDeclarationFragment(SimpleName:manifestReferences)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifest))(SimpleName:getReferences))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Reference))(SimpleName:manifestReference))(SimpleName:manifestReferences)(Block(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifestReference))(SimpleName:getDigestValue)))(Block(ContinueStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:DOMReference))(VariableDeclarationFragment(SimpleName:manifestDOMReference)(CastExpression(SimpleType(SimpleName:DOMReference))(SimpleName:manifestReference))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manifestDOMReference))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:xmlSignContext))))))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:Reference)))(VariableDeclarationFragment(SimpleName:signedInfoReferences)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedInfo))(SimpleName:getReferences))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Reference))(SimpleName:signedInfoReference))(SimpleName:signedInfoReferences)(Block(VariableDeclarationStatement(SimpleType(SimpleName:DOMReference))(VariableDeclarationFragment(SimpleName:domReference)(CastExpression(SimpleType(SimpleName:DOMReference))(SimpleName:signedInfoReference))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:domReference))(SimpleName:getDigestValue)))(Block(ContinueStatement)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:domReference))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:xmlSignContext))))))(VariableDeclarationStatement(SimpleType(SimpleName:TemporaryDataStorage))(VariableDeclarationFragment(SimpleName:temporaryDataStorage)(MethodInvocation(SimpleName:getTemporaryDataStorage))))(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:tempDocumentOutputStream)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:temporaryDataStorage))(SimpleName:getTempOutputStream))))(ExpressionStatement(MethodInvocation(SimpleName:writeDocument)(METHOD_INVOCATION_ARGUMENTS(SimpleName:document)(SimpleName:tempDocumentOutputStream))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:temporaryDataStorage))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SIGNATURE_ID_ATTRIBUTE)(SimpleName:localSignatureId))))(VariableDeclarationStatement(SimpleType(SimpleName:DOMSignedInfo))(VariableDeclarationFragment(SimpleName:domSignedInfo)(CastExpression(SimpleType(SimpleName:DOMSignedInfo))(SimpleName:signedInfo))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:dataStream)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:domSignedInfo))(SimpleName:canonicalize)(METHOD_INVOCATION_ARGUMENTS(SimpleName:xmlSignContext)(SimpleName:dataStream))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:octets)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dataStream))(SimpleName:toByteArray))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:jcaMessageDigest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestAlgo))(SimpleName:getAlgoId))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digestValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:jcaMessageDigest))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:octets)))))(ReturnStatement(SimpleName:digestValue))))))