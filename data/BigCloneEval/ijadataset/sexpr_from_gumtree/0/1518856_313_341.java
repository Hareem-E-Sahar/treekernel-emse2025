(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:void)(SimpleName:authorize)(SingleVariableDeclaration(SimpleType(SimpleName:WebSocketConnector))(SimpleName:aConnector))(SingleVariableDeclaration(SimpleType(SimpleName:Token))(SimpleName:aToken))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:aChannelId))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lAccessKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aToken))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ACCESS_KEY)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lSecretKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aToken))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:SECRET_KEY)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lLogin)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aToken))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:User))(VariableDeclarationFragment(SimpleName:lUser)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecurityFactory))(SimpleName:getUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lLogin)))))(IfStatement(InfixExpression(SimpleName:lUser)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aConnector)(SimpleName:aChannelId)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aConnector))(SimpleName:getId))(StringLiteral:<STR>)(SimpleName:aChannelId)(StringLiteral:<STR>)))))(ReturnStatement)))(IfStatement(InfixExpression(InfixExpression(SimpleName:lSecretKey)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:lAccessKey)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ExpressionStatement(MethodInvocation(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aConnector)(SimpleName:aChannelId)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aConnector))(SimpleName:getId))(StringLiteral:<STR>)))))(ReturnStatement))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Channel))(VariableDeclarationFragment(SimpleName:lChannel)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mChannelManager))(SimpleName:getChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aChannelId)))))(IfStatement(InfixExpression(SimpleName:lChannel)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aConnector)(SimpleName:aChannelId)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aConnector))(SimpleName:getId))(StringLiteral:<STR>)(SimpleName:aChannelId)(StringLiteral:<STR>)))))(ReturnStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:Publisher))(VariableDeclarationFragment(SimpleName:lPublisher)(MethodInvocation(SimpleName:authorizePublisher)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aConnector)(SimpleName:lChannel)(SimpleName:lUser)(SimpleName:lSecretKey)(SimpleName:lAccessKey)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lPublisher))(SimpleName:isAuthorized)))(Block(ExpressionStatement(MethodInvocation(SimpleName:sendError)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aConnector)(SimpleName:aChannelId)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aConnector))(SimpleName:getId))(StringLiteral:<STR>)(SimpleName:aChannelId)(StringLiteral:<STR>))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lChannel))(SimpleName:addPublisher)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lPublisher))))(VariableDeclarationStatement(SimpleType(SimpleName:Token))(VariableDeclarationFragment(SimpleName:lResponseToken)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mChannelManager))(SimpleName:getChannelSuccessToken)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aConnector)(SimpleName:aChannelId)(QualifiedName:ChannelEventEnum.AUTHORIZE)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mChannelManager))(SimpleName:publishToLoggerChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lResponseToken))))(ExpressionStatement(MethodInvocation(SimpleName:sendToken)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aConnector)(SimpleName:aConnector)(SimpleName:lResponseToken))))))))))))