(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:sign)(SingleVariableDeclaration(SimpleType(SimpleName:XMLSignContext))(SimpleName:signContext))(SimpleType(SimpleName:MarshalException))(SimpleType(SimpleName:XMLSignatureException))(Block(IfStatement(InfixExpression(SimpleName:signContext)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:NullPointerException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:DOMSignContext))(VariableDeclarationFragment(SimpleName:context)(CastExpression(SimpleType(SimpleName:DOMSignContext))(SimpleName:signContext))))(IfStatement(InfixExpression(SimpleName:context)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(SimpleName:marshal)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getParent))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getNextSibling))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DOMUtils))(SimpleName:getSignaturePrefix)(METHOD_INVOCATION_ARGUMENTS(SimpleName:context)))(SimpleName:context))))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:allReferences)(ClassInstanceCreation(SimpleType(SimpleName:ArrayList)))))(ExpressionStatement(Assignment(SimpleName:signatureIdMap)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:HashMap)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureIdMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:id)(ThisExpression))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureIdMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:si))(SimpleName:getId))(SimpleName:si))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:refs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:si))(SimpleName:getReferences))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0))(VariableDeclarationFragment(SimpleName:size)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:refs))(SimpleName:size))))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:size))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Reference))(VariableDeclarationFragment(SimpleName:ref)(CastExpression(SimpleType(SimpleName:Reference))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:refs))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureIdMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ref))(SimpleName:getId))(SimpleName:ref))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0))(VariableDeclarationFragment(SimpleName:size)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:objects))(SimpleName:size))))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:size))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:XMLObject))(VariableDeclarationFragment(SimpleName:obj)(CastExpression(SimpleType(SimpleName:XMLObject))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:objects))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureIdMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:obj))(SimpleName:getId))(SimpleName:obj))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:content)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:obj))(SimpleName:getContent))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:j)(NumberLiteral:0))(VariableDeclarationFragment(SimpleName:csize)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:content))(SimpleName:size))))(InfixExpression(SimpleName:j)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:csize))(PostfixExpression(SimpleName:j)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:XMLStructure))(VariableDeclarationFragment(SimpleName:xs)(CastExpression(SimpleType(SimpleName:XMLStructure))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:content))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:j))))))(IfStatement(InstanceofExpression(SimpleName:xs)(SimpleType(SimpleName:Manifest)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Manifest))(VariableDeclarationFragment(SimpleName:man)(CastExpression(SimpleType(SimpleName:Manifest))(SimpleName:xs))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureIdMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:man))(SimpleName:getId))(SimpleName:man))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:manRefs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:man))(SimpleName:getReferences))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:k)(NumberLiteral:0))(VariableDeclarationFragment(SimpleName:msize)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manRefs))(SimpleName:size))))(InfixExpression(SimpleName:k)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:msize))(PostfixExpression(SimpleName:k)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Reference))(VariableDeclarationFragment(SimpleName:ref)(CastExpression(SimpleType(SimpleName:Reference))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manRefs))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:k))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:allReferences))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ref))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureIdMap))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ref))(SimpleName:getId))(SimpleName:ref))))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:allReferences))(SimpleName:addAll)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:si))(SimpleName:getReferences)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0))(VariableDeclarationFragment(SimpleName:size)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:allReferences))(SimpleName:size))))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:size))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DOMReference))(VariableDeclarationFragment(SimpleName:ref)(CastExpression(SimpleType(SimpleName:DOMReference))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:allReferences))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i))))))(ExpressionStatement(MethodInvocation(SimpleName:digestReference)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ref)(SimpleName:signContext))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0))(VariableDeclarationFragment(SimpleName:size)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:allReferences))(SimpleName:size))))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:size))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DOMReference))(VariableDeclarationFragment(SimpleName:ref)(CastExpression(SimpleType(SimpleName:DOMReference))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:allReferences))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ref))(SimpleName:isDigested))(Block(ContinueStatement)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ref))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signContext))))))(VariableDeclarationStatement(SimpleType(SimpleName:Key))(VariableDeclarationFragment(SimpleName:signingKey)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:KeySelectorResult))(VariableDeclarationFragment(SimpleName:ksr)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:ksr)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signContext))(SimpleName:getKeySelector)))(SimpleName:select)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ki)(QualifiedName:KeySelector.Purpose.SIGN)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:si))(SimpleName:getSignatureMethod))(SimpleName:signContext)))))(ExpressionStatement(Assignment(SimpleName:signingKey)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ksr))(SimpleName:getKey))))(IfStatement(InfixExpression(SimpleName:signingKey)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:XMLSignatureException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:KeySelectorException))(SimpleName:kse))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:XMLSignatureException))(StringLiteral:<STR>)(SimpleName:kse))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:val)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:val)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:DOMSignatureMethod))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:si))(SimpleName:getSignatureMethod)))))(SimpleName:sign)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signingKey)(CastExpression(SimpleType(SimpleName:DOMSignedInfo))(SimpleName:si))(SimpleName:signContext))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidKeyException))(SimpleName:ike))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:XMLSignatureException))(SimpleName:ike))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Level.FINE)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Level.FINE)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:val)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:DOMSignatureValue))(SimpleName:sv))))(SimpleName:setValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:val))))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:localSigElem))(ASSIGNMENT_OPERATOR:=)(SimpleName:sigElem)))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:ksr))(ASSIGNMENT_OPERATOR:=)(SimpleName:ksr)))))))