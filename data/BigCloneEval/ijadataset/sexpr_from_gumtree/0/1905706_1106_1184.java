(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:getEncodedPKCS7)(SingleVariableDeclaration(PrimitiveType:byte)(SimpleName:secondDigest)(Dimension))(SingleVariableDeclaration(SimpleType(SimpleName:Calendar))(SimpleName:signingTime))(SingleVariableDeclaration(SimpleType(SimpleName:TSAClient))(SimpleName:tsaClient))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:ocsp))(Block(TryStatement(Block(IfStatement(InfixExpression(SimpleName:externalDigest)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(SimpleName:externalDigest)))(IfStatement(InfixExpression(SimpleName:RSAdata)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(Assignment(SimpleName:RSAdata)(ASSIGNMENT_OPERATOR:=)(SimpleName:externalRSAdata)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:externalRSAdata)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:RSAdata)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:RSAdata)(ASSIGNMENT_OPERATOR:=)(SimpleName:externalRSAdata)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:RSAdata))))(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:sign)))))(Block(IfStatement(InfixExpression(SimpleName:RSAdata)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:RSAdata)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:RSAdata))))))(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sig))(SimpleName:sign)))))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:digestAlgorithms)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Object))(SimpleName:element))(SimpleName:digestalgos)(Block(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:algos)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algos))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ASN1ObjectIdentifier))(CastExpression(SimpleType(SimpleName:String))(SimpleName:element))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:algos))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:DERNull.INSTANCE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestAlgorithms))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:algos)))))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:v)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ASN1ObjectIdentifier))(SimpleName:ID_PKCS7_DATA)))))(IfStatement(InfixExpression(SimpleName:RSAdata)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERTaggedObject))(NumberLiteral:0)(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(SimpleName:RSAdata)))))))(VariableDeclarationStatement(SimpleType(SimpleName:DERSequence))(VariableDeclarationFragment(SimpleName:contentinfo)(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:v))))(ExpressionStatement(Assignment(SimpleName:v)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Object))(SimpleName:element))(SimpleName:certs)(Block(VariableDeclarationStatement(SimpleType(SimpleName:ASN1InputStream))(VariableDeclarationFragment(SimpleName:tempstream)(ClassInstanceCreation(SimpleType(SimpleName:ASN1InputStream))(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:X509Certificate))(SimpleName:element))))(SimpleName:getEncoded))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tempstream))(SimpleName:readObject)))))))(VariableDeclarationStatement(SimpleType(SimpleName:DERSet))(VariableDeclarationFragment(SimpleName:dercertificates)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:v))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:signerinfo)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ASN1Integer))(SimpleName:signerversion)))))(ExpressionStatement(Assignment(SimpleName:v)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getIssuer)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signCert))(SimpleName:getTBSCertificate)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ASN1Integer))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signCert))(SimpleName:getSerialNumber))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:v)))))(ExpressionStatement(Assignment(SimpleName:v)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ASN1ObjectIdentifier))(SimpleName:digestAlgorithm)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERNull))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:v)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:secondDigest)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:signingTime)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERTaggedObject))(BooleanLiteral:false)(NumberLiteral:0)(MethodInvocation(SimpleName:getAuthenticatedAttributeSet)(METHOD_INVOCATION_ARGUMENTS(SimpleName:secondDigest)(SimpleName:signingTime)(SimpleName:ocsp)))))))))(ExpressionStatement(Assignment(SimpleName:v)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ASN1ObjectIdentifier))(SimpleName:digestEncryptionAlgorithm)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERNull))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:v)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DEROctetString))(SimpleName:digest)))))(IfStatement(InfixExpression(SimpleName:tsaClient)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tsImprint)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsaClient))(SimpleName:getDigestAlgorithm)))))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:tsToken)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tsaClient))(SimpleName:getTimeStampToken)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tsImprint)))))(IfStatement(InfixExpression(SimpleName:tsToken)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:unauthAttributes)(MethodInvocation(SimpleName:buildUnauthenticatedAttributes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tsToken)))))(IfStatement(InfixExpression(SimpleName:unauthAttributes)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerinfo))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERTaggedObject))(BooleanLiteral:false)(NumberLiteral:1)(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:unauthAttributes))))))))))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:body)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ASN1Integer))(SimpleName:version)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(SimpleName:digestAlgorithms)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentinfo))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERTaggedObject))(BooleanLiteral:false)(NumberLiteral:0)(SimpleName:dercertificates)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSet))(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:signerinfo))))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:whole)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:whole))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ASN1ObjectIdentifier))(SimpleName:ID_PKCS7_SIGNED_DATA)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:whole))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERTaggedObject))(NumberLiteral:0)(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:body))))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:bOut)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1OutputStream))(VariableDeclarationFragment(SimpleName:dout)(ClassInstanceCreation(SimpleType(SimpleName:ASN1OutputStream))(SimpleName:bOut))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dout))(SimpleName:writeObject)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DERSequence))(SimpleName:whole)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dout))(SimpleName:close)))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:bOut))(SimpleName:toByteArray))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExceptionConverter))(SimpleName:e))))))))))