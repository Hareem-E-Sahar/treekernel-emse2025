(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:void)(SimpleName:run)(SingleVariableDeclaration(SimpleType(SimpleName:X509Name))(SimpleName:issuerDN))(SingleVariableDeclaration(SimpleType(SimpleName:X509Name))(SimpleName:subjectDN))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:outPath))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:tomcatPasswd))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:truststorePasswd))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:testClientPasswd))(SimpleType(SimpleName:Exception))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPairGenerator))(VariableDeclarationFragment(SimpleName:keygen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyPairGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keygen))(SimpleName:initialize)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:2048))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:cAKeys)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keygen))(SimpleName:generateKeyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:caCert)(MethodInvocation(SimpleName:genCert)(METHOD_INVOCATION_ARGUMENTS(SimpleName:issuerDN)(SimpleName:issuerDN)(NumberLiteral:3650)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cAKeys))(SimpleName:getPrivate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cAKeys))(SimpleName:getPublic))(BooleanLiteral:true)(InfixExpression(QualifiedName:X509KeyUsage.keyCertSign)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:X509KeyUsage.cRLSign))(NullLiteral)))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:cacerts)(ArrayCreation(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension(NumberLiteral:1))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:cacerts)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(SimpleName:caCert)))(ExpressionStatement(MethodInvocation(SimpleName:writeCACertToPEM)(METHOD_INVOCATION_ARGUMENTS(SimpleName:caCert)(SimpleName:outPath))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:sSLServerKeys)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keygen))(SimpleName:generateKeyPair))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:sSLServerEKU)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:String))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sSLServerEKU))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:sSLServerCert)(MethodInvocation(SimpleName:genCert)(METHOD_INVOCATION_ARGUMENTS(SimpleName:issuerDN)(SimpleName:subjectDN)(NumberLiteral:3650)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cAKeys))(SimpleName:getPrivate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sSLServerKeys))(SimpleName:getPublic))(BooleanLiteral:false)(InfixExpression(QualifiedName:X509KeyUsage.digitalSignature)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:X509KeyUsage.keyEncipherment))(SimpleName:sSLServerEKU)))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:tomcat)(MethodInvocation(SimpleName:createUserJKS)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sSLServerKeys))(SimpleName:getPrivate))(SimpleName:tomcatPasswd)(SimpleName:sSLServerCert)(SimpleName:cacerts)))))(VariableDeclarationStatement(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:fos)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(InfixExpression(SimpleName:outPath)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:File.separator)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tomcat))(SimpleName:store)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fos)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tomcatPasswd))(SimpleName:toCharArray)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fos))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:truststore)(MethodInvocation(SimpleName:createTrustJKS)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:truststorePasswd)(SimpleName:caCert)))))(ExpressionStatement(Assignment(SimpleName:fos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(InfixExpression(SimpleName:outPath)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:File.separator)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:truststore))(SimpleName:store)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fos)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:truststorePasswd))(SimpleName:toCharArray)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fos))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:testClientKeys)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keygen))(SimpleName:generateKeyPair))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:testClientEKU)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:String))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sSLServerEKU))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Name))(VariableDeclarationFragment(SimpleName:testClientName)(ClassInstanceCreation(SimpleType(SimpleName:X509Name))(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:testClientCert)(MethodInvocation(SimpleName:genCert)(METHOD_INVOCATION_ARGUMENTS(SimpleName:issuerDN)(SimpleName:testClientName)(NumberLiteral:3650)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cAKeys))(SimpleName:getPrivate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:testClientKeys))(SimpleName:getPublic))(BooleanLiteral:false)(InfixExpression(QualifiedName:X509KeyUsage.digitalSignature)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:X509KeyUsage.keyEncipherment))(SimpleName:testClientEKU)))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:testclient)(MethodInvocation(SimpleName:createUserJKS)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:testClientKeys))(SimpleName:getPrivate))(SimpleName:testClientPasswd)(SimpleName:testClientCert)(SimpleName:cacerts)))))(ExpressionStatement(Assignment(SimpleName:fos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(InfixExpression(SimpleName:outPath)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:File.separator)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:testclient))(SimpleName:store)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fos)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:testClientPasswd))(SimpleName:toCharArray)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fos))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:outPath)))))))))