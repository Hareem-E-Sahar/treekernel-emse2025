(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(ArrayType(SimpleType(SimpleName:IFile))(Dimension))(SimpleName:getDocuments)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:IFile))(SimpleName:iReportFile))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:ReportFolders))(VariableDeclarationFragment(SimpleName:folder)(ClassInstanceCreation(SimpleType(SimpleName:ReportFolders))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NofdpCorePlugin))(SimpleName:getProjectManager)))(SimpleName:getActiveProject)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:IFolder))(VariableDeclarationFragment(SimpleName:iTempFolder)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:folder))(SimpleName:getTempFolder)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:IFile))(VariableDeclarationFragment(SimpleName:iTempReportFile)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iTempFolder))(SimpleName:getFile)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iReportFile))(SimpleName:getName))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:copyFile)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iReportFile))(SimpleName:getLocation)))(SimpleName:toFile))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iTempReportFile))(SimpleName:getLocation)))(SimpleName:toFile)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:WorkspaceSync))(SimpleName:sync)(METHOD_INVOCATION_ARGUMENTS(SimpleName:iTempFolder)(QualifiedName:IResource.DEPTH_INFINITE))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iTempReportFile))(SimpleName:exists)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(QualifiedName:Messages.OpenOfficeExporter_1))))(ExpressionStatement(MethodInvocation(SimpleName:configureJob)(METHOD_INVOCATION_ARGUMENTS(SimpleName:iTempReportFile))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:IFile))(VariableDeclarationFragment(SimpleName:jobFile)(MethodInvocation(SimpleName:writeJobFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:iTempFolder)))))(ExpressionStatement(MethodInvocation(SimpleName:processJobFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jobFile))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:WorkspaceSync))(SimpleName:sync)(METHOD_INVOCATION_ARGUMENTS(SimpleName:iTempFolder)(QualifiedName:IResource.DEPTH_INFINITE))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:IFile))(VariableDeclarationFragment(SimpleName:resultZip)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iTempFolder))(SimpleName:getFile)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:OpenOfficeExporter.RESULT_ZIP_NAME)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:resultZip))(SimpleName:exists)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(QualifiedName:Messages.OpenOfficeExporter_2))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:IFolder))(VariableDeclarationFragment(SimpleName:iDocumentResultFolder)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iTempFolder))(SimpleName:getFolder)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Messages.OpenOfficeExporter_3)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:ZipFile))(VariableDeclarationFragment(SimpleName:zf)(ClassInstanceCreation(SimpleType(SimpleName:ZipFile))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:resultZip))(SimpleName:getLocation)))(SimpleName:toFile)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ZipUtils))(SimpleName:unpack)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zf)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iDocumentResultFolder))(SimpleName:getLocation)))(SimpleName:toFile)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zf))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:WorkspaceSync))(SimpleName:sync)(METHOD_INVOCATION_ARGUMENTS(SimpleName:iTempFolder)(QualifiedName:IResource.DEPTH_INFINITE))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:CollectFilesVisitor))(VariableDeclarationFragment(SimpleName:visitor)(ClassInstanceCreation(SimpleType(SimpleName:CollectFilesVisitor)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:iDocumentResultFolder))(SimpleName:accept)(METHOD_INVOCATION_ARGUMENTS(SimpleName:visitor))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:visitor))(SimpleName:getFiles)))))))