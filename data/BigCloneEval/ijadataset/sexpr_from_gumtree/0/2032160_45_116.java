(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:main)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:args)(Dimension))(Block(IfStatement(InfixExpression(QualifiedName:args.length)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:5))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.err))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:MailcapCommandMap))(VariableDeclarationFragment(SimpleName:mailcap)(CastExpression(SimpleType(SimpleName:MailcapCommandMap))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CommandMap))(SimpleName:getDefaultCommandMap)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mailcap))(SimpleName:addMailcap)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mailcap))(SimpleName:addMailcap)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mailcap))(SimpleName:addMailcap)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mailcap))(SimpleName:addMailcap)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mailcap))(SimpleName:addMailcap)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CommandMap))(SimpleName:setDefaultCommandMap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mailcap))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Security))(SimpleName:addProvider)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:BouncyCastleProvider))))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:keystore)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keystore))(SimpleName:load)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(ArrayAccess(SimpleName:args)(NumberLiteral:0)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:args)(NumberLiteral:1)))(SimpleName:toCharArray)))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:chain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keystore))(SimpleName:getCertificateChain)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(NumberLiteral:2))))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:privateKey)(CastExpression(SimpleType(SimpleName:PrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keystore))(SimpleName:getKey)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(NumberLiteral:2))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:args)(NumberLiteral:1)))(SimpleName:toCharArray)))))))(IfStatement(InfixExpression(SimpleName:privateKey)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:Exception))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ArrayAccess(SimpleName:args)(NumberLiteral:2)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Properties))(VariableDeclarationFragment(SimpleName:props)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:getProperties))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:props))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ArrayAccess(SimpleName:args)(NumberLiteral:3)))))(VariableDeclarationStatement(SimpleType(SimpleName:Session))(VariableDeclarationFragment(SimpleName:session)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Session))(SimpleName:getDefaultInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:props)(NullLiteral)))))(VariableDeclarationStatement(SimpleType(SimpleName:MimeMessage))(VariableDeclarationFragment(SimpleName:body)(ClassInstanceCreation(SimpleType(SimpleName:MimeMessage))(SimpleName:session))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:setFrom)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:InternetAddress))(ArrayAccess(SimpleName:args)(NumberLiteral:4))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:setRecipient)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Message.RecipientType.TO)(ClassInstanceCreation(SimpleType(SimpleName:InternetAddress))(ArrayAccess(SimpleName:args)(NumberLiteral:4))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:setSubject)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:setContent)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:saveChanges)))(VariableDeclarationStatement(SimpleType(SimpleName:SMIMECapabilityVector))(VariableDeclarationFragment(SimpleName:capabilities)(ClassInstanceCreation(SimpleType(SimpleName:SMIMECapabilityVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:capabilities))(SimpleName:addCapability)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SMIMECapability.dES_EDE3_CBC))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:capabilities))(SimpleName:addCapability)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SMIMECapability.rC2_CBC)(NumberLiteral:128))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:capabilities))(SimpleName:addCapability)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SMIMECapability.dES_CBC))))(VariableDeclarationStatement(SimpleType(SimpleName:ASN1EncodableVector))(VariableDeclarationFragment(SimpleName:attributes)(ClassInstanceCreation(SimpleType(SimpleName:ASN1EncodableVector)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attributes))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:SMIMEEncryptionKeyPreferenceAttribute))(ClassInstanceCreation(SimpleType(SimpleName:IssuerAndSerialNumber))(ClassInstanceCreation(SimpleType(SimpleName:X509Name))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(NumberLiteral:0)))))(SimpleName:getIssuerDN)))(SimpleName:getName)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(NumberLiteral:0)))))(SimpleName:getSerialNumber)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attributes))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:SMIMECapabilitiesAttribute))(SimpleName:capabilities)))))(VariableDeclarationStatement(SimpleType(SimpleName:SMIMESignedGenerator))(VariableDeclarationFragment(SimpleName:signer)(ClassInstanceCreation(SimpleType(SimpleName:SMIMESignedGenerator)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signer))(SimpleName:addSigner)(METHOD_INVOCATION_ARGUMENTS(SimpleName:privateKey)(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(NumberLiteral:0)))(ConditionalExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateKey))(SimpleName:getAlgorithm))))(QualifiedName:SMIMESignedGenerator.DIGEST_SHA1)(QualifiedName:SMIMESignedGenerator.DIGEST_MD5))(ClassInstanceCreation(SimpleType(SimpleName:AttributeTable))(SimpleName:attributes))(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:certList)(ClassInstanceCreation(SimpleType(SimpleName:ArrayList)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certList))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:chain)(NumberLiteral:0)))))(VariableDeclarationStatement(SimpleType(SimpleName:CertStore))(VariableDeclarationFragment(SimpleName:certs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ClassInstanceCreation(SimpleType(SimpleName:CollectionCertStoreParameters))(SimpleName:certList))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signer))(SimpleName:addCertificatesAndCRLs)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certs))))(VariableDeclarationStatement(SimpleType(SimpleName:MimeMultipart))(VariableDeclarationFragment(SimpleName:mm)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signer))(SimpleName:generate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:body)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:MimeMessage))(VariableDeclarationFragment(SimpleName:signedMessage)(ClassInstanceCreation(SimpleType(SimpleName:MimeMessage))(SimpleName:session))))(VariableDeclarationStatement(SimpleType(SimpleName:Enumeration))(VariableDeclarationFragment(SimpleName:headers)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:getAllHeaderLines))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headers))(SimpleName:hasMoreElements))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedMessage))(SimpleName:addHeaderLine)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headers))(SimpleName:nextElement))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedMessage))(SimpleName:setContent)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mm))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedMessage))(SimpleName:saveChanges)))(VariableDeclarationStatement(SimpleType(SimpleName:SMIMEEnvelopedGenerator))(VariableDeclarationFragment(SimpleName:encrypter)(ClassInstanceCreation(SimpleType(SimpleName:SMIMEEnvelopedGenerator)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypter))(SimpleName:addKeyTransRecipient)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(NumberLiteral:0))))))(VariableDeclarationStatement(SimpleType(SimpleName:MimeBodyPart))(VariableDeclarationFragment(SimpleName:encryptedPart)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encrypter))(SimpleName:generate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedMessage)(QualifiedName:SMIMEEnvelopedGenerator.RC2_CBC)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:out)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encryptedPart))(SimpleName:writeTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:out))))(VariableDeclarationStatement(SimpleType(SimpleName:MimeMessage))(VariableDeclarationFragment(SimpleName:encryptedMessage)(ClassInstanceCreation(SimpleType(SimpleName:MimeMessage))(SimpleName:session)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:toByteArray))))))(ExpressionStatement(Assignment(SimpleName:headers)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:body))(SimpleName:getAllHeaderLines))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headers))(SimpleName:hasMoreElements))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:headerLine)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headers))(SimpleName:nextElement)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Strings))(SimpleName:toLowerCase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:headerLine))))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encryptedMessage))(SimpleName:addHeaderLine)(METHOD_INVOCATION_ARGUMENTS(SimpleName:headerLine))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Transport))(SimpleName:send)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptedMessage)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:SMIMEException))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ex))(SimpleName:getUnderlyingException)))(SimpleName:printStackTrace)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:System.err))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ex))(SimpleName:printStackTrace)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:System.err))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ex))(SimpleName:printStackTrace)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:System.err)))))))))))