(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:process)(SingleVariableDeclaration(SimpleType(SimpleName:HttpServletRequest))(SimpleName:req))(SingleVariableDeclaration(SimpleType(SimpleName:HttpServletResponse))(SimpleName:resp))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:ServletException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:text)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:req))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:clientuuid)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:req))(SimpleName:getParameter)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:UrlStr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:req))(SimpleName:getRequestURL)))(SimpleName:toString))))(VariableDeclarationStatement(SimpleType(SimpleName:URL))(VariableDeclarationFragment(SimpleName:domainurl)(ClassInstanceCreation(SimpleType(SimpleName:URL))(SimpleName:UrlStr))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:domain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:domainurl))(SimpleName:getHost))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:chatdomain)(NullLiteral)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:domain))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:chatdomain)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:domain))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:chatdomain)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:clientuuid)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:chatdomain)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lastline)(SimpleName:text)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:phrasetype)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:Key))(VariableDeclarationFragment(SimpleName:key)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyFactory))(SimpleName:createKey)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(InfixExpression(SimpleName:clientuuid)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:chatdomain)(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:Entity))(VariableDeclarationFragment(SimpleName:lastLineEntity)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:lastLineEntity)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DatastoreServiceFactory))(SimpleName:getDatastoreService)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:key)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:msgBody)))(VariableDeclarationStatement(SimpleType(SimpleName:JID))(VariableDeclarationFragment(SimpleName:jid)(ClassInstanceCreation(SimpleType(SimpleName:JID))(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:JID))(VariableDeclarationFragment(SimpleName:jidr)(ClassInstanceCreation(SimpleType(SimpleName:JID))(InfixExpression(SimpleName:clientuuid)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:chatdomain)(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:lastline)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:lastline)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastLineEntity))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:LINE))))))(ExpressionStatement(Assignment(SimpleName:phrasetype)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastLineEntity))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:PHRASETYPE))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:phrasetype))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:msgBody)(ASSIGNMENT_OPERATOR:=)(SimpleName:phrasetype)))(VariableDeclarationStatement(SimpleType(SimpleName:Message))(VariableDeclarationFragment(SimpleName:msg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:MessageBuilder))))(SimpleName:withFromJid)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jidr))))(SimpleName:withRecipientJids)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jid))))(SimpleName:withBody)(METHOD_INVOCATION_ARGUMENTS(SimpleName:msgBody))))(SimpleName:build))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:messageSent)(BooleanLiteral:false)))(VariableDeclarationStatement(SimpleType(SimpleName:XMPPService))(VariableDeclarationFragment(SimpleName:xmpp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMPPServiceFactory))(SimpleName:getXMPPService))))(VariableDeclarationStatement(SimpleType(SimpleName:SendResponse))(VariableDeclarationFragment(SimpleName:status)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmpp))(SimpleName:sendMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:msg)))))(ExpressionStatement(Assignment(SimpleName:messageSent)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:status))(SimpleName:getStatusMap)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jid)))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:SendResponse.Status.SUCCESS)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:messageSent))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))))(Block(ExpressionStatement(Assignment(SimpleName:phrasetype)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastLineEntity))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:PHRASETYPE))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastLineEntity))(SimpleName:setProperty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:LINE)(SimpleName:text))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:phrasetype))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:msgBody)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:phrasetype)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:text))))(EmptyStatement))(Block(ExpressionStatement(Assignment(SimpleName:msgBody)(ASSIGNMENT_OPERATOR:=)(SimpleName:text)))))(VariableDeclarationStatement(SimpleType(SimpleName:Message))(VariableDeclarationFragment(SimpleName:msg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:MessageBuilder))))(SimpleName:withFromJid)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jidr))))(SimpleName:withRecipientJids)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jid))))(SimpleName:withBody)(METHOD_INVOCATION_ARGUMENTS(SimpleName:msgBody))))(SimpleName:build))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:messageSent)(BooleanLiteral:false)))(VariableDeclarationStatement(SimpleType(SimpleName:XMPPService))(VariableDeclarationFragment(SimpleName:xmpp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMPPServiceFactory))(SimpleName:getXMPPService))))(VariableDeclarationStatement(SimpleType(SimpleName:SendResponse))(VariableDeclarationFragment(SimpleName:status)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmpp))(SimpleName:sendMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:msg)))))(ExpressionStatement(Assignment(SimpleName:messageSent)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:status))(SimpleName:getStatusMap)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jid)))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:SendResponse.Status.SUCCESS)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:messageSent))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:EntityNotFoundException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:lastLineEntity)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Entity))(SimpleName:key))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastLineEntity))(SimpleName:setProperty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:LINE)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastLineEntity))(SimpleName:setProperty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:PHRASETYPE)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DatastoreServiceFactory))(SimpleName:getDatastoreService)))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lastLineEntity)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:lastline)))))(VariableDeclarationStatement(SimpleType(SimpleName:PrintWriter))(VariableDeclarationFragment(SimpleName:out)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:resp))(SimpleName:getWriter))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lastline))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(SimpleName:phrasetype))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:flush))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:severe)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))))