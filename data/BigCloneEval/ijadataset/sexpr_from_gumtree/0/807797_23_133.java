(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:decode)(SingleVariableDeclaration(SimpleType(SimpleName:ConnectionHandler))(SimpleName:p))(SingleVariableDeclaration(SimpleType(SimpleName:InStream))(SimpleName:in))(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getConnectionStage))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:Constants.LOGIN_START))(Block(VariableDeclarationStatement(SimpleType(SimpleName:OutStream))(VariableDeclarationFragment(SimpleName:outstream)(ClassInstanceCreation(SimpleType(SimpleName:OutStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outstream))(SimpleName:writeByte)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outstream))(SimpleName:writeLong)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getSessionKey)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:outstream))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setConnectionStage)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.LOGIN_CYPTION)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getConnectionStage))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:Constants.LOGIN_CYPTION))(Block(IfStatement(InfixExpression(NumberLiteral:3)(INFIX_EXPRESSION_OPERATOR:>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:remaining)))(Block(ReturnStatement)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:loginType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readUnsignedByte))))(IfStatement(InfixExpression(InfixExpression(SimpleName:loginType)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:16))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:loginType)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:18)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setConnectionStage)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.DISCONNECT))))(ReturnStatement)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:loginPacketSize)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readUnsignedShort))))(IfStatement(InfixExpression(SimpleName:loginPacketSize)(INFIX_EXPRESSION_OPERATOR:>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:remaining)))(Block(ReturnStatement)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:clientVersion)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readInt))))(IfStatement(InfixExpression(SimpleName:clientVersion)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:Constants.REVISION))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setConnectionStage)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.DISCONNECT))))(ReturnStatement)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:unknown0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readUnsignedByte))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:displayMode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readUnsignedByte))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setDisplayMode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:displayMode))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:screenSizeX)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readUnsignedShort))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:screenSizeY)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readUnsignedShort))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:unknown3)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readUnsignedByte))))(VariableDeclarationStatement(SimpleType(SimpleName:InStream))(VariableDeclarationFragment(SimpleName:inStream1)(ClassInstanceCreation(SimpleType(SimpleName:InStream))(NumberLiteral:24))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inStream1))(SimpleName:addBytes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:buffer))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:offset))(NumberLiteral:24))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:skip)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:24))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:settings)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readRS2String))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:unknown4)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readInt))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:size)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readUnsignedByte))))(VariableDeclarationStatement(SimpleType(SimpleName:InStream))(VariableDeclarationFragment(SimpleName:inStream2)(ClassInstanceCreation(SimpleType(SimpleName:InStream))(SimpleName:size))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inStream2))(SimpleName:addBytes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:buffer))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:offset))(SimpleName:size))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:skip)(METHOD_INVOCATION_ARGUMENTS(SimpleName:size))))(VariableDeclarationStatement(SimpleType(SimpleName:InStream))(VariableDeclarationFragment(SimpleName:inStream3)(ClassInstanceCreation(SimpleType(SimpleName:InStream))(NumberLiteral:14))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inStream1))(SimpleName:addBytes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:buffer))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:offset))(NumberLiteral:14))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:skip)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:14))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readShort)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readLong)))(VariableDeclarationStatement(ArrayType(PrimitiveType:int)(Dimension))(VariableDeclarationFragment(SimpleName:idxSizes)(ArrayCreation(ArrayType(PrimitiveType:int)(Dimension(NumberLiteral:33))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:index)(NumberLiteral:0)))(InfixExpression(SimpleName:index)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:idxSizes.length))(PostfixExpression(SimpleName:index)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:idxSizes)(SimpleName:index))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readInt)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:skip)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:6))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readUnsignedByte))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:10))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setConnectionStage)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.DISCONNECT))))(ReturnStatement)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:sessionKey)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:int)(Dimension(NumberLiteral:4))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:4))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:sessionKey)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readInt)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:l)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readLong))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:hash)(CastExpression(PrimitiveType:int)(ParenthesizedExpression(InfixExpression(NumberLiteral:31)(INFIX_EXPRESSION_OPERATOR:&)(InfixExpression(SimpleName:l)(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:16)))))))(IfStatement(InfixExpression(SimpleName:hash)(INFIX_EXPRESSION_OPERATOR:!=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getNameHash)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setConnectionStage)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.DISCONNECT))))(ReturnStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:Username)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Misc))(SimpleName:formatPlayerNameForProtocol)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Misc))(SimpleName:longToString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:l)))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:Password)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:in))(SimpleName:readRS2String))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:4))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:sessionKey)(SimpleName:i))(ASSIGNMENT_OPERATOR:+=)(NumberLiteral:50))))(VariableDeclarationStatement(PrimitiveType:byte)(VariableDeclarationFragment(SimpleName:OpCode)(NumberLiteral:0)))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:account)(MethodInvocation(SimpleName:AccountFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:Username)))))(VariableDeclarationStatement(SimpleType(SimpleName:Player))(VariableDeclarationFragment(SimpleName:player)(NullLiteral)))(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:account)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:Username)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:Password)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:OpCode)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Constants.INVALID_PASSWORD))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:World))(SimpleName:isOnList)(METHOD_INVOCATION_ARGUMENTS(SimpleName:Username)))(Block(ExpressionStatement(Assignment(SimpleName:OpCode)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Constants.ALREADY_ONLINE))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:account))(SimpleName:exists)))(Block(ExpressionStatement(Assignment(SimpleName:player)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Player))(SimpleName:Username)(SimpleName:Password)(ClassInstanceCreation(SimpleType(SimpleName:GregorianCalendar)))(ClassInstanceCreation(SimpleType(SimpleName:GregorianCalendar)))(CastExpression(PrimitiveType:short)(NumberLiteral:1))(StringLiteral:<STR>)(CastExpression(PrimitiveType:byte)(NumberLiteral:1)))))(ExpressionStatement(Assignment(SimpleName:OpCode)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:2))))(Block(ExpressionStatement(Assignment(SimpleName:player)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Serializer))(SimpleName:LoadAccount)(METHOD_INVOCATION_ARGUMENTS(SimpleName:account)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Password))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:player))(SimpleName:getPassword)))))(Block(ExpressionStatement(Assignment(SimpleName:OpCode)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Constants.INVALID_PASSWORD))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:player))(SimpleName:isBanned))(Block(ExpressionStatement(Assignment(SimpleName:OpCode)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Constants.BANNED))))(Block(ExpressionStatement(Assignment(SimpleName:OpCode)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:2))))))))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:waitTime)(NumberLiteral:0)))(IfStatement(InfixExpression(SimpleName:OpCode)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:2))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ip)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getChannel)))(SimpleName:getLocalAddress)))))(ExpressionStatement(Assignment(SimpleName:ip)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ip))(SimpleName:replaceAll)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:ip)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ip))(SimpleName:replaceAll)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:ip)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ip))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ip))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:ipInt)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Misc))(SimpleName:IPAddressToNumber)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ip)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:World))(SimpleName:getIps)))(SimpleName:containsKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ipInt)))(Block(ExpressionStatement(Assignment(SimpleName:waitTime)(ASSIGNMENT_OPERATOR:=)(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:-)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:World))(SimpleName:getIps)))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ipInt)))))(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:1000))))(IfStatement(InfixExpression(SimpleName:waitTime)(INFIX_EXPRESSION_OPERATOR:<=)(NumberLiteral:42))(Block))))))(VariableDeclarationStatement(SimpleType(SimpleName:OutStream))(VariableDeclarationFragment(SimpleName:outstream)(ClassInstanceCreation(SimpleType(SimpleName:OutStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outstream))(SimpleName:writeByte)(METHOD_INVOCATION_ARGUMENTS(SimpleName:OpCode))))(IfStatement(InfixExpression(SimpleName:OpCode)(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:21))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outstream))(SimpleName:writeByte)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:int)(ParenthesizedExpression(InfixExpression(NumberLiteral:42)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:waitTime))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:outstream))))(IfStatement(InfixExpression(SimpleName:OpCode)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:2))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setConnectionStage)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.DISCONNECT))))(ReturnStatement)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setConnectionStage)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.REMOVE_ID))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setPlayer)(METHOD_INVOCATION_ARGUMENTS(SimpleName:player))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:World))(SimpleName:registerConnection)(METHOD_INVOCATION_ARGUMENTS(SimpleName:p)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setConnectionStage)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.DISCONNECT)))))))))))