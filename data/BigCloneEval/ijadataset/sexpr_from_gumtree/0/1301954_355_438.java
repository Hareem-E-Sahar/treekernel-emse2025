(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:downloadCert)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:label))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:pintype))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:pin))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:basicpin))(SingleVariableDeclaration(SimpleType(SimpleName:X509Certificate))(SimpleName:cert))(SimpleType(SimpleName:ObjectAlreadyExistsException))(SimpleType(SimpleName:OperationNotSupportedException))(SimpleType(SimpleName:TokenException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Session))(VariableDeclarationFragment(SimpleName:session)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:Token))(VariableDeclarationFragment(SimpleName:token)(CastExpression(SimpleType(SimpleName:Token))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tokens))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pintype))))))(VariableDeclarationStatement(SimpleType(SimpleName:Token))(VariableDeclarationFragment(SimpleName:basetoken)(CastExpression(SimpleType(SimpleName:Token))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tokens))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:IToken.PINTYPE_BASIC))))))(IfStatement(InfixExpression(SimpleName:token)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:OperationNotSupportedException))(StringLiteral:<STR>)))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(QualifiedName:java.security.PublicKey))(VariableDeclarationFragment(SimpleName:publicKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getPublicKey))))(ExpressionStatement(Assignment(SimpleName:session)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:openSession)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SessionType.SERIAL_SESSION)(QualifiedName:SessionReadWriteBehavior.RW_SESSION)(NullLiteral)(NullLiteral)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getSessionInfo)))(SimpleName:getState)))(SimpleName:toString)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:State.RW_USER_FUNCTIONS))(SimpleName:toString)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:login)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:UserType.USER)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pin))(SimpleName:toCharArray)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Object))(VariableDeclarationFragment(SimpleName:searchTemplate)(NullLiteral)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:publicKey))(SimpleName:getAlgorithm)))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:java.security.interfaces.RSAPublicKey))(VariableDeclarationFragment(SimpleName:rsaPublicKey)(CastExpression(SimpleType(QualifiedName:java.security.interfaces.RSAPublicKey))(SimpleName:publicKey))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPrivateKey))(VariableDeclarationFragment(SimpleName:rsaPrivateKeySearchTemplate)(ClassInstanceCreation(SimpleType(SimpleName:RSAPrivateKey)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:modulus)(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:iaik.pkcs.pkcs11.Util))(SimpleName:unsignedBigIntergerToByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaPublicKey))(SimpleName:getModulus))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaPrivateKeySearchTemplate))(SimpleName:getModulus)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:modulus))))(ExpressionStatement(Assignment(SimpleName:searchTemplate)(ASSIGNMENT_OPERATOR:=)(SimpleName:rsaPrivateKeySearchTemplate)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:objectID)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:searchTemplate)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:findObjectsInit)(METHOD_INVOCATION_ARGUMENTS(SimpleName:searchTemplate))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Object))(Dimension))(VariableDeclarationFragment(SimpleName:foundKeyObjects)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:findObjects)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)))))(IfStatement(InfixExpression(QualifiedName:foundKeyObjects.length)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Key))(VariableDeclarationFragment(SimpleName:foundKey)(CastExpression(SimpleType(SimpleName:Key))(ArrayAccess(SimpleName:foundKeyObjects)(NumberLiteral:0)))))(ExpressionStatement(Assignment(SimpleName:objectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:foundKey))(SimpleName:getId)))(SimpleName:getByteArrayValue))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:findObjectsFinal)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:closeSession)))(ExpressionStatement(Assignment(SimpleName:session)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:basetoken))(SimpleName:openSession)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SessionType.SERIAL_SESSION)(QualifiedName:SessionReadWriteBehavior.RW_SESSION)(NullLiteral)(NullLiteral)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getSessionInfo)))(SimpleName:getState)))(SimpleName:toString)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:State.RW_USER_FUNCTIONS))(SimpleName:toString)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:login)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:UserType.USER)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:basicpin))(SimpleName:toCharArray)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:findObjectsInit)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:X509PublicKeyCertificate))))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Object))(Dimension))(VariableDeclarationFragment(SimpleName:objects)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:findObjects)(METHOD_INVOCATION_ARGUMENTS(SimpleName:MAXNUMOBJECTS)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:objects.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:X509PublicKeyCertificate))(VariableDeclarationFragment(SimpleName:tokencert)(CastExpression(SimpleType(SimpleName:X509PublicKeyCertificate))(ArrayAccess(SimpleName:objects)(SimpleName:i)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:label))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tokencert))(SimpleName:getLabel)))(SimpleName:getCharArrayValue)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ObjectAlreadyExistsException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:label)(StringLiteral:<STR>))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:findObjectsFinal)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:newObjectID)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:objectID)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(IfStatement(InstanceofExpression(SimpleName:publicKey)(SimpleType(QualifiedName:java.security.interfaces.RSAPublicKey)))(Block(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(QualifiedName:java.security.interfaces.RSAPublicKey))(SimpleName:publicKey))))(SimpleName:getModulus)))(SimpleName:toByteArray))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digest))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newObjectID))))))(Block(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertUtils))(SimpleName:getFingerprintAsString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cert))))(SimpleName:getBytes)))))))(Block(ExpressionStatement(Assignment(SimpleName:newObjectID)(ASSIGNMENT_OPERATOR:=)(SimpleName:objectID)))))(VariableDeclarationStatement(SimpleType(SimpleName:DERInteger))(VariableDeclarationFragment(SimpleName:dERInteger)(ClassInstanceCreation(SimpleType(SimpleName:DERInteger))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getSerialNumber)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:serialNumber)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dERInteger))(SimpleName:getDEREncoded))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:X509PublicKeyCertificate))(VariableDeclarationFragment(SimpleName:certObject)(ClassInstanceCreation(SimpleType(SimpleName:X509PublicKeyCertificate)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certObject))(SimpleName:getToken)))(SimpleName:setBooleanValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Boolean.TRUE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certObject))(SimpleName:getPrivate)))(SimpleName:setBooleanValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Boolean.FALSE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certObject))(SimpleName:getLabel)))(SimpleName:setCharArrayValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:label))(SimpleName:toCharArray)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certObject))(SimpleName:getId)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newObjectID))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certObject))(SimpleName:getSubject)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getSubjectDN)))(SimpleName:getName)))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certObject))(SimpleName:getIssuer)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getIssuerDN)))(SimpleName:getName)))(SimpleName:getBytes)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certObject))(SimpleName:getSerialNumber)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:serialNumber))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certObject))(SimpleName:getValue)))(SimpleName:setByteArrayValue)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getEncoded)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:createObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certObject)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CertificateEncodingException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TokenException))(StringLiteral:<STR>)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:PKCS11Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TokenException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:TokenException))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))(SimpleName:e)))))(Block(IfStatement(InfixExpression(SimpleName:session)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:closeSession)))))))(ExpressionStatement(MethodInvocation(SimpleName:clearCertificateCache)))))))