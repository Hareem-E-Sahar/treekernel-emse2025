(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:encode)(SingleVariableDeclaration(SimpleType(SimpleName:DatagramPacket))(SimpleName:packet))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Host))(VariableDeclarationFragment(SimpleName:h)(ClassInstanceCreation(SimpleType(SimpleName:Host))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getAddress))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getPort)))))(VariableDeclarationStatement(SimpleType(SimpleName:HostKey))(VariableDeclarationFragment(SimpleName:hostKey)(CastExpression(SimpleType(SimpleName:HostKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hostKeys))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:h))))))(IfStatement(InfixExpression(SimpleName:hostKey)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:hostKey)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:HostKey)))))(ExpressionStatement(Assignment(QualifiedName:hostKey.hasOwnPK)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:hostKeys))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:h)(SimpleName:hostKey))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getData))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:o)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getOffset))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:l)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getLength))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:rest)(InfixExpression(QualifiedName:data.length)(INFIX_EXPRESSION_OPERATOR:-)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getOffset))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getLength)))))(IfStatement(InfixExpression(SimpleName:rest)(INFIX_EXPRESSION_OPERATOR:>=)(QualifiedName:encryptedPublicKey.length))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptedPublicKey)(NumberLiteral:0)(SimpleName:data)(InfixExpression(SimpleName:o)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:l))(QualifiedName:encryptedPublicKey.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:setData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(SimpleName:o)(InfixExpression(SimpleName:l)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:encryptedPublicKey.length))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:BufferOutputStream))(VariableDeclarationFragment(SimpleName:out)(ClassInstanceCreation(SimpleType(SimpleName:BufferOutputStream))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getLength))(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:encryptedPublicKey.length)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(SimpleName:o)(SimpleName:l))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptedPublicKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:setData)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:getBuffer))(NumberLiteral:0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:getPosition))))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:SecretKey))(VariableDeclarationFragment(SimpleName:secretKey)(QualifiedName:hostKey.key)))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:cipher)(MethodInvocation(SimpleName:createCipher))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:secretKey))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encrypted)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getData))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getOffset))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getLength))))))(SynchronizedStatement(SimpleName:hostKey)(Block(IfStatement(QualifiedName:hostKey.hasOwnPK)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:setData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encrypted)))))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(QualifiedName:encrypted.length)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:encryptedPublicKey.length)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encrypted)(NumberLiteral:0)(SimpleName:buf)(NumberLiteral:0)(QualifiedName:encrypted.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptedPublicKey)(NumberLiteral:0)(SimpleName:buf)(QualifiedName:encrypted.length)(QualifiedName:encryptedPublicKey.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:setData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(NumberLiteral:0)(QualifiedName:buf.length))))(ExpressionStatement(Assignment(QualifiedName:hostKey.hasOwnPK)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))))))))))))