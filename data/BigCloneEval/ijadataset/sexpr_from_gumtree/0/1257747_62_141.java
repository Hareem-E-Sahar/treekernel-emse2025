(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:main)(SingleVariableDeclaration(ArrayType(SimpleType(SimpleName:String))(Dimension))(SimpleName:args))(Block(IfStatement(InfixExpression(QualifiedName:args.length)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:3))(Block(ExpressionStatement(MethodInvocation(SimpleName:printUsage)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Module))(VariableDeclarationFragment(SimpleName:pkcs11Module)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Module))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(NumberLiteral:0))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11Module))(SimpleName:initialize)(METHOD_INVOCATION_ARGUMENTS(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:Token))(VariableDeclarationFragment(SimpleName:token)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:selectToken)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pkcs11Module)(SimpleName:output_)(SimpleName:input_)))))(IfStatement(InfixExpression(SimpleName:token)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:supportedMechanisms)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:asList)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:getMechanismList))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:supportedMechanisms))(SimpleName:contains)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Mechanism.RSA_PKCS))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MechanismInfo))(VariableDeclarationFragment(SimpleName:rsaMechanismInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:token))(SimpleName:getMechanismInfo)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Mechanism.RSA_PKCS)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rsaMechanismInfo))(SimpleName:isSign)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))))(VariableDeclarationStatement(SimpleType(SimpleName:Session))(VariableDeclarationFragment(SimpleName:session)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:openAuthorizedSession)(METHOD_INVOCATION_ARGUMENTS(SimpleName:token)(QualifiedName:Token.SessionReadWriteBehavior.RO_SESSION)(SimpleName:output_)(SimpleName:input_)))))(VariableDeclarationStatement(SimpleType(SimpleName:RSAPrivateKey))(VariableDeclarationFragment(SimpleName:privateSignatureKeyTemplate)(ClassInstanceCreation(SimpleType(SimpleName:RSAPrivateKey)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateSignatureKeyTemplate))(SimpleName:getSign)))(SimpleName:setBooleanValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Boolean.TRUE))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyAndCertificate))(VariableDeclarationFragment(SimpleName:selectedSignatureKeyAndCertificate)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:selectKeyAndCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:session)(SimpleName:privateSignatureKeyTemplate)(SimpleName:output_)(SimpleName:input_)))))(IfStatement(InfixExpression(SimpleName:selectedSignatureKeyAndCertificate)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:exit)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:selectedSignatureKey)(CastExpression(SimpleType(SimpleName:PrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:selectedSignatureKeyAndCertificate))(SimpleName:getKey)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509PublicKeyCertificate))(VariableDeclarationFragment(SimpleName:pkcs11SignerCertificate)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:selectedSignatureKeyAndCertificate))(SimpleName:getCertificate))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:signerCertificate)(ConditionalExpression(ParenthesizedExpression(InfixExpression(SimpleName:pkcs11SignerCertificate)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(ClassInstanceCreation(SimpleType(SimpleName:X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11SignerCertificate))(SimpleName:getValue)))(SimpleName:getByteArrayValue)))(NullLiteral))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ArrayAccess(SimpleName:args)(NumberLiteral:1))))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:dataInputStream)(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(ArrayAccess(SimpleName:args)(NumberLiteral:1)))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:digestEngine)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:contentBuffer)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:dataBuffer)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:1024))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:helpBuffer)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bytesRead)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:bytesRead)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dataInputStream))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataBuffer)))))(INFIX_EXPRESSION_OPERATOR:>=)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestEngine))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataBuffer)(NumberLiteral:0)(SimpleName:bytesRead))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentBuffer))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dataBuffer)(NumberLiteral:0)(SimpleName:bytesRead))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:contentHash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestEngine))(SimpleName:digest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentBuffer))(SimpleName:close)))(VariableDeclarationStatement(SimpleType(SimpleName:SignedData))(VariableDeclarationFragment(SimpleName:signedData)(ClassInstanceCreation(SimpleType(SimpleName:SignedData))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:contentBuffer))(SimpleName:toByteArray))(QualifiedName:SignedData.IMPLICIT))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedData))(SimpleName:setCertificates)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:X509Certificate))(Dimension))(ArrayInitializer(SimpleName:signerCertificate))))))(VariableDeclarationStatement(SimpleType(SimpleName:SignerInfo))(VariableDeclarationFragment(SimpleName:signerInfo)(ClassInstanceCreation(SimpleType(SimpleName:SignerInfo))(ClassInstanceCreation(SimpleType(SimpleName:IssuerAndSerialNumber))(SimpleName:signerCertificate))(QualifiedName:AlgorithmID.sha1)(NullLiteral))))(VariableDeclarationStatement(ArrayType(SimpleType(QualifiedName:iaik.asn1.structures.Attribute))(Dimension))(VariableDeclarationFragment(SimpleName:authenticatedAttributes)(ArrayInitializer(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:ObjectID.contentType)(ArrayCreation(ArrayType(SimpleType(SimpleName:ASN1Object))(Dimension))(ArrayInitializer(QualifiedName:ObjectID.pkcs7_data))))(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:ObjectID.signingTime)(ArrayCreation(ArrayType(SimpleType(SimpleName:ASN1Object))(Dimension))(ArrayInitializer(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(SimpleName:ChoiceOfTime))))(SimpleName:toASN1Object)))))(ClassInstanceCreation(SimpleType(SimpleName:Attribute))(QualifiedName:ObjectID.messageDigest)(ArrayCreation(ArrayType(SimpleType(SimpleName:ASN1Object))(Dimension))(ArrayInitializer(ClassInstanceCreation(SimpleType(SimpleName:OCTET_STRING))(SimpleName:contentHash))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerInfo))(SimpleName:setAuthenticatedAttributes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:authenticatedAttributes))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:toBeSigned)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DerCoder))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ASN))(SimpleName:createSetOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:authenticatedAttributes)(BooleanLiteral:true)))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hashToBeSigned)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestEngine))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:toBeSigned)))))(VariableDeclarationStatement(SimpleType(SimpleName:DigestInfo))(VariableDeclarationFragment(SimpleName:digestInfoEngine)(ClassInstanceCreation(SimpleType(SimpleName:DigestInfo))(QualifiedName:AlgorithmID.sha1)(SimpleName:hashToBeSigned))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:toBeEncrypted)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestInfoEngine))(SimpleName:toByteArray))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:signInit)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Mechanism.RSA_PKCS)(SimpleName:selectedSignatureKey))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:signatureValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:sign)(METHOD_INVOCATION_ARGUMENTS(SimpleName:toBeEncrypted)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerInfo))(SimpleName:setEncryptedDigest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureValue))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedData))(SimpleName:addSignerInfo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signerInfo))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ArrayAccess(SimpleName:args)(NumberLiteral:2))))))(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:signatureOutput)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(ArrayAccess(SimpleName:args)(NumberLiteral:2)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedData))(SimpleName:writeTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureOutput))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureOutput))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureOutput))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:closeSession)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs11Module))(SimpleName:finalize)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:thr))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:thr))(SimpleName:printStackTrace)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:output_))(SimpleName:close)))))))))