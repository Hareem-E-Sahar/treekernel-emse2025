(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:processMessage)(SingleVariableDeclaration(SimpleType(SimpleName:Message))(SimpleName:m))(SingleVariableDeclaration(SimpleType(SimpleName:Session))(SimpleName:session))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ChannelManager))(VariableDeclarationFragment(SimpleName:channelManager)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getServerFacilities)))(SimpleName:getChannelManager))))(SwitchStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getType))(SwitchCase(QualifiedName:MessageTypes.CLIENT_CHANNEL_JOIN))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channelName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getDataString)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:nickName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getUserState)))(SimpleName:getUser)))(SimpleName:getNickname))))(VariableDeclarationStatement(SimpleType(SimpleName:StringBuffer))(VariableDeclarationFragment(SimpleName:topicMsg)(ClassInstanceCreation(SimpleType(SimpleName:StringBuffer))(NumberLiteral:64))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:channelExists)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:getChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName)))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:OutboundMessageQueue))(VariableDeclarationFragment(SimpleName:queue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getOutboundMessageQueue))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:isAtCapacity)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName)))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:queue))(SimpleName:queueMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:atCapacityError)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidatedQueueException))(SimpleName:iqe))(Block))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelName))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:queue))(SimpleName:queueMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelNameError)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidatedQueueException))(SimpleName:iqe))(Block))))(IfStatement(InfixExpression(SimpleName:channelExists)(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(SimpleName:meetsLevelRequirement)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:getChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName))))(SimpleName:getLevel))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getUserState)))(SimpleName:getUser)))(SimpleName:getLevel))))))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:queue))(SimpleName:queueMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:permissionError)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidatedQueueException))(SimpleName:iqe))(Block))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:addUserToChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName)(SimpleName:nickName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:notifyChannelOfUserAction)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ChannelManager.ACTION_JOIN)(SimpleName:channelName)(SimpleName:nickName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:topicMsg))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:topicMsg))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:topicMsg))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:getChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName))))(SimpleName:getTopic)))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:queue))(SimpleName:queueMessage)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Message))(QualifiedName:MessageTypes.SERVER_CHANNEL_JOIN_ACK)(SimpleName:channelName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:queue))(SimpleName:queueMessage)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Message))(QualifiedName:MessageTypes.CHANNEL_TOPIC)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:topicMsg))(SimpleName:toString)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidatedQueueException))(SimpleName:iqe))(Block)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:sendChannelList)(METHOD_INVOCATION_ARGUMENTS(SimpleName:session)(SimpleName:channelName)(QualifiedName:ChannelManager.NON_USER_INITIATED))))))))(BreakStatement))(SwitchCase(QualifiedName:MessageTypes.CLIENT_CHANNEL_LEAVE))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channelName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getDataString)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:nickName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getUserState)))(SimpleName:getUser)))(SimpleName:getNickname))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:removeUserFromChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName)(SimpleName:nickName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:notifyChannelOfUserAction)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ChannelManager.ACTION_LEAVE)(SimpleName:channelName)(SimpleName:nickName))))(BreakStatement))(SwitchCase(QualifiedName:MessageTypes.CLIENT_CHANNEL_PUBLIC_MESSAGE))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channelName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getDataString)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:textToSend)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getDataString))))(ExpressionStatement(Assignment(SimpleName:textToSend)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:textToSend))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:textToSend))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:textToSend))(SimpleName:length))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:sendMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getUserState)))(SimpleName:getUser)))(SimpleName:getNickname))(SimpleName:textToSend))))(BreakStatement))(SwitchCase(QualifiedName:MessageTypes.LIST_CHANNELS))(Block(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Channel))(Dimension))(VariableDeclarationFragment(SimpleName:channels)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:getChannels))))(VariableDeclarationStatement(SimpleType(SimpleName:OutboundMessageQueue))(VariableDeclarationFragment(SimpleName:queue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getOutboundMessageQueue))))(IfStatement(InfixExpression(SimpleName:channels)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:x)(NumberLiteral:0)))(InfixExpression(SimpleName:x)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:channels.length))(PostfixExpression(SimpleName:x)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:StringBuffer))(VariableDeclarationFragment(SimpleName:buf)(ClassInstanceCreation(SimpleType(SimpleName:StringBuffer))(NumberLiteral:128))))(VariableDeclarationStatement(SimpleType(SimpleName:Channel))(VariableDeclarationFragment(SimpleName:c)(ArrayAccess(SimpleName:channels)(SimpleName:x))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:getName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:numMembers)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:c))(SimpleName:getTopic)))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:queue))(SimpleName:queueMessage)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Message))(QualifiedName:MessageTypes.LIST_CHANNELS_ENTRY)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:toString)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidatedQueueException))(SimpleName:iqe))(Block)))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:queue))(SimpleName:queueMessage)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Message))(QualifiedName:MessageTypes.LIST_CHANNELS)(StringLiteral:<STR>))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidatedQueueException))(SimpleName:iqe))(Block)))(BreakStatement))(SwitchCase(QualifiedName:MessageTypes.CHANNEL_EMOTE))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channelName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getDataString)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:emoteText)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getDataString)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:user)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:getUserState)))(SimpleName:getUser)))(SimpleName:getNickname))))(VariableDeclarationStatement(SimpleType(SimpleName:StringBuffer))(VariableDeclarationFragment(SimpleName:buf)(ClassInstanceCreation(SimpleType(SimpleName:StringBuffer))(NumberLiteral:128))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:emoteText))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:sendMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName)(ClassInstanceCreation(SimpleType(SimpleName:Message))(QualifiedName:MessageTypes.CHANNEL_EMOTE)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buf))(SimpleName:toString))))))(BreakStatement))(SwitchCase(QualifiedName:MessageTypes.CHANNEL_TOPIC))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channelName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getDataString)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))(VariableDeclarationStatement(SimpleType(SimpleName:StringBuffer))(VariableDeclarationFragment(SimpleName:topic)(ClassInstanceCreation(SimpleType(SimpleName:StringBuffer))(NumberLiteral:128))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:wholeStr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getDataString))))(VariableDeclarationStatement(SimpleType(SimpleName:StringBuffer))(VariableDeclarationFragment(SimpleName:topicMsgToSend)(ClassInstanceCreation(SimpleType(SimpleName:StringBuffer))(NumberLiteral:128))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:topicMsgToSend))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:topicMsgToSend))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:topicMsgToSend))(SimpleName:append)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wholeStr))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wholeStr))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(CharacterLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wholeStr))(SimpleName:length)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:sendMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channelName)(ClassInstanceCreation(SimpleType(SimpleName:Message))(QualifiedName:MessageTypes.CHANNEL_TOPIC)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:topicMsgToSend))(SimpleName:toString))))))(BreakStatement))(SwitchCase(QualifiedName:MessageTypes.CLIENT_CHANNEL_USER_LIST))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channelName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:m))(SimpleName:getDataString)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelManager))(SimpleName:sendChannelList)(METHOD_INVOCATION_ARGUMENTS(SimpleName:session)(SimpleName:channelName)(QualifiedName:ChannelManager.USER_INITIATED))))(BreakStatement)))))))