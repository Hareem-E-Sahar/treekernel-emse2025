(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:final)(PrimitiveType:void)(SimpleName:setReadObserver)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:ChannelReadObserver))(SimpleName:newReader))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NIODispatcher))(SimpleName:instance)))(SimpleName:getScheduledExecutorService)))(SimpleName:execute)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Runnable))(AnonymousClassDeclaration(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:run)(Block(VariableDeclarationStatement(SimpleType(SimpleName:ReadObserver))(VariableDeclarationFragment(SimpleName:oldReader)(SimpleName:reader)))(TryStatement(Block(SynchronizedStatement(SimpleName:LOCK)(Block(IfStatement(SimpleName:shutdown)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newReader))(SimpleName:shutdown)))(ReturnStatement)))(ExpressionStatement(Assignment(SimpleName:reader)(ASSIGNMENT_OPERATOR:=)(SimpleName:newReader)))))(VariableDeclarationStatement(SimpleType(SimpleName:ChannelReader))(VariableDeclarationFragment(SimpleName:lastChannel)(SimpleName:newReader)))(WhileStatement(InstanceofExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastChannel))(SimpleName:getReadChannel))(SimpleType(SimpleName:ChannelReader)))(ExpressionStatement(Assignment(SimpleName:lastChannel)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:ChannelReader))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastChannel))(SimpleName:getReadChannel))))))(IfStatement(InstanceofExpression(SimpleName:lastChannel)(SimpleType(SimpleName:RequiresSelectionKeyAttachment)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:RequiresSelectionKeyAttachment))(SimpleName:lastChannel))))(SimpleName:setAttachment)(METHOD_INVOCATION_ARGUMENTS(ThisExpression(SimpleName:AbstractNBSocket))))))(IfStatement(InfixExpression(InstanceofExpression(SimpleName:oldReader)(SimpleType(SimpleName:InterestReadableByteChannel)))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:oldReader)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:newReader)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastChannel))(SimpleName:setReadChannel)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:InterestReadableByteChannel))(SimpleName:oldReader)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:handleRead)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oldReader))(SimpleName:shutdown)))))(VariableDeclarationStatement(SimpleType(SimpleName:InterestReadableByteChannel))(VariableDeclarationFragment(SimpleName:source)(MethodInvocation(SimpleName:getBaseReadChannel))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lastChannel))(SimpleName:setReadChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:source))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:source))(SimpleName:interestRead)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(IfStatement(InfixExpression(MethodInvocation(SimpleName:isConnected))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NIODispatcher))(SimpleName:instance)))(SimpleName:isReadReadyThisIteration)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getChannel))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:handleRead)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:iox))(Block(ExpressionStatement(MethodInvocation(SimpleName:shutdown)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oldReader))(SimpleName:shutdown)))))))))))))))))