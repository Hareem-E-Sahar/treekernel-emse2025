(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:protected)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:decrypt)(SingleVariableDeclaration(PrimitiveType:byte)(SimpleName:type))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:fragment))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:offset))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:len))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:decCipher))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fragment)(SimpleName:offset)(SimpleName:len)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:content)))(IfStatement(SimpleName:is_block_cipher)(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:padding_length)(ArrayAccess(SimpleName:data)(InfixExpression(QualifiedName:data.length)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:padding_length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(ArrayAccess(SimpleName:data)(InfixExpression(QualifiedName:data.length)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:2)(SimpleName:i)))(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:padding_length))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:AlertException))(QualifiedName:AlertProtocol.DECRYPTION_FAILED)(ClassInstanceCreation(SimpleType(SimpleName:SSLProtocolException))(StringLiteral:<STR>))))))))(ExpressionStatement(Assignment(SimpleName:content)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(QualifiedName:data.length)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:hash_size)(SimpleName:padding_length)(NumberLiteral:1))))))))(Block(ExpressionStatement(Assignment(SimpleName:content)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(QualifiedName:data.length)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:hash_size)))))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:mac_value)))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:mac_material_part)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(SimpleName:type)))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:mac_material_part)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:0x00FF00)(INFIX_EXPRESSION_OPERATOR:&)(QualifiedName:content.length)))(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:mac_material_part)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(NumberLiteral:0x0000FF)(INFIX_EXPRESSION_OPERATOR:&)(QualifiedName:content.length))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_read_secret))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pad_1))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:read_seq_num))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_material_part))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(QualifiedName:content.length))))(ExpressionStatement(Assignment(SimpleName:mac_value)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_read_secret))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pad_2))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_value))))(ExpressionStatement(Assignment(SimpleName:mac_value)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(IfStatement(InfixExpression(SimpleName:logger)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_value))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:hash_size))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(InfixExpression(ArrayAccess(SimpleName:mac_value)(SimpleName:i))(INFIX_EXPRESSION_OPERATOR:!=)(ArrayAccess(SimpleName:data)(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:content.length))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:AlertException))(QualifiedName:AlertProtocol.BAD_RECORD_MAC)(ClassInstanceCreation(SimpleType(SimpleName:SSLProtocolException))(StringLiteral:<STR>))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(NumberLiteral:0)(SimpleName:content)(NumberLiteral:0)(QualifiedName:content.length))))(ExpressionStatement(MethodInvocation(SimpleName:incSequenceNumber)(METHOD_INVOCATION_ARGUMENTS(SimpleName:read_seq_num))))(ReturnStatement(SimpleName:content))))))