(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:runExcelGenerate)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:outputType))(SingleVariableDeclaration(SimpleType(SimpleName:XThread))(SimpleName:userThread))(SingleVariableDeclaration(SimpleType(SimpleName:ContextUElem))(SimpleName:pContextUElem))(SingleVariableDeclaration(SimpleType(SimpleName:ContextUCon))(SimpleName:pContextUCon))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:fileExtension)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outputType))(SimpleName:toLowerCase)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:contentType)(ParenthesizedExpression(ConditionalExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:outputType)))(StringLiteral:<STR>)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:popupWindowName)(MethodInvocation(SimpleName:getUniqueWindowName))))(VariableDeclarationStatement(SimpleType(SimpleName:UCon))(VariableDeclarationFragment(SimpleName:lUCon)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:BLOB))(VariableDeclarationFragment(SimpleName:lBlob)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:CLOB))(VariableDeclarationFragment(SimpleName:lClob)(NullLiteral)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:lUCon)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUCon))(SimpleName:getUCon))))(VariableDeclarationStatement(SimpleType(SimpleName:Writer))(VariableDeclarationFragment(SimpleName:writer)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:blobOS)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lFileName)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XFUtil))(SimpleName:unique))(SimpleName:fileExtension))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XFUtil))(SimpleName:isNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mFileName))))(Block(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:lFileName)(ASSIGNMENT_OPERATOR:=)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedStringOrXPathString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:attachDOM))(SimpleName:mFileName)))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:fileExtension)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:ExActionFailed))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExInternal))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:mFileName))(SimpleName:e))))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lTempResourceId)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userThread))(SimpleName:createTempWorkDocId))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:outputType)))(Block(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:lClob)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lUCon))(SimpleName:getTemporaryClob))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:writer)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lClob))(SimpleName:getCharacterOutputStream)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:SQLException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExInternal))(StringLiteral:<STR>)(SimpleName:e))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:s)(NumberLiteral:0)))(InfixExpression(SimpleName:s)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:sheets.length))(PostfixExpression(SimpleName:s)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:visibleColumns)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:boolean)(Dimension(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length)))))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:lShowHeaders)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XFUtil))(SimpleName:isNull)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getShowHeadersExpr))))(Block(ExpressionStatement(Assignment(SimpleName:lShowHeaders)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))(Block(ExpressionStatement(Assignment(SimpleName:lShowHeaders)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedXPathBoolean)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:attachDOM))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getShowHeadersExpr))))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:c)(NumberLiteral:0)))(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length)))(PostfixExpression(SimpleName:c)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:Sheet.Column))(VariableDeclarationFragment(SimpleName:column)(ArrayAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:c))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:visibleColumns)(SimpleName:c))(ASSIGNMENT_OPERATOR:=)(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:column))(SimpleName:getVisibleExpression))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedXPathBoolean)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:attachDOM))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:column))(SimpleName:getVisibleExpression)))))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:c)(NumberLiteral:0)))(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length)))(PostfixExpression(SimpleName:c)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:Sheet.Column))(VariableDeclarationFragment(SimpleName:column)(ArrayAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:c))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cellValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedStringOrXPathString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:attachDOM))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:column))(SimpleName:getNameExpr))))))(IfStatement(InfixExpression(SimpleName:lShowHeaders)(INFIX_EXPRESSION_OPERATOR:&&)(ArrayAccess(SimpleName:visibleColumns)(SimpleName:c)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:escapeCSVFieldValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cellValue))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(InfixExpression(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:&&)(ArrayAccess(SimpleName:visibleColumns)(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))))(IfStatement(SimpleName:lShowHeaders)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))))))(VariableDeclarationStatement(SimpleType(SimpleName:DOMList))(VariableDeclarationFragment(SimpleName:rowElems)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedXPathUL)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getRowExpression))(QualifiedName:ContextUElem.ATTACH)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:r)(NumberLiteral:0)))(InfixExpression(SimpleName:r)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rowElems))(SimpleName:getLength)))(PostfixExpression(SimpleName:r)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DOM))(VariableDeclarationFragment(SimpleName:rowElem)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rowElems))(SimpleName:item)(METHOD_INVOCATION_ARGUMENTS(SimpleName:r)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:c)(NumberLiteral:0)))(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length)))(PostfixExpression(SimpleName:c)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ArrayAccess(SimpleName:visibleColumns)(SimpleName:c)))(ContinueStatement))(VariableDeclarationStatement(SimpleType(QualifiedName:Sheet.Column))(VariableDeclarationFragment(SimpleName:column)(ArrayAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:c))))(VariableDeclarationStatement(SimpleType(SimpleName:XPathResult))(VariableDeclarationFragment(SimpleName:cellValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedXPathResult)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rowElem)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:column))(SimpleName:getColumnExpression))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getOrConvertCSVCellValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userThread)(SimpleName:pContextUElem)(SimpleName:pContextUCon)(SimpleName:cellValue)(SimpleName:column))))))(IfStatement(InfixExpression(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(InfixExpression(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:&&)(ArrayAccess(SimpleName:visibleColumns)(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtil))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:writer)))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:outputType)))(Block(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:lBlob)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lUCon))(SimpleName:getTemporaryBlob))))(ExpressionStatement(Assignment(SimpleName:blobOS)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lBlob))(SimpleName:getBinaryOutputStream))))(VariableDeclarationStatement(SimpleType(SimpleName:HSSFWorkbook))(VariableDeclarationFragment(SimpleName:wb)(ClassInstanceCreation(SimpleType(SimpleName:HSSFWorkbook)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:s)(NumberLiteral:0)))(InfixExpression(SimpleName:s)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:sheets.length))(PostfixExpression(SimpleName:s)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:HSSFSheet))(VariableDeclarationFragment(SimpleName:sheet)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wb))(SimpleName:createSheet)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedStringOrXPathString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:attachDOM))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getName))))))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:visibleColumns)(Dimension)(ArrayCreation(ArrayType(PrimitiveType:boolean)(Dimension(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length)))))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:lShowHeaders)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XFUtil))(SimpleName:isNull)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getShowHeadersExpr))))(Block(ExpressionStatement(Assignment(SimpleName:lShowHeaders)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false))))(Block(ExpressionStatement(Assignment(SimpleName:lShowHeaders)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedXPathBoolean)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:attachDOM))(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getShowHeadersExpr))))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:c)(NumberLiteral:0)))(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length)))(PostfixExpression(SimpleName:c)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:Sheet.Column))(VariableDeclarationFragment(SimpleName:column)(ArrayAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:c))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:visibleColumns)(SimpleName:c))(ASSIGNMENT_OPERATOR:=)(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:column))(SimpleName:getVisibleExpression))(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedXPathBoolean)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:attachDOM))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:column))(SimpleName:getVisibleExpression)))))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:rowOffset)(NumberLiteral:0)))(VariableDeclarationStatement(SimpleType(SimpleName:HSSFRow))(VariableDeclarationFragment(SimpleName:headerRow)(NullLiteral)))(IfStatement(SimpleName:lShowHeaders)(Block(ExpressionStatement(Assignment(SimpleName:headerRow)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sheet))(SimpleName:createRow)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))(ExpressionStatement(PostfixExpression(SimpleName:rowOffset)(POSTFIX_EXPRESSION_OPERATOR:++)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:c)(NumberLiteral:0))(VariableDeclarationFragment(SimpleName:visCols)(NumberLiteral:0)))(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length)))(PostfixExpression(SimpleName:c)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:Sheet.Column))(VariableDeclarationFragment(SimpleName:column)(ArrayAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:c))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cellValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedStringOrXPathString)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:attachDOM))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:column))(SimpleName:getNameExpr))))))(IfStatement(InfixExpression(SimpleName:lShowHeaders)(INFIX_EXPRESSION_OPERATOR:&&)(ArrayAccess(SimpleName:visibleColumns)(SimpleName:c)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:HSSFCell))(VariableDeclarationFragment(SimpleName:cell)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:headerRow))(SimpleName:createCell)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:short)(SimpleName:visCols))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cell))(SimpleName:setCellValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cellValue))))))(ExpressionStatement(PostfixExpression(SimpleName:visCols)(POSTFIX_EXPRESSION_OPERATOR:++)))))(VariableDeclarationStatement(SimpleType(SimpleName:DOMList))(VariableDeclarationFragment(SimpleName:rowElems)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedXPathUL)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getRowExpression))(QualifiedName:ContextUElem.ATTACH)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:r)(NumberLiteral:0)))(InfixExpression(SimpleName:r)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rowElems))(SimpleName:getLength)))(PostfixExpression(SimpleName:r)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DOM))(VariableDeclarationFragment(SimpleName:rowElem)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rowElems))(SimpleName:item)(METHOD_INVOCATION_ARGUMENTS(SimpleName:r)))))(VariableDeclarationStatement(SimpleType(SimpleName:HSSFRow))(VariableDeclarationFragment(SimpleName:row)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sheet))(SimpleName:createRow)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:r)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:rowOffset))))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:c)(NumberLiteral:0))(VariableDeclarationFragment(SimpleName:visCols)(NumberLiteral:0)))(InfixExpression(SimpleName:c)(INFIX_EXPRESSION_OPERATOR:<)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:length)))(PostfixExpression(SimpleName:c)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(QualifiedName:Sheet.Column))(VariableDeclarationFragment(SimpleName:column)(ArrayAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:sheets)(SimpleName:s)))(SimpleName:getColumns))(SimpleName:c))))(VariableDeclarationStatement(SimpleType(SimpleName:XPathResult))(VariableDeclarationFragment(SimpleName:cellValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pContextUElem))(SimpleName:extendedXPathResult)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rowElem)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:column))(SimpleName:getColumnExpression))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ArrayAccess(SimpleName:visibleColumns)(SimpleName:c)))(ContinueStatement))(VariableDeclarationStatement(SimpleType(SimpleName:HSSFCell))(VariableDeclarationFragment(SimpleName:cell)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:row))(SimpleName:createCell)(METHOD_INVOCATION_ARGUMENTS(CastExpression(PrimitiveType:short)(SimpleName:visCols))))))(ExpressionStatement(MethodInvocation(SimpleName:setXLSCellValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userThread)(SimpleName:pContextUElem)(SimpleName:pContextUCon)(SimpleName:wb)(SimpleName:cell)(SimpleName:cellValue)(SimpleName:column))))(ExpressionStatement(PostfixExpression(SimpleName:visCols)(POSTFIX_EXPRESSION_OPERATOR:++)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:wb))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:blobOS)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtil))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:blobOS)))))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mMethod))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mMethod))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(IfStatement(InfixExpression(SimpleName:lBlob)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userThread))(SimpleName:getTopApp)))(SimpleName:createTemporaryResource)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lTempResourceId)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:lBlob)(SimpleName:contentType)(SimpleName:lUCon)))))(IfStatement(InfixExpression(SimpleName:lClob)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userThread))(SimpleName:getTopApp)))(SimpleName:createTemporaryResource)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lTempResourceId)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:lClob)(SimpleName:contentType)(SimpleName:lUCon)))))))(VariableDeclarationStatement(SimpleType(SimpleName:StreamParcel))(VariableDeclarationFragment(SimpleName:lStreamParcel)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:lStreamParcel)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:StreamParcel))(QualifiedName:StreamParcel.TYPE_STANDARD)(SimpleName:lFileName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userThread))(SimpleName:getTopApp))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userThread))(SimpleName:getFoxRequest)))(SimpleName:getCookieValue)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:ExServiceUnavailable))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExInternal))(StringLiteral:<STR>)(SimpleName:e))))))(VariableDeclarationStatement(SimpleType(SimpleName:StreamParcelInput))(VariableDeclarationFragment(SimpleName:lStreamParcelInput)(ClassInstanceCreation(SimpleType(SimpleName:StreamParcelInputTempResource))(SimpleName:lFileName)(NullLiteral)(SimpleName:contentType)(SimpleName:lTempResourceId))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lStreamParcel))(SimpleName:addStreamParcelInput)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lStreamParcelInput)(SimpleName:userThread))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userThread))(SimpleName:addURIFilePopup)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lStreamParcel))(SimpleName:getStreamURL)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userThread))(SimpleName:getFoxRequest))))(SimpleName:lFileName)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mMethod))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:FileStorageLocation))(VariableDeclarationFragment(SimpleName:sl)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userThread))(SimpleName:getTopModule)))(SimpleName:getFileStorageLocation)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mStoreLocationName)))))(IfStatement(InfixExpression(SimpleName:sl)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExInternal))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:mStoreLocationName)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userThread))(SimpleName:getTopModule)))(SimpleName:getName))(StringLiteral:<STR>)(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:WorkingFileStoreLocation))(VariableDeclarationFragment(SimpleName:workingSL)(ClassInstanceCreation(SimpleType(SimpleName:WorkingFileStoreLocation))(SimpleName:sl)(SimpleName:pContextUElem))))(IfStatement(InfixExpression(SimpleName:lBlob)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:workingSL))(SimpleName:updateLOB)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lBlob)(SimpleName:pContextUCon)(ClassInstanceCreation(SimpleType(SimpleName:FileUploadInfo)))))))(IfStatement(InfixExpression(SimpleName:lClob)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:workingSL))(SimpleName:updateLOB)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lClob)(SimpleName:pContextUCon)(ClassInstanceCreation(SimpleType(SimpleName:FileUploadInfo)))))))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ioEx))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:ExInternal))(StringLiteral:<STR>)(SimpleName:ioEx)))))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lBlob))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:ignore))(Block)))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lClob))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:ignore))(Block)))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lUCon))(SimpleName:freeTemporaryBlob)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lBlob)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:ignore))(Block)))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lUCon))(SimpleName:freeTemporaryClob)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lClob)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:ignore))(Block)))))))))