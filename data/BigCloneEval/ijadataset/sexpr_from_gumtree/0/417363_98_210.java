(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(PrimitiveType:void)(SimpleName:incomingMessage)(SingleVariableDeclaration(SimpleType(SimpleName:NetEvent))(SimpleName:event))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Socket))(VariableDeclarationFragment(SimpleName:socket)(CastExpression(SimpleType(SimpleName:Socket))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:event))(SimpleName:getSource)))))(VariableDeclarationStatement(SimpleType(SimpleName:DefaultData))(VariableDeclarationFragment(SimpleName:defaultData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:event))(SimpleName:getData))))(VariableDeclarationStatement(SimpleType(SimpleName:User))(VariableDeclarationFragment(SimpleName:user)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userDatabase))(SimpleName:getSocketOfUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socket)))))(IfStatement(InstanceofExpression(SimpleName:defaultData)(SimpleType(SimpleName:UserData)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:UserData))(VariableDeclarationFragment(SimpleName:userData)(CastExpression(SimpleType(SimpleName:UserData))(SimpleName:defaultData))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:oldUserName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:getName))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:rename)(ParenthesizedExpression(InfixExpression(SimpleName:oldUserName)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:success)(BooleanLiteral:false)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:rename))(Block(ExpressionStatement(Assignment(SimpleName:success)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userDatabase))(SimpleName:addUser)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userData))(SimpleName:getName))(SimpleName:socket))))))(Block(ExpressionStatement(Assignment(SimpleName:success)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userDatabase))(SimpleName:renameUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userData))(SimpleName:getName))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Level.INFO)(StringLiteral:<STR>)(ArrayCreation(ArrayType(SimpleType(SimpleName:Object))(Dimension))(ArrayInitializer(SimpleName:oldUserName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userData))(SimpleName:getName))(ConditionalExpression(SimpleName:success)(StringLiteral:<STR>)(StringLiteral:<STR>)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:ServerMessage))(VariableDeclarationFragment(SimpleName:serverMessage)(ClassInstanceCreation(SimpleType(SimpleName:ServerMessage)))))(IfStatement(SimpleName:success)(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:rename))(Block(VariableDeclarationStatement(SimpleType(SimpleName:UserConnection))(VariableDeclarationFragment(SimpleName:userConnection)(ClassInstanceCreation(SimpleType(SimpleName:UserConnection)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userConnection))(SimpleName:setUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userConnection))(SimpleName:setConnected)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Socket)))(VariableDeclarationFragment(SimpleName:userSocketList)(CastExpression(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Socket)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userDatabase))(SimpleName:getSocketList)))))(ExpressionStatement(MethodInvocation(SimpleName:sendToAllSockets)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userSocketList)(SimpleName:userConnection)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:renameUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:oldUserName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userData))(SimpleName:getName)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:serverMessage))(SimpleName:setMessageEnum)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ServerMessageEnum.USERNAME_SET))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:serverMessage))(SimpleName:setAdditionalMessage)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userData))(SimpleName:getName))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:serverMessage))(SimpleName:setMessageEnum)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ServerMessageEnum.ERROR_USERNAME_IN_USE))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:serverMessage))(SimpleName:setAdditionalMessage)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userData))(SimpleName:getName)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tcpSocket))(SimpleName:writeData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socket)(SimpleName:serverMessage)))))(IfStatement(InstanceofExpression(SimpleName:defaultData)(SimpleType(SimpleName:Ping)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Pong))(VariableDeclarationFragment(SimpleName:pong)(ClassInstanceCreation(SimpleType(SimpleName:Pong)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pong))(SimpleName:setTimestamp)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Ping))(SimpleName:defaultData))))(SimpleName:getTimestamp)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tcpSocket))(SimpleName:writeData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socket)(SimpleName:pong)))))(IfStatement(InstanceofExpression(SimpleName:defaultData)(SimpleType(SimpleName:ChatMessage)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ChatMessage))(VariableDeclarationFragment(SimpleName:chatMessage)(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:ChatMessage))(SimpleName:defaultData)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chatMessage))(SimpleName:setFromUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chatMessage))(SimpleName:isChannel))(Block(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Socket)))(VariableDeclarationFragment(SimpleName:userSocketList)(CastExpression(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Socket)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:getSocketsOfUsersInChannel)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chatMessage))(SimpleName:getTo))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chatMessage))(SimpleName:getFromUser)))))))(IfStatement(InfixExpression(SimpleName:userSocketList)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Socket))(SimpleName:userSocket))(SimpleName:userSocketList)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tcpSocket))(SimpleName:writeData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userSocket)(SimpleName:chatMessage)))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ServerMessage))(VariableDeclarationFragment(SimpleName:serverMessage)(ClassInstanceCreation(SimpleType(SimpleName:ServerMessage)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:serverMessage))(SimpleName:setMessageEnum)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ServerMessageEnum.ERROR_CHANNEL_NON_EXISTENT))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:serverMessage))(SimpleName:setAdditionalMessage)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chatMessage))(SimpleName:getTo)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tcpSocket))(SimpleName:writeData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socket)(SimpleName:serverMessage)))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Socket))(VariableDeclarationFragment(SimpleName:toUserSocket)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userDatabase))(SimpleName:getUserOfSocket)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chatMessage))(SimpleName:getTo))))))(IfStatement(InfixExpression(SimpleName:toUserSocket)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tcpSocket))(SimpleName:writeData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:toUserSocket)(SimpleName:chatMessage)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ServerMessage))(VariableDeclarationFragment(SimpleName:serverMessage)(ClassInstanceCreation(SimpleType(SimpleName:ServerMessage)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:serverMessage))(SimpleName:setMessageEnum)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:ServerMessageEnum.ERROR_USER_NON_EXISTENT))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:serverMessage))(SimpleName:setAdditionalMessage)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chatMessage))(SimpleName:getTo)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tcpSocket))(SimpleName:writeData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socket)(SimpleName:serverMessage)))))))))(IfStatement(InstanceofExpression(SimpleName:defaultData)(SimpleType(SimpleName:UserList)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:UserList))(VariableDeclarationFragment(SimpleName:userList)(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:UserList))(SimpleName:defaultData)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:channel)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userList))(SimpleName:getChannel))))(IfStatement(InfixExpression(SimpleName:channel)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userList))(SimpleName:setUserList)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:getUsersInChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channel)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userList))(SimpleName:setUserList)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userDatabase))(SimpleName:getUserList)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tcpSocket))(SimpleName:writeData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socket)(SimpleName:userList)))))(IfStatement(InstanceofExpression(SimpleName:defaultData)(SimpleType(SimpleName:UserConnection)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:UserConnection))(VariableDeclarationFragment(SimpleName:userConnection)(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:UserConnection))(SimpleName:defaultData)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userConnection))(SimpleName:isConnected)))(Block(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:success)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userDatabase))(SimpleName:removeUser)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userConnection))(SimpleName:getUser))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:userChannelList)(CastExpression(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:String)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:getUserChannels)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userConnection))(SimpleName:getUser)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:removeUserFromAllChannels)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userConnection))(SimpleName:getUser)))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:channel))(SimpleName:userChannelList)(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:channelExists)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channel))))(Block(ExpressionStatement(MethodInvocation(SimpleName:notifyChannelStatusChange)(METHOD_INVOCATION_ARGUMENTS(SimpleName:channel)(BooleanLiteral:false))))))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Socket)))(VariableDeclarationFragment(SimpleName:userSocketList)(CastExpression(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Socket)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userDatabase))(SimpleName:getSocketList)))))(ExpressionStatement(MethodInvocation(SimpleName:sendToAllSockets)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userSocketList)(SimpleName:userConnection))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userConnection))(SimpleName:toString))))))(IfStatement(InstanceofExpression(SimpleName:defaultData)(SimpleType(SimpleName:ChannelList)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ChannelList))(VariableDeclarationFragment(SimpleName:channelList)(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:ChannelList))(SimpleName:defaultData)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelList))(SimpleName:setChannelList)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:getListOfChannels)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tcpSocket))(SimpleName:writeData)(METHOD_INVOCATION_ARGUMENTS(SimpleName:socket)(SimpleName:channelList)))))(IfStatement(InstanceofExpression(SimpleName:defaultData)(SimpleType(SimpleName:ChannelJoinPart)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:ChannelJoinPart))(VariableDeclarationFragment(SimpleName:channelJoinPart)(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:ChannelJoinPart))(SimpleName:defaultData)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:setUser)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:hasJoined))(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:channelExists)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getChannel)))))(Block(ExpressionStatement(MethodInvocation(SimpleName:notifyChannelStatusChange)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getChannel))(BooleanLiteral:true))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:addUserToChannel)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getChannel))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getUser))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:removeUserFromChannel)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getChannel))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getUser)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:channelExists)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getChannel)))))(Block(ExpressionStatement(MethodInvocation(SimpleName:notifyChannelStatusChange)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getChannel))(BooleanLiteral:false))))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Socket)))(VariableDeclarationFragment(SimpleName:userSocketList)(CastExpression(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Socket)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelDatabase))(SimpleName:getSocketsOfUsersInChannel)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getChannel))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:getUser)))))))(ExpressionStatement(MethodInvocation(SimpleName:sendToAllSockets)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userSocketList)(SimpleName:channelJoinPart))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channelJoinPart))(SimpleName:toString))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Level.WARNING)(StringLiteral:<STR>)(SimpleName:defaultData))))))))))))))))