(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(SimpleType(SimpleName:KeySelectorResult))(SimpleName:select)(SingleVariableDeclaration(SimpleType(SimpleName:KeyInfo))(SimpleName:keyInfo))(SingleVariableDeclaration(SimpleType(SimpleName:Purpose))(SimpleName:purpose))(SingleVariableDeclaration(SimpleType(SimpleName:AlgorithmMethod))(SimpleName:method))(SingleVariableDeclaration(SimpleType(SimpleName:XMLCryptoContext))(SimpleName:context))(SimpleType(SimpleName:KeySelectorException))(Block(TryStatement(Block(ReturnStatement(SuperMethodInvocation(SimpleName:select)(SimpleName:keyInfo)(SimpleName:purpose)(SimpleName:method)(SimpleName:context))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:KeySelectorException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(FieldAccess(ThisExpression)(SimpleName:signatureResourceName))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signatureSegment)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:signatureResourceName)))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:signatureResourceName)))(SimpleName:lastIndexOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:signatureSegment)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signatureBase)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:signatureResourceName)))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:signatureResourceName)))(SimpleName:lastIndexOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:signatureBase)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signatureRelationshipResourceName)(InfixExpression(SimpleName:signatureSegment)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(SimpleName:signatureBase)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:signatureRelationshipResourceName)))))(VariableDeclarationStatement(SimpleType(SimpleName:ZipArchiveInputStream))(VariableDeclarationFragment(SimpleName:zipInputStream)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:zipInputStream)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ZipArchiveInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:opcUrl)))(SimpleName:openStream))(StringLiteral:<STR>)(BooleanLiteral:true)(BooleanLiteral:true)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeySelectorException))(SimpleName:e))))))(VariableDeclarationStatement(SimpleType(SimpleName:ZipArchiveEntry))(VariableDeclarationFragment(SimpleName:zipEntry)))(TryStatement(Block(WhileStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(ParenthesizedExpression(Assignment(SimpleName:zipEntry)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipInputStream))(SimpleName:getNextZipEntry)))))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureRelationshipResourceName))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipEntry))(SimpleName:getName))))(Block(BreakStatement))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeySelectorException))(SimpleName:e))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:zipEntry))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:signatureRelationshipResourceName)))))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeySelectorException))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:JAXBElement))(SimpleType(SimpleName:CTRelationships)))(VariableDeclarationFragment(SimpleName:signatureRelationshipsElement)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:signatureRelationshipsElement)(ASSIGNMENT_OPERATOR:=)(CastExpression(ParameterizedType(SimpleType(SimpleName:JAXBElement))(SimpleType(SimpleName:CTRelationships)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:relationshipsUnmarshaller)))(SimpleName:unmarshal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zipInputStream)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:JAXBException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeySelectorException))(SimpleName:e))))))(VariableDeclarationStatement(SimpleType(SimpleName:CTRelationships))(VariableDeclarationFragment(SimpleName:signatureRelationships)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureRelationshipsElement))(SimpleName:getValue))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:CTRelationship)))(VariableDeclarationFragment(SimpleName:signatureRelationshipList)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureRelationships))(SimpleName:getRelationship))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:certificateResourceNames)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:String))))))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:CTRelationship))(SimpleName:signatureRelationship))(SimpleName:signatureRelationshipList)(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DIGITAL_SIGNATURE_CERTIFICATE_REL_TYPE))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureRelationship))(SimpleName:getType))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:certificateResourceName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureRelationship))(SimpleName:getTarget)))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateResourceNames))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificateResourceName))))))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:endEntityCertificate)(NullLiteral)))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:certificateResourceName))(SimpleName:certificateResourceNames)(Block(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:zipInputStream)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ZipArchiveInputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:opcUrl)))(SimpleName:openStream))(StringLiteral:<STR>)(BooleanLiteral:true)(BooleanLiteral:true)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeySelectorException))(SimpleName:e))))))(TryStatement(Block(WhileStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(ParenthesizedExpression(Assignment(SimpleName:zipEntry)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipInputStream))(SimpleName:getNextZipEntry)))))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateResourceName))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipEntry))(SimpleName:getName))))(Block(BreakStatement))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeySelectorException))(SimpleName:e))))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:zipEntry))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:certificateResourceName)))))(ContinueStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:certificate)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:certificate)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:certificateFactory)))(SimpleName:generateCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zipInputStream)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CertificateException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeySelectorException))(SimpleName:e))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificate))(SimpleName:getSubjectX500Principal))))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))(INFIX_EXPRESSION_OPERATOR:!=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificate))(SimpleName:getBasicConstraints)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ContinueStatement)))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:endEntityCertificate))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeySelectorException))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:endEntityCertificate)(ASSIGNMENT_OPERATOR:=)(SimpleName:certificate)))))(IfStatement(InfixExpression(NullLiteral)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:endEntityCertificate))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeySelectorException))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:certificate))(ASSIGNMENT_OPERATOR:=)(SimpleName:endEntityCertificate)))(ReturnStatement(ThisExpression))))))