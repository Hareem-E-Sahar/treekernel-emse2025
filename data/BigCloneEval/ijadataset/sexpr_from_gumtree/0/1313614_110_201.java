(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:calculateChecksum)(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:alg))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:header))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:trailer))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:data))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:start))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:len))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:tokenId))(SimpleType(SimpleName:GSSException))(Block(SwitchStatement(SimpleName:alg)(SwitchCase(QualifiedName:MessageToken.SGN_ALG_DES_MAC_MD5))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md5)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md5))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:header))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md5))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(SimpleName:start)(SimpleName:len))))(IfStatement(InfixExpression(SimpleName:trailer)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md5))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:trailer))))))(ExpressionStatement(Assignment(SimpleName:data)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md5))(SimpleName:digest))))(ExpressionStatement(Assignment(SimpleName:start)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(ExpressionStatement(Assignment(SimpleName:len)(ASSIGNMENT_OPERATOR:=)(QualifiedName:data.length)))(ExpressionStatement(Assignment(SimpleName:header)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(ExpressionStatement(Assignment(SimpleName:trailer)(ASSIGNMENT_OPERATOR:=)(NullLiteral))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(VariableDeclarationStatement(SimpleType(SimpleName:GSSException))(VariableDeclarationFragment(SimpleName:ge)(ClassInstanceCreation(SimpleType(SimpleName:GSSException))(QualifiedName:GSSException.FAILURE)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ge))(SimpleName:initCause)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e))))(ThrowStatement(SimpleName:ge)))))(SwitchCase(QualifiedName:MessageToken.SGN_ALG_DES_MAC))(ReturnStatement(MethodInvocation(SimpleName:getDesCbcChecksum)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keybytes)(SimpleName:header)(SimpleName:data)(SimpleName:start)(SimpleName:len))))(SwitchCase(QualifiedName:MessageToken.SGN_ALG_HMAC_SHA1_DES3_KD))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buf)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:offset))(VariableDeclarationFragment(SimpleName:total)))(IfStatement(InfixExpression(InfixExpression(SimpleName:header)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:trailer)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:buf)(ASSIGNMENT_OPERATOR:=)(SimpleName:data)))(ExpressionStatement(Assignment(SimpleName:total)(ASSIGNMENT_OPERATOR:=)(SimpleName:len)))(ExpressionStatement(Assignment(SimpleName:offset)(ASSIGNMENT_OPERATOR:=)(SimpleName:start))))(Block(ExpressionStatement(Assignment(SimpleName:total)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:header)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(QualifiedName:header.length)(NumberLiteral:0)))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:len)(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:trailer)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(QualifiedName:trailer.length)(NumberLiteral:0)))))))(ExpressionStatement(Assignment(SimpleName:buf)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:total))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:pos)(NumberLiteral:0)))(IfStatement(InfixExpression(SimpleName:header)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:header)(NumberLiteral:0)(SimpleName:buf)(NumberLiteral:0)(QualifiedName:header.length))))(ExpressionStatement(Assignment(SimpleName:pos)(ASSIGNMENT_OPERATOR:=)(QualifiedName:header.length)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(SimpleName:start)(SimpleName:buf)(SimpleName:pos)(SimpleName:len))))(ExpressionStatement(Assignment(SimpleName:pos)(ASSIGNMENT_OPERATOR:+=)(SimpleName:len)))(IfStatement(InfixExpression(SimpleName:trailer)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:trailer)(NumberLiteral:0)(SimpleName:buf)(SimpleName:pos)(QualifiedName:trailer.length))))))(ExpressionStatement(Assignment(SimpleName:offset)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))))(TryStatement(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:answer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Des3))(SimpleName:calculateChecksum)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keybytes)(SimpleName:KG_USAGE_SIGN)(SimpleName:buf)(SimpleName:offset)(SimpleName:total)))))(ReturnStatement(SimpleName:answer)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:GeneralSecurityException))(SimpleName:e))(Block(VariableDeclarationStatement(SimpleType(SimpleName:GSSException))(VariableDeclarationFragment(SimpleName:ge)(ClassInstanceCreation(SimpleType(SimpleName:GSSException))(QualifiedName:GSSException.FAILURE)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ge))(SimpleName:initCause)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e))))(ThrowStatement(SimpleName:ge)))))(SwitchCase(QualifiedName:MessageToken.SGN_ALG_HMAC_MD5_ARCFOUR))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:buffer)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:off))(VariableDeclarationFragment(SimpleName:tot)))(IfStatement(InfixExpression(InfixExpression(SimpleName:header)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:trailer)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:buffer)(ASSIGNMENT_OPERATOR:=)(SimpleName:data)))(ExpressionStatement(Assignment(SimpleName:tot)(ASSIGNMENT_OPERATOR:=)(SimpleName:len)))(ExpressionStatement(Assignment(SimpleName:off)(ASSIGNMENT_OPERATOR:=)(SimpleName:start))))(Block(ExpressionStatement(Assignment(SimpleName:tot)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:header)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(QualifiedName:header.length)(NumberLiteral:0)))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:len)(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:trailer)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(QualifiedName:trailer.length)(NumberLiteral:0)))))))(ExpressionStatement(Assignment(SimpleName:buffer)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:tot))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:pos)(NumberLiteral:0)))(IfStatement(InfixExpression(SimpleName:header)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:header)(NumberLiteral:0)(SimpleName:buffer)(NumberLiteral:0)(QualifiedName:header.length))))(ExpressionStatement(Assignment(SimpleName:pos)(ASSIGNMENT_OPERATOR:=)(QualifiedName:header.length)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(SimpleName:start)(SimpleName:buffer)(SimpleName:pos)(SimpleName:len))))(ExpressionStatement(Assignment(SimpleName:pos)(ASSIGNMENT_OPERATOR:+=)(SimpleName:len)))(IfStatement(InfixExpression(SimpleName:trailer)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:trailer)(NumberLiteral:0)(SimpleName:buffer)(SimpleName:pos)(QualifiedName:trailer.length))))))(ExpressionStatement(Assignment(SimpleName:off)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))))(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:key_usage)(SimpleName:KG_USAGE_SIGN)))(IfStatement(InfixExpression(SimpleName:tokenId)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:Krb5Token.MIC_ID))(Block(ExpressionStatement(Assignment(SimpleName:key_usage)(ASSIGNMENT_OPERATOR:=)(SimpleName:KG_USAGE_SIGN_MS)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:answer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ArcFourHmac))(SimpleName:calculateChecksum)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keybytes)(SimpleName:key_usage)(SimpleName:buffer)(SimpleName:off)(SimpleName:tot)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:output)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(SimpleName:getChecksumLength)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:answer)(NumberLiteral:0)(SimpleName:output)(NumberLiteral:0)(QualifiedName:output.length))))(ReturnStatement(SimpleName:output)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:GeneralSecurityException))(SimpleName:e))(Block(VariableDeclarationStatement(SimpleType(SimpleName:GSSException))(VariableDeclarationFragment(SimpleName:ge)(ClassInstanceCreation(SimpleType(SimpleName:GSSException))(QualifiedName:GSSException.FAILURE)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ge))(SimpleName:initCause)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e))))(ThrowStatement(SimpleName:ge)))))(SwitchCase)(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GSSException))(QualifiedName:GSSException.FAILURE)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:sgnAlg)))))))))