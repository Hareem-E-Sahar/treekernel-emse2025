(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:IPPacket))(SimpleName:processPacket)(SingleVariableDeclaration(SimpleType(SimpleName:IPPacket))(SimpleName:packet))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:direction))(Block(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:now)(NumberLiteral:0)))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:now)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:nanoTime)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block)))(IfStatement(InfixExpression(SimpleName:direction)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:DIRECTION_IN))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:offset)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getIPHeaderByteLength))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:len)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getIPPacketLength))(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:offset))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:esp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getDataUnprotected))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:spi)(CastExpression(PrimitiveType:int)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:esp)(SimpleName:offset))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:|)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:esp)(InfixExpression(SimpleName:offset)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:16)))(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:esp)(InfixExpression(SimpleName:offset)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))(INFIX_EXPRESSION_OPERATOR:<<)(NumberLiteral:8)))(ParenthesizedExpression(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:esp)(InfixExpression(SimpleName:offset)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:3)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:BeetEntry))(VariableDeclarationFragment(SimpleName:entry)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:__inbound))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:spi)))))))(IfStatement(InfixExpression(SimpleName:entry)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ReturnStatement(NullLiteral)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:iv)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getCipher)))(SimpleName:getIVLength)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:elen)(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:ICV_LENGTH)(QualifiedName:iv.length)(SimpleName:ESP_HEADER_LEN))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:alen)(SimpleName:ICV_LENGTH)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:esp)(InfixExpression(SimpleName:offset)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ESP_HEADER_LEN))(SimpleName:iv)(NumberLiteral:0)(QualifiedName:iv.length))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:cipher)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:elen))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hash)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:ICV_LENGTH))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hash2)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:ICV_LENGTH))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ivcipher)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(QualifiedName:iv.length)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:elen)(SimpleName:ESP_HEADER_LEN)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:esp)(InfixExpression(SimpleName:offset)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ESP_HEADER_LEN)(QualifiedName:iv.length))(SimpleName:cipher)(NumberLiteral:0)(SimpleName:elen))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:esp)(InfixExpression(SimpleName:offset)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ESP_HEADER_LEN)(QualifiedName:iv.length)(QualifiedName:cipher.length))(SimpleName:hash)(NumberLiteral:0)(SimpleName:alen))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:esp)(SimpleName:offset)(SimpleName:ivcipher)(NumberLiteral:0)(QualifiedName:ivcipher.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getDigest)))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ivcipher)))(NumberLiteral:0)(SimpleName:hash2)(NumberLiteral:0)(SimpleName:ICV_LENGTH))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:areEqual)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:hash2))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ReturnStatement(NullLiteral))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:plain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getCipher)))(SimpleName:decrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cipher)(SimpleName:iv)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:padlen)(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:plain)(InfixExpression(QualifiedName:plain.length)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:2)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:proto)(ParenthesizedExpression(InfixExpression(ArrayAccess(SimpleName:plain)(InfixExpression(QualifiedName:plain.length)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF)))))(VariableDeclarationStatement(SimpleType(SimpleName:IPPacket))(VariableDeclarationFragment(SimpleName:ipv6)(ClassInstanceCreation(SimpleType(SimpleName:IPPacket))(InfixExpression(QualifiedName:IPPacket.IP_VERSION6_LEN)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(SimpleName:elen)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:padlen)(SimpleName:ESP_TRAILER_LEN)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ipv6))(SimpleName:setIPVersion)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:IPPacket.IP_VERSION6))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ipv6))(SimpleName:setNextHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:proto))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ipv6))(SimpleName:setIPPacketLength)(METHOD_INVOCATION_ARGUMENTS(ParenthesizedExpression(InfixExpression(SimpleName:elen)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:padlen)(SimpleName:ESP_TRAILER_LEN))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ipv6))(SimpleName:setDestination)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSrc)))(SimpleName:getAddress)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ipv6))(SimpleName:setSource)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getDst)))(SimpleName:getAddress)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:ipv6raw)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ipv6))(SimpleName:getDataUnprotected))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:plain)(NumberLiteral:0)(SimpleName:ipv6raw)(QualifiedName:IPPacket.IP_VERSION6_LEN)(ParenthesizedExpression(InfixExpression(SimpleName:elen)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:padlen)(SimpleName:ESP_TRAILER_LEN))))))(ReturnStatement(SimpleName:ipv6)))(IfStatement(InfixExpression(SimpleName:direction)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:DIRECTION_OUT))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:dst6)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(QualifiedName:IPPacket.LENGTH_DESTINATION_ADDRESS6))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getDestination)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dst6))))(VariableDeclarationStatement(SimpleType(SimpleName:BeetEntry))(VariableDeclarationFragment(SimpleName:entry)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:__outbound))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Helpers))(SimpleName:toHexString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dst6)(StringLiteral:<STR>)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:elen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getIPPacketLength))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:padlen)(NumberLiteral:0)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:eivlength)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getCipher)))(SimpleName:getIVLength))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:raw)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getDataUnprotected))))(IfStatement(InfixExpression(SimpleName:eivlength)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:padlen)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:eivlength)(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:elen)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2)))(INFIX_EXPRESSION_OPERATOR:%)(SimpleName:eivlength)))))))(Block(ExpressionStatement(Assignment(SimpleName:padlen)(ASSIGNMENT_OPERATOR:=)(InfixExpression(NumberLiteral:4)(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:elen)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:2)))(INFIX_EXPRESSION_OPERATOR:%)(NumberLiteral:4))))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:esp)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:ESP_HEADER_LEN)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:elen)(SimpleName:eivlength)(SimpleName:padlen)(SimpleName:ESP_TRAILER_LEN)))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:esp)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSPI))(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:esp)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSPI))(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:esp)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSPI))(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:esp)(NumberLiteral:3))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSPI))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:esp)(NumberLiteral:4))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSequence))(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:24)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:esp)(NumberLiteral:5))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSequence))(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:16)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:esp)(NumberLiteral:6))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSequence))(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8)))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:esp)(NumberLiteral:7))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSequence))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:setSequence)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSequence))(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:edat)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:elen)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:padlen)(SimpleName:ESP_TRAILER_LEN)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:raw)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getIPHeaderByteLength))(SimpleName:edat)(NumberLiteral:0)(SimpleName:elen))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:edat)(InfixExpression(SimpleName:elen)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:padlen)))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(SimpleName:padlen)(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:edat)(InfixExpression(SimpleName:elen)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:padlen)(NumberLiteral:1)))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getNextHeader))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0xFF))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:enc)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getCipher)))(SimpleName:encrypt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:edat)))))(IfStatement(InfixExpression(SimpleName:eivlength)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getCipher)))(SimpleName:getIV))(NumberLiteral:0)(SimpleName:esp)(SimpleName:ESP_HEADER_LEN)(SimpleName:eivlength)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:enc)(NumberLiteral:0)(SimpleName:esp)(InfixExpression(SimpleName:ESP_HEADER_LEN)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:eivlength))(QualifiedName:enc.length))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:adat)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getDigest)))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:esp)))))(VariableDeclarationStatement(SimpleType(SimpleName:IPPacket))(VariableDeclarationFragment(SimpleName:espPacket)(ClassInstanceCreation(SimpleType(SimpleName:IPPacket))(InfixExpression(ParenthesizedExpression(ConditionalExpression(InstanceofExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getDst))(SimpleType(SimpleName:Inet4Address)))(SimpleName:DEFAULT_IPV4_HEADER_LEN)(SimpleName:DEFAULT_IPV6_HEADER_LEN)))(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:esp.length)(SimpleName:ICV_LENGTH)))))(IfStatement(InstanceofExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getDst))(SimpleType(SimpleName:Inet4Address)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:setSource)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getSrc)))(SimpleName:getAddress)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:setDestination)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getDst)))(SimpleName:getAddress)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:setIPVersion)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:IPPacket.IP_VERSION4))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:setIPHeaderLength)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:DEFAULT_IPV4_HEADER_LEN)(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:4)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:setTTL)(METHOD_INVOCATION_ARGUMENTS(SimpleName:DEFAULT_TTL))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:setProtocol)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ESP_PROTO)))))(Block))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:esp)(NumberLiteral:0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:getDataUnprotected))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:getIPHeaderByteLength))(QualifiedName:esp.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:adat)(NumberLiteral:0)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:getDataUnprotected))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:espPacket))(SimpleName:getIPHeaderByteLength))(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:esp.length))(SimpleName:ICV_LENGTH))))(ReturnStatement(SimpleName:espPacket)))))(ReturnStatement(NullLiteral))))))