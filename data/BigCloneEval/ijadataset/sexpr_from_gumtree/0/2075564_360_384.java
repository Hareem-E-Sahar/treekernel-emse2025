(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:User))(SimpleName:updateUser)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:userId))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:password1))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:password2))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:passwordReset))(SimpleType(SimpleName:PortalException))(SimpleType(SimpleName:SystemException))(Block(ExpressionStatement(Assignment(SimpleName:userId)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userId))(SimpleName:trim)))(SimpleName:toLowerCase))))(ExpressionStatement(MethodInvocation(SimpleName:validate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userId)(SimpleName:password1)(SimpleName:password2))))(VariableDeclarationStatement(SimpleType(SimpleName:User))(VariableDeclarationFragment(SimpleName:user)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserUtil))(SimpleName:findByPrimaryKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userId)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:oldEncPwd)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:getPassword))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:isPasswordEncrypted)))(Block(ExpressionStatement(Assignment(SimpleName:oldEncPwd)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Encryptor))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:getPassword))))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:newEncPwd)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Encryptor))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password1)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:passwordsLifespan)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:GetterUtil))(SimpleName:getInteger)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.PASSWORDS_LIFESPAN)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:expirationDate)(NullLiteral)))(IfStatement(InfixExpression(SimpleName:passwordsLifespan)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(SimpleName:expirationDate)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Date))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:+)(InfixExpression(QualifiedName:Time.DAY)(INFIX_EXPRESSION_OPERATOR:*)(SimpleName:passwordsLifespan))))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:hasCompanyMx))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MailManagerUtil))(SimpleName:updatePassword)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userId)(SimpleName:password1))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setPassword)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newEncPwd))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setPasswordEncrypted)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setPasswordExpirationDate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:expirationDate))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setPasswordReset)(METHOD_INVOCATION_ARGUMENTS(SimpleName:passwordReset))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserUtil))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PasswordTrackerLocalManagerUtil))(SimpleName:trackPassword)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userId)(SimpleName:oldEncPwd))))(ReturnStatement(SimpleName:user))))))