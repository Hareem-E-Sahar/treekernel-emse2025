(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(SimpleType(SimpleName:HttpResponse))(SimpleName:constructHandShakeResponse)(SingleVariableDeclaration(SimpleType(SimpleName:HttpRequest))(SimpleName:aReq))(SingleVariableDeclaration(SimpleType(SimpleName:ChannelHandlerContext))(SimpleName:aCtx))(SimpleType(SimpleName:NoSuchAlgorithmException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:HttpResponse))(VariableDeclarationFragment(SimpleName:lResp)(ClassInstanceCreation(SimpleType(SimpleName:DefaultHttpResponse))(QualifiedName:HttpVersion.HTTP_1_1)(ClassInstanceCreation(SimpleType(SimpleName:HttpResponseStatus))(NumberLiteral:101)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.UPGRADE)(QualifiedName:HttpHeaders.Values.WEBSOCKET))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.CONNECTION)(QualifiedName:HttpHeaders.Values.UPGRADE))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:containsHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.SEC_WEBSOCKET_KEY1)))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:containsHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.SEC_WEBSOCKET_KEY2))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.SEC_WEBSOCKET_ORIGIN)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:getHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.ORIGIN))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.SEC_WEBSOCKET_LOCATION)(MethodInvocation(SimpleName:getWebSocketLocation)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aReq))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lProtocol)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:getHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.SEC_WEBSOCKET_PROTOCOL)))))(IfStatement(InfixExpression(SimpleName:lProtocol)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.SEC_WEBSOCKET_PROTOCOL)(SimpleName:lProtocol)))))(Block(ExpressionStatement(Assignment(SimpleName:lProtocol)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:getHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.WEBSOCKET_PROTOCOL)))))(IfStatement(InfixExpression(SimpleName:lProtocol)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.SEC_WEBSOCKET_PROTOCOL)(SimpleName:lProtocol))))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lKey1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:getHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.SEC_WEBSOCKET_KEY1)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lKey2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:getHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.SEC_WEBSOCKET_KEY2)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:lA)(CastExpression(PrimitiveType:int)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Long))(SimpleName:parseLong)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lKey1))(SimpleName:replaceAll)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(INFIX_EXPRESSION_OPERATOR:/)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lKey1))(SimpleName:replaceAll)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(SimpleName:length)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:lB)(CastExpression(PrimitiveType:int)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Long))(SimpleName:parseLong)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lKey2))(SimpleName:replaceAll)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(INFIX_EXPRESSION_OPERATOR:/)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lKey2))(SimpleName:replaceAll)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(SimpleName:length)))))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:lC)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:getContent)))(SimpleName:readLong))))(VariableDeclarationStatement(SimpleType(SimpleName:ChannelBuffer))(VariableDeclarationFragment(SimpleName:lInput)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ChannelBuffers))(SimpleName:buffer)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:16)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lInput))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lA))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lInput))(SimpleName:writeInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lB))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lInput))(SimpleName:writeLong)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lC))))(VariableDeclarationStatement(SimpleType(SimpleName:ChannelBuffer))(VariableDeclarationFragment(SimpleName:lOutput)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ChannelBuffers))(SimpleName:wrappedBuffer)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lInput))(SimpleName:array))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:setContent)(METHOD_INVOCATION_ARGUMENTS(SimpleName:lOutput)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.WEBSOCKET_ORIGIN)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:getHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.ORIGIN))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.WEBSOCKET_LOCATION)(MethodInvocation(SimpleName:getWebSocketLocation)(METHOD_INVOCATION_ARGUMENTS(SimpleName:aReq))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:lProtocol)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aReq))(SimpleName:getHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.WEBSOCKET_PROTOCOL)))))(IfStatement(InfixExpression(SimpleName:lProtocol)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:lResp))(SimpleName:addHeader)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:HttpHeaders.Names.WEBSOCKET_PROTOCOL)(SimpleName:lProtocol))))))))(ReturnStatement(SimpleName:lResp))))))