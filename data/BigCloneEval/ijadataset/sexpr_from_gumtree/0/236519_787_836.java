(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:verifyMIC)(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:inTok))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:tokOff))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:tokLen))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:inMsg))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:msgOff))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:msgLen))(SingleVariableDeclaration(SimpleType(SimpleName:MessageProp))(SimpleName:prop))(SimpleType(SimpleName:GSSException))(Block(ExpressionStatement(MethodInvocation(SimpleName:checkContext)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:SSLCipherState))(VariableDeclarationFragment(SimpleName:st)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:conn)))(SimpleName:getReadCipherState))))(VariableDeclarationStatement(SimpleType(SimpleName:SSLCipherSuite))(VariableDeclarationFragment(SimpleName:cs)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:st))(SimpleName:getCipherSuite))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cs))(SimpleName:getDigestAlg))))))(IfStatement(InfixExpression(SimpleName:tokLen)(INFIX_EXPRESSION_OPERATOR:!=)(ParenthesizedExpression(InfixExpression(SimpleName:GSI_MESSAGE_DIGEST_PADDING)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cs))(SimpleName:getDigestOutputLength)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GlobusGSSException))(QualifiedName:GSSException.DEFECTIVE_TOKEN)(QualifiedName:GlobusGSSException.TOKEN_FAIL)(StringLiteral:<STR>)(ArrayCreation(ArrayType(SimpleType(SimpleName:Object))(Dimension))(ArrayInitializer(ClassInstanceCreation(SimpleType(SimpleName:Integer))(SimpleName:tokLen))(ClassInstanceCreation(SimpleType(SimpleName:Integer))(InfixExpression(SimpleName:GSI_MESSAGE_DIGEST_PADDING)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cs))(SimpleName:getDigestOutputLength))))))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:bufLen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SSLUtil))(SimpleName:toInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inTok)(InfixExpression(SimpleName:tokOff)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:GSI_SEQUENCE_SIZE))))))(IfStatement(InfixExpression(SimpleName:bufLen)(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:msgLen))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GlobusGSSException))(QualifiedName:GSSException.DEFECTIVE_TOKEN)(QualifiedName:GlobusGSSException.TOKEN_FAIL)(StringLiteral:<STR>)(ArrayCreation(ArrayType(SimpleType(SimpleName:Object))(Dimension))(ArrayInitializer(ClassInstanceCreation(SimpleType(SimpleName:Integer))(SimpleName:msgLen))(ClassInstanceCreation(SimpleType(SimpleName:Integer))(SimpleName:bufLen))))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:pad_ct)(ConditionalExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cs))(SimpleName:getDigestOutputLength))(INFIX_EXPRESSION_OPERATOR:==)(NumberLiteral:16)))(NumberLiteral:48)(NumberLiteral:40))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digest)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cs))(SimpleName:getDigestAlg))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:st))(SimpleName:getMacKey)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:pad_ct))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SSLHandshake.pad_1))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inTok)(SimpleName:tokOff)(SimpleName:GSI_MESSAGE_DIGEST_PADDING))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inMsg)(SimpleName:msgOff)(SimpleName:msgLen))))(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GlobusGSSException))(QualifiedName:GSSException.FAILURE)(SimpleName:e))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:token)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:tokLen)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:GSI_MESSAGE_DIGEST_PADDING)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inTok)(InfixExpression(SimpleName:tokOff)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:GSI_MESSAGE_DIGEST_PADDING))(SimpleName:token)(NumberLiteral:0)(QualifiedName:token.length))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest)(SimpleName:token))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GlobusGSSException))(QualifiedName:GSSException.BAD_MIC)(QualifiedName:GlobusGSSException.BAD_MIC)(StringLiteral:<STR>)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:tokSeq)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SSLUtil))(SimpleName:toLong)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inTok)(SimpleName:tokOff)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:readSeq)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:conn)))(SimpleName:getReadSequence))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:seqTest)(InfixExpression(SimpleName:tokSeq)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:readSeq))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:tokSeq)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:readSeq)))))(IfStatement(InfixExpression(SimpleName:seqTest)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GSSException))(QualifiedName:GSSException.GAP_TOKEN))))(IfStatement(InfixExpression(SimpleName:seqTest)(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:0))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GSSException))(QualifiedName:GSSException.OLD_TOKEN))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:conn)))(SimpleName:incrementReadSequence))))))(IfStatement(InfixExpression(SimpleName:prop)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prop))(SimpleName:setPrivacy)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prop))(SimpleName:setQOP)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))