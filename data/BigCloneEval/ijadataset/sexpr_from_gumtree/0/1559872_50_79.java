(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(Modifier:synchronized)(PrimitiveType:void)(SimpleName:exportToIpFilter)(SingleVariableDeclaration(SimpleType(SimpleName:PluginInterface))(SimpleName:aPlugin))(Block(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:evilEntries)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getSafePeer)))(SimpleName:getCache)))(SimpleName:getEvilPeerEntries))))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:it)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:evilEntries))(SimpleName:iterator))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:newRanges)(ClassInstanceCreation(SimpleType(SimpleName:ArrayList))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:evilEntries))(SimpleName:size)))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:oldRanges)(ClassInstanceCreation(SimpleType(SimpleName:ArrayList))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:asList)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aPlugin))(SimpleName:getIPFilter)))(SimpleName:getRanges)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Collections))(SimpleName:sort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:oldRanges))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:newRangesCount)(NumberLiteral:0)))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:hasNext))(Block(VariableDeclarationStatement(SimpleType(SimpleName:IpRange))(VariableDeclarationFragment(SimpleName:entry)(CastExpression(SimpleType(SimpleName:IpRange))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:next)))))(VariableDeclarationStatement(SimpleType(SimpleName:IPRange))(VariableDeclarationFragment(SimpleName:range)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aPlugin))(SimpleName:getIPFilter)))(SimpleName:createRange)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:range))(SimpleName:setStartIP)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getStartIp)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:range))(SimpleName:setEndIP)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getEndIp)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:range))(SimpleName:setDescription)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entry))(SimpleName:getDescription)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:range))(SimpleName:checkValid)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(SimpleName:containsRange)(METHOD_INVOCATION_ARGUMENTS(SimpleName:oldRanges)(SimpleName:range))))(Block(ExpressionStatement(PostfixExpression(SimpleName:newRangesCount)(POSTFIX_EXPRESSION_OPERATOR:++)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aPlugin))(SimpleName:getIPFilter)))(SimpleName:addRange)(METHOD_INVOCATION_ARGUMENTS(SimpleName:range))))))))(IfStatement(InfixExpression(NumberLiteral:0)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:newRangesCount))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aPlugin))(SimpleName:getIPFilter)))(SimpleName:markAsUpToDate))))(VariableDeclarationStatement(SimpleType(SimpleName:LoggerChannel))(VariableDeclarationFragment(SimpleName:logger)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aPlugin))(SimpleName:getLogger)))(SimpleName:getChannel)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:entry)(StringLiteral:<STR>)))(IfStatement(InfixExpression(SimpleName:newRangesCount)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:1))(ExpressionStatement(Assignment(SimpleName:entry)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:logMsg)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:newRangesCount)(StringLiteral:<STR>)(SimpleName:entry)(StringLiteral:<STR>)(FieldAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:aPlugin))(SimpleName:getIPFilter)))(SimpleName:getRanges))(SimpleName:length))(StringLiteral:<STR>)(SimpleName:entry)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:LoggerChannel.LT_INFORMATION)(SimpleName:logMsg))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:end)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DefaultEvilIPCache))(SimpleName:getInstance)))(SimpleName:clear)))(VariableDeclarationStatement(SimpleType(SimpleName:MiniLogger))(VariableDeclarationFragment(SimpleName:log)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DefaultMiniLogger))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SafePeer.LOG_IDENTIFIER)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(SimpleName:logMsg))))))))