(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(PrimitiveType:void)(SimpleName:_downloadFile)(SingleVariableDeclaration(SimpleType(SimpleName:InputStream))(SimpleName:reader))(SingleVariableDeclaration(PrimitiveType:byte)(SimpleName:first_char))(SimpleType(SimpleName:IOException))(SimpleType(QualifiedName:java.io.FileNotFoundException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:TransferStatus))(VariableDeclarationFragment(SimpleName:ts)(NullLiteral)))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:downloaded_so_far)(NumberLiteral:0)))(SynchronizedStatement(SimpleName:_download_lock)(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(SimpleName:_setUserConnectionState)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:UserConnectionState.DL_DOWNLOADING))))(ExpressionStatement(Assignment(SimpleName:downloaded_so_far)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:file_size)(MethodInvocation(SimpleName:_downloadFileSize))))(ExpressionStatement(Assignment(SimpleName:ts)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:TransferStatus))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getOwnerNick))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getDestinationPath))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getDRUCMapId))(QualifiedName:TransferStatus._WAITING)(QualifiedName:TransferStatus._DOWNLOAD)(SimpleName:file_size)(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:setStatus)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:DownloadRequest._RUNNING))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_user_cb_handler))(SimpleName:execute)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:UserConnectionHandler.TRANSFER_STATUS_CREATED_CB)(SimpleName:ts))))(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:os)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:save_file)(NullLiteral)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getFileType))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:DownloadRequest.FILE_TYPE_NORMAL))(Block(ExpressionStatement(Assignment(SimpleName:save_file)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getDestinationPath)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:save_file))(SimpleName:createNewFile)))(ExpressionStatement(Assignment(SimpleName:os)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:save_file)))))(Block(ExpressionStatement(Assignment(SimpleName:os)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream))(CastExpression(PrimitiveType:int)(SimpleName:file_size)))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:receiverBufferSize)(CastExpression(PrimitiveType:int)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Configuration))(SimpleName:instance)))(SimpleName:getReceiveBufferSize)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:read_arr)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(SimpleName:receiverBufferSize))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:read_arr)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(SimpleName:first_char)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:read_arr)(NumberLiteral:0)(NumberLiteral:1))))(ExpressionStatement(Assignment(SimpleName:downloaded_so_far)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:1)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ts))(SimpleName:setStatus_Progress)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TransferStatus._RUNNING)(SimpleName:downloaded_so_far))))(ExpressionStatement(MethodInvocation(SimpleName:_debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:downloaded_so_far)))))(ExpressionStatement(MethodInvocation(SimpleName:_debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:file_size)))))(WhileStatement(InfixExpression(InfixExpression(SimpleName:downloaded_so_far)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:file_size))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getActive)))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:nr_of_chars_read)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:read)(METHOD_INVOCATION_ARGUMENTS(SimpleName:read_arr)(NumberLiteral:0)(QualifiedName:read_arr.length)))))(IfStatement(InfixExpression(SimpleName:nr_of_chars_read)(INFIX_EXPRESSION_OPERATOR:==)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(BreakStatement))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:read_arr)(NumberLiteral:0)(SimpleName:nr_of_chars_read))))(ExpressionStatement(Assignment(SimpleName:downloaded_so_far)(ASSIGNMENT_OPERATOR:+=)(SimpleName:nr_of_chars_read)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ts))(SimpleName:setProgress)(METHOD_INVOCATION_ARGUMENTS(SimpleName:downloaded_so_far))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_user_cb_handler))(SimpleName:execute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FILE_DOWNLOAD_PROGRESS_CB)(SimpleName:ts))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:flush)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:os))(SimpleName:close)))(ExpressionStatement(MethodInvocation(SimpleName:_fileDownloadMode)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false))))(ExpressionStatement(MethodInvocation(SimpleName:_downloadFileSize)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getActive))(Block(ExpressionStatement(MethodInvocation(SimpleName:_debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ts))(SimpleName:setStatus_Progress)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TransferStatus._FINISHED)(SimpleName:downloaded_so_far))))(VariableDeclarationStatement(SimpleType(SimpleName:Object))(VariableDeclarationFragment(SimpleName:data)(SimpleName:save_file)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getFileType))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:DownloadRequest.FILE_TYPE_FILE_LIST))(Block(ExpressionStatement(Assignment(SimpleName:data)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:_createTree)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:ByteArrayOutputStream))(SimpleName:os)))))))(Block))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_cb_handler))(SimpleName:execute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FILE_DOWNLOAD_DONE_CB)(ClassInstanceCreation(SimpleType(SimpleName:DownloadedFile))(SimpleName:_dr)(SimpleName:data)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EventDispatcher))(SimpleName:instance)))(SimpleName:dispatchEvent)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DownloadEvent))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getIdStr))(SimpleName:_dr)(QualifiedName:DownloadEvent.DONE))))))(Block(ExpressionStatement(MethodInvocation(SimpleName:_debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ts))(SimpleName:setStatus_Progress)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TransferStatus._ABORTED)(SimpleName:downloaded_so_far))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_cb_handler))(SimpleName:execute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:FILE_DOWNLOAD_ABORTED_CB)(SimpleName:_dr))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EventDispatcher))(SimpleName:instance)))(SimpleName:dispatchEvent)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DownloadEvent))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getIdStr))(SimpleName:_dr)(QualifiedName:DownloadEvent.ABORTED)))))(ExpressionStatement(MethodInvocation(SimpleName:disconnectNoThread)))(ExpressionStatement(MethodInvocation(SimpleName:_dispatchRelocateDLQueueEvent))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ioEx))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ts))(SimpleName:setStatus_Progress)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TransferStatus._FAILURE)(SimpleName:downloaded_so_far))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EventDispatcher))(SimpleName:instance)))(SimpleName:dispatchEvent)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DownloadEvent))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getIdStr))(SimpleName:_dr)(QualifiedName:DownloadEvent.FAILED)(QualifiedName:DownloadEvent.REASON_CONNECTION_CLOSED)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IllegalStateTransition))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Configuration))(SimpleName:instance)))(SimpleName:executeExceptionCallback)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ex))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ts))(SimpleName:setStatus_Progress)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:TransferStatus._FAILURE)(SimpleName:downloaded_so_far))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EventDispatcher))(SimpleName:instance)))(SimpleName:dispatchEvent)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DownloadEvent))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_dr))(SimpleName:getIdStr))(SimpleName:_dr)(QualifiedName:DownloadEvent.FAILED)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:libLogger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:ex))))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:checkTime))(VariableDeclarationFragment(SimpleName:cleaner)(ClassInstanceCreation(SimpleType(SimpleName:checkTime))(NumberLiteral:10)(SimpleName:ts)(StringLiteral:<STR>))))(TryStatement(Block(ExpressionStatement(MethodInvocation(SimpleName:_setUserConnectionState)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:UserConnectionState.NONE)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IllegalStateTransition))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Configuration))(SimpleName:instance)))(SimpleName:executeExceptionCallback)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ex))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:libLogger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:ex)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_download_lock))(SimpleName:notifyAll)))))))))))