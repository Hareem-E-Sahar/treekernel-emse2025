(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:boolean)(SimpleName:onHandshakeRecieved)(SingleVariableDeclaration(SimpleType(SimpleName:WebSocket))(SimpleName:conn))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:handshake))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:key3))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:NoSuchAlgorithmException))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FLASH_POLICY_REQUEST))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:handshake)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:policy)(InfixExpression(MethodInvocation(SimpleName:getFlashSecurityPolicy))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:conn))(SimpleName:socketChannel)))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:wrap)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:policy))(SimpleName:getBytes)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:WebSocket.UTF8_CHARSET))))))))(ReturnStatement(BooleanLiteral:false))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:String))(Dimension))(VariableDeclarationFragment(SimpleName:requestLines)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:handshake))(SimpleName:split)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:isWebSocketRequest)(BooleanLiteral:true)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:line)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:requestLines)(NumberLiteral:0)))(SimpleName:trim))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:path)(NullLiteral)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:line))(SimpleName:startsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:line))(SimpleName:endsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(Block(ExpressionStatement(Assignment(SimpleName:isWebSocketRequest)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false))))(Block(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:String))(Dimension))(VariableDeclarationFragment(SimpleName:firstLineTokens)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:line))(SimpleName:split)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:path)(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:firstLineTokens)(NumberLiteral:1))))))(VariableDeclarationStatement(SimpleType(SimpleName:Properties))(VariableDeclarationFragment(SimpleName:p)(ClassInstanceCreation(SimpleType(SimpleName:Properties)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:1)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:requestLines.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(Assignment(SimpleName:line)(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:requestLines)(SimpleName:i))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:firstColon)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:line))(SimpleName:indexOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:firstColon)(INFIX_EXPRESSION_OPERATOR:!=)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:setProperty)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:line))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)(SimpleName:firstColon))))(SimpleName:trim))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:line))(SimpleName:substring)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:firstColon)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:1)))))(SimpleName:trim)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:prop)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:prop)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prop))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(Block(ExpressionStatement(Assignment(SimpleName:isWebSocketRequest)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))))(ExpressionStatement(Assignment(SimpleName:prop)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:prop)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:prop))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(Block(ExpressionStatement(Assignment(SimpleName:isWebSocketRequest)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:key1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:key2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:headerPrefix)(StringLiteral:<STR>)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:responseChallenge)(NullLiteral)))(SwitchStatement(FieldAccess(ThisExpression)(SimpleName:draft))(SwitchCase(SimpleName:DRAFT75))(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:key1)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:key2)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:key3)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:isWebSocketRequest)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))))(BreakStatement)(SwitchCase(SimpleName:DRAFT76))(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:key1)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:key2)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:key3)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:isWebSocketRequest)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))))(BreakStatement))(IfStatement(SimpleName:isWebSocketRequest)(Block(IfStatement(InfixExpression(InfixExpression(InfixExpression(SimpleName:key1)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:key2)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:key3)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:headerPrefix)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:part1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getPart)(METHOD_INVOCATION_ARGUMENTS(SimpleName:key1)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:part2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getPart)(METHOD_INVOCATION_ARGUMENTS(SimpleName:key2)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:challenge)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:16))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:part1)(NumberLiteral:0))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:part1)(NumberLiteral:1))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:part1)(NumberLiteral:2))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:3))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:part1)(NumberLiteral:3))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:4))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:part2)(NumberLiteral:0))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:5))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:part2)(NumberLiteral:1))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:6))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:part2)(NumberLiteral:2))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:7))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:part2)(NumberLiteral:3))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:8))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:key3)(NumberLiteral:0))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:9))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:key3)(NumberLiteral:1))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:10))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:key3)(NumberLiteral:2))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:11))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:key3)(NumberLiteral:3))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:12))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:key3)(NumberLiteral:4))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:13))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:key3)(NumberLiteral:5))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:14))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:key3)(NumberLiteral:6))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:challenge)(NumberLiteral:15))(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:key3)(NumberLiteral:7))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md5)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:responseChallenge)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md5))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:challenge)))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:responseHandshake)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:responseHandshake)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(SimpleName:headerPrefix)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:responseHandshake)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(SimpleName:headerPrefix)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(SimpleName:path)(StringLiteral:<STR>))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:containsKey)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:headerPrefix)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))(Block(ExpressionStatement(Assignment(SimpleName:responseHandshake)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(SimpleName:headerPrefix)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(StringLiteral:<STR>))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:containsKey)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:responseHandshake)(ASSIGNMENT_OPERATOR:+=)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:p))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(StringLiteral:<STR>))))))(ExpressionStatement(Assignment(SimpleName:responseHandshake)(ASSIGNMENT_OPERATOR:+=)(StringLiteral:<STR>)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:conn))(SimpleName:socketChannel)))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:wrap)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:responseHandshake))(SimpleName:getBytes)))))))(IfStatement(InfixExpression(SimpleName:responseChallenge)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:conn))(SimpleName:socketChannel)))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:wrap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:responseChallenge))))))))(ReturnStatement(BooleanLiteral:true))))(ReturnStatement(BooleanLiteral:false))))))