(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:final)(PrimitiveType:void)(SimpleName:handleRequest)(SingleVariableDeclaration(MarkerAnnotation(SimpleName:Nonnull))(Modifier:final)(SimpleType(SimpleName:SocketChannel))(SimpleName:inChannel))(SingleVariableDeclaration(MarkerAnnotation(SimpleName:Nonnull))(Modifier:final)(SimpleType(SimpleName:Socket))(SimpleName:socket))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:StopWatch))(VariableDeclarationFragment(SimpleName:sw)(ClassInstanceCreation(SimpleType(SimpleName:StopWatch)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inChannel))(SimpleName:isBlocking)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inChannel))(SimpleName:configureBlocking)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:in)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:socket))(SimpleName:getInputStream))))(VariableDeclarationStatement(SimpleType(SimpleName:DataInputStream))(VariableDeclarationFragment(SimpleName:dis)(ClassInstanceCreation(SimpleType(SimpleName:DataInputStream))(SimpleName:in))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:fname)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtils))(SimpleName:readString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dis)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:dirPath)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtils))(SimpleName:readString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dis)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:len)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readLong))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:append)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readBoolean))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:ackRequired)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readBoolean))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:hasAdditionalHeader)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dis))(SimpleName:readBoolean))))(IfStatement(SimpleName:hasAdditionalHeader)(Block(ExpressionStatement(MethodInvocation(SimpleName:readAdditionalHeader)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dis)(SimpleName:fname)(SimpleName:dirPath)(SimpleName:len)(SimpleName:append)(SimpleName:ackRequired))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:file)))(IfStatement(InfixExpression(SimpleName:dirPath)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:file)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:baseDir)(SimpleName:fname)))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:dir)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:resolvePath)(METHOD_INVOCATION_ARGUMENTS(SimpleName:baseDir)(SimpleName:dirPath)))))(ExpressionStatement(Assignment(SimpleName:file)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:dir)(SimpleName:fname))))))(ExpressionStatement(MethodInvocation(SimpleName:preFileAppend)(METHOD_INVOCATION_ARGUMENTS(SimpleName:file)(SimpleName:append))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:dst)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:file)(SimpleName:append))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:fp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:file))(SimpleName:getAbsolutePath))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:ReadWriteLock))(VariableDeclarationFragment(SimpleName:filelock)(MethodInvocation(SimpleName:accquireLock)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fp)(SimpleName:locks)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:FileChannel))(VariableDeclarationFragment(SimpleName:fileCh)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dst))(SimpleName:getChannel))))(VariableDeclarationStatement(Modifier:final)(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:startPos)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:file))(SimpleName:length))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NIOUtils))(SimpleName:transferFullyFrom)(METHOD_INVOCATION_ARGUMENTS(SimpleName:inChannel)(NumberLiteral:0)(SimpleName:len)(SimpleName:fileCh)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtils))(SimpleName:closeQuietly)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fileCh)(SimpleName:dst))))(ExpressionStatement(MethodInvocation(SimpleName:releaseLock)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fp)(SimpleName:filelock)(SimpleName:locks))))(ExpressionStatement(MethodInvocation(SimpleName:postFileAppend)(METHOD_INVOCATION_ARGUMENTS(SimpleName:file)(SimpleName:startPos)(SimpleName:len))))))(IfStatement(SimpleName:ackRequired)(Block(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:out)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:socket))(SimpleName:getOutputStream))))(VariableDeclarationStatement(SimpleType(SimpleName:DataOutputStream))(VariableDeclarationFragment(SimpleName:dos)(ClassInstanceCreation(SimpleType(SimpleName:DataOutputStream))(SimpleName:out))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dos))(SimpleName:writeLong)(METHOD_INVOCATION_ARGUMENTS(SimpleName:len))))(ExpressionStatement(MethodInvocation(SimpleName:postAck)(METHOD_INVOCATION_ARGUMENTS(SimpleName:file)(SimpleName:startPos)(SimpleName:len))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:isDebugEnabled))(Block(VariableDeclarationStatement(SimpleType(SimpleName:SocketAddress))(VariableDeclarationFragment(SimpleName:remoteAddr)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:socket))(SimpleName:getRemoteSocketAddress))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(ConditionalExpression(SimpleName:append)(StringLiteral:<STR>)(StringLiteral:<STR>)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:file))(SimpleName:getAbsolutePath))(StringLiteral:<STR>)(SimpleName:len)(StringLiteral:<STR>)(SimpleName:remoteAddr)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sw))(SimpleName:toString))))))))))))