(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Test))(Modifier:public)(PrimitiveType:void)(SimpleName:testSignEnvelopingDocument)(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:EnvelopedSignatureFacet))(VariableDeclarationFragment(SimpleName:envelopedSignatureFacet)(ClassInstanceCreation(SimpleType(SimpleName:EnvelopedSignatureFacet)))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyInfoSignatureFacet))(VariableDeclarationFragment(SimpleName:keyInfoSignatureFacet)(ClassInstanceCreation(SimpleType(SimpleName:KeyInfoSignatureFacet))(BooleanLiteral:true)(BooleanLiteral:false)(BooleanLiteral:false))))(VariableDeclarationStatement(SimpleType(SimpleName:SignaturePolicyService))(VariableDeclarationFragment(SimpleName:signaturePolicyService)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:XAdESSignatureFacet))(VariableDeclarationFragment(SimpleName:xadesSignatureFacet)(ClassInstanceCreation(SimpleType(SimpleName:XAdESSignatureFacet))(SimpleName:signaturePolicyService))))(VariableDeclarationStatement(SimpleType(SimpleName:TimeStampService))(VariableDeclarationFragment(SimpleName:mockTimeStampService)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:createMock)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:TimeStampService)))))))(VariableDeclarationStatement(SimpleType(SimpleName:RevocationDataService))(VariableDeclarationFragment(SimpleName:mockRevocationDataService)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:createMock)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:RevocationDataService)))))))(VariableDeclarationStatement(SimpleType(SimpleName:XAdESXLSignatureFacet))(VariableDeclarationFragment(SimpleName:xadesXLSignatureFacet)(ClassInstanceCreation(SimpleType(SimpleName:XAdESXLSignatureFacet))(SimpleName:mockTimeStampService)(SimpleName:mockRevocationDataService))))(VariableDeclarationStatement(SimpleType(SimpleName:XmlSignatureTestService))(VariableDeclarationFragment(SimpleName:testedInstance)(ClassInstanceCreation(SimpleType(SimpleName:XmlSignatureTestService))(SimpleName:envelopedSignatureFacet)(SimpleName:keyInfoSignatureFacet)(SimpleName:xadesSignatureFacet)(SimpleName:xadesXLSignatureFacet))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:keyPair)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PkiTestUtils))(SimpleName:generateKeyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:DateTime))(VariableDeclarationFragment(SimpleName:notBefore)(ClassInstanceCreation(SimpleType(SimpleName:DateTime)))))(VariableDeclarationStatement(SimpleType(SimpleName:DateTime))(VariableDeclarationFragment(SimpleName:notAfter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:notBefore))(SimpleName:plusYears)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:certificate)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PkiTestUtils))(SimpleName:generateCertificate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic))(StringLiteral:<STR>)(SimpleName:notBefore)(SimpleName:notAfter)(NullLiteral)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate))(BooleanLiteral:true)(NumberLiteral:0)(NullLiteral)(NullLiteral)(ClassInstanceCreation(SimpleType(SimpleName:KeyUsage))(QualifiedName:KeyUsage.nonRepudiation))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:X509Certificate)))(VariableDeclarationFragment(SimpleName:certificateChain)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:LinkedList))(SimpleType(SimpleName:X509Certificate))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificateChain))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate))))(VariableDeclarationStatement(SimpleType(SimpleName:RevocationData))(VariableDeclarationFragment(SimpleName:revocationData)(ClassInstanceCreation(SimpleType(SimpleName:RevocationData)))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:X509CRL))(VariableDeclarationFragment(SimpleName:crl)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PkiTestUtils))(SimpleName:generateCrl)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:revocationData))(SimpleName:addCRL)(METHOD_INVOCATION_ARGUMENTS(SimpleName:crl))))(VariableDeclarationStatement(SimpleType(SimpleName:OCSPResp))(VariableDeclarationFragment(SimpleName:ocspResp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PkiTestUtils))(SimpleName:createOcspResp)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate)(BooleanLiteral:false)(SimpleName:certificate)(SimpleName:certificate)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:revocationData))(SimpleName:addOCSP)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ocspResp))(SimpleName:getEncoded)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:expect)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mockTimeStampService))(SimpleName:timeStamp)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:anyObject)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(ArrayType(PrimitiveType:byte)(Dimension)))))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:anyObject)(METHOD_INVOCATION_ARGUMENTS(TypeLiteral(SimpleType(SimpleName:RevocationData))))))))))(SimpleName:andStubAnswer)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:IAnswer))(ArrayType(PrimitiveType:byte)(Dimension)))(AnonymousClassDeclaration(MethodDeclaration(Modifier:public)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:answer)(SimpleType(SimpleName:Throwable))(Block(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Object))(Dimension))(VariableDeclarationFragment(SimpleName:arguments)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:getCurrentArguments))))(VariableDeclarationStatement(SimpleType(SimpleName:RevocationData))(VariableDeclarationFragment(SimpleName:revocationData)(CastExpression(SimpleType(SimpleName:RevocationData))(ArrayAccess(SimpleName:arguments)(NumberLiteral:1)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:revocationData))(SimpleName:addCRL)(METHOD_INVOCATION_ARGUMENTS(SimpleName:crl))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:getBytes))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:expect)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mockRevocationDataService))(SimpleName:getRevocationData)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:eq)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificateChain))))))))(SimpleName:andStubReturn)(METHOD_INVOCATION_ARGUMENTS(SimpleName:revocationData))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:replay)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mockTimeStampService)(SimpleName:mockRevocationDataService))))(VariableDeclarationStatement(SimpleType(SimpleName:DigestInfo))(VariableDeclarationFragment(SimpleName:digestInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:testedInstance))(SimpleName:preSign)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:certificateChain)))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestInfo))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(QualifiedName:digestInfo.digestAlgo))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:digestInfo.digestValue))))(VariableDeclarationStatement(SimpleType(SimpleName:TemporaryTestDataStorage))(VariableDeclarationFragment(SimpleName:temporaryDataStorage)(CastExpression(SimpleType(SimpleName:TemporaryTestDataStorage))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:testedInstance))(SimpleName:getTemporaryDataStorage)))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:temporaryDataStorage))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:tempInputStream)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:temporaryDataStorage))(SimpleName:getTempInputStream))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tempInputStream))))(VariableDeclarationStatement(SimpleType(SimpleName:Document))(VariableDeclarationFragment(SimpleName:tmpDocument)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PkiTestUtils))(SimpleName:loadDocument)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tempInputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PkiTestUtils))(SimpleName:toString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmpDocument)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:nsElement)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpDocument))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nsElement))(SimpleName:setAttributeNS)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.NamespaceSpecNS)(StringLiteral:<STR>)(QualifiedName:Constants.SignatureSpecNS))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:nsElement))(SimpleName:setAttributeNS)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.NamespaceSpecNS)(StringLiteral:<STR>)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:Node))(VariableDeclarationFragment(SimpleName:digestValueNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XPathAPI))(SimpleName:selectSingleNode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmpDocument)(StringLiteral:<STR>)(SimpleName:nsElement)))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestValueNode))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:digestValueTextContent)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestValueNode))(SimpleName:getTextContent))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:digestValueTextContent)))))(ExpressionStatement(MethodInvocation(SimpleName:assertFalse)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestValueTextContent))(SimpleName:isEmpty)))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:cipher)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digestInfoValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ArrayUtils))(SimpleName:addAll)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PkiTestUtils.SHA1_DIGEST_INFO_PREFIX)(QualifiedName:digestInfo.digestValue)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:signatureValue)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:doFinal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestInfoValue)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:testedInstance))(SimpleName:postSign)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureValue)(SimpleName:certificateChain))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EasyMock))(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mockTimeStampService)(SimpleName:mockRevocationDataService))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:signedDocumentData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:testedInstance))(SimpleName:getSignedDocumentData))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedDocumentData))))(VariableDeclarationStatement(SimpleType(SimpleName:Document))(VariableDeclarationFragment(SimpleName:signedDocument)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PkiTestUtils))(SimpleName:loadDocument)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayInputStream))(SimpleName:signedDocumentData))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PkiTestUtils))(SimpleName:toString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedDocument)))))))(VariableDeclarationStatement(SimpleType(SimpleName:NodeList))(VariableDeclarationFragment(SimpleName:signatureNodeList)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedDocument))(SimpleName:getElementsByTagNameNS)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:XMLSignature.XMLNS)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(SimpleName:assertEquals)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureNodeList))(SimpleName:getLength)))))(VariableDeclarationStatement(SimpleType(SimpleName:Node))(VariableDeclarationFragment(SimpleName:signatureNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureNodeList))(SimpleName:item)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:0)))))(VariableDeclarationStatement(SimpleType(SimpleName:DOMValidateContext))(VariableDeclarationFragment(SimpleName:domValidateContext)(ClassInstanceCreation(SimpleType(SimpleName:DOMValidateContext))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeySelector))(SimpleName:singletonKeySelector)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic))))(SimpleName:signatureNode))))(VariableDeclarationStatement(SimpleType(SimpleName:XMLSignatureFactory))(VariableDeclarationFragment(SimpleName:xmlSignatureFactory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMLSignatureFactory))(SimpleName:getInstance))))(VariableDeclarationStatement(SimpleType(SimpleName:XMLSignature))(VariableDeclarationFragment(SimpleName:xmlSignature)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignatureFactory))(SimpleName:unmarshalXMLSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:domValidateContext)))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:validity)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:validate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:domValidateContext)))))(ExpressionStatement(MethodInvocation(SimpleName:assertTrue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:validity))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:tmpFile)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:File))(SimpleName:createTempFile)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtils))(SimpleName:writeStringToFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tmpFile)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PkiTestUtils))(SimpleName:toString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedDocument))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpFile))(SimpleName:getAbsolutePath))))))(VariableDeclarationStatement(SimpleType(SimpleName:Node))(VariableDeclarationFragment(SimpleName:resultNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XPathAPI))(SimpleName:selectSingleNode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedDocument)(StringLiteral:<STR>)(SimpleName:nsElement)))))(ExpressionStatement(MethodInvocation(SimpleName:assertNotNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:resultNode))))(VariableDeclarationStatement(SimpleType(SimpleName:Node))(VariableDeclarationFragment(SimpleName:qualifyingPropertiesNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XPathAPI))(SimpleName:selectSingleNode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedDocument)(StringLiteral:<STR>)(SimpleName:nsElement)))))(VariableDeclarationStatement(SimpleType(SimpleName:SchemaFactory))(VariableDeclarationFragment(SimpleName:factory)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SchemaFactory))(SimpleName:newInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:LSResourceResolver))(VariableDeclarationFragment(SimpleName:xadesResourceResolver)(ClassInstanceCreation(SimpleType(SimpleName:XAdESLSResourceResolver)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:factory))(SimpleName:setResourceResolver)(METHOD_INVOCATION_ARGUMENTS(SimpleName:xadesResourceResolver))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:schemaInputStream)(MethodInvocation(METHOD_INVOCATION_RECEIVER(TypeLiteral(SimpleType(SimpleName:XAdESSignatureFacetTest))))(SimpleName:getResourceAsStream)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Source))(VariableDeclarationFragment(SimpleName:schemaSource)(ClassInstanceCreation(SimpleType(SimpleName:StreamSource))(SimpleName:schemaInputStream))))(VariableDeclarationStatement(SimpleType(SimpleName:Schema))(VariableDeclarationFragment(SimpleName:schema)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:factory))(SimpleName:newSchema)(METHOD_INVOCATION_ARGUMENTS(SimpleName:schemaSource)))))(VariableDeclarationStatement(SimpleType(SimpleName:Validator))(VariableDeclarationFragment(SimpleName:validator)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:schema))(SimpleName:newValidator))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:validator))(SimpleName:validate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:DOMSource))(SimpleName:qualifyingPropertiesNode)))))(VariableDeclarationStatement(SimpleType(SimpleName:StreamSource))(VariableDeclarationFragment(SimpleName:streamSource)(ClassInstanceCreation(SimpleType(SimpleName:StreamSource))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:tmpFile))(SimpleName:toURI)))(SimpleName:toString)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:resultOutputStream)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:StreamResult))(VariableDeclarationFragment(SimpleName:streamResult)(ClassInstanceCreation(SimpleType(SimpleName:StreamResult))(SimpleName:resultOutputStream))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LOG))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:resultOutputStream)))))))))