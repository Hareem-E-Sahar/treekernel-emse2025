(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(PrimitiveType:void)(SimpleName:send)(SingleVariableDeclaration(ArrayType(PrimitiveType:int)(Dimension))(SimpleName:targets))(SingleVariableDeclaration(SimpleType(SimpleName:TOMMessage))(SimpleName:sm))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:serializeClassHeaders))(Block(VariableDeclarationStatement(SimpleType(SimpleName:DataOutputStream))(VariableDeclarationFragment(SimpleName:dos)(NullLiteral)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:baos)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(Assignment(SimpleName:dos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DataOutputStream))(SimpleName:baos))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sm))(SimpleName:wExternal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:dos))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dos))(SimpleName:flush)))(ExpressionStatement(Assignment(SimpleName:data)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:baos))(SimpleName:toByteArray))))(ExpressionStatement(Assignment(QualifiedName:sm.serializedMessage)(ASSIGNMENT_OPERATOR:=)(SimpleName:data))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dos))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:ex))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ex))(SimpleName:getMessage)))))))))))(ExpressionStatement(Assignment(QualifiedName:sm.signed)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))(IfStatement(QualifiedName:sm.signed)(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:data2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TOMUtil))(SimpleName:signMessage)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manager))(SimpleName:getStaticConf)))(SimpleName:getRSAPrivateKey))(SimpleName:data)))))(ExpressionStatement(Assignment(QualifiedName:sm.serializedMessageSignature)(ASSIGNMENT_OPERATOR:=)(SimpleName:data2)))))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:targets.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rl))(SimpleName:readLock)))(SimpleName:lock)))(VariableDeclarationStatement(SimpleType(SimpleName:NettyClientServerSession))(VariableDeclarationFragment(SimpleName:ncss)(CastExpression(SimpleType(SimpleName:NettyClientServerSession))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sessionTable))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:targets)(SimpleName:i)))))))(IfStatement(InfixExpression(SimpleName:ncss)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:Channel))(VariableDeclarationFragment(SimpleName:session)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ncss))(SimpleName:getChannel))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rl))(SimpleName:readLock)))(SimpleName:unlock)))(ExpressionStatement(Assignment(QualifiedName:sm.destination)(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:targets)(SimpleName:i))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sendLock))(SimpleName:lock)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:session))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sm))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sendLock))(SimpleName:unlock))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:rl))(SimpleName:readLock)))(SimpleName:unlock)))))))))))