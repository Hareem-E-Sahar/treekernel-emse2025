(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:decryptDocument)(SingleVariableDeclaration(SimpleType(SimpleName:PDDocument))(SimpleName:doc))(SingleVariableDeclaration(SimpleType(SimpleName:DecryptionMaterial))(SimpleName:decryptionMaterial))(SimpleType(SimpleName:CryptographyException))(SimpleType(SimpleName:IOException))(Block(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:document))(ASSIGNMENT_OPERATOR:=)(SimpleName:doc)))(VariableDeclarationStatement(SimpleType(SimpleName:PDEncryptionDictionary))(VariableDeclarationFragment(SimpleName:dictionary)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:getEncryptionDictionary))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:getLength))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0))(Block(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:keyLength))(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:getLength))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(ParenthesizedExpression(InstanceofExpression(SimpleName:decryptionMaterial)(SimpleType(SimpleName:PublicKeyDecryptionMaterial)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKeyDecryptionMaterial))(VariableDeclarationFragment(SimpleName:material)(CastExpression(SimpleType(SimpleName:PublicKeyDecryptionMaterial))(SimpleName:decryptionMaterial))))(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:foundRecipient)(BooleanLiteral:false)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:envelopedData)(NullLiteral)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension)(Dimension))(VariableDeclarationFragment(SimpleName:recipientFieldsBytes)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:getRecipientsLength)))(Dimension)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:recipientFieldsLength)(NumberLiteral:0)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:getRecipientsLength)))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:COSString))(VariableDeclarationFragment(SimpleName:recipientFieldString)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dictionary))(SimpleName:getRecipientStringAt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:i)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:recipientBytes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:recipientFieldString))(SimpleName:getBytes))))(VariableDeclarationStatement(SimpleType(SimpleName:CMSEnvelopedData))(VariableDeclarationFragment(SimpleName:data)(ClassInstanceCreation(SimpleType(SimpleName:CMSEnvelopedData))(SimpleName:recipientBytes))))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:recipCertificatesIt)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data))(SimpleName:getRecipientInfos)))(SimpleName:getRecipients)))(SimpleName:iterator))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:recipCertificatesIt))(SimpleName:hasNext))(Block(VariableDeclarationStatement(SimpleType(SimpleName:RecipientInformation))(VariableDeclarationFragment(SimpleName:ri)(CastExpression(SimpleType(SimpleName:RecipientInformation))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:recipCertificatesIt))(SimpleName:next)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ri))(SimpleName:getRID)))(SimpleName:match)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:material))(SimpleName:getCertificate))))(INFIX_EXPRESSION_OPERATOR:&&)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:foundRecipient)))(Block(ExpressionStatement(Assignment(SimpleName:foundRecipient)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ExpressionStatement(Assignment(SimpleName:envelopedData)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ri))(SimpleName:getContent)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:material))(SimpleName:getPrivateKey))(StringLiteral:<STR>)))))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:recipientFieldsBytes)(SimpleName:i))(ASSIGNMENT_OPERATOR:=)(SimpleName:recipientBytes)))(ExpressionStatement(Assignment(SimpleName:recipientFieldsLength)(ASSIGNMENT_OPERATOR:+=)(QualifiedName:recipientBytes.length)))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:foundRecipient))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:envelopedData)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(QualifiedName:envelopedData.length)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:24))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:accessBytes)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:4))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:envelopedData)(NumberLiteral:20)(SimpleName:accessBytes)(NumberLiteral:0)(NumberLiteral:4))))(ExpressionStatement(Assignment(SimpleName:currentAccessPermission)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:AccessPermission))(SimpleName:accessBytes))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:currentAccessPermission))(SimpleName:setReadOnly)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:sha1Input)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:recipientFieldsLength)(INFIX_EXPRESSION_OPERATOR:+)(NumberLiteral:20)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:envelopedData)(NumberLiteral:0)(SimpleName:sha1Input)(NumberLiteral:0)(NumberLiteral:20))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:sha1InputOffset)(NumberLiteral:20)))(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:recipientFieldsBytes.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:recipientFieldsBytes)(SimpleName:i))(NumberLiteral:0)(SimpleName:sha1Input)(SimpleName:sha1InputOffset)(FieldAccess(ArrayAccess(SimpleName:recipientFieldsBytes)(SimpleName:i))(SimpleName:length)))))(ExpressionStatement(Assignment(SimpleName:sha1InputOffset)(ASSIGNMENT_OPERATOR:+=)(FieldAccess(ArrayAccess(SimpleName:recipientFieldsBytes)(SimpleName:i))(SimpleName:length))))))(VariableDeclarationStatement(SimpleType(SimpleName:MessageDigest))(VariableDeclarationFragment(SimpleName:md)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:mdResult)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sha1Input)))))(ExpressionStatement(Assignment(SimpleName:encryptionKey)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(FieldAccess(ThisExpression)(SimpleName:keyLength))(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:8)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mdResult)(NumberLiteral:0)(SimpleName:encryptionKey)(NumberLiteral:0)(InfixExpression(FieldAccess(ThisExpression)(SimpleName:keyLength))(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:8)))))(ExpressionStatement(MethodInvocation(SimpleName:proceedDecryption))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:CMSException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:KeyStoreException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchProviderException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(SimpleName:e)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:CryptographyException))(SimpleName:e))))))))))