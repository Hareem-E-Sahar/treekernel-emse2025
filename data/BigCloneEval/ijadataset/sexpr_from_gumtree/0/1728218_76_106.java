(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:write)(SingleVariableDeclaration(ArrayType(PrimitiveType:char)(Dimension))(SimpleName:buf))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:offset))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:len))(SimpleType(SimpleName:IOException))(Block(SynchronizedStatement(SimpleName:lock)(Block(IfStatement(InfixExpression(SimpleName:enc)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:lastLen)(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))(WhileStatement(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:allowed)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Math))(SimpleName:min)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:charBuffer))(SimpleName:remaining))(SimpleName:len)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:charBuffer))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(SimpleName:offset)(SimpleName:allowed))))(ExpressionStatement(Assignment(SimpleName:offset)(ASSIGNMENT_OPERATOR:+=)(SimpleName:allowed)))(ExpressionStatement(Assignment(SimpleName:len)(ASSIGNMENT_OPERATOR:-=)(SimpleName:allowed)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:charBuffer))(SimpleName:flip)))(IfStatement(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:lastLen))(Block(IfStatement(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:<=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:charBuffer))(SimpleName:remaining)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:charBuffer))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(SimpleName:offset)(SimpleName:len))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:charBuffer))(SimpleName:flip))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:CharBuffer))(VariableDeclarationFragment(SimpleName:ncb)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CharBuffer))(SimpleName:allocate)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:charBuffer))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:len))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ncb))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:charBuffer))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ncb))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:buf)(SimpleName:offset)(SimpleName:len))))(ExpressionStatement(Assignment(SimpleName:charBuffer)(ASSIGNMENT_OPERATOR:=)(SimpleName:ncb)))))(BreakStatement)))(ExpressionStatement(Assignment(SimpleName:lastLen)(ASSIGNMENT_OPERATOR:=)(SimpleName:len)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:byteBuffer))(SimpleName:clear)))(VariableDeclarationStatement(SimpleType(SimpleName:CoderResult))(VariableDeclarationFragment(SimpleName:res)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:enc))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:charBuffer)(SimpleName:byteBuffer)(BooleanLiteral:false)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:charBuffer))(SimpleName:compact)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:isError))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:isMalformed))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:isUnmappable)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:throwException))))(ExpressionStatement(MethodInvocation(SimpleName:writeBuffer)))))))))))