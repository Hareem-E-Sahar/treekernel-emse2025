(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:generateNewCASignedKeystore)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:ksLocation))(SingleVariableDeclaration(ArrayType(PrimitiveType:char)(Dimension))(SimpleName:ksPass))(SingleVariableDeclaration(SimpleType(SimpleName:Provider))(SimpleName:provider))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:caKSLocation))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:caKSAlias))(SingleVariableDeclaration(ArrayType(PrimitiveType:char)(Dimension))(SimpleName:caKSPass))(SingleVariableDeclaration(SimpleType(SimpleName:Provider))(SimpleName:caProvider))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:caType))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:caSigAlg))(SingleVariableDeclaration(ParameterizedType(SimpleType(SimpleName:Vector))(SimpleType(SimpleName:KeyDefinition)))(SimpleName:keys))(SimpleType(SimpleName:KeyStoreException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:CertificateException))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:caChain)))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:chain)))(VariableDeclarationStatement(SimpleType(SimpleName:KeyDefinition))(VariableDeclarationFragment(SimpleName:key)))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:caKey)))(VariableDeclarationStatement(SimpleType(SimpleName:SignKey))(VariableDeclarationFragment(SimpleName:signer)))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:newKSFile)))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:alias)))(VariableDeclarationStatement(SimpleType(SimpleName:Iterator))(VariableDeclarationFragment(SimpleName:it)))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:signedCert)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:trustedCert)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:cert)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:FileOutputStream))(VariableDeclarationFragment(SimpleName:fos)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:newKS)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:caKS)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:pair)(NullLiteral)))(TryStatement(Block(IfStatement(InfixExpression(SimpleName:provider)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:newKS)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:provider))))))(Block(ExpressionStatement(Assignment(SimpleName:newKS)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:KeyStoreException))(SimpleName:kse))(Block(IfStatement(InfixExpression(SimpleName:provider)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeyStoreException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeyStoreException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IllegalArgumentException))(SimpleName:iae))(Block(IfStatement(InfixExpression(SimpleName:provider)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalArgumentException))(StringLiteral:<STR>))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeyStoreException))(StringLiteral:<STR>))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newKS))(SimpleName:load)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(SimpleName:ksPass))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:caKS)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:openJKS)(METHOD_INVOCATION_ARGUMENTS(SimpleName:caKSLocation)(SimpleName:caKSPass)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:caKS))(SimpleName:isKeyEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:caKSAlias))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:Exception))(StringLiteral:<STR>)))))(ExpressionStatement(Assignment(SimpleName:caChain)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:caKS))(SimpleName:getCertificateChain)(METHOD_INVOCATION_ARGUMENTS(SimpleName:caKSAlias)))))(IfStatement(InfixExpression(SimpleName:caChain)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:Exception))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))))))(ExpressionStatement(Assignment(SimpleName:trustedCert)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:X509Certificate))(ParenthesizedExpression(ArrayAccess(SimpleName:caChain)(InfixExpression(QualifiedName:caChain.length)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1)))))))(ExpressionStatement(Assignment(SimpleName:caKey)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:PrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:caKS))(SimpleName:getKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:caKSAlias)(SimpleName:caKSPass))))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:caKey))(SimpleName:getAlgorithm)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:caType))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:Exception))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:caType)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:caKey))(SimpleName:getAlgorithm))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:caKey))(SimpleName:getAlgorithm))(StringLiteral:<STR>))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newKS))(SimpleName:setCertificateEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:caKSAlias)(SimpleName:trustedCert)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeyStoreException))(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:caKSAlias)(StringLiteral:<STR>)(SimpleName:caKSLocation)(StringLiteral:<STR>)(SimpleName:ksLocation)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))(ExpressionStatement(Assignment(SimpleName:it)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keys))(SimpleName:iterator))))(WhileStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:hasNext))(Block(ExpressionStatement(Assignment(SimpleName:key)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:KeyDefinition))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:it))(SimpleName:next)))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:pair)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:generateKeyPair)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getType))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getKeysize))(SimpleName:provider)))))(ExpressionStatement(Assignment(SimpleName:cert)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:generateCertificate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getDNameObject))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getDNameObject))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getValidity))(SimpleName:caSigAlg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pair))(SimpleName:getPublic))))))(ExpressionStatement(Assignment(SimpleName:chain)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(SimpleType(SimpleName:Certificate))(Dimension(NumberLiteral:1))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:chain)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(SimpleName:cert)))(ExpressionStatement(Assignment(SimpleName:alias)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getAlias)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeyStoreException))(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getAlias))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getName))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))(ExpressionStatement(Assignment(SimpleName:signer)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SignKey)))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:signedCert)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signer))(SimpleName:sign)(METHOD_INVOCATION_ARGUMENTS(SimpleName:trustedCert)(SimpleName:caKey)(SimpleName:cert)(SimpleName:caSigAlg)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getUsageArray))(NullLiteral))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeyStoreException))(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getAlias))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getName))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))(ExpressionStatement(Assignment(SimpleName:chain)(ASSIGNMENT_OPERATOR:=)(ArrayCreation(ArrayType(SimpleType(SimpleName:Certificate))(Dimension(NumberLiteral:2))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:chain)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(SimpleName:signedCert)))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:chain)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(SimpleName:trustedCert)))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newKS))(SimpleName:setKeyEntry)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pair))(SimpleName:getPrivate))(SimpleName:ksPass)(SimpleName:chain)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeyStoreException))(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getAlias))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getName))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))))(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:newKSFile)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:ksLocation))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newKSFile))(SimpleName:createNewFile)))(ExpressionStatement(Assignment(SimpleName:fos)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:FileOutputStream))(SimpleName:newKSFile))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newKS))(SimpleName:store)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fos)(SimpleName:ksPass))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fos))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:KeyStoreException))(InfixExpression(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ksLocation)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))))))))))))