(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(Modifier:synchronized)(SimpleType(SimpleName:KeyStore))(SimpleName:readLocalStore)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:ksp))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:cp))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:typ))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:provider))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:GeneralSecurityException))(SimpleType(SimpleName:PkiException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:kp)))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:cert)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStore))(VariableDeclarationFragment(SimpleName:ks)))(ExpressionStatement(Assignment(SimpleName:ks)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyStore))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:typ)(SimpleName:provider)))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:keyStoreFile)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:ksp))))(VariableDeclarationStatement(SimpleType(SimpleName:File))(VariableDeclarationFragment(SimpleName:certFile)(ClassInstanceCreation(SimpleType(SimpleName:File))(SimpleName:cp))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyStoreFile))(SimpleName:exists))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:load)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:FileInputStream))(SimpleName:keyStoreFile))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:password))(SimpleName:toCharArray)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certFile))(SimpleName:exists))(Block(VariableDeclarationStatement(SimpleType(SimpleName:PEMReader))(VariableDeclarationFragment(SimpleName:pr)(ClassInstanceCreation(SimpleType(SimpleName:PEMReader))(ClassInstanceCreation(SimpleType(SimpleName:FileReader))(SimpleName:certFile)))))(ExpressionStatement(Assignment(SimpleName:cert)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:X509Certificate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pr))(SimpleName:readObject)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pr))(SimpleName:close)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:checkValidity)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:cp)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:key1)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:getCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias))))(SimpleName:getPublicKey))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:key2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cert))(SimpleName:getPublicKey))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key1))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:key2))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:GeneralSecurityException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Key))(VariableDeclarationFragment(SimpleName:key)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:getKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:password))(SimpleName:toCharArray))))))(ExpressionStatement(Assignment(SimpleName:ks)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:saveLocalStore)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cert)(CastExpression(SimpleType(SimpleName:PrivateKey))(SimpleName:key))(SimpleName:ksp)(SimpleName:typ)(SimpleName:provider))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:ksp)(StringLiteral:<STR>)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:keyType)(StringLiteral:<STR>)(StringLiteral:<STR>)(SimpleName:keySize)(StringLiteral:<STR>)(SimpleName:isCa)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ks))(SimpleName:load)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(NullLiteral))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPairGenerator))(VariableDeclarationFragment(SimpleName:keyGen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyPairGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keyType)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyGen))(SimpleName:initialize)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Integer))(SimpleName:parseInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:keySize))))))(ExpressionStatement(Assignment(SimpleName:kp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyGen))(SimpleName:generateKeyPair))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:reset)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:setSerialNumber)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BigInteger))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:setIssuerDN)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:X509Name))(SimpleName:dn)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:setNotBefore)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Date))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:setNotAfter)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Date))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:currentTimeMillis))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:maxValidLong))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:notbefore)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:getAsDate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Config))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Config.NOT_BEFORE)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Date))(VariableDeclarationFragment(SimpleName:notafter)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Util))(SimpleName:getAsDate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Config))(SimpleName:getProperty)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Config.NOT_AFTER)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:setNotBefore)(METHOD_INVOCATION_ARGUMENTS(SimpleName:notbefore))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:setNotAfter)(METHOD_INVOCATION_ARGUMENTS(SimpleName:notafter)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:PkiException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage)))(SimpleName:e))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:setSubjectDN)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:X509Name))(SimpleName:dn)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:setPublicKey)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kp))(SimpleName:getPublic)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:setSignatureAlgorithm)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureAlgorithm))))(IfStatement(SimpleName:isCa)(Block(ExpressionStatement(MethodInvocation(SimpleName:setCaExtensions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:kp))))))(IfStatement(SimpleName:isRa)(Block(ExpressionStatement(MethodInvocation(SimpleName:setRaExtensions)(METHOD_INVOCATION_ARGUMENTS(SimpleName:kp))))))(ExpressionStatement(Assignment(SimpleName:cert)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:v3CertGen))(SimpleName:generateX509Certificate)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:PrivateKey))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kp))(SimpleName:getPrivate)))))))(ExpressionStatement(Assignment(SimpleName:ks)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:saveLocalStore)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cert)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:kp))(SimpleName:getPrivate))(SimpleName:ksp)(SimpleName:typ)(SimpleName:provider)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certFile))(SimpleName:createNewFile))(Block(VariableDeclarationStatement(SimpleType(SimpleName:PEMWriter))(VariableDeclarationFragment(SimpleName:pr)(ClassInstanceCreation(SimpleType(SimpleName:PEMWriter))(ClassInstanceCreation(SimpleType(SimpleName:FileWriter))(SimpleName:certFile)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pr))(SimpleName:writeObject)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cert))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pr))(SimpleName:close))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:cp)))))))))(ReturnStatement(SimpleName:ks))))))