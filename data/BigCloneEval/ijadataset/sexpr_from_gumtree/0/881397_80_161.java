(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:singleSign)(SingleVariableDeclaration(Modifier:final)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:data))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:Alias))(SimpleName:alias))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Assert))(SimpleName:notEmpty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:data)(StringLiteral:<STR>))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Store))(VariableDeclarationFragment(SimpleName:store)(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getStore))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKeyEntry))(VariableDeclarationFragment(SimpleName:privateEntry)(CastExpression(SimpleType(SimpleName:PrivateKeyEntry))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:store))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:alias)(QualifiedName:StoreEntryType.PRIVATE_KEY))))))(IfStatement(InfixExpression(SimpleName:privateEntry)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignerException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:alias))(SimpleName:getName))(StringLiteral:<STR>))))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:outputStream)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:privateKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateEntry))(SimpleName:getValue))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:chain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:privateEntry))(SimpleName:getChain))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:certificate)(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(NumberLiteral:0)))))(VariableDeclarationStatement(SimpleType(SimpleName:DigestType))(VariableDeclarationFragment(SimpleName:digestType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getDigestTypeFromSignature)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificate))(SimpleName:getSigAlgName))))))(VariableDeclarationStatement(SimpleType(SimpleName:Calendar))(VariableDeclarationFragment(SimpleName:calendar)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Calendar))(SimpleName:getInstance))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfReader))(VariableDeclarationFragment(SimpleName:reader)(ClassInstanceCreation(SimpleType(SimpleName:PdfReader))(SimpleName:data))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfStamper))(VariableDeclarationFragment(SimpleName:stamper)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfStamper))(SimpleName:createSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reader)(SimpleName:outputStream)(QualifiedName:PDFSigner.PDF_SIGNATURE_VERSION)(NullLiteral)(BooleanLiteral:true)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignatureAppearance))(VariableDeclarationFragment(SimpleName:appearance)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:stamper))(SimpleName:getSignatureAppearance))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:setCrypto)(METHOD_INVOCATION_ARGUMENTS(SimpleName:privateKey)(SimpleName:chain)(NullLiteral)(QualifiedName:PdfSignatureAppearance.SELF_SIGNED))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:setContact)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getContactInfo)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:setLocation)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getLocation)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:setReason)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getReason)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:setSignDate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:calendar))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfSignature))(VariableDeclarationFragment(SimpleName:signature)(ClassInstanceCreation(SimpleType(SimpleName:PdfSignature))(QualifiedName:PdfName.ADOBE_PPKLITE)(QualifiedName:PdfName.ADBE_PKCS7_DETACHED))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signature))(SimpleName:setReason)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:getReason)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signature))(SimpleName:setLocation)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:getLocation)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signature))(SimpleName:setContact)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:getContact)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signature))(SimpleName:setDate)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:PdfDate))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:getSignDate))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ConditionUtils))(SimpleName:isNotEmpty)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getName))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signature))(SimpleName:setName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getName))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signature))(SimpleName:setName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:BouncyCastleProviderHelper))(SimpleName:getName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificate))(SimpleName:getSubjectX500Principal)))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:setCryptoDictionary)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signature))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:contentSize)(NumberLiteral:0x2502)))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer)))(VariableDeclarationFragment(SimpleName:exc)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:HashMap))(SimpleType(SimpleName:PdfName))(SimpleType(SimpleName:Integer))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exc))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(ClassInstanceCreation(SimpleType(SimpleName:Integer))(SimpleName:contentSize)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:preClose)(METHOD_INVOCATION_ARGUMENTS(SimpleName:exc))))(VariableDeclarationStatement(SimpleType(SimpleName:Digester))(VariableDeclarationFragment(SimpleName:digester)(ClassInstanceCreation(SimpleType(SimpleName:BasicDigester))(SimpleName:digestType))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:rangeStream)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IOUtils))(SimpleName:toByteArray)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:getRangeStream))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:hash)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digester))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:rangeStream)))))(VariableDeclarationStatement(SimpleType(SimpleName:TSAClient))(VariableDeclarationFragment(SimpleName:tsc)(NullLiteral)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getTimeStampClient))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:tsc)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:DelegateITextTSAClient))(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getTimeStampClient)))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:oscp)(NullLiteral)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ConditionUtils))(SimpleName:isNotEmpty)(METHOD_INVOCATION_ARGUMENTS(SimpleName:chain)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:oscpUrl)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PdfPKCS7))(SimpleName:getOCSPURL)(METHOD_INVOCATION_ARGUMENTS(SimpleName:certificate)))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:parentCertificate)(NullLiteral)))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Certificate))(SimpleName:c))(SimpleName:chain)(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:certificate))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:c))))(Block(ExpressionStatement(Assignment(SimpleName:parentCertificate)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:X509Certificate))(SimpleName:c))))(BreakStatement)))))(IfStatement(InfixExpression(SimpleName:parentCertificate)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:oscpUrl)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:oscpUrl))(SimpleName:trim)))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:OcspClient))(VariableDeclarationFragment(SimpleName:ocspClient)(ClassInstanceCreation(SimpleType(SimpleName:OcspClientBouncyCastle))(SimpleName:certificate)(SimpleName:parentCertificate)(SimpleName:oscpUrl))))(ExpressionStatement(Assignment(SimpleName:oscp)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ocspClient))(SimpleName:getEncoded))))))))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfPKCS7))(VariableDeclarationFragment(SimpleName:pkcs7)(ClassInstanceCreation(SimpleType(SimpleName:PdfPKCS7))(SimpleName:privateKey)(SimpleName:chain)(NullLiteral)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digestType))(SimpleName:getAlgorithm))(NullLiteral)(BooleanLiteral:false))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:authenticatedAttributes)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs7))(SimpleName:getAuthenticatedAttributeBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:calendar)(SimpleName:oscp)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs7))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:authenticatedAttributes)(NumberLiteral:0)(QualifiedName:authenticatedAttributes.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs7))(SimpleName:setLocation)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getLocation)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs7))(SimpleName:setReason)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(FieldAccess(ThisExpression)(SimpleName:parameters)))(SimpleName:getReason)))))(IfStatement(InfixExpression(SimpleName:tsc)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs7))(SimpleName:setSignDate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:calendar))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:encodedPkcs7)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkcs7))(SimpleName:getEncodedPKCS7)(METHOD_INVOCATION_ARGUMENTS(SimpleName:hash)(SimpleName:calendar)(SimpleName:tsc)(SimpleName:oscp)))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:output)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:contentSize)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:2)))(INFIX_EXPRESSION_OPERATOR:/)(NumberLiteral:2)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encodedPkcs7)(NumberLiteral:0)(SimpleName:output)(NumberLiteral:0)(QualifiedName:encodedPkcs7.length))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfDictionary))(VariableDeclarationFragment(SimpleName:newDictionary)(ClassInstanceCreation(SimpleType(SimpleName:PdfDictionary)))))(VariableDeclarationStatement(SimpleType(SimpleName:PdfString))(VariableDeclarationFragment(SimpleName:content)(ClassInstanceCreation(SimpleType(SimpleName:PdfString))(SimpleName:output))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:content))(SimpleName:setHexWriting)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:newDictionary))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PdfName.CONTENTS)(SimpleName:content))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:appearance))(SimpleName:close)(METHOD_INVOCATION_ARGUMENTS(SimpleName:newDictionary))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outputStream))(SimpleName:toByteArray))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SignerException))(SimpleName:e))))))))))