(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:UserZipFile))(SimpleName:makeCertificate)(SimpleType(SimpleName:NullPointerException))(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleType(SimpleName:NoSuchProviderException))(SimpleType(SimpleName:SignatureException))(SimpleType(SimpleName:InvalidKeyException))(Block(IfStatement(InfixExpression(SimpleName:name)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:NullPointerException))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:passphrase)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:NullPointerException))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(SimpleName:saveFile)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecurityUtil))(SimpleName:lazyLoad)))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPairGenerator))(VariableDeclarationFragment(SimpleName:keyGen)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:KeyPairGenerator))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyGen))(SimpleName:initialize)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1024))))(VariableDeclarationStatement(SimpleType(SimpleName:KeyPair))(VariableDeclarationFragment(SimpleName:keyPair)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyGen))(SimpleName:generateKeyPair))))(VariableDeclarationStatement(SimpleType(SimpleName:PrivateKey))(VariableDeclarationFragment(SimpleName:privateKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPrivate))))(VariableDeclarationStatement(SimpleType(SimpleName:PublicKey))(VariableDeclarationFragment(SimpleName:publicKey)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:keyPair))(SimpleName:getPublic))))(VariableDeclarationStatement(SimpleType(SimpleName:Hashtable))(VariableDeclarationFragment(SimpleName:attrs)(ClassInstanceCreation(SimpleType(SimpleName:Hashtable)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attrs))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:X509Principal.CN)(SimpleName:name))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:serno)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8))))))(VariableDeclarationStatement(SimpleType(SimpleName:SecureRandom))(VariableDeclarationFragment(SimpleName:random)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SecureRandom))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:random))(SimpleName:setSeed)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TimeUtil))(SimpleName:getTrancheTimestamp)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:random))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:serno))))(VariableDeclarationStatement(SimpleType(SimpleName:BigInteger))(VariableDeclarationFragment(SimpleName:sn)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ClassInstanceCreation(SimpleType(QualifiedName:java.math.BigInteger))(SimpleName:serno)))(SimpleName:abs))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Principal))(VariableDeclarationFragment(SimpleName:principal)(ClassInstanceCreation(SimpleType(SimpleName:X509Principal))(SimpleName:attrs))))(VariableDeclarationStatement(SimpleType(SimpleName:X509V3CertificateGenerator))(VariableDeclarationFragment(SimpleName:gen)(ClassInstanceCreation(SimpleType(SimpleName:X509V3CertificateGenerator)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:setSerialNumber)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sn))))(IfStatement(InfixExpression(InfixExpression(SimpleName:signerCertificate)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:signerPrivateKey)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:setIssuerDN)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:X509Principal))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signerCertificate))(SimpleName:getSubjectDN)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:setIssuerDN)(METHOD_INVOCATION_ARGUMENTS(SimpleName:principal))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:setNotBefore)(METHOD_INVOCATION_ARGUMENTS(SimpleName:startDate))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:setNotAfter)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:Date))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:startDate))(SimpleName:getTime))(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(SimpleName:validDays)(INFIX_EXPRESSION_OPERATOR:*)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Long))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:setSubjectDN)(METHOD_INVOCATION_ARGUMENTS(SimpleName:principal))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:setSignatureAlgorithm)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:setPublicKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:publicKey))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:cert)(NullLiteral)))(IfStatement(InfixExpression(InfixExpression(SimpleName:signerCertificate)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:signerPrivateKey)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ExpressionStatement(Assignment(SimpleName:cert)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:generateX509Certificate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getSignerPrivateKey)))))))(Block(ExpressionStatement(Assignment(SimpleName:cert)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:gen))(SimpleName:generateX509Certificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:privateKey)))))))(VariableDeclarationStatement(SimpleType(SimpleName:UserZipFile))(VariableDeclarationFragment(SimpleName:uzf)(ClassInstanceCreation(SimpleType(SimpleName:UserZipFile))(SimpleName:saveFile))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uzf))(SimpleName:setCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cert))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uzf))(SimpleName:setPrivateKey)(METHOD_INVOCATION_ARGUMENTS(SimpleName:privateKey))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uzf))(SimpleName:setPassphrase)(METHOD_INVOCATION_ARGUMENTS(SimpleName:passphrase))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uzf))(SimpleName:saveTo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:saveFile))))(ReturnStatement(SimpleName:uzf))))))