(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(PrimitiveType:void)(SimpleName:sessionSetup)(SingleVariableDeclaration(SimpleType(SimpleName:ServerMessageBlock))(SimpleName:andx))(SingleVariableDeclaration(SimpleType(SimpleName:ServerMessageBlock))(SimpleName:andxResponse))(SimpleType(SimpleName:SmbException))(Block(SynchronizedStatement(MethodInvocation(SimpleName:transport))(Block(IfStatement(SimpleName:sessionSetup)(Block(ReturnStatement)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:transport))(SimpleName:negotiate)))(IfStatement(QualifiedName:DebugFile.trace)(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DebugFile))(SimpleName:writeln)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(QualifiedName:auth.username)(StringLiteral:<STR>)(QualifiedName:auth.domain))))))(VariableDeclarationStatement(SimpleType(SimpleName:SmbComSessionSetupAndX))(VariableDeclarationFragment(SimpleName:request)(ClassInstanceCreation(SimpleType(SimpleName:SmbComSessionSetupAndX))(ThisExpression)(SimpleName:andx))))(VariableDeclarationStatement(SimpleType(SimpleName:SmbComSessionSetupAndXResponse))(VariableDeclarationFragment(SimpleName:response)(ClassInstanceCreation(SimpleType(SimpleName:SmbComSessionSetupAndXResponse))(SimpleName:andxResponse))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:transport))(SimpleName:isSignatureSetupRequired)(METHOD_INVOCATION_ARGUMENTS(SimpleName:auth)))(Block(IfStatement(InfixExpression(QualifiedName:auth.hashesExternal)(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(QualifiedName:NtlmPasswordAuthentication.DEFAULT_PASSWORD)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:transport))(SimpleName:getSmbSession)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:NtlmPasswordAuthentication.DEFAULT))))(SimpleName:getSmbTree)(METHOD_INVOCATION_ARGUMENTS(SimpleName:LOGON_SHARE)(NullLiteral))))(SimpleName:treeConnect)(METHOD_INVOCATION_ARGUMENTS(NullLiteral)(NullLiteral))))))(ExpressionStatement(Assignment(QualifiedName:request.digest)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:SigningDigest))(SimpleName:transport)(SimpleName:auth))))))(ExpressionStatement(Assignment(QualifiedName:request.auth)(ASSIGNMENT_OPERATOR:=)(SimpleName:auth)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:transport))(SimpleName:send)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:response))))(IfStatement(InfixExpression(QualifiedName:response.isLoggedInAsGuest)(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(StringLiteral:<STR>))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:auth.username))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SmbAuthException))(QualifiedName:NtStatus.NT_STATUS_LOGON_FAILURE)))))(ExpressionStatement(Assignment(SimpleName:uid)(ASSIGNMENT_OPERATOR:=)(QualifiedName:response.uid)))(ExpressionStatement(Assignment(SimpleName:sessionSetup)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(IfStatement(InfixExpression(QualifiedName:request.digest)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(QualifiedName:transport.digest)(ASSIGNMENT_OPERATOR:=)(QualifiedName:request.digest)))))))))))