(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(ParameterizedType(SimpleType(SimpleName:Map))(SimpleType(SimpleName:Permission))(SimpleType(SimpleName:PermissionState)))(SimpleName:getPolicies)(SingleVariableDeclaration(SimpleType(SimpleName:CodeSigner))(SimpleName:signer))(Block(VariableDeclarationStatement(SimpleType(SimpleName:CodeSigner))(VariableDeclarationFragment(SimpleName:sig)(NullLiteral)))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:CodeSigner))(SimpleName:s))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:policies))(SimpleName:keySet))(Block(IfStatement(InfixExpression(InfixExpression(SimpleName:s)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:signer))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:s))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signer))))(Block(ExpressionStatement(Assignment(SimpleName:sig)(ASSIGNMENT_OPERATOR:=)(SimpleName:s)))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:CombinationMap))(SimpleType(SimpleName:Permission))(SimpleType(SimpleName:PermissionState)))(VariableDeclarationFragment(SimpleName:perm)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:policies))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:sig)))))(IfStatement(InfixExpression(SimpleName:perm)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:name)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Base64))(SimpleName:encodeBytes)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:digester))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:signer)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signer))(SimpleName:toString)))))(SimpleName:getBytes))))))))(ExpressionStatement(Assignment(SimpleName:perm)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:CombinationMap))(SimpleType(SimpleName:Permission))(SimpleType(SimpleName:PermissionState)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NamingUtils))(SimpleName:asName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(ThisExpression))(SimpleName:getClass)))))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:name)))(QualifiedName:DynSecurityPolicy.ENCLOSURE_PERM))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:policies))(SimpleName:put)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signer)(SimpleName:perm)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:InvalidNameException))(SimpleName:ine))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:RuntimeException))(SimpleName:ine))))))))(ReturnStatement(SimpleName:perm))))))