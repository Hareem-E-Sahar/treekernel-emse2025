(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:void)(SimpleName:unwrapFromInputStream)(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:forHandshake))(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:SSLEngineResult))(VariableDeclarationFragment(SimpleName:result)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteBuffer))(VariableDeclarationFragment(SimpleName:cryptBuffer)))(VariableDeclarationStatement(SimpleType(SimpleName:ByteArrayOutputStream))(VariableDeclarationFragment(SimpleName:byteOutputStream)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:keepRun)(BooleanLiteral:true)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:closed)(BooleanLiteral:false)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:oldPosition)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:position))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:position)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:limit)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:limit)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:capacity)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:byteOutputStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read)))))(WhileStatement(SimpleName:keepRun)(Block(ExpressionStatement(Assignment(SimpleName:cryptBuffer)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteBuffer))(SimpleName:wrap)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:byteOutputStream))(SimpleName:toByteArray))))))(ExpressionStatement(Assignment(SimpleName:result)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:sslEngine))(SimpleName:unwrap)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cryptBuffer)(SimpleName:clearInputBuffer)))))(SwitchStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:result))(SimpleName:getStatus))(SwitchCase(SimpleName:BUFFER_OVERFLOW))(ExpressionStatement(MethodInvocation(SimpleName:enlargeClearInputBuffer)))(ExpressionStatement(Assignment(SimpleName:oldPosition)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:position))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:position)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:limit)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:limit)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:capacity)))))(BreakStatement)(SwitchCase(SimpleName:BUFFER_UNDERFLOW))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:byteOutputStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:inputStream))(SimpleName:read)))))(BreakStatement)(SwitchCase(SimpleName:CLOSED))(ExpressionStatement(Assignment(SimpleName:keepRun)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false)))(ExpressionStatement(Assignment(SimpleName:closed)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(BreakStatement)(SwitchCase(SimpleName:OK))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:limit)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:position)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:clearInputBuffer))(SimpleName:position)(METHOD_INVOCATION_ARGUMENTS(SimpleName:oldPosition))))(IfStatement(SimpleName:forHandshake)(Block(ExpressionStatement(Assignment(SimpleName:keepRun)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false))))(Block(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cryptBuffer))(SimpleName:position))(INFIX_EXPRESSION_OPERATOR:>=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cryptBuffer))(SimpleName:limit)))(Block(ExpressionStatement(Assignment(SimpleName:keepRun)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:false))))(Block(ExpressionStatement(Assignment(SimpleName:cryptBuffer)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cryptBuffer))(SimpleName:slice))))(ExpressionStatement(Assignment(SimpleName:byteOutputStream)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:ByteArrayOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:byteOutputStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cryptBuffer))(SimpleName:array)))))))))(BreakStatement))))(IfStatement(SimpleName:closed)(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(StringLiteral:<STR>)))))))))