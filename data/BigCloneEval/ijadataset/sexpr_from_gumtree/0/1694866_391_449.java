(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(Modifier:static)(PrimitiveType:void)(SimpleName:markProbeFinished)(SingleVariableDeclaration(SimpleType(SimpleName:Db))(SimpleName:statusDb))(SingleVariableDeclaration(SimpleType(SimpleName:ProbeBase))(SimpleName:probeBase))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:success))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:error))(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ex))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:message))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:trialRun))(SimpleType(SimpleName:Exception))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_logger))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)(SimpleName:success)(StringLiteral:<STR>)(SimpleName:error)(StringLiteral:<STR>)(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:ex)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ex))(SimpleName:getMessage))))(StringLiteral:<STR>)(SimpleName:message)(StringLiteral:<STR>)(SimpleName:trialRun)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:msg)(ParenthesizedExpression(ConditionalExpression(InfixExpression(InfixExpression(SimpleName:ex)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:message)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:StringHelper))(SimpleName:getMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ex)))(SimpleName:message)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:stackTrace)(ParenthesizedExpression(ConditionalExpression(InfixExpression(SimpleName:ex)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:StringHelper))(SimpleName:getStackTraceAsString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ex)))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:statusDb))(SimpleName:begin)))(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:state)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DbHelper))(SimpleName:getKey)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:statusDb))(SimpleName:prepareStatement)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getProbeHistoryId)))))))))(IfStatement(InfixExpression(SimpleName:state)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getProbeHistoryId))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:state)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:ProbeStatus.STILL_RUNNING))(INFIX_EXPRESSION_OPERATOR:&&)(InfixExpression(SimpleName:state)(INFIX_EXPRESSION_OPERATOR:!=)(QualifiedName:ProbeStatus.NO_DATA)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:state)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getProbeHistoryId))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:thread)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DbHelper))(SimpleName:getKey)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:statusDb))(SimpleName:prepareStatement)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>))))))))(IfStatement(InfixExpression(SimpleName:thread)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:thread))(SimpleName:intValue))(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:1))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IllegalStateException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)(SimpleName:thread)(StringLiteral:<STR>)))))(SynchronizedStatement(SimpleName:lock)(Block(ExpressionStatement(MethodInvocation(SimpleName:removeLock)(METHOD_INVOCATION_ARGUMENTS(SimpleName:statusDb)(SimpleName:probeBase))))))(VariableDeclarationStatement(SimpleType(SimpleName:PreparedStatement))(VariableDeclarationFragment(SimpleName:ps_finish_elt)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:statusDb))(SimpleName:prepareStatement)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ps_finish_elt))(SimpleName:setBoolean)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:1)(SimpleName:success))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ps_finish_elt))(SimpleName:setBoolean)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:2)(SimpleName:error))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DbHelper))(SimpleName:setSafeString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ps_finish_elt)(NumberLiteral:3)(SimpleName:msg))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DbHelper))(SimpleName:setSafeString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ps_finish_elt)(NumberLiteral:4)(SimpleName:stackTrace))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:status)(QualifiedName:ProbeStatus.FAILURE)))(IfStatement(SimpleName:success)(ExpressionStatement(Assignment(SimpleName:status)(ASSIGNMENT_OPERATOR:=)(QualifiedName:ProbeStatus.SUCCESS))))(IfStatement(SimpleName:error)(ExpressionStatement(Assignment(SimpleName:status)(ASSIGNMENT_OPERATOR:=)(QualifiedName:ProbeStatus.ERROR))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ps_finish_elt))(SimpleName:setInt)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:5)(SimpleName:status))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ps_finish_elt))(SimpleName:setInt)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:6)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getProbeHistoryId)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:statusDb))(SimpleName:executeUpdate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ps_finish_elt))))(ExpressionStatement(MethodInvocation(SimpleName:saveProbeParameters)(METHOD_INVOCATION_ARGUMENTS(SimpleName:statusDb)(SimpleName:probeBase))))(IfStatement(InstanceofExpression(SimpleName:probeBase)(SimpleType(SimpleName:FileProbe)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:FileProbe))(VariableDeclarationFragment(SimpleName:fp)(CastExpression(SimpleType(SimpleName:FileProbe))(SimpleName:probeBase))))(ExpressionStatement(MethodInvocation(SimpleName:updateFileProbeHistory)(METHOD_INVOCATION_ARGUMENTS(SimpleName:statusDb)(SimpleName:fp))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fp))(SimpleName:isAssetProbe))(Block(ExpressionStatement(MethodInvocation(SimpleName:fillAssetProbeHistory)(METHOD_INVOCATION_ARGUMENTS(SimpleName:statusDb)(SimpleName:fp)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fp))(SimpleName:getProbeHistoryId)))))))))(VariableDeclarationStatement(SimpleType(SimpleName:Incident))(VariableDeclarationFragment(SimpleName:i)(ClassInstanceCreation(SimpleType(SimpleName:Incident)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:i))(SimpleName:setProbeName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:i))(SimpleName:setEsisVersion)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Version))(SimpleName:getVersionString)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:i))(SimpleName:setLastException)(METHOD_INVOCATION_ARGUMENTS(SimpleName:stackTrace))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:List))(SimpleType(SimpleName:Exception)))(VariableDeclarationFragment(SimpleName:exs)(ClassInstanceCreation(ParameterizedType(SimpleType(SimpleName:ArrayList))(SimpleType(SimpleName:Exception))))))(IfStatement(InfixExpression(SimpleName:ex)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:exs))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ex)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:status)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:ProbeStatus.FAILURE))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:isSendIncidentWhenFailure)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_logger))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:i))(SimpleName:setSummary)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:i))(SimpleName:setProbeMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DbIncident))(SimpleName:saveIncident)(METHOD_INVOCATION_ARGUMENTS(SimpleName:statusDb)(SimpleName:i)(NullLiteral)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:status)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:ProbeStatus.ERROR))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:isSendIncidentWhenError)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_logger))(SimpleName:warn)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:i))(SimpleName:setSummary)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)(SimpleName:msg)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:i))(SimpleName:setProbeMessage)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName))(StringLiteral:<STR>)(SimpleName:msg)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DbIncident))(SimpleName:saveIncident)(METHOD_INVOCATION_ARGUMENTS(SimpleName:statusDb)(SimpleName:i)(NullLiteral))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_logger))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:msg)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:probeBase))(SimpleName:getClass)))(SimpleName:getName)))(SimpleName:e))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:statusDb))(SimpleName:rollback)))(ThrowStatement(SimpleName:e))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:statusDb))(SimpleName:commitUnless)))))))))