(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(PrimitiveType:void)(SimpleName:connect)(SimpleType(SimpleName:IOException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:NtlmPasswordAuthentication))(VariableDeclarationFragment(SimpleName:ntlmPasswordAuthentication)(ClassInstanceCreation(SimpleType(SimpleName:NtlmPasswordAuthentication))(NullLiteral)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_ntlmServiceAccount))(SimpleName:getAccount))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_ntlmServiceAccount))(SimpleName:getPassword)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:endpoint)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:_domainController)(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:_handle)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DcerpcHandle))(SimpleName:getHandle)(METHOD_INVOCATION_ARGUMENTS(SimpleName:endpoint)(SimpleName:ntlmPasswordAuthentication)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handle))(SimpleName:bind)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:clientChallenge)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_secureRandom))(SimpleName:nextBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:clientChallenge))))(VariableDeclarationStatement(SimpleType(SimpleName:NetrServerReqChallenge))(VariableDeclarationFragment(SimpleName:netrServerReqChallenge)(ClassInstanceCreation(SimpleType(SimpleName:NetrServerReqChallenge))(SimpleName:_domainControllerName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_ntlmServiceAccount))(SimpleName:getComputerName))(SimpleName:clientChallenge)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handle))(SimpleName:sendrecv)(METHOD_INVOCATION_ARGUMENTS(SimpleName:netrServerReqChallenge))))(VariableDeclarationStatement(SimpleType(SimpleName:MD4))(VariableDeclarationFragment(SimpleName:md4)(ClassInstanceCreation(SimpleType(SimpleName:MD4)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md4))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_ntlmServiceAccount))(SimpleName:getPassword)))(SimpleName:getBytes)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:sessionKey)(MethodInvocation(SimpleName:computeSessionKey)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:md4))(SimpleName:digest))(SimpleName:clientChallenge)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:netrServerReqChallenge))(SimpleName:getServerChallenge))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:clientCredential)(MethodInvocation(SimpleName:computeNetlogonCredential)(METHOD_INVOCATION_ARGUMENTS(SimpleName:clientChallenge)(SimpleName:sessionKey)))))(VariableDeclarationStatement(SimpleType(SimpleName:NetrServerAuthenticate3))(VariableDeclarationFragment(SimpleName:netrServerAuthenticate3)(ClassInstanceCreation(SimpleType(SimpleName:NetrServerAuthenticate3))(SimpleName:_domainControllerName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_ntlmServiceAccount))(SimpleName:getAccountName))(NumberLiteral:2)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_ntlmServiceAccount))(SimpleName:getComputerName))(SimpleName:clientCredential)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(NumberLiteral:8))))(NumberLiteral:0xFFFFFFFF))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handle))(SimpleName:sendrecv)(METHOD_INVOCATION_ARGUMENTS(SimpleName:netrServerAuthenticate3))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:serverCredential)(MethodInvocation(SimpleName:computeNetlogonCredential)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:netrServerReqChallenge))(SimpleName:getServerChallenge))(SimpleName:sessionKey)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:serverCredential)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:netrServerAuthenticate3))(SimpleName:getServerCredential)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:System.out))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ReturnStatement)))(ExpressionStatement(Assignment(SimpleName:_clientCredential)(ASSIGNMENT_OPERATOR:=)(SimpleName:clientCredential)))(ExpressionStatement(Assignment(SimpleName:_sessionKey)(ASSIGNMENT_OPERATOR:=)(SimpleName:sessionKey)))))))