(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:run)(Block(IfStatement(InfixExpression(SimpleName:_socket)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MSG_PORT_OPEN))(VariableDeclarationFragment(SimpleName:open_packet)(ClassInstanceCreation(SimpleType(SimpleName:MSG_PORT_OPEN))(SimpleName:_localChannelNumber)(SimpleName:_hostname)(SimpleName:_remoteport))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:enqueueToRemote)(METHOD_INVOCATION_ARGUMENTS(SimpleName:open_packet))))(VariableDeclarationStatement(SimpleType(SimpleName:Packet))(VariableDeclarationFragment(SimpleName:reply)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_queue))(SimpleName:getNextPacket))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reply))(SimpleName:getPacketType))(INFIX_EXPRESSION_OPERATOR:!=)(SimpleName:SSH_MSG_CHANNEL_OPEN_CONFIRMATION))(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_socket))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block)))(ReturnStatement)))(VariableDeclarationStatement(SimpleType(SimpleName:MSG_CHANNEL_OPEN_CONFIRMATION))(VariableDeclarationFragment(SimpleName:confirm)(CastExpression(SimpleType(SimpleName:MSG_CHANNEL_OPEN_CONFIRMATION))(SimpleName:reply))))(ExpressionStatement(Assignment(SimpleName:_remoteChannelNumber)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:confirm))(SimpleName:getLocalChannelNumber)))))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:InetAddress))(VariableDeclarationFragment(SimpleName:address)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:InetAddress))(SimpleName:getByName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:_hostname)))))(ExpressionStatement(Assignment(SimpleName:_socket)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:Socket))(SimpleName:address)(SimpleName:_localport)))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MSG_CHANNEL_OPEN_FAILURE))(VariableDeclarationFragment(SimpleName:reply)(ClassInstanceCreation(SimpleType(SimpleName:MSG_CHANNEL_OPEN_FAILURE))(SimpleName:_remoteChannelNumber))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:enqueueToRemote)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reply))))(ReturnStatement))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:registerOpenChannel)(METHOD_INVOCATION_ARGUMENTS(ThisExpression))))(VariableDeclarationStatement(SimpleType(SimpleName:MSG_CHANNEL_OPEN_CONFIRMATION))(VariableDeclarationFragment(SimpleName:reply)(ClassInstanceCreation(SimpleType(SimpleName:MSG_CHANNEL_OPEN_CONFIRMATION))(SimpleName:_remoteChannelNumber)(MethodInvocation(SimpleName:getLocalChannelNumber)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:enqueueToRemote)(METHOD_INVOCATION_ARGUMENTS(SimpleName:reply))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:ChannelReader))(VariableDeclarationFragment(SimpleName:channel_reader)(ClassInstanceCreation(SimpleType(SimpleName:ChannelReader))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_socket))(SimpleName:getInputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channel_reader))(SimpleName:setDaemon)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:channel_reader))(SimpleName:start)))(VariableDeclarationStatement(SimpleType(SimpleName:OutputStream))(VariableDeclarationFragment(SimpleName:out)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_socket))(SimpleName:getOutputStream))))(ForStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Packet))(VariableDeclarationFragment(SimpleName:packet)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_queue))(SimpleName:getNextPacket))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:type)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getPacketType))))(IfStatement(InfixExpression(SimpleName:type)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:SSH_MSG_CHANNEL_DATA))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MSG_CHANNEL_DATA))(VariableDeclarationFragment(SimpleName:data_packet)(CastExpression(SimpleType(SimpleName:MSG_CHANNEL_DATA))(SimpleName:packet))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:out))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:data_packet))(SimpleName:getChannelData))))))(IfStatement(InfixExpression(SimpleName:type)(INFIX_EXPRESSION_OPERATOR:==)(SimpleName:SSH_MSG_CHANNEL_CLOSE))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_socket))(SimpleName:shutdownOutput)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_socket))(SimpleName:close)))(VariableDeclarationStatement(SimpleType(SimpleName:MSG_CHANNEL_CLOSE_CONFIRMATION))(VariableDeclarationFragment(SimpleName:confirmation)(ClassInstanceCreation(SimpleType(SimpleName:MSG_CHANNEL_CLOSE_CONFIRMATION))(SimpleName:_remoteChannelNumber))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:enqueueToRemote)(METHOD_INVOCATION_ARGUMENTS(SimpleName:confirmation))))(BreakStatement))(BreakStatement))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:IOException))(SimpleName:e))(Block(VariableDeclarationStatement(SimpleType(SimpleName:MSG_CHANNEL_CLOSE))(VariableDeclarationFragment(SimpleName:close_packet)(ClassInstanceCreation(SimpleType(SimpleName:MSG_CHANNEL_CLOSE))(SimpleName:_remoteChannelNumber))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:enqueueToRemote)(METHOD_INVOCATION_ARGUMENTS(SimpleName:close_packet))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_socket))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e2))(Block))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_handler))(SimpleName:removeOpenChannel)(METHOD_INVOCATION_ARGUMENTS(ThisExpression))))(ReturnStatement)))))