(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:writeBlock)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:DiskManagerWriteRequest))(SimpleName:request))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:DiskManagerWriteRequestListener))(SimpleName:_listener))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:requestStarts)))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:DiskManagerWriteRequestListener))(VariableDeclarationFragment(SimpleName:listener)(ClassInstanceCreation(SimpleType(SimpleName:DiskManagerWriteRequestListener))(AnonymousClassDeclaration(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:writeCompleted)(SingleVariableDeclaration(SimpleType(SimpleName:DiskManagerWriteRequest))(SimpleName:request))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:requestEnds)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_listener))(SimpleName:writeCompleted)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request))))))(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:writeFailed)(SingleVariableDeclaration(SimpleType(SimpleName:DiskManagerWriteRequest))(SimpleName:request))(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:cause))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:requestEnds)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:false))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:_listener))(SimpleName:writeFailed)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:cause))))))))))(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:pieceNumber)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getPieceNumber))))(VariableDeclarationStatement(SimpleType(SimpleName:DirectByteBuffer))(VariableDeclarationFragment(SimpleName:buffer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getBuffer))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:offset)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getOffset))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:DiskManagerPiece))(VariableDeclarationFragment(SimpleName:dmPiece)(ArrayAccess(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:disk_manager))(SimpleName:getPieces))(SimpleName:pieceNumber))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmPiece))(SimpleName:isDone))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:returnToPool)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listener))(SimpleName:writeCompleted)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)))))(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:buffer_position)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:position)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:DirectByteBuffer.SS_DW)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:buffer_limit)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:limit)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:DirectByteBuffer.SS_DW)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:previousFilesLength)(NumberLiteral:0)))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:currentFile)(NumberLiteral:0)))(VariableDeclarationStatement(SimpleType(SimpleName:DMPieceList))(VariableDeclarationFragment(SimpleName:pieceList)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:disk_manager))(SimpleName:getPieceList)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pieceNumber)))))(VariableDeclarationStatement(SimpleType(SimpleName:DMPieceMapEntry))(VariableDeclarationFragment(SimpleName:current_piece)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pieceList))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:currentFile)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:fileOffset)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:current_piece))(SimpleName:getOffset))))(WhileStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:previousFilesLength)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:current_piece))(SimpleName:getLength))))(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:offset))(Block(ExpressionStatement(Assignment(SimpleName:previousFilesLength)(ASSIGNMENT_OPERATOR:+=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:current_piece))(SimpleName:getLength))))(ExpressionStatement(PostfixExpression(SimpleName:currentFile)(POSTFIX_EXPRESSION_OPERATOR:++)))(ExpressionStatement(Assignment(SimpleName:fileOffset)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(ExpressionStatement(Assignment(SimpleName:current_piece)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pieceList))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:currentFile)))))))(VariableDeclarationStatement(SimpleType(SimpleName:List))(VariableDeclarationFragment(SimpleName:chunks)(ClassInstanceCreation(SimpleType(SimpleName:ArrayList)))))(WhileStatement(InfixExpression(SimpleName:buffer_position)(INFIX_EXPRESSION_OPERATOR:<)(SimpleName:buffer_limit))(Block(ExpressionStatement(Assignment(SimpleName:current_piece)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pieceList))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(SimpleName:currentFile)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:file_limit)(InfixExpression(SimpleName:buffer_position)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:current_piece))(SimpleName:getFile)))(SimpleName:getLength))(INFIX_EXPRESSION_OPERATOR:-)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:current_piece))(SimpleName:getOffset))))(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(SimpleName:offset)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:previousFilesLength))))))))(IfStatement(InfixExpression(SimpleName:file_limit)(INFIX_EXPRESSION_OPERATOR:>)(SimpleName:buffer_limit))(Block(ExpressionStatement(Assignment(SimpleName:file_limit)(ASSIGNMENT_OPERATOR:=)(SimpleName:buffer_limit)))))(IfStatement(InfixExpression(SimpleName:file_limit)(INFIX_EXPRESSION_OPERATOR:>)(SimpleName:buffer_position))(Block(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:file_pos)(InfixExpression(SimpleName:fileOffset)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(InfixExpression(SimpleName:offset)(INFIX_EXPRESSION_OPERATOR:-)(SimpleName:previousFilesLength))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chunks))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(ArrayCreation(ArrayType(SimpleType(SimpleName:Object))(Dimension))(ArrayInitializer(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:current_piece))(SimpleName:getFile))(ClassInstanceCreation(SimpleType(SimpleName:Long))(SimpleName:file_pos))(ClassInstanceCreation(SimpleType(SimpleName:Integer))(CastExpression(PrimitiveType:int)(SimpleName:file_limit))))))))(ExpressionStatement(Assignment(SimpleName:buffer_position)(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:int)(SimpleName:file_limit))))))(ExpressionStatement(PostfixExpression(SimpleName:currentFile)(POSTFIX_EXPRESSION_OPERATOR:++)))(ExpressionStatement(Assignment(SimpleName:fileOffset)(ASSIGNMENT_OPERATOR:=)(NumberLiteral:0)))(ExpressionStatement(Assignment(SimpleName:previousFilesLength)(ASSIGNMENT_OPERATOR:=)(SimpleName:offset)))))(VariableDeclarationStatement(SimpleType(SimpleName:DiskManagerWriteRequestListener))(VariableDeclarationFragment(SimpleName:l)(ClassInstanceCreation(SimpleType(SimpleName:DiskManagerWriteRequestListener))(AnonymousClassDeclaration(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:writeCompleted)(SingleVariableDeclaration(SimpleType(SimpleName:DiskManagerWriteRequest))(SimpleName:request))(Block(ExpressionStatement(MethodInvocation(SimpleName:complete)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listener))(SimpleName:writeCompleted)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request))))))(MethodDeclaration(Modifier:public)(PrimitiveType:void)(SimpleName:writeFailed)(SingleVariableDeclaration(SimpleType(SimpleName:DiskManagerWriteRequest))(SimpleName:request))(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:cause))(Block(ExpressionStatement(MethodInvocation(SimpleName:complete)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmPiece))(SimpleName:isDone))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:isEnabled))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:LogEvent))(SimpleName:disk_manager)(SimpleName:LOGID)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dmPiece))(SimpleName:getPieceNumber))(StringLiteral:<STR>))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listener))(SimpleName:writeCompleted)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:disk_manager))(SimpleName:setFailed)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:getNestedExceptionMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cause)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:printStackTrace)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cause))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listener))(SimpleName:writeFailed)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:cause))))))))(MethodDeclaration(Modifier:protected)(PrimitiveType:void)(SimpleName:complete)(Block(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:this_mon))(SimpleName:enter)))(ExpressionStatement(PostfixExpression(SimpleName:async_writes)(POSTFIX_EXPRESSION_OPERATOR:--)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:write_requests))(SimpleName:remove)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:out)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))(IfStatement(SimpleName:stopped)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:async_write_sem))(SimpleName:release))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:this_mon))(SimpleName:exit)))))))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:this_mon))(SimpleName:enter)))(IfStatement(SimpleName:stopped)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:buffer))(SimpleName:returnToPool)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listener))(SimpleName:writeFailed)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(ClassInstanceCreation(SimpleType(SimpleName:Exception))(StringLiteral:<STR>)))))(ReturnStatement))(Block(ExpressionStatement(PostfixExpression(SimpleName:async_writes)(POSTFIX_EXPRESSION_OPERATOR:++)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:write_requests))(SimpleName:add)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:this_mon))(SimpleName:exit)))))(ExpressionStatement(ClassInstanceCreation(SimpleType(SimpleName:requestDispatcher))(SimpleName:request)(SimpleName:l)(SimpleName:buffer)(SimpleName:chunks))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Throwable))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getBuffer)))(SimpleName:returnToPool)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:disk_manager))(SimpleName:setFailed)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:getNestedExceptionMessage)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Debug))(SimpleName:printStackTrace)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:listener))(SimpleName:writeFailed)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:e)))))))))))