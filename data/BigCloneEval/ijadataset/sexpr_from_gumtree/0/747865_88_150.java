(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:boolean)(SimpleName:checkJar)(SingleVariableDeclaration(SimpleType(SimpleName:URL))(SimpleName:url))(SimpleType(SimpleName:CertificateException))(SimpleType(SimpleName:NoSuchProviderException))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(SimpleType(SimpleName:JarEntry))(VariableDeclarationFragment(SimpleName:next)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:signatureFound)(BooleanLiteral:false)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:acceptAllSigner)(BooleanLiteral:true)))(ExpressionStatement(Assignment(SimpleName:userCert)(ASSIGNMENT_OPERATOR:=)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:is)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:openConnection)))(SimpleName:getInputStream))))(VariableDeclarationStatement(SimpleType(SimpleName:JarInputStream))(VariableDeclarationFragment(SimpleName:jis)(ClassInstanceCreation(SimpleType(SimpleName:JarInputStream))(SimpleName:is))))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:next)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:jis))(SimpleName:getNextJarEntry))))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Certificate))(Dimension))(VariableDeclarationFragment(SimpleName:chain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:next))(SimpleName:getCertificates))))(IfStatement(InfixExpression(SimpleName:chain)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ForStatement(VariableDeclarationExpression(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:i)(NumberLiteral:0)))(InfixExpression(SimpleName:i)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:chain.length))(PostfixExpression(SimpleName:i)(POSTFIX_EXPRESSION_OPERATOR:++))(Block(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:x509)(CastExpression(SimpleType(SimpleName:X509Certificate))(ArrayAccess(SimpleName:chain)(SimpleName:i)))))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:next))(SimpleName:getName)))(SimpleName:endsWith)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(Block(ExpressionStatement(Assignment(SimpleName:signatureFound)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(VariableDeclarationStatement(SimpleType(SimpleName:CertificateFactory))(VariableDeclarationFragment(SimpleName:cf)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateFactory))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Collection))(VariableDeclarationFragment(SimpleName:coll)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cf))(SimpleName:generateCertificates)(METHOD_INVOCATION_ARGUMENTS(SimpleName:jis)))))(IfStatement(InfixExpression(InfixExpression(SimpleName:coll)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:coll))(SimpleName:size))(INFIX_EXPRESSION_OPERATOR:<)(NumberLiteral:1)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserMessages))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:url)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))(ReturnStatement(BooleanLiteral:false))))(VariableDeclarationStatement(SimpleType(SimpleName:X509Certificate))(VariableDeclarationFragment(SimpleName:userChain)(Dimension)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:CertificateUtility))(SimpleName:toX509Chain)(METHOD_INVOCATION_ARGUMENTS(SimpleName:coll)))))(ExpressionStatement(Assignment(SimpleName:userCert)(ASSIGNMENT_OPERATOR:=)(ArrayAccess(SimpleName:userChain)(NumberLiteral:0))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userCert))(SimpleName:checkValidity)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:acceptSigner)(BooleanLiteral:false)))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:userCertVerified)(BooleanLiteral:false)))(VariableDeclarationStatement(SimpleType(SimpleName:KeyStoreManager))(VariableDeclarationFragment(SimpleName:manager)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ResourceManager))(SimpleName:getKeystoreManager))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signer)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manager))(SimpleName:getAliasFromCertifcate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userCert)))))(IfStatement(InfixExpression(SimpleName:signer)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:acceptSigner)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ExpressionStatement(Assignment(SimpleName:userCertVerified)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:info)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:signer))))))(Block(ExpressionStatement(Assignment(SimpleName:userCertVerified)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manager))(SimpleName:verify)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userChain)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:userCertVerified))(Block(VariableDeclarationStatement(SimpleType(SimpleName:CertificateGeneralDialog))(VariableDeclarationFragment(SimpleName:dialog)(ClassInstanceCreation(SimpleType(SimpleName:CertificateGeneralDialog))(SimpleName:userChain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:url))(SimpleName:toString)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dialog))(SimpleName:show)))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:dialogShow))(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))))))(IfStatement(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:acceptSigner))(INFIX_EXPRESSION_OPERATOR:&&)(SimpleName:userCertVerified))(Block(VariableDeclarationStatement(SimpleType(SimpleName:AddToKeystoreDialog))(VariableDeclarationFragment(SimpleName:dialog)(ClassInstanceCreation(SimpleType(SimpleName:AddToKeystoreDialog))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ResourceManager))(SimpleName:getCurrentInstance))(SimpleName:url)(SimpleName:userCert))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dialog))(SimpleName:show)))(ExpressionStatement(Assignment(FieldAccess(ThisExpression)(SimpleName:dialogShow))(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dialog))(SimpleName:getResult))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:AddToKeystoreDialog.ACCEPT))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manager))(SimpleName:addTrustedCertificate)(METHOD_INVOCATION_ARGUMENTS(SimpleName:userCert)(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:manager))(SimpleName:reWriteKeyStore)))(ExpressionStatement(Assignment(SimpleName:acceptSigner)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:dialog))(SimpleName:getResult))(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:AddToKeystoreDialog.ONLY_FOR_SESSION))(Block(ExpressionStatement(Assignment(SimpleName:acceptSigner)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true))))))))(ExpressionStatement(Assignment(SimpleName:acceptAllSigner)(ASSIGNMENT_OPERATOR:=)(InfixExpression(SimpleName:acceptAllSigner)(INFIX_EXPRESSION_OPERATOR:&&)(SimpleName:acceptSigner))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:jis))(SimpleName:closeEntry)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:jis))(SimpleName:close)))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:signatureFound))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:IOException))(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:url)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:res))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))(ReturnStatement(InfixExpression(SimpleName:signatureFound)(INFIX_EXPRESSION_OPERATOR:&&)(SimpleName:acceptAllSigner)))))))