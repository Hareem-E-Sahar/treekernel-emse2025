(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:protected)(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:encrypt)(SingleVariableDeclaration(PrimitiveType:byte)(SimpleName:type))(SingleVariableDeclaration(ArrayType(PrimitiveType:byte)(Dimension))(SimpleName:fragment))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:offset))(SingleVariableDeclaration(PrimitiveType:int)(SimpleName:len))(Block(TryStatement(Block(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:content_mac_length)(InfixExpression(SimpleName:len)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:hash_size))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:padding_length)(ConditionalExpression(SimpleName:is_block_cipher)(Assignment(SimpleName:padding_length)(ASSIGNMENT_OPERATOR:=)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:8)(INFIX_EXPRESSION_OPERATOR:-)(ParenthesizedExpression(InfixExpression(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:++)(SimpleName:content_mac_length))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0x07)))))(INFIX_EXPRESSION_OPERATOR:&)(NumberLiteral:0x07))))(NumberLiteral:0))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:res)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(InfixExpression(SimpleName:content_mac_length)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:padding_length)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fragment)(SimpleName:offset)(SimpleName:res)(NumberLiteral:0)(SimpleName:len))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:mac_material_part)(NumberLiteral:0))(ASSIGNMENT_OPERATOR:=)(SimpleName:type)))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:mac_material_part)(NumberLiteral:1))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(ParenthesizedExpression(InfixExpression(NumberLiteral:0x00FF00)(INFIX_EXPRESSION_OPERATOR:&)(SimpleName:len)))(INFIX_EXPRESSION_OPERATOR:>>)(NumberLiteral:8))))))(ExpressionStatement(Assignment(ArrayAccess(SimpleName:mac_material_part)(NumberLiteral:2))(ASSIGNMENT_OPERATOR:=)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(InfixExpression(NumberLiteral:0x0000FF)(INFIX_EXPRESSION_OPERATOR:&)(SimpleName:len))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_write_secret))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pad_1))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:write_seq_num))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_material_part))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fragment)(SimpleName:offset)(SimpleName:len))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digest)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:mac_write_secret))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pad_2))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest))))(ExpressionStatement(Assignment(SimpleName:digest)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDigest))(SimpleName:digest))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:arraycopy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digest)(NumberLiteral:0)(SimpleName:res)(SimpleName:len)(SimpleName:hash_size))))(IfStatement(SimpleName:is_block_cipher)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:fill)(METHOD_INVOCATION_ARGUMENTS(SimpleName:res)(InfixExpression(SimpleName:content_mac_length)(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))(QualifiedName:res.length)(CastExpression(PrimitiveType:byte)(ParenthesizedExpression(SimpleName:padding_length))))))))(IfStatement(InfixExpression(SimpleName:logger)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:println)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(ParenthesizedExpression(ConditionalExpression(SimpleName:is_block_cipher)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:padding_length)(StringLiteral:<STR>))(StringLiteral:<STR>)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(SimpleName:res))))))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:rez)(ArrayCreation(ArrayType(PrimitiveType:byte)(Dimension(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encCipher))(SimpleName:getOutputSize)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:res.length))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:encCipher))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:res)(NumberLiteral:0)(QualifiedName:res.length)(SimpleName:rez))))(ExpressionStatement(MethodInvocation(SimpleName:incSequenceNumber)(METHOD_INVOCATION_ARGUMENTS(SimpleName:write_seq_num))))(ReturnStatement(SimpleName:rez)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:GeneralSecurityException))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:printStackTrace)))(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:AlertException))(QualifiedName:AlertProtocol.INTERNAL_ERROR)(ClassInstanceCreation(SimpleType(SimpleName:SSLProtocolException))(StringLiteral:<STR>)))))))))))