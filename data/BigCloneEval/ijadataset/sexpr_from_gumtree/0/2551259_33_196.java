(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(SingleMemberAnnotation(SimpleName:SuppressWarnings)(StringLiteral:<STR>))(Modifier:protected)(SimpleType(SimpleName:ModelAndView))(SimpleName:handleRequestAfterValidation)(SingleVariableDeclaration(SimpleType(SimpleName:HttpServletRequest))(SimpleName:request))(SingleVariableDeclaration(SimpleType(SimpleName:HttpServletResponse))(SimpleName:response))(SimpleType(SimpleName:Exception))(Block(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:zipEncodeFilenames)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SPropsUtil))(SimpleName:getBoolean)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(BooleanLiteral:false)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:zipFilenameEncoding)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SPropsUtil))(SimpleName:getString)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:pathInfo)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getPathInfo))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:String))(Dimension))(VariableDeclarationFragment(SimpleName:args)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pathInfo))(SimpleName:split)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Constants.SLASH)))))(IfStatement(InfixExpression(InfixExpression(QualifiedName:args.length)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:WebUrlUtil.FILE_URL_ZIP_ARG_LENGTH))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_FILE_ID)))))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Boolean))(VariableDeclarationFragment(SimpleName:singleByte)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SPropsUtil))(SimpleName:getBoolean)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(BooleanLiteral:true)))))(VariableDeclarationStatement(SimpleType(SimpleName:DefinableEntity))(VariableDeclarationFragment(SimpleName:entity)(MethodInvocation(SimpleName:getEntity)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_ENTITY_TYPE))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Long))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_ENTITY_ID))))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Set))(SimpleType(SimpleName:Attachment)))(VariableDeclarationFragment(SimpleName:attachments)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getAttachments))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:fileName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getBinderModule)))(SimpleName:filename8BitSingleByteOnly)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getTitle))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(StringLiteral:<STR>)(SimpleName:singleByte)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setContentType)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mimeTypes))(SimpleName:getContentType)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fileName))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:fileName)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:fileStream)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ZipOutputStream))(VariableDeclarationFragment(SimpleName:zipOut)(ClassInstanceCreation(SimpleType(SimpleName:ZipOutputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:setEncoding)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zipFilenameEncoding))))(VariableDeclarationStatement(SimpleType(SimpleName:Integer))(VariableDeclarationFragment(SimpleName:fileCounter)(NumberLiteral:1)))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Attachment))(SimpleName:attachment))(SimpleName:attachments)(Block(IfStatement(InstanceofExpression(SimpleName:attachment)(SimpleType(SimpleName:FileAttachment)))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:attExt)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EntityIndexUtils))(SimpleName:getFileExtension)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:FileAttachment))(SimpleName:attachment))))(SimpleName:getFileItem)))(SimpleName:getName))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:attName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:FileAttachment))(SimpleName:attachment))))(SimpleName:getFileItem)))(SimpleName:getName))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:zipEncodeFilenames))(Block(ExpressionStatement(Assignment(SimpleName:attName)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getBinderModule)))(SimpleName:filename8BitSingleByteOnly)(METHOD_INVOCATION_ARGUMENTS(SimpleName:attName)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileCounter))(SimpleName:toString)))(SimpleName:singleByte)))))))(ExpressionStatement(PostfixExpression(SimpleName:fileCounter)(POSTFIX_EXPRESSION_OPERATOR:++)))(TryStatement(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getEntityType)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:EntityType.folderEntry)))(Block(ExpressionStatement(Assignment(SimpleName:fileStream)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getFileModule)))(SimpleName:readFile)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getParentBinder))(SimpleName:entity)(CastExpression(SimpleType(SimpleName:FileAttachment))(SimpleName:attachment)))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getEntityType)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:EntityType.folder)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getEntityType)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:EntityType.workspace))))(Block(ExpressionStatement(Assignment(SimpleName:fileStream)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getFileModule)))(SimpleName:readFile)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:Binder))(SimpleName:entity))(SimpleName:entity)(CastExpression(SimpleType(SimpleName:FileAttachment))(SimpleName:attachment)))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:finish)))(ReturnStatement(NullLiteral)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:putNextEntry)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ZipEntry))(SimpleName:attName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtil))(SimpleName:copy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fileStream)(SimpleName:zipOut))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:closeEntry)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileStream))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e)))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:finish)))(ReturnStatement(NullLiteral)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream)))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NLT))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))))(ReturnStatement(NullLiteral)))(IfStatement(InfixExpression(InfixExpression(QualifiedName:args.length)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:WebUrlUtil.FILE_URL_ZIP_SINGLE_ARG_LENGTH))(INFIX_EXPRESSION_OPERATOR:&&)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_FILE_ID)))))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:faId)(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_ZIP_SINGLE_FILE_ID))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Boolean))(VariableDeclarationFragment(SimpleName:singleByte)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SPropsUtil))(SimpleName:getBoolean)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(BooleanLiteral:true)))))(VariableDeclarationStatement(SimpleType(SimpleName:DefinableEntity))(VariableDeclarationFragment(SimpleName:entity)(MethodInvocation(SimpleName:getEntity)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_ENTITY_TYPE))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Long))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_ENTITY_ID))))))))(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Set))(SimpleType(SimpleName:Attachment)))(VariableDeclarationFragment(SimpleName:attachments)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getAttachments))))(VariableDeclarationStatement(SimpleType(SimpleName:FileAttachment))(VariableDeclarationFragment(SimpleName:fileAtt)(NullLiteral)))(EnhancedForStatement(SingleVariableDeclaration(SimpleType(SimpleName:Attachment))(SimpleName:attachment))(SimpleName:attachments)(Block(IfStatement(InstanceofExpression(SimpleName:attachment)(SimpleType(SimpleName:FileAttachment)))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:attachment))(SimpleName:getId)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:faId)))(Block(ExpressionStatement(Assignment(SimpleName:fileAtt)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:FileAttachment))(SimpleName:attachment))))(BreakStatement)))(ExpressionStatement(Assignment(SimpleName:fileAtt)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:FileAttachment))(SimpleName:attachment))))(SimpleName:findFileVersionById)(METHOD_INVOCATION_ARGUMENTS(SimpleName:faId)))))(IfStatement(InfixExpression(SimpleName:fileAtt)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(BreakStatement))))))(IfStatement(InfixExpression(SimpleName:fileAtt)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:fileName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EntityIndexUtils))(SimpleName:getFileNameWithoutExtension)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileAtt))(SimpleName:getFileItem)))(SimpleName:getName))))))(ExpressionStatement(Assignment(SimpleName:fileName)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getBinderModule)))(SimpleName:filename8BitSingleByteOnly)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(SimpleName:fileName)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>))(StringLiteral:<STR>)(SimpleName:singleByte)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setContentType)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mimeTypes))(SimpleName:getContentType)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fileName))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:fileName)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:InputStream))(VariableDeclarationFragment(SimpleName:fileStream)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:ZipOutputStream))(VariableDeclarationFragment(SimpleName:zipOut)(ClassInstanceCreation(SimpleType(SimpleName:ZipOutputStream))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:setEncoding)(METHOD_INVOCATION_ARGUMENTS(SimpleName:zipFilenameEncoding))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:attExt)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:EntityIndexUtils))(SimpleName:getFileExtension)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileAtt))(SimpleName:getFileItem)))(SimpleName:getName))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:attName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileAtt))(SimpleName:getFileItem)))(SimpleName:getName))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(SimpleName:zipEncodeFilenames))(Block(ExpressionStatement(Assignment(SimpleName:attName)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getBinderModule)))(SimpleName:filename8BitSingleByteOnly)(METHOD_INVOCATION_ARGUMENTS(SimpleName:attName)(StringLiteral:<STR>)(SimpleName:singleByte)))))))(TryStatement(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getEntityType)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:EntityType.folderEntry)))(Block(ExpressionStatement(Assignment(SimpleName:fileStream)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getFileModule)))(SimpleName:readFile)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getParentBinder))(SimpleName:entity)(SimpleName:fileAtt))))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getEntityType)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:EntityType.folder)))(INFIX_EXPRESSION_OPERATOR:||)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:entity))(SimpleName:getEntityType)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:EntityType.workspace))))(Block(ExpressionStatement(Assignment(SimpleName:fileStream)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getFileModule)))(SimpleName:readFile)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:Binder))(SimpleName:entity))(SimpleName:entity)(SimpleName:fileAtt))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:finish)))(ReturnStatement(NullLiteral)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:putNextEntry)(METHOD_INVOCATION_ARGUMENTS(ClassInstanceCreation(SimpleType(SimpleName:ZipEntry))(SimpleName:attName)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:loggerText)(StringLiteral:<STR>)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileAtt))(SimpleName:isEncrypted))(Block(ExpressionStatement(Assignment(SimpleName:loggerText)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))))(VariableDeclarationStatement(PrimitiveType:long)(VariableDeclarationFragment(SimpleName:startTime)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:System))(SimpleName:nanoTime))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtil))(SimpleName:copy)(METHOD_INVOCATION_ARGUMENTS(SimpleName:fileStream)(SimpleName:zipOut))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:closeEntry)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fileStream))(SimpleName:close))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:logger))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(SimpleName:e)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:zipOut))(SimpleName:finish)))))(ReturnStatement(NullLiteral)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream)))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NLT))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))))(ReturnStatement(NullLiteral)))(IfStatement(InfixExpression(QualifiedName:args.length)(INFIX_EXPRESSION_OPERATOR:<)(QualifiedName:WebUrlUtil.FILE_URL_ARG_LENGTH))(Block(ReturnStatement(NullLiteral)))(Block(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:DefinableEntity))(VariableDeclarationFragment(SimpleName:entity)(MethodInvocation(SimpleName:getEntity)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_ENTITY_TYPE))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Long))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_ENTITY_ID))))))))(VariableDeclarationStatement(SimpleType(SimpleName:FileAttachment))(VariableDeclarationFragment(SimpleName:fa)(NullLiteral)))(IfStatement(InfixExpression(InfixExpression(QualifiedName:args.length)(INFIX_EXPRESSION_OPERATOR:>)(QualifiedName:WebUrlUtil.FILE_URL_ARG_LENGTH))(INFIX_EXPRESSION_OPERATOR:&&)(InstanceofExpression(SimpleName:entity)(SimpleType(SimpleName:FolderEntry))))(Block(ExpressionStatement(Assignment(SimpleName:fa)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getAttachment)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:FolderEntry))(SimpleName:entity))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Arrays))(SimpleName:asList)(METHOD_INVOCATION_ARGUMENTS(SimpleName:args))))(SimpleName:subList)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:WebUrlUtil.FILE_URL_NAME)(QualifiedName:args.length))))(SimpleName:toArray))))))(IfStatement(InfixExpression(SimpleName:fa)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:entity)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fa))(SimpleName:getOwner)))(SimpleName:getEntity)))))))(Block(ExpressionStatement(Assignment(SimpleName:fa)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:getAttachment)(METHOD_INVOCATION_ARGUMENTS(SimpleName:entity)(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_NAME))(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_VERSION))(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_FILE_ID))))))))(IfStatement(InfixExpression(SimpleName:fa)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:shortFileName)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileUtil))(SimpleName:getShortFileName)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fa))(SimpleName:getFileItem)))(SimpleName:getName))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:contentType)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getFileTypeMap)))(SimpleName:getContentType)(METHOD_INVOCATION_ARGUMENTS(SimpleName:shortFileName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setContentType)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentType))))(VariableDeclarationStatement(PrimitiveType:boolean)(VariableDeclarationFragment(SimpleName:isHttps)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:request))(SimpleName:getScheme)))(SimpleName:equalsIgnoreCase)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cacheControl)(StringLiteral:<STR>)))(IfStatement(SimpleName:isHttps)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(StringLiteral:<STR>))))(ExpressionStatement(Assignment(SimpleName:cacheControl)(ASSIGNMENT_OPERATOR:+=)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(SimpleName:cacheControl))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:attachment)(StringLiteral:<STR>)))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileHelper))(SimpleName:checkIfAttachment)(METHOD_INVOCATION_ARGUMENTS(SimpleName:contentType)))(ExpressionStatement(Assignment(SimpleName:attachment)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(InfixExpression(SimpleName:attachment)(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileHelper))(SimpleName:encodeFileName)(METHOD_INVOCATION_ARGUMENTS(SimpleName:request)(SimpleName:shortFileName)))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(SimpleName:formatDate)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fa))(SimpleName:getModification)))(SimpleName:getDate)))))))(TryStatement(Block(VariableDeclarationStatement(SimpleType(SimpleName:Binder))(VariableDeclarationFragment(SimpleName:parent)(MethodInvocation(SimpleName:getBinder)(METHOD_INVOCATION_ARGUMENTS(SimpleName:entity)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:fa))(SimpleName:isEncrypted)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:setHeader)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FileHelper))(SimpleName:getLength)(METHOD_INVOCATION_ARGUMENTS(SimpleName:parent)(SimpleName:entity)(SimpleName:fa))))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getFileModule)))(SimpleName:readFile)(METHOD_INVOCATION_ARGUMENTS(SimpleName:parent)(SimpleName:entity)(SimpleName:fa)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ArrayAccess(SimpleName:args)(QualifiedName:WebUrlUtil.FILE_URL_VERSION)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:WebKeys.READ_FILE_LAST_VIEW)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getReportModule)))(SimpleName:addFileInfo)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:AuditType.download)(SimpleName:fa)))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream)))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NLT))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))(INFIX_EXPRESSION_OPERATOR:+)(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getLocalizedMessage))))))))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream)))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NLT))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))))))(TryStatement(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream)))(SimpleName:flush))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:ignore))(Block))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getOutputStream)))(SimpleName:print)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:NLT))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)))))))))))))(ReturnStatement(NullLiteral))))))