(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(PrimitiveType:int)(SimpleName:_authenticate)(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:companyId))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:login))(SingleVariableDeclaration(SimpleType(SimpleName:String))(SimpleName:password))(SingleVariableDeclaration(PrimitiveType:boolean)(SimpleName:byEmailAddress))(SimpleType(SimpleName:PortalException))(SimpleType(SimpleName:SystemException))(Block(ExpressionStatement(Assignment(SimpleName:login)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:login))(SimpleName:trim)))(SimpleName:toLowerCase))))(IfStatement(SimpleName:byEmailAddress)(Block(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Validator))(SimpleName:isEmailAddress)(METHOD_INVOCATION_ARGUMENTS(SimpleName:login))))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:UserEmailAddressException)))))))(Block(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Validator))(SimpleName:isNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:login)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:UserIdException))))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Validator))(SimpleName:isNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:UserPasswordException))(QualifiedName:UserPasswordException.PASSWORD_INVALID)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:authResult)(QualifiedName:Authenticator.FAILURE)))(IfStatement(SimpleName:byEmailAddress)(Block(ExpressionStatement(Assignment(SimpleName:authResult)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AuthPipeline))(SimpleName:authenticateByEmailAddress)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:getArray)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.AUTH_PIPELINE_PRE)))(SimpleName:companyId)(SimpleName:login)(SimpleName:password))))))(Block(ExpressionStatement(Assignment(SimpleName:authResult)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AuthPipeline))(SimpleName:authenticateByUserId)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:getArray)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.AUTH_PIPELINE_PRE)))(SimpleName:companyId)(SimpleName:login)(SimpleName:password)))))))(VariableDeclarationStatement(SimpleType(SimpleName:User))(VariableDeclarationFragment(SimpleName:user)(NullLiteral)))(TryStatement(Block(IfStatement(SimpleName:byEmailAddress)(Block(ExpressionStatement(Assignment(SimpleName:user)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserUtil))(SimpleName:findByC_EA)(METHOD_INVOCATION_ARGUMENTS(SimpleName:companyId)(SimpleName:login))))))(Block(ExpressionStatement(Assignment(SimpleName:user)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserUtil))(SimpleName:findByC_U)(METHOD_INVOCATION_ARGUMENTS(SimpleName:companyId)(SimpleName:login))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchUserException))(SimpleName:nsue))(Block(ReturnStatement(QualifiedName:Authenticator.DNE)))))(IfStatement(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:!)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:isPasswordEncrypted)))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setPassword)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Encryptor))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:getPassword)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setPasswordEncrypted)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setPasswordReset)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:GetterUtil))(SimpleName:getBoolean)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.PASSWORDS_CHANGE_ON_FIRST_USE))))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserUtil))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:isPasswordExpired))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setPasswordReset)(METHOD_INVOCATION_ARGUMENTS(BooleanLiteral:true))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserUtil))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user)))))))(IfStatement(InfixExpression(SimpleName:authResult)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:Authenticator.SUCCESS))(Block(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:encPwd)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Encryptor))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(SimpleName:password)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:getPassword)))(SimpleName:equals)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encPwd)))(Block(ExpressionStatement(Assignment(SimpleName:authResult)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Authenticator.SUCCESS))))(Block(ExpressionStatement(Assignment(SimpleName:authResult)(ASSIGNMENT_OPERATOR:=)(QualifiedName:Authenticator.FAILURE)))))))(IfStatement(InfixExpression(SimpleName:authResult)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:Authenticator.SUCCESS))(Block(IfStatement(SimpleName:byEmailAddress)(Block(ExpressionStatement(Assignment(SimpleName:authResult)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AuthPipeline))(SimpleName:authenticateByEmailAddress)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:getArray)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.AUTH_PIPELINE_POST)))(SimpleName:companyId)(SimpleName:login)(SimpleName:password))))))(Block(ExpressionStatement(Assignment(SimpleName:authResult)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AuthPipeline))(SimpleName:authenticateByUserId)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:getArray)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.AUTH_PIPELINE_POST)))(SimpleName:companyId)(SimpleName:login)(SimpleName:password)))))))))(IfStatement(InfixExpression(SimpleName:authResult)(INFIX_EXPRESSION_OPERATOR:==)(QualifiedName:Authenticator.FAILURE))(Block(TryStatement(Block(IfStatement(SimpleName:byEmailAddress)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AuthPipeline))(SimpleName:onFailureByEmailAddress)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:getArray)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.AUTH_FAILURE)))(SimpleName:companyId)(SimpleName:login)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AuthPipeline))(SimpleName:onFailureByUserId)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:getArray)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.AUTH_FAILURE)))(SimpleName:companyId)(SimpleName:login))))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:failedLoginAttempts)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:getFailedLoginAttempts))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:user))(SimpleName:setFailedLoginAttempts)(METHOD_INVOCATION_ARGUMENTS(PrefixExpression(PREFIX_EXPRESSION_OPERATOR:++)(SimpleName:failedLoginAttempts)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UserUtil))(SimpleName:update)(METHOD_INVOCATION_ARGUMENTS(SimpleName:user))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:maxFailures)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:GetterUtil))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:get)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.AUTH_MAX_FAILURES_LIMIT)))(NumberLiteral:0)))))(IfStatement(InfixExpression(ParenthesizedExpression(InfixExpression(SimpleName:failedLoginAttempts)(INFIX_EXPRESSION_OPERATOR:>=)(SimpleName:maxFailures)))(INFIX_EXPRESSION_OPERATOR:&&)(ParenthesizedExpression(InfixExpression(SimpleName:maxFailures)(INFIX_EXPRESSION_OPERATOR:!=)(NumberLiteral:0))))(Block(IfStatement(SimpleName:byEmailAddress)(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AuthPipeline))(SimpleName:onMaxFailuresByEmailAddress)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:getArray)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.AUTH_MAX_FAILURES)))(SimpleName:companyId)(SimpleName:login)))))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:AuthPipeline))(SimpleName:onMaxFailuresByUserId)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:PropsUtil))(SimpleName:getArray)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:PropsUtil.AUTH_MAX_FAILURES)))(SimpleName:companyId)(SimpleName:login)))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Logger))(SimpleName:error)(METHOD_INVOCATION_ARGUMENTS(ThisExpression)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:e))(SimpleName:getMessage))(SimpleName:e)))))))))(ReturnStatement(SimpleName:authResult))))))