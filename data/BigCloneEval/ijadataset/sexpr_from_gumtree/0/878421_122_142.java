(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleType(SimpleName:OutputStream))(SimpleName:encrypt)(SingleVariableDeclaration(SimpleType(SimpleName:OutputStream))(SimpleName:outputStream))(SimpleType(SimpleName:Exception))(Block(IfStatement(InfixExpression(SimpleName:key)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ExpressionStatement(Assignment(SimpleName:key)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:generateKey)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:getKeysize))))))(ExpressionStatement(Assignment(SimpleName:pbeIV)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:randomBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:PBE_IV_LENGTH)))))(ExpressionStatement(Assignment(SimpleName:encryptionIV)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:randomBytes)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ENCRYPTION_IV_LENGTH)))))(ExpressionStatement(Assignment(SimpleName:encryptedKeyBytes)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:transformWithPassword)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:key))(SimpleName:getEncoded))(SimpleName:pbeIV)(SimpleName:password)(QualifiedName:Cipher.ENCRYPT_MODE)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outputStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:pbeIV))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outputStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptionIV))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outputStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:encryptedKeyBytes.length))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:outputStream))(SimpleName:write)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encryptedKeyBytes))))(VariableDeclarationStatement(SimpleType(SimpleName:Cipher))(VariableDeclarationFragment(SimpleName:cipher)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Cipher))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ENCRYPTION_ALGORITHM)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:cipher))(SimpleName:init)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Cipher.ENCRYPT_MODE)(SimpleName:key)(ClassInstanceCreation(SimpleType(SimpleName:IvParameterSpec))(SimpleName:encryptionIV)))))(ExpressionStatement(Assignment(SimpleName:outputStream)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:FilterOutputStream))(SimpleName:outputStream)(AnonymousClassDeclaration(MethodDeclaration(MarkerAnnotation(SimpleName:Override))(Modifier:public)(PrimitiveType:void)(SimpleName:close)(SimpleType(SimpleName:IOException))(Block))))))(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:CipherOutputStream))(SimpleName:outputStream)(SimpleName:cipher)))))))