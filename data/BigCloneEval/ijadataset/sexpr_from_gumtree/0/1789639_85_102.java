(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:public)(SimpleName:OldIcbm)(SingleVariableDeclaration(SimpleType(SimpleName:SnacPacket))(SimpleName:packet))(Block(SuperConstructorInvocation(QualifiedName:IcbmCommand.CMD_ICBM)(SimpleName:packet))(ExpressionStatement(Assignment(SimpleName:requestID)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:packet))(SimpleName:getReqid))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:DefensiveTools))(SimpleName:checkNull)(METHOD_INVOCATION_ARGUMENTS(SimpleName:packet)(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteBlock))(VariableDeclarationFragment(SimpleName:snacData)(MethodInvocation(SimpleName:getChannelData))))(ExpressionStatement(Assignment(SimpleName:userInfo)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:FullUserInfo))(SimpleName:readUserInfo)(METHOD_INVOCATION_ARGUMENTS(SimpleName:snacData)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteBlock))(VariableDeclarationFragment(SimpleName:tlvBlock)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:snacData))(SimpleName:subBlock)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:userInfo))(SimpleName:getTotalSize))))))(VariableDeclarationStatement(SimpleType(SimpleName:TlvChain))(VariableDeclarationFragment(SimpleName:chain)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:TlvTools))(SimpleName:readChain)(METHOD_INVOCATION_ARGUMENTS(SimpleName:tlvBlock)))))(VariableDeclarationStatement(SimpleType(SimpleName:Tlv))(VariableDeclarationFragment(SimpleName:messageDataTlv)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:chain))(SimpleName:getLastTlv)(METHOD_INVOCATION_ARGUMENTS(SimpleName:TYPE_MESSAGE_DATA)))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteBlock))(VariableDeclarationFragment(SimpleName:messageData)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageDataTlv))(SimpleName:getData))))(ExpressionStatement(Assignment(SimpleName:sender)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LEBinaryTools))(SimpleName:getUInt)(METHOD_INVOCATION_ARGUMENTS(SimpleName:messageData)(NumberLiteral:0)))))(ExpressionStatement(Assignment(SimpleName:messageType)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LEBinaryTools))(SimpleName:getUByte)(METHOD_INVOCATION_ARGUMENTS(SimpleName:messageData)(NumberLiteral:4)))))(VariableDeclarationStatement(PrimitiveType:short)(VariableDeclarationFragment(SimpleName:msgFlags)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LEBinaryTools))(SimpleName:getUByte)(METHOD_INVOCATION_ARGUMENTS(SimpleName:messageData)(NumberLiteral:5)))))(VariableDeclarationStatement(PrimitiveType:int)(VariableDeclarationFragment(SimpleName:textlen)(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LEBinaryTools))(SimpleName:getUShort)(METHOD_INVOCATION_ARGUMENTS(SimpleName:messageData)(NumberLiteral:6)))(INFIX_EXPRESSION_OPERATOR:-)(NumberLiteral:1))))(VariableDeclarationStatement(SimpleType(SimpleName:ByteBlock))(VariableDeclarationFragment(SimpleName:field)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:messageData))(SimpleName:subBlock)(METHOD_INVOCATION_ARGUMENTS(NumberLiteral:8)(SimpleName:textlen)))))(VariableDeclarationStatement(SimpleType(SimpleName:ImEncodingParams))(VariableDeclarationFragment(SimpleName:encoding)(ClassInstanceCreation(SimpleType(SimpleName:ImEncodingParams))(NumberLiteral:0))))(ExpressionStatement(Assignment(SimpleName:reason)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ImEncodedString))(SimpleName:readImEncodedString)(METHOD_INVOCATION_ARGUMENTS(SimpleName:encoding)(SimpleName:field)))))))))