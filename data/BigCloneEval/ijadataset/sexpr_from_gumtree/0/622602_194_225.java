(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:protected)(Modifier:static)(SimpleType(SimpleName:String))(SimpleName:incrementalRefresh)(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:Connection))(SimpleName:masterConn))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:Connection))(SimpleName:replicaConn))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:Subscriber))(SimpleName:suber))(SingleVariableDeclaration(Modifier:final)(SimpleType(SimpleName:Subscription))(SimpleName:subs))(SimpleType(SimpleName:SQLException))(SimpleType(SimpleName:SyncDatabaseException))(Block(IfStatement(InfixExpression(InfixExpression(InfixExpression(InfixExpression(SimpleName:masterConn)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:replicaConn)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:suber)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:subs)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ThrowStatement(ClassInstanceCreation(SimpleType(SimpleName:SyncDatabaseException))(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:IncrementalReader))(VariableDeclarationFragment(SimpleName:reader)(NullLiteral)))(VariableDeclarationStatement(SimpleType(SimpleName:IncrementalWriter))(VariableDeclarationFragment(SimpleName:writer)(NullLiteral)))(TryStatement(Block(VariableDeclarationStatement(ParameterizedType(SimpleType(SimpleName:Hashtable))(SimpleType(SimpleName:Short))(SimpleType(SimpleName:String)))(VariableDeclarationFragment(SimpleName:pkNames)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SyncDatabaseDAO))(SimpleName:getPKNames)(METHOD_INVOCATION_ARGUMENTS(SimpleName:masterConn)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:suber))(SimpleName:getNspName))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:suber))(SimpleName:getRelName))))))(VariableDeclarationStatement(Modifier:final)(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:incrementalQuery)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:IncrementalReader))(SimpleName:getIncrementalQuery)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:suber))(SimpleName:getMlogName))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subs))(SimpleName:getQuery))(SimpleName:pkNames)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:suber))(SimpleName:getLastMlogID))))))(ExpressionStatement(Assignment(SimpleName:reader)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:IncrementalReader))(SimpleName:masterConn)(SimpleName:incrementalQuery)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:pkNames))(SimpleName:size)))))(ExpressionStatement(Assignment(SimpleName:pkNames)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:SyncDatabaseDAO))(SimpleName:getPKNames)(METHOD_INVOCATION_ARGUMENTS(SimpleName:replicaConn)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subs))(SimpleName:getSchema))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subs))(SimpleName:getTable))))))(ExpressionStatement(Assignment(SimpleName:writer)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:IncrementalWriter))(SimpleName:replicaConn)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subs))(SimpleName:getSchema))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subs))(SimpleName:getTable))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getColumnCount))(SimpleName:pkNames))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MappingData))(SimpleName:createDataMappers)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getColumnMapping))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getColumnMapping)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:prepare)(METHOD_INVOCATION_ARGUMENTS(SimpleName:replicaConn)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subs))(SimpleName:getReplicaTable)))))(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Object))(Dimension))(VariableDeclarationFragment(SimpleName:columns)))(WhileStatement(InfixExpression(ParenthesizedExpression(Assignment(SimpleName:columns)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:getNextColumns))))(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:setColumns)(METHOD_INVOCATION_ARGUMENTS(SimpleName:columns)))))))(Block(IfStatement(InfixExpression(SimpleName:reader)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:reader))(SimpleName:close)))))(IfStatement(InfixExpression(SimpleName:writer)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:close)))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:subs))(SimpleName:setLastType)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:suber))(SimpleName:setLastType)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:suber))(SimpleName:setLastCount)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:suber))(SimpleName:getLastCount))(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getInsertCount)))(INFIX_EXPRESSION_OPERATOR:-)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getDeleteCount))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:log))(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getInsertCount))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getDeleteCount))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getUpdateCount))(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getExecCount))))))(ReturnStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:mProperty))(SimpleName:getMessage)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getInsertCount))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getUpdateCount))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:writer))(SimpleName:getDeleteCount)))))))))