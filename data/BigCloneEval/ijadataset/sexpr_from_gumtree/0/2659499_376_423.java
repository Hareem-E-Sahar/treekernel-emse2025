(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(SimpleType(SimpleName:Exception))(SimpleName:takeControl)(SingleVariableDeclaration(SimpleType(SimpleName:ManagerConnection))(SimpleName:connection))(SingleVariableDeclaration(SimpleType(SimpleName:SafletContext))(SimpleName:context))(SimpleType(SimpleName:ActionStepException))(SimpleType(SimpleName:IOException))(SimpleType(SimpleName:IllegalArgumentException))(SimpleType(SimpleName:IllegalStateException))(SimpleType(SimpleName:TimeoutException))(SimpleType(SimpleName:AgiException))(Block(VariableDeclarationStatement(SimpleType(SimpleName:OriginateAction))(VariableDeclarationFragment(SimpleName:action)(ClassInstanceCreation(SimpleType(SimpleName:OriginateAction)))))(VariableDeclarationStatement(SimpleType(SimpleName:Object))(VariableDeclarationFragment(SimpleName:dynValue)(MethodInvocation(SimpleName:resolveDynamicValue)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:channel))(SimpleName:context)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:chan)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:VariableTranslator))(SimpleName:translateValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:VariableType.TEXT)(SimpleName:dynValue))))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:StringUtils))(SimpleName:isBlank)(METHOD_INVOCATION_ARGUMENTS(SimpleName:chan)))(Block(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:ActionStepException))(StringLiteral:<STR>)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:debugLog))(SimpleName:isLoggable)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:Level.FINEST)))(ExpressionStatement(MethodInvocation(SimpleName:debug)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:chan))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:action))(SimpleName:setContext)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:action))(SimpleName:setApplication)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(VariableDeclarationStatement(SimpleType(SimpleName:AsteriskServer))(VariableDeclarationFragment(SimpleName:server)(CastExpression(SimpleType(SimpleName:AsteriskServer))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:context))(SimpleName:getVariableRawValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:SafletConstants.VAR_KEY_TELEPHONY_SUBSYSTEM))))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:serverAddr)(ConditionalExpression(InfixExpression(SimpleName:server)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(NullLiteral)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:server))(SimpleName:getVisibleSafiServerIP)))))(IfStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:StringUtils))(SimpleName:isBlank)(METHOD_INVOCATION_ARGUMENTS(SimpleName:serverAddr)))(ExpressionStatement(Assignment(SimpleName:serverAddr)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:connection))(SimpleName:getLocalAddress)))(SimpleName:getCanonicalHostName)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:action))(SimpleName:setData)(METHOD_INVOCATION_ARGUMENTS(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(SimpleName:serverAddr)(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:action))(SimpleName:setChannel)(METHOD_INVOCATION_ARGUMENTS(SimpleName:chan))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:action))(SimpleName:setAsync)(METHOD_INVOCATION_ARGUMENTS(SimpleName:async))))(ExpressionStatement(Assignment(SimpleName:dynValue)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:resolveDynamicValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:callerId)(SimpleName:context)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:cid)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:VariableTranslator))(SimpleName:translateValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:VariableType.TEXT)(SimpleName:dynValue))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:action))(SimpleName:setCallerId)(METHOD_INVOCATION_ARGUMENTS(SimpleName:cid))))(ExpressionStatement(Assignment(SimpleName:dynValue)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:resolveDynamicValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:account)(SimpleName:context)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:acctVal)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:VariableTranslator))(SimpleName:translateValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:VariableType.TEXT)(SimpleName:dynValue))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:action))(SimpleName:setAccount)(METHOD_INVOCATION_ARGUMENTS(SimpleName:acctVal))))(VariableDeclarationStatement(SimpleType(SimpleName:UUID))(VariableDeclarationFragment(SimpleName:uuid)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:UUID))(SimpleName:randomUUID))))(VariableDeclarationStatement(SimpleType(SimpleName:AsteriskSafletEnvironment))(VariableDeclarationFragment(SimpleName:handlerEnvironment)(CastExpression(SimpleType(SimpleName:AsteriskSafletEnvironment))(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(SimpleName:getSaflet)))(SimpleName:getSafletEnvironment)))))(VariableDeclarationStatement(SimpleType(SimpleName:Long))(VariableDeclarationFragment(SimpleName:timeoutVal)(ClassInstanceCreation(SimpleType(SimpleName:Long))(ConditionalExpression(InfixExpression(SimpleName:timeout)(INFIX_EXPRESSION_OPERATOR:<=)(NumberLiteral:0))(QualifiedName:Saflet.DEFAULT_MANAGER_ACTION_TIMEOUT)(SimpleName:timeout)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:handlerEnvironment))(SimpleName:setLoopbackLock)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uuid))(SimpleName:toString))(SimpleName:timeoutVal))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:action))(SimpleName:setVariable)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uuid))(SimpleName:toString)))))(VariableDeclarationStatement(SimpleType(SimpleName:ManagerResponse))(VariableDeclarationFragment(SimpleName:response)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:connection))(SimpleName:sendAction)(METHOD_INVOCATION_ARGUMENTS(SimpleName:action)(QualifiedName:Saflet.DEFAULT_MANAGER_ACTION_TIMEOUT)))))(IfStatement(InstanceofExpression(SimpleName:response)(SimpleType(SimpleName:ManagerError)))(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:ActionStepException))(InfixExpression(StringLiteral:<STR>)(INFIX_EXPRESSION_OPERATOR:+)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:response))(SimpleName:getMessage))))))(VariableDeclarationStatement(SimpleType(SimpleName:Object))(VariableDeclarationFragment(SimpleName:returned)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:handlerEnvironment))(SimpleName:getLoopbackCall)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:uuid))(SimpleName:toString))))))(IfStatement(InstanceofExpression(SimpleName:returned)(ArrayType(SimpleType(SimpleName:Object))(Dimension)))(Block(VariableDeclarationStatement(ArrayType(SimpleType(SimpleName:Object))(Dimension))(VariableDeclarationFragment(SimpleName:pair)(CastExpression(ArrayType(SimpleType(SimpleName:Object))(Dimension))(SimpleName:returned))))(IfStatement(InfixExpression(SimpleName:newCall1)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(ExpressionStatement(MethodInvocation(SimpleName:setNewCall1)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(QualifiedName:AsteriskFactoryImpl.eINSTANCE))(SimpleName:createCall))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Call))(SimpleName:newCall1))))(SimpleName:setChannel)(METHOD_INVOCATION_ARGUMENTS(CastExpression(SimpleType(SimpleName:AgiChannel))(ArrayAccess(SimpleName:pair)(NumberLiteral:0))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Call))(SimpleName:newCall1))))(SimpleName:setData)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>)(ArrayAccess(SimpleName:pair)(NumberLiteral:1))))))(Block(ReturnStatement(ClassInstanceCreation(SimpleType(SimpleName:ActionStepException))(StringLiteral:<STR>)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:action))(SimpleName:setCallingPres)(METHOD_INVOCATION_ARGUMENTS(SimpleName:callingPresentation))))(ExpressionStatement(Assignment(SimpleName:dynValue)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:resolveDynamicValue)(METHOD_INVOCATION_ARGUMENTS(FieldAccess(ThisExpression)(SimpleName:context))(SimpleName:context)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ctx)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:VariableTranslator))(SimpleName:translateValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:VariableType.TEXT)(SimpleName:dynValue))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Call))(SimpleName:newCall1))))(SimpleName:getChannel)))(SimpleName:setContext)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ctx))))(ExpressionStatement(Assignment(SimpleName:dynValue)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:resolveDynamicValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:extension)(SimpleName:context)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:ext)(CastExpression(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:VariableTranslator))(SimpleName:translateValue)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:VariableType.TEXT)(SimpleName:dynValue))))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Call))(SimpleName:newCall1))))(SimpleName:getChannel)))(SimpleName:setExtension)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ext))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Call))(SimpleName:newCall1))))(SimpleName:getChannel)))(SimpleName:setPriority)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:String))(SimpleName:valueOf)(METHOD_INVOCATION_ARGUMENTS(SimpleName:priority))))))(ReturnStatement(NullLiteral))))))