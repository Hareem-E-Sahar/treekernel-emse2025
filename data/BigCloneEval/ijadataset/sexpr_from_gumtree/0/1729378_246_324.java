(CompilationUnit(TypeDeclaration(Modifier:public)(TYPE_DECLARATION_KIND:class)(SimpleName:Test)(MethodDeclaration(Modifier:private)(Modifier:static)(SimpleType(SimpleName:XMLSignature))(SimpleName:signInternal)(SingleVariableDeclaration(SimpleType(SimpleName:Node))(SimpleName:a_node))(SingleVariableDeclaration(SimpleType(SimpleName:IMyPrivateKey))(SimpleName:a_privateKey))(SimpleType(SimpleName:XMLParseException))(Block(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:digestValue)))(VariableDeclarationStatement(ArrayType(PrimitiveType:byte)(Dimension))(VariableDeclarationFragment(SimpleName:signatureValue)))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:elementToSign)))(VariableDeclarationStatement(SimpleType(SimpleName:XMLSignature))(VariableDeclarationFragment(SimpleName:xmlSignature)))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:oldSignatureNode)))(IfStatement(InfixExpression(InfixExpression(SimpleName:a_node)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(INFIX_EXPRESSION_OPERATOR:||)(InfixExpression(SimpleName:a_privateKey)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral)))(Block(ReturnStatement(NullLiteral)))(IfStatement(InstanceofExpression(SimpleName:a_node)(SimpleType(SimpleName:Document)))(Block(ExpressionStatement(Assignment(SimpleName:elementToSign)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(ParenthesizedExpression(CastExpression(SimpleType(SimpleName:Document))(SimpleName:a_node))))(SimpleName:getDocumentElement)))))(IfStatement(InstanceofExpression(SimpleName:a_node)(SimpleType(SimpleName:Element)))(Block(ExpressionStatement(Assignment(SimpleName:elementToSign)(ASSIGNMENT_OPERATOR:=)(CastExpression(SimpleType(SimpleName:Element))(SimpleName:a_node)))))(Block(ReturnStatement(NullLiteral))))))(ExpressionStatement(Assignment(SimpleName:xmlSignature)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:XMLSignature)))))(ExpressionStatement(Assignment(SimpleName:oldSignatureNode)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:removeSignatureFromInternal)(METHOD_INVOCATION_ARGUMENTS(SimpleName:elementToSign)))))(TryStatement(Block(TryStatement(Block(ExpressionStatement(Assignment(SimpleName:digestValue)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:MessageDigest))(SimpleName:getInstance)(METHOD_INVOCATION_ARGUMENTS(StringLiteral:<STR>))))(SimpleName:digest)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(SimpleName:toCanonical)(METHOD_INVOCATION_ARGUMENTS(SimpleName:elementToSign))))))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:NoSuchAlgorithmException))(SimpleName:a_e))(Block(ReturnStatement(NullLiteral)))))(ExpressionStatement(Assignment(QualifiedName:xmlSignature.m_referenceURI)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))(ExpressionStatement(Assignment(QualifiedName:xmlSignature.m_digestMethod)(ASSIGNMENT_OPERATOR:=)(SimpleName:DIGEST_METHOD_ALGORITHM)))(ExpressionStatement(Assignment(QualifiedName:xmlSignature.m_digestValue)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Base64))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestValue)(BooleanLiteral:false))))))(VariableDeclarationStatement(SimpleType(SimpleName:Document))(VariableDeclarationFragment(SimpleName:doc)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:elementToSign))(SimpleName:getOwnerDocument))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:signedInfoNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ELEM_SIGNED_INFO)))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:canonicalizationNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ELEM_CANONICALIZATION_METHOD)))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:signatureMethodNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ELEM_SIGNATURE_METHOD)))))(VariableDeclarationStatement(SimpleType(SimpleName:String))(VariableDeclarationFragment(SimpleName:signatureMethod)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:a_privateKey))(SimpleName:getSignatureAlgorithm)))(SimpleName:getXMLSignatureAlgorithmReference))))(IfStatement(InfixExpression(SimpleName:signatureMethod)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(Assignment(QualifiedName:xmlSignature.m_signatureMethod)(ASSIGNMENT_OPERATOR:=)(SimpleName:signatureMethod)))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMLUtil))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureMethodNode)(SimpleName:ATTR_ALGORITHM)(SimpleName:signatureMethod)))))(Block(ExpressionStatement(Assignment(QualifiedName:xmlSignature.m_signatureMethod)(ASSIGNMENT_OPERATOR:=)(StringLiteral:<STR>)))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:referenceNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ELEM_REFERENCE)))))(IfStatement(InfixExpression(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:getReferenceURI)))(SimpleName:length))(INFIX_EXPRESSION_OPERATOR:>)(NumberLiteral:0))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:referenceNode))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ATTR_URI)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:xmlSignature))(SimpleName:getReferenceURI)))))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:digestMethodNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ELEM_DIGEST_METHOD)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMLUtil))(SimpleName:setAttribute)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestMethodNode)(SimpleName:ATTR_ALGORITHM)(SimpleName:DIGEST_METHOD_ALGORITHM))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:digestValueNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ELEM_DIGEST_VALUE)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:XMLUtil))(SimpleName:setValue)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestValueNode)(QualifiedName:xmlSignature.m_digestValue))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:referenceNode))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestMethodNode))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:referenceNode))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:digestValueNode))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedInfoNode))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:canonicalizationNode))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedInfoNode))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureMethodNode))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signedInfoNode))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:referenceNode))))(ExpressionStatement(Assignment(QualifiedName:xmlSignature.m_signedInfoCanonical)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(SimpleName:toCanonical)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedInfoNode)))))(ExpressionStatement(Assignment(SimpleName:signatureValue)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:ByteSignature))(SimpleName:sign)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:xmlSignature.m_signedInfoCanonical)(SimpleName:a_privateKey)))))(ExpressionStatement(Assignment(SimpleName:signatureValue)(ASSIGNMENT_OPERATOR:=)(MethodInvocation(METHOD_INVOCATION_RECEIVER(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:a_privateKey))(SimpleName:getSignatureAlgorithm)))(SimpleName:encodeForXMLSignature)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureValue)))))(IfStatement(InfixExpression(SimpleName:signatureValue)(INFIX_EXPRESSION_OPERATOR:==)(NullLiteral))(Block(ReturnStatement(NullLiteral))))(ExpressionStatement(Assignment(QualifiedName:xmlSignature.m_signatureValue)(ASSIGNMENT_OPERATOR:=)(ClassInstanceCreation(SimpleType(SimpleName:String))(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:Base64))(SimpleName:encode)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureValue)(BooleanLiteral:false))))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:signatureValueNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:ELEM_SIGNATURE_VALUE)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureValueNode))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:createTextNode)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:xmlSignature.m_signatureValue))))))(VariableDeclarationStatement(SimpleType(SimpleName:Element))(VariableDeclarationFragment(SimpleName:signatureNode)(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:doc))(SimpleName:createElement)(METHOD_INVOCATION_ARGUMENTS(SimpleName:XML_ELEMENT_NAME)))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureNode))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signedInfoNode))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:signatureNode))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureValueNode))))(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:elementToSign))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:signatureNode))))(ExpressionStatement(Assignment(QualifiedName:xmlSignature.m_elemSignature)(ASSIGNMENT_OPERATOR:=)(SimpleName:signatureNode)))(ExpressionStatement(Assignment(QualifiedName:xmlSignature.m_bVerified)(ASSIGNMENT_OPERATOR:=)(BooleanLiteral:true)))(ReturnStatement(SimpleName:xmlSignature)))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:XMLParseException))(SimpleName:a_e))(Block(IfStatement(InfixExpression(SimpleName:oldSignatureNode)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:elementToSign))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:oldSignatureNode))))))(ThrowStatement(SimpleName:a_e))))(CatchClause(SingleVariableDeclaration(SimpleType(SimpleName:Exception))(SimpleName:a_e))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:LogHolder))(SimpleName:log)(METHOD_INVOCATION_ARGUMENTS(QualifiedName:LogLevel.EXCEPTION)(QualifiedName:LogType.CRYPTO)(StringLiteral:<STR>)(SimpleName:a_e))))(IfStatement(InfixExpression(SimpleName:oldSignatureNode)(INFIX_EXPRESSION_OPERATOR:!=)(NullLiteral))(Block(ExpressionStatement(MethodInvocation(METHOD_INVOCATION_RECEIVER(SimpleName:elementToSign))(SimpleName:appendChild)(METHOD_INVOCATION_ARGUMENTS(SimpleName:oldSignatureNode))))))(ReturnStatement(NullLiteral)))))))))